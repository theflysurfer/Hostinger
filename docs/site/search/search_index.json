{"config":{"lang":["fr","en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Hostinger Server Documentation","text":"<p>Serveur : srv759970.hstgr.cloud (69.62.108.82) OS : Ubuntu 24.04.2 LTS Compte Admin : <code>automation</code></p>"},{"location":"#vue-densemble","title":"\ud83c\udfaf Vue d'Ensemble","text":"<p>Documentation compl\u00e8te pour la gestion du serveur Hostinger avec : - 45 applications d\u00e9ploy\u00e9es (13 cat\u00e9gories) - Infrastructure : Nginx, bases de donn\u00e9es, SSL, monitoring - Automation : Scripts, auto-start, backups - Documentation dynamique : \u00c9tat en temps r\u00e9el</p>"},{"location":"#navigation-rapide","title":"\ud83d\udcda Navigation Rapide","text":""},{"location":"#infrastructure","title":"\ud83c\udfd7\ufe0f Infrastructure","text":"<ul> <li>Serveur &amp; Configuration - Setup, users, s\u00e9curit\u00e9</li> <li>Nginx Manager - Reverse proxy, SSL, configs</li> <li>Bases de Donn\u00e9es - PostgreSQL, Redis, MongoDB partag\u00e9s</li> <li>Docker Architecture - Conteneurs, r\u00e9seaux, volumes</li> </ul>"},{"location":"#applications","title":"\ud83d\ude80 Applications","text":"<ul> <li>WordPress Sites - 4 sites WordPress (Clemence, SolidarLink, etc.)</li> <li>AI Transcription - WhisperX, Faster-Whisper</li> <li>AI RAG - RAGFlow, MemVid, RAG-Anything</li> <li>Dashboards - Energie Dashboard (DownTo40), Photos Chantier</li> </ul>"},{"location":"#operations","title":"\u2699\ufe0f Op\u00e9rations","text":"<ul> <li>D\u00e9ploiement - Proc\u00e9dures de d\u00e9ploiement</li> <li>Backup &amp; Restore - Strat\u00e9gie de sauvegarde</li> <li>Troubleshooting - R\u00e9solution de probl\u00e8mes</li> </ul>"},{"location":"#etat-en-temps-reel","title":"\ud83d\udcca \u00c9tat en Temps R\u00e9el","text":"<ul> <li>System Status - RAM, CPU, disque</li> <li>Containers Status - Docker containers actifs</li> <li>Services Health - Health checks</li> </ul>"},{"location":"#liens-rapides","title":"\ud83d\udea8 Liens Rapides","text":""},{"location":"#emergency","title":"Emergency","text":"<ul> <li>Emergency Runbook - Proc\u00e9dures d'urgence</li> <li>Incident History - Historique des incidents</li> </ul>"},{"location":"#dashboards","title":"Dashboards","text":"<ul> <li>Dashy Portal - Dashboard visuel</li> <li>Grafana Monitoring - M\u00e9triques</li> <li>Portainer - Gestion Docker</li> </ul>"},{"location":"#external-repos","title":"External Repos","text":"<ul> <li>Nginx Manager - Repo Nginx s\u00e9par\u00e9 (en activit\u00e9)</li> </ul>"},{"location":"#tags","title":"\ud83c\udff7\ufe0f Tags","text":"<p>La documentation utilise des tags pour filtrer les apps :</p> <ul> <li><code>production</code> - Applications en production</li> <li><code>staging</code> - Applications de test</li> <li><code>wordpress</code> - Sites WordPress</li> <li><code>ai</code> - Services IA/ML</li> <li><code>dashboard</code> - Dashboards custom</li> <li><code>monitoring</code> - Services de monitoring</li> </ul> <p>Rechercher par tag : Utiliser la barre de recherche avec <code>tag:production</code></p>"},{"location":"#quick-commands","title":"\ud83d\udd27 Quick Commands","text":"<pre><code># Se connecter au serveur\nssh automation@69.62.108.82\n\n# Voir les conteneurs actifs\ndocker ps --format 'table {{.Names}}\\t{{.Status}}'\n\n# Health check global\n./scripts/health-check-all.sh\n\n# Sync configs depuis serveur\n./scripts/sync-from-server.sh\n</code></pre>"},{"location":"#structure-du-repo","title":"\ud83d\udcd6 Structure du Repo","text":"<pre><code>Hostinger/\n\u251c\u2500\u2500 apps/                    # 45 applications (13 cat\u00e9gories)\n\u251c\u2500\u2500 infrastructure/          # Configs serveur, nginx, SSL\n\u251c\u2500\u2500 docs/                    # Cette documentation (MkDocs)\n\u251c\u2500\u2500 scripts/                 # Scripts d'administration\n\u2514\u2500\u2500 .claude/                 # Skills Claude Code\n</code></pre> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28 Version : 2.0.0 (Restructuration compl\u00e8te)</p>"},{"location":"01-infrastructure/","title":"Infrastructure - Vue d'Ensemble","text":"<p>Serveur : srv759970.hstgr.cloud (69.62.108.82) OS : Ubuntu 24.04.2 LTS RAM : 15 GB Disque : 193 GB</p>"},{"location":"01-infrastructure/#composants-infrastructure","title":"Composants Infrastructure","text":""},{"location":"01-infrastructure/#serveur","title":"\ud83d\udda5\ufe0f Serveur","text":"<ul> <li>Configuration syst\u00e8me</li> <li>Utilisateurs (compte <code>automation</code>)</li> <li>SSH et s\u00e9curit\u00e9</li> <li>Fail2ban</li> <li>Cron jobs</li> </ul>"},{"location":"01-infrastructure/#nginx-manager","title":"\ud83c\udf10 Nginx Manager","text":"<ul> <li>Reverse proxy pour 30+ sites</li> <li>SSL/TLS (Let's Encrypt)</li> <li>Rate limiting et s\u00e9curit\u00e9</li> <li>Bot protection</li> <li>Backup/rollback automatique</li> </ul>"},{"location":"01-infrastructure/#bases-de-donnees","title":"\ud83d\uddc4\ufe0f Bases de Donn\u00e9es","text":"<ul> <li>PostgreSQL partag\u00e9 (MemVid, Nextcloud)</li> <li>Redis partag\u00e9 (WhisperX, MemVid, Telegram Bot)</li> <li>MongoDB partag\u00e9 (inutilis\u00e9 actuellement)</li> </ul>"},{"location":"01-infrastructure/#docker-architecture","title":"\ud83d\udc33 Docker Architecture","text":"<ul> <li>36 conteneurs actifs</li> <li>19 stacks Docker Compose</li> <li>R\u00e9seaux partag\u00e9s</li> <li>Volumes persistants</li> <li>Auto-start system</li> </ul>"},{"location":"01-infrastructure/#securite","title":"\ud83d\udd12 S\u00e9curit\u00e9","text":"<ul> <li>Fail2ban (3 jails WordPress)</li> <li>Authentification Basic Auth</li> <li>SSL/TLS hardening</li> <li>Rate limiting</li> <li>Audit r\u00e9guliers</li> </ul>"},{"location":"01-infrastructure/#statistiques","title":"Statistiques","text":"M\u00e9trique Valeur Conteneurs actifs 36 / 64 RAM utilis\u00e9e ~12 GB / 15 GB Disque utilis\u00e9 77 GB / 193 GB (40%) Sites Nginx 30+ configur\u00e9s Certificats SSL 30+ actifs"},{"location":"01-infrastructure/#services-critiques","title":"Services Critiques","text":""},{"location":"01-infrastructure/#spof-single-point-of-failure","title":"SPOF (Single Point of Failure)","text":"<p>\u26a0\ufe0f Si down, impact multiple services :</p> <ol> <li>redis-shared \u2192 4+ services affect\u00e9s</li> <li>postgresql-shared \u2192 2 services affect\u00e9s</li> <li>nginx \u2192 Tous les sites down</li> <li>databases-shared \u2192 Arr\u00eat de nombreux services</li> </ol> <p>Recommandation : Monitoring actif + alertes</p>"},{"location":"01-infrastructure/#quick-commands","title":"Quick Commands","text":"<pre><code># Se connecter au serveur\nssh automation@69.62.108.82\n\n# \u00c9tat syst\u00e8me\nfree -h                  # RAM\ndf -h                    # Disque\ndocker ps                # Conteneurs\n\n# Services critiques\nsudo systemctl status nginx\nsudo systemctl status docker\ndocker ps | grep -E \"redis|postgres\"\n\n# Logs\nsudo journalctl -u nginx -n 50\ndocker logs &lt;container&gt; --tail 50\n</code></pre>"},{"location":"01-infrastructure/#liens-rapides","title":"Liens Rapides","text":"<ul> <li>Nginx Manager - Gestion configs Nginx</li> <li>Databases - Bases de donn\u00e9es partag\u00e9es</li> <li>S\u00e9curit\u00e9 - Audit et hardening</li> <li>Docker - Architecture conteneurs</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28</p>"},{"location":"01-infrastructure/architecture-dependencies/","title":"Architecture et D\u00e9pendances - Serveur srv759970.hstgr.cloud","text":"<p>Date: 27 octobre 2025 Serveur: srv759970.hstgr.cloud OS: MSYS_NT-10.0-22635 (Ubuntu-based) Ressources: 15 GB RAM, 193 GB disque, 4 CPU cores</p>"},{"location":"01-infrastructure/architecture-dependencies/#vue-densemble","title":"\ud83d\udcca Vue d'ensemble","text":"<p>\u00c9tat actuel: - \ud83d\udfe2 Actifs: 14 stacks / 36 conteneurs - \ud83d\udd34 Arr\u00eat\u00e9s: 13 conteneurs (optimisation RAM) - \ud83d\udcbe Disque: 77 GB / 193 GB (40%) - \ud83e\udde0 RAM: 9 GB disponibles / 15 GB</p>"},{"location":"01-infrastructure/architecture-dependencies/#stacks-de-services","title":"\ud83c\udfaf Stacks de Services","text":""},{"location":"01-infrastructure/architecture-dependencies/#1-ragflow-ia-rag-stack-principal-actif","title":"1. \ud83e\udd16 RAGFlow (IA / RAG) - STACK PRINCIPAL ACTIF","text":"<p>Statut: \ud83d\udfe2 Actif (depuis optimisation) R\u00e9seau: <code>docker_ragflow</code> RAM totale: ~3.4 GB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>ragflow-server</code> infiniflow/ragflow:v0.21.0-slim 2.1 GB API Backend + Frontend nginx \u2705 ragflow-mysql\u2705 ragflow-redis\u2705 ragflow-minio\u2705 ragflow-es-01 <code>ragflow-es-01</code> elasticsearch:8.11.3 913 MB Vector database (Elasticsearch) \u2705 ragflow-server <code>ragflow-mysql</code> mysql:8.0.39 386 MB Database (metadata) \u2705 ragflow-server <code>ragflow-minio</code> minio:2025.06.13 261 MB Object storage (documents) \u2705 ragflow-server <code>ragflow-redis</code> valkey/valkey:8 4.8 MB Cache &amp; queue \u2705 ragflow-server"},{"location":"01-infrastructure/architecture-dependencies/#volumes","title":"Volumes","text":"<ul> <li><code>docker_esdata01</code> - Elasticsearch data (32.5 MB)</li> <li><code>docker_mysql_data</code> - MySQL database (257 MB)</li> <li><code>docker_minio_data</code> - MinIO object storage (16 KB)</li> <li><code>docker_redis_data</code> - Redis cache (2.4 KB)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#ports-exposes","title":"Ports expos\u00e9s","text":"<ul> <li><code>9500</code> \u2192 9380 (Backend API)</li> <li><code>9501</code> \u2192 9381 (Admin API)</li> <li><code>9504</code> \u2192 80 (Frontend nginx)</li> <li><code>1220</code> \u2192 9200 (Elasticsearch)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#dependances-critiques","title":"D\u00e9pendances critiques","text":"<pre><code>ragflow-server\n\u251c\u2500\u2500 ragflow-mysql (base de donn\u00e9es)\n\u251c\u2500\u2500 ragflow-redis (cache)\n\u251c\u2500\u2500 ragflow-minio (stockage fichiers)\n\u2514\u2500\u2500 ragflow-es-01 (vectorisation documents)\n</code></pre> <p>\u26a0\ufe0f Si un composant tombe : Le syst\u00e8me complet est inutilisable</p>"},{"location":"01-infrastructure/architecture-dependencies/#2-energie-dashboard-projet-downto40-principal","title":"2. \u26a1 Energie Dashboard - PROJET DOWNTO40 PRINCIPAL","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>energie-dashboard_default</code> RAM totale: ~123 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_1","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>energie-40eur-dashboard</code> energie-dashboard_app 123 MB Streamlit dashboard prix \u00e9lectricit\u00e9 Aucune (standalone)"},{"location":"01-infrastructure/architecture-dependencies/#volumes_1","title":"Volumes","text":"<ul> <li>Aucun (donn\u00e9es locales ou API externes)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#ports-exposes_1","title":"Ports expos\u00e9s","text":"<ul> <li><code>8501</code> \u2192 8501 (Streamlit HTTP)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#url","title":"URL","text":"<ul> <li>https://energie.srv759970.hstgr.cloud</li> </ul> <p>\u2705 Ind\u00e9pendant : Peut fonctionner seul</p>"},{"location":"01-infrastructure/architecture-dependencies/#3-langchain-service-api-ia","title":"3. \ud83d\udd17 LangChain Service - API IA","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>langchain-service_langchain-network</code> RAM totale: ~74 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_2","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>langchain-service</code> langchain-service:latest 74 MB API LangChain orchestration \u26a0\ufe0f telegram-voice-bot\u26a0\ufe0f redis-shared (optionnel)"},{"location":"01-infrastructure/architecture-dependencies/#limite-memoire","title":"Limite m\u00e9moire","text":"<ul> <li>Max: 1 GB (d\u00e9fini dans docker-compose)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#ports-exposes_2","title":"Ports expos\u00e9s","text":"<ul> <li><code>8503</code> \u2192 8503 (Uvicorn HTTP)</li> </ul> <p>\u26a0\ufe0f Connect\u00e9 \u00e0 : telegram-voice-bot, whisperx</p>"},{"location":"01-infrastructure/architecture-dependencies/#4-telegram-voice-bot","title":"4. \ud83d\udcac Telegram Voice Bot","text":"<p>Statut: \ud83d\udfe2 Actif (Healthy) R\u00e9seaux: - <code>telegram-bot_default</code> - <code>langchain-service_langchain-network</code> - <code>whisperx_whisperx</code></p> <p>RAM totale: ~35 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_3","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>telegram-voice-bot</code> telegram-bot:latest 35 MB Bot Telegram vocal \u2705 langchain-service\u26a0\ufe0f whisperx (redis)"},{"location":"01-infrastructure/architecture-dependencies/#limite-memoire_1","title":"Limite m\u00e9moire","text":"<ul> <li>Max: 512 MB</li> </ul> <p>\ud83d\udd17 Multi-r\u00e9seau : Communique avec 3 stacks diff\u00e9rentes</p>"},{"location":"01-infrastructure/architecture-dependencies/#5-discord-voice-bot","title":"5. \ud83d\udcac Discord Voice Bot","text":"<p>Statut: \ud83d\udfe2 Actif (Unhealthy - \u00e0 v\u00e9rifier) R\u00e9seau: <code>discord-bot_discord-network</code> RAM totale: ~34 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_4","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>discord-voice-bot</code> discord-bot:latest 34 MB Bot Discord vocal \u26a0\ufe0f \u00c0 v\u00e9rifier (unhealthy)"},{"location":"01-infrastructure/architecture-dependencies/#limite-memoire_2","title":"Limite m\u00e9moire","text":"<ul> <li>Max: 512 MB</li> </ul> <p>\u26a0\ufe0f Status unhealthy : N\u00e9cessite investigation</p>"},{"location":"01-infrastructure/architecture-dependencies/#6-human-chain-interface-humainia","title":"6. \ud83e\udd1d Human Chain - Interface Humain/IA","text":"<p>Statut: \ud83d\udfe2 Actif (Backend unhealthy) R\u00e9seau: <code>human-chain_human-chain-net</code> RAM totale: ~62 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_5","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>human-chain-frontend</code> human-chain_frontend 5.9 MB Interface web (React/Vue) \u2705 human-chain-backend <code>human-chain-backend</code> human-chain_backend 56.9 MB API backend \u26a0\ufe0f \u00c0 v\u00e9rifier (unhealthy) <p>\u26a0\ufe0f Backend unhealthy : Frontend d\u00e9pend du backend</p>"},{"location":"01-infrastructure/architecture-dependencies/#7-memvid-video-transcription","title":"7. \ud83c\udfac MemVid - Vid\u00e9o + Transcription","text":"<p>Statut: \ud83d\udd34 Arr\u00eat\u00e9 (optimisation RAM) R\u00e9seaux: - <code>memvid_memvid-network</code> - <code>monitoring_monitoring</code> - <code>whisperx_whisperx</code></p> <p>RAM totale quand actif: ~962 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_6","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>memvid-api</code> memvid_memvid-api 871 MB API FastAPI uploads vid\u00e9os \u2705 redis-shared\u2705 postgresql-shared\u26a0\ufe0f whisperx <code>memvid-ui</code> memvid_memvid-ui 45 MB Interface Streamlit \u2705 memvid-api <code>memvid-worker</code> memvid_memvid-worker (stopped) Worker traitement vid\u00e9os \u2705 redis-shared\u2705 memvid-api"},{"location":"01-infrastructure/architecture-dependencies/#volumes_2","title":"Volumes","text":"<ul> <li>Aucun volume d\u00e9di\u00e9</li> </ul> <p>\ud83d\udd17 Multi-r\u00e9seau : Communique avec monitoring + whisperx</p>"},{"location":"01-infrastructure/architecture-dependencies/#8-whisperx-transcription-audio","title":"8. \ud83c\udf99\ufe0f WhisperX - Transcription Audio","text":"<p>Statut: \ud83d\udfe2 Actif (worker uniquement) R\u00e9seau: <code>faster-whisper-queue_faster-whisper-net</code> + <code>whisperx_whisperx</code> RAM totale: ~24 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_7","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>faster-whisper-worker</code> faster-whisper-worker 24 MB Worker transcription Whisper \u2705 redis-shared <code>rq-exporter-faster-whisper</code> mdawar/rq-exporter 23 MB Metrics RQ queue \u2705 redis-shared <code>rq-exporter-whisperx</code> mdawar/rq-exporter 25 MB Metrics RQ queue \u2705 redis-shared"},{"location":"01-infrastructure/architecture-dependencies/#volumes_3","title":"Volumes","text":"<ul> <li><code>whisperx_rq-queue-redis-data</code> (4.8 MB)</li> <li><code>whisperx_whisperx-redis-data</code> (236 KB)</li> <li><code>whisperx_whisperx-uploads</code> (34 MB)</li> </ul> <p>\u2705 Partag\u00e9 : Utilis\u00e9 par telegram-bot, memvid, discord-bot</p>"},{"location":"01-infrastructure/architecture-dependencies/#9-bases-de-donnees-partagees-infrastructure-critique","title":"9. \ud83d\uddc4\ufe0f Bases de Donn\u00e9es Partag\u00e9es - INFRASTRUCTURE CRITIQUE","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>databases-shared</code> RAM totale: ~535 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_8","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le Services utilisant <code>postgresql-shared</code> postgres:17-alpine 31 MB PostgreSQL partag\u00e9 \u2705 memvid-api\u26a0\ufe0f nextcloud (si actif) <code>redis-shared</code> redis:7-alpine 7 MB Redis partag\u00e9 \u2705 memvid\u2705 whisperx\u2705 telegram-bot <code>mongodb-shared</code> mongo:7 101 MB MongoDB partag\u00e9 \ud83d\udd34 Arr\u00eat\u00e9 (aucun service actif) <code>postgres-exporter</code> postgres-exporter 11 MB Metrics PostgreSQL \u2705 prometheus (monitoring)"},{"location":"01-infrastructure/architecture-dependencies/#volumes_4","title":"Volumes","text":"<ul> <li><code>databases-shared_postgres-data</code> (0 B - vide actuellement)</li> <li><code>databases-shared_redis-data</code> (0 B)</li> <li><code>databases-shared_mongo-data</code> (0 B)</li> </ul> <p>\ud83d\udea8 INFRASTRUCTURE CRITIQUE : Utilis\u00e9 par 5+ stacks</p>"},{"location":"01-infrastructure/architecture-dependencies/#10-monitoring-stack-grafana-prometheus-loki","title":"10. \ud83d\udcca Monitoring Stack - Grafana + Prometheus + Loki","text":"<p>Statut: \ud83d\udd34 Arr\u00eat\u00e9 (optimisation RAM) R\u00e9seau: <code>monitoring_monitoring</code> RAM totale quand actif: ~262 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_9","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>grafana</code> grafana/grafana 118 MB Dashboards m\u00e9triques \u2705 prometheus\u2705 loki <code>prometheus</code> prom/prometheus 51 MB Time-series database \u2705 postgres-exporter\u2705 rq-exporters <code>loki</code> grafana/loki 92 MB Log aggregation \u26a0\ufe0f promtail <code>promtail</code> grafana/promtail 42 MB Log collector \u2705 loki"},{"location":"01-infrastructure/architecture-dependencies/#volumes_5","title":"Volumes","text":"<ul> <li><code>monitoring_grafana-data</code> (139.9 MB)</li> <li><code>monitoring_prometheus-data</code> (66.5 MB)</li> <li><code>monitoring_loki-data</code> (6.1 MB)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#ports-exposes-quand-actif","title":"Ports expos\u00e9s (quand actif)","text":"<ul> <li><code>3000</code> \u2192 3000 (Grafana UI)</li> <li><code>9090</code> \u2192 9090 (Prometheus API)</li> <li><code>3100</code> \u2192 3100 (Loki API)</li> </ul> <p>\ud83d\udd17 Multi-r\u00e9seau : Connect\u00e9 \u00e0 databases-shared, langchain, memvid</p>"},{"location":"01-infrastructure/architecture-dependencies/#11-nextcloud-cloud-storage","title":"11. \ud83d\udcc1 Nextcloud - Cloud Storage","text":"<p>Statut: \ud83d\udd34 Arr\u00eat\u00e9 (optimisation RAM) R\u00e9seaux: - <code>databases-shared</code> - <code>nextcloud</code></p> <p>RAM totale quand actif: ~125 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_10","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>nextcloud</code> nextcloud:29-apache 111 MB Application Nextcloud \u2705 postgresql-shared\u2705 redis-shared <code>nextcloud-cron</code> nextcloud:29-apache 14 MB T\u00e2ches planifi\u00e9es \u2705 nextcloud"},{"location":"01-infrastructure/architecture-dependencies/#volumes_6","title":"Volumes","text":"<ul> <li><code>nextcloud_nextcloud-data</code> (0 B - vide)</li> <li><code>nextcloud_onlyoffice-data</code> (2 KB)</li> <li><code>nextcloud_onlyoffice-log</code> (36 KB)</li> </ul> <p>\ud83d\udd17 Multi-r\u00e9seau : Utilise databases-shared</p>"},{"location":"01-infrastructure/architecture-dependencies/#12-wordpress-clemence","title":"12. \ud83d\udcdd WordPress Clemence","text":"<p>Statut: \ud83d\udd34 Arr\u00eat\u00e9 (optimisation RAM) R\u00e9seau: <code>wordpress-clemence_clemence-network</code> RAM totale quand actif: ~840 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_11","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>wordpress-clemence</code> wordpress:php8.3-fpm 69 MB WordPress PHP-FPM \u2705 mysql-clemence <code>mysql-clemence</code> mysql:8.0 383 MB Base de donn\u00e9es MySQL \u2705 wordpress-clemence <code>nginx-clemence</code> nginx:alpine 5 MB Serveur web nginx \u2705 wordpress-clemence <code>wp-cli-clemence</code> wordpress:cli-php8.3 0.3 MB WP-CLI pour admin \u2705 wordpress-clemence"},{"location":"01-infrastructure/architecture-dependencies/#volumes_7","title":"Volumes","text":"<ul> <li><code>wordpress-clemence_mysql-data</code> (247.5 MB)</li> <li><code>wordpress-clemence_wordpress-data</code> (116.5 MB)</li> </ul>"},{"location":"01-infrastructure/architecture-dependencies/#dependances-strictes","title":"D\u00e9pendances strictes","text":"<pre><code>nginx-clemence\n\u2514\u2500\u2500 wordpress-clemence (PHP-FPM via FastCGI)\n    \u2514\u2500\u2500 mysql-clemence (database)\n</code></pre> <p>\u26a0\ufe0f Stack complet : Les 4 conteneurs doivent \u00eatre actifs ensemble</p>"},{"location":"01-infrastructure/architecture-dependencies/#13-photos-chantier","title":"13. \ud83d\uddbc\ufe0f Photos Chantier","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>photos-chantier_photos-network</code> RAM totale: ~46 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_12","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>photos-chantier</code> photos-chantier 46 MB Application photos Aucune (standalone) <p>\u2705 Ind\u00e9pendant : Peut fonctionner seul</p>"},{"location":"01-infrastructure/architecture-dependencies/#14-mkdocs-documentation","title":"14. \ud83d\udcda MkDocs - Documentation","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>mkdocs_default</code> RAM totale: ~52 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_13","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>mkdocs</code> mkdocs:latest 52 MB Documentation site Aucune (standalone) <p>\u2705 Ind\u00e9pendant : Peut fonctionner seul</p>"},{"location":"01-infrastructure/architecture-dependencies/#15-dashy-dashboard-liens","title":"15. \ud83d\udcca Dashy - Dashboard Liens","text":"<p>Statut: \ud83d\udfe2 Actif (Healthy) R\u00e9seau: <code>dashy_default</code> RAM totale: ~116 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_14","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>dashy</code> lissy93/dashy 116 MB Dashboard liens/apps Aucune (standalone) <p>\u2705 Ind\u00e9pendant : Peut fonctionner seul</p>"},{"location":"01-infrastructure/architecture-dependencies/#16-portainer-docker-management","title":"16. \ud83d\udda5\ufe0f Portainer - Docker Management","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>bridge</code> (default) RAM totale: ~21 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_15","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>portainer</code> portainer/portainer-ce 21 MB Docker web UI Aucune (acc\u00e8s Docker socket)"},{"location":"01-infrastructure/architecture-dependencies/#volumes_8","title":"Volumes","text":"<ul> <li><code>portainer_data</code> (1 MB)</li> </ul> <p>\u2705 Ind\u00e9pendant : Management interface</p>"},{"location":"01-infrastructure/architecture-dependencies/#17-glances-system-monitoring","title":"17. \ud83d\udcc8 Glances - System Monitoring","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>bridge</code> (default) RAM totale: ~68 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_16","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>glances</code> nicolargo/glances 68 MB Monitoring syst\u00e8me temps r\u00e9el Aucune (lecture host)"},{"location":"01-infrastructure/architecture-dependencies/#limite-memoire_3","title":"Limite m\u00e9moire","text":"<ul> <li>Max: 256 MB</li> </ul> <p>\u2705 Ind\u00e9pendant : Monitoring local</p>"},{"location":"01-infrastructure/architecture-dependencies/#18-rustdesk-remote-desktop","title":"18. \ud83d\udda5\ufe0f RustDesk - Remote Desktop","text":"<p>Statut: \ud83d\udfe2 Actif R\u00e9seau: <code>rustdesk_rustdesk-net</code> RAM totale: ~0.8 MB</p>"},{"location":"01-infrastructure/architecture-dependencies/#conteneurs_17","title":"Conteneurs","text":"Conteneur Image RAM R\u00f4le D\u00e9pendances <code>hbbr</code> rustdesk/rustdesk-server 0.8 MB RustDesk relay broker Aucune (P2P relay) <p>\u2705 Ind\u00e9pendant : Service P2P</p>"},{"location":"01-infrastructure/architecture-dependencies/#graphe-de-dependances-global","title":"\ud83d\udd17 Graphe de D\u00e9pendances Global","text":"<pre><code>INFRASTRUCTURE PARTAG\u00c9E\n\u2514\u2500\u2500 databases-shared\n    \u251c\u2500\u2500 postgresql-shared \u2500\u2500\u2500\u2500\u252c\u2500\u2500&gt; memvid-api\n    \u2502                          \u251c\u2500\u2500&gt; nextcloud (stopped)\n    \u2502                          \u2514\u2500\u2500&gt; postgres-exporter\n    \u251c\u2500\u2500 redis-shared \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500&gt; memvid (api + worker)\n    \u2502                          \u251c\u2500\u2500&gt; whisperx (workers)\n    \u2502                          \u251c\u2500\u2500&gt; telegram-voice-bot\n    \u2502                          \u2514\u2500\u2500&gt; nextcloud (stopped)\n    \u2514\u2500\u2500 mongodb-shared \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; (AUCUN SERVICE ACTIF)\n\nSTACKS IND\u00c9PENDANTES\n\u251c\u2500\u2500 ragflow \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; ragflow-server + es-01 + mysql + minio + redis\n\u251c\u2500\u2500 energie-dashboard \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; energie-40eur-dashboard\n\u251c\u2500\u2500 photos-chantier \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; photos-chantier\n\u251c\u2500\u2500 mkdocs \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; mkdocs\n\u251c\u2500\u2500 dashy \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; dashy\n\u251c\u2500\u2500 portainer \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; portainer\n\u251c\u2500\u2500 glances \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; glances\n\u2514\u2500\u2500 rustdesk \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; hbbr\n\nSTACKS AVEC D\u00c9PENDANCES INTERNES\n\u251c\u2500\u2500 human-chain\n\u2502   \u251c\u2500\u2500 human-chain-frontend \u2500&gt; human-chain-backend\n\u2502   \u2514\u2500\u2500 human-chain-backend\n\u251c\u2500\u2500 wordpress-clemence\n\u2502   \u251c\u2500\u2500 nginx-clemence \u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; wordpress-clemence \u2500\u2500&gt; mysql-clemence\n\u2502   \u2514\u2500\u2500 wp-cli-clemence \u2500\u2500\u2500\u2500\u2500\u2500&gt; wordpress-clemence\n\u2514\u2500\u2500 langchain-service\n    \u2514\u2500\u2500 langchain-service \u2500\u2500\u2500\u2500&gt; telegram-voice-bot\n\nSTACKS MULTI-R\u00c9SEAU (Complexes)\n\u251c\u2500\u2500 memvid\n\u2502   \u251c\u2500\u2500 memvid-api \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; postgresql-shared, redis-shared, whisperx\n\u2502   \u251c\u2500\u2500 memvid-ui \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; memvid-api\n\u2502   \u2514\u2500\u2500 memvid-worker \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; memvid-api, redis-shared\n\u251c\u2500\u2500 telegram-voice-bot \u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; langchain-service, whisperx (redis)\n\u251c\u2500\u2500 whisperx\n\u2502   \u251c\u2500\u2500 faster-whisper-worker &gt; redis-shared\n\u2502   \u2514\u2500\u2500 rq-exporters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; redis-shared, prometheus\n\u2514\u2500\u2500 monitoring (STOPPED)\n    \u251c\u2500\u2500 prometheus \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; postgres-exporter, rq-exporters, langchain\n    \u251c\u2500\u2500 grafana \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; prometheus, loki\n    \u251c\u2500\u2500 loki \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; promtail\n    \u2514\u2500\u2500 promtail \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; (logs host)\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#points-critiques","title":"\u26a0\ufe0f Points Critiques","text":""},{"location":"01-infrastructure/architecture-dependencies/#services-avec-dependances-multiples","title":"\ud83d\udea8 Services avec d\u00e9pendances multiples","text":"<ol> <li>redis-shared (SPOF)</li> <li>Utilis\u00e9 par: memvid, whisperx, telegram-bot, nextcloud</li> <li> <p>Impact si down: 4+ services affect\u00e9s</p> </li> <li> <p>postgresql-shared (SPOF)</p> </li> <li>Utilis\u00e9 par: memvid-api, nextcloud</li> <li> <p>Impact si down: 2 services affect\u00e9s</p> </li> <li> <p>langchain-service</p> </li> <li>Utilis\u00e9 par: telegram-voice-bot</li> <li>Impact si down: telegram bot non fonctionnel</li> </ol>"},{"location":"01-infrastructure/architecture-dependencies/#services-avec-status-unhealthy","title":"\ud83d\udd34 Services avec status unhealthy","text":"<ol> <li>human-chain-backend - Backend non fonctionnel</li> <li>discord-voice-bot - Bot Discord non fonctionnel</li> </ol>"},{"location":"01-infrastructure/architecture-dependencies/#volumes-orphelins-a-nettoyer","title":"\ud83d\udce6 Volumes orphelins (\u00e0 nettoyer)","text":"<p>Les volumes suivants n'ont aucun conteneur actif :</p> <pre><code># Volumes de services supprim\u00e9s\n- invidious_invidious-db-data (52.75 MB)\n- paperless-ai_paperless-ai-data (258.9 KB)\n- paperless-ngx_* (4 volumes)\n- rag-anything_* (2 volumes)\n- open-webui (1.08 GB) \u26a0\ufe0f GROS\n- deploy_xtts-models (0 B)\n\n# Volumes WordPress orphelins\n- wordpress-jesuishyperphagique_* (274 MB)\n- wordpress-panneauxsolidaires_* (274 MB)\n- wordpress-solidarlink_* (474 MB)\n- wordpress-shared-db_* (221 MB)\n</code></pre> <p>Total r\u00e9cup\u00e9rable: ~2.5 GB</p>"},{"location":"01-infrastructure/architecture-dependencies/#recommandations","title":"\ud83c\udfaf Recommandations","text":""},{"location":"01-infrastructure/architecture-dependencies/#pour-redemarrer-un-service-arrete","title":"Pour red\u00e9marrer un service arr\u00eat\u00e9","text":""},{"location":"01-infrastructure/architecture-dependencies/#wordpress-clemence-stack-complete","title":"WordPress Clemence (Stack compl\u00e8te)","text":"<pre><code>docker start mysql-clemence &amp;&amp; sleep 5\ndocker start wordpress-clemence\ndocker start nginx-clemence\ndocker start wp-cli-clemence\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#monitoring-stack","title":"Monitoring Stack","text":"<pre><code>docker start loki promtail\ndocker start prometheus\ndocker start grafana\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#nextcloud","title":"Nextcloud","text":"<pre><code>docker start nextcloud\ndocker start nextcloud-cron\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#memvid","title":"MemVid","text":"<pre><code>docker start memvid-api\ndocker start memvid-ui\n# memvid-worker si besoin de traitement\ndocker start memvid-worker\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#pour-nettoyer-les-volumes-orphelins","title":"Pour nettoyer les volumes orphelins","text":"<pre><code># ATTENTION: Supprimer d\u00e9finitivement les donn\u00e9es !\ndocker volume rm \\\n  invidious_invidious-db-data \\\n  open-webui \\\n  paperless-ai_paperless-ai-data \\\n  paperless-ngx_paperless-data \\\n  paperless-ngx_paperless-db-data \\\n  paperless-ngx_paperless-media \\\n  paperless-ngx_paperless-redis-data \\\n  rag-anything_rag-anything-output \\\n  rag-anything_rag-anything-storage \\\n  deploy_xtts-models \\\n  wordpress-jesuishyperphagique_mysql-jesuishyperphagique-data \\\n  wordpress-jesuishyperphagique_wordpress-jesuishyperphagique-data \\\n  wordpress-panneauxsolidaires_mysql-panneauxsolidaires-data \\\n  wordpress-panneauxsolidaires_wordpress-panneauxsolidaires-data \\\n  wordpress-solidarlink_mysql-data \\\n  wordpress-solidarlink_mysql-solidarlink-data \\\n  wordpress-solidarlink_wordpress-data \\\n  wordpress-solidarlink_wordpress-solidarlink-data \\\n  wordpress-shared-db_mysql-wordpress-shared-data\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#pour-identifier-un-service-utilisateur-de-redis-shared","title":"Pour identifier un service utilisateur de <code>redis-shared</code>","text":"<pre><code># Voir les connexions actives\ndocker exec redis-shared redis-cli CLIENT LIST\n\n# Voir les cl\u00e9s utilis\u00e9es\ndocker exec redis-shared redis-cli KEYS '*'\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#pour-identifier-un-service-utilisateur-de-postgresql-shared","title":"Pour identifier un service utilisateur de <code>postgresql-shared</code>","text":"<pre><code># Lister les bases de donn\u00e9es\ndocker exec postgresql-shared psql -U postgres -c '\\l'\n\n# Lister les connexions actives\ndocker exec postgresql-shared psql -U postgres -c \"SELECT datname, usename, client_addr FROM pg_stat_activity WHERE state = 'active';\"\n</code></pre>"},{"location":"01-infrastructure/architecture-dependencies/#notes-de-maintenance","title":"\ud83d\udcdd Notes de Maintenance","text":"<p>Derni\u00e8re optimisation: 27 octobre 2025 - Elasticsearch heap: 8GB \u2192 1GB (-3.5 GB RAM) - Services arr\u00eat\u00e9s: 13 conteneurs (-1.5 GB RAM) - Docker images nettoy\u00e9es: -84.5 GB disque - Logs nettoy\u00e9s: -1.6 GB disque</p> <p>Services critiques actifs: - \u2705 RAGFlow (complet) - \u2705 energie-40eur-dashboard (DownTo40 projet) - \u2705 databases-shared (infrastructure) - \u2705 langchain + telegram/discord bots - \u2705 whisperx workers</p> <p>\u00c0 investiguer: - \u26a0\ufe0f human-chain-backend (unhealthy) - \u26a0\ufe0f discord-voice-bot (unhealthy) - \u26a0\ufe0f mongodb-shared (aucun service actif, peut \u00eatre supprim\u00e9)</p> <p>Derni\u00e8re mise \u00e0 jour: 27 octobre 2025 - 16h15</p>"},{"location":"01-infrastructure/basic-auth/","title":"Guide d'utilisation - Basic Auth sur srv759970.hstgr.cloud","text":""},{"location":"01-infrastructure/basic-auth/#protection-activee","title":"\ud83d\udd12 Protection activ\u00e9e","text":"<p>Tous les sites et APIs sur <code>srv759970.hstgr.cloud</code> sont maintenant prot\u00e9g\u00e9s par HTTP Basic Authentication.</p>"},{"location":"01-infrastructure/basic-auth/#identifiants","title":"\ud83d\udd11 Identifiants","text":"<p>Username : <code>julien</code> Password : <code>DevAccess2025</code></p>"},{"location":"01-infrastructure/basic-auth/#acces-via-navigateur-web","title":"\ud83c\udf10 Acc\u00e8s via Navigateur Web","text":""},{"location":"01-infrastructure/basic-auth/#tous-les-sites-proteges","title":"Tous les sites prot\u00e9g\u00e9s :","text":"<ul> <li>https://clemence.srv759970.hstgr.cloud</li> <li>https://cristina.srv759970.hstgr.cloud</li> <li>https://wordpress.srv759970.hstgr.cloud</li> <li>https://admin.cristina.srv759970.hstgr.cloud (Strapi)</li> <li>https://dashboard.srv759970.hstgr.cloud</li> <li>https://sharepoint.srv759970.hstgr.cloud</li> <li>https://portal.srv759970.hstgr.cloud</li> <li>https://whisper.srv759970.hstgr.cloud</li> <li>https://tika.srv759970.hstgr.cloud</li> </ul>"},{"location":"01-infrastructure/basic-auth/#comment-se-connecter","title":"Comment se connecter :","text":"<ol> <li>Ouvrir l'URL dans le navigateur</li> <li>Une popup appara\u00eet demandant login/password</li> <li>Entrer :</li> <li>Nom d'utilisateur : <code>julien</code></li> <li>Mot de passe : <code>DevAccess2025</code></li> <li>Cliquer OK ou Se connecter</li> </ol> <p>Le navigateur m\u00e9morise les credentials pour la session.</p>"},{"location":"01-infrastructure/basic-auth/#acces-api-via-code","title":"\ud83d\udd27 Acc\u00e8s API via Code","text":"<p>Toutes les APIs n\u00e9cessitent maintenant l'authentification Basic Auth.</p>"},{"location":"01-infrastructure/basic-auth/#python-requests","title":"Python (requests)","text":"<pre><code>import requests\n\n# M\u00e9thode 1 : auth parameter (recommand\u00e9e)\nresponse = requests.get(\n    'https://whisper.srv759970.hstgr.cloud/docs',\n    auth=('julien', 'DevAccess2025')\n)\n\n# M\u00e9thode 2 : headers manuels\nimport base64\ncredentials = base64.b64encode(b'julien:DevAccess2025').decode('utf-8')\nheaders = {'Authorization': f'Basic {credentials}'}\nresponse = requests.get(\n    'https://whisper.srv759970.hstgr.cloud/docs',\n    headers=headers\n)\n\n# Exemple Whisper API (transcription)\nwith open('audio.mp3', 'rb') as audio_file:\n    response = requests.post(\n        'https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions',\n        auth=('julien', 'DevAccess2025'),\n        files={'file': audio_file},\n        data={'model': 'base'}\n    )\n    print(response.json())\n\n# Exemple Tika API (extraction document)\nwith open('document.pdf', 'rb') as doc:\n    response = requests.put(\n        'https://tika.srv759970.hstgr.cloud/tika',\n        auth=('julien', 'DevAccess2025'),\n        data=doc,\n        headers={'Accept': 'text/plain'}\n    )\n    print(response.text)\n\n# Exemple Ollama API (g\u00e9n\u00e9ration texte)\nresponse = requests.post(\n    'http://69.62.108.82:11435/api/generate',\n    auth=('julien', 'DevAccess2025'),\n    json={\n        'model': 'qwen2.5:3b',\n        'prompt': 'Explique-moi la diversit\u00e9 en entreprise',\n        'stream': False\n    }\n)\nprint(response.json()['response'])\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#javascript-nodejs-fetch","title":"JavaScript / Node.js (fetch)","text":"<pre><code>// M\u00e9thode 1 : Basic Auth dans l'URL (simple mais visible)\nfetch('https://julien:DevAccess2025@whisper.srv759970.hstgr.cloud/docs')\n    .then(res =&gt; res.json())\n    .then(data =&gt; console.log(data));\n\n// M\u00e9thode 2 : Headers manuels (recommand\u00e9e)\nconst credentials = btoa('julien:DevAccess2025');\nfetch('https://whisper.srv759970.hstgr.cloud/docs', {\n    headers: {\n        'Authorization': `Basic ${credentials}`\n    }\n})\n.then(res =&gt; res.json())\n.then(data =&gt; console.log(data));\n\n// Exemple Whisper API\nconst formData = new FormData();\nformData.append('file', audioBlob, 'audio.mp3');\nformData.append('model', 'base');\n\nfetch('https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions', {\n    method: 'POST',\n    headers: {\n        'Authorization': `Basic ${btoa('julien:DevAccess2025')}`\n    },\n    body: formData\n})\n.then(res =&gt; res.json())\n.then(data =&gt; console.log(data.text));\n\n// Exemple Tika API\nfetch('https://tika.srv759970.hstgr.cloud/tika', {\n    method: 'PUT',\n    headers: {\n        'Authorization': `Basic ${btoa('julien:DevAccess2025')}`,\n        'Accept': 'text/plain'\n    },\n    body: pdfFile\n})\n.then(res =&gt; res.text())\n.then(text =&gt; console.log(text));\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#curl-terminalbash","title":"cURL (Terminal/Bash)","text":"<pre><code># M\u00e9thode 1 : -u flag (recommand\u00e9e)\ncurl -u julien:DevAccess2025 https://clemence.srv759970.hstgr.cloud\n\n# M\u00e9thode 2 : URL avec credentials\ncurl https://julien:DevAccess2025@clemence.srv759970.hstgr.cloud\n\n# M\u00e9thode 3 : Header manuel\ncurl -H \"Authorization: Basic anVsaWVuOkRldkFjY2VzczIwMjU=\" https://clemence.srv759970.hstgr.cloud\n\n# Exemple Whisper API\ncurl -u julien:DevAccess2025 \\\n  -X POST https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions \\\n  -F file=@audio.mp3 \\\n  -F model=base\n\n# Exemple Tika API\ncurl -u julien:DevAccess2025 \\\n  -X PUT https://tika.srv759970.hstgr.cloud/tika \\\n  -H \"Accept: text/plain\" \\\n  --data-binary @document.pdf\n\n# Exemple Ollama API\ncurl -u julien:DevAccess2025 \\\n  http://69.62.108.82:11435/api/generate \\\n  -d '{\n    \"model\": \"qwen2.5:3b\",\n    \"prompt\": \"Hello world\",\n    \"stream\": false\n  }'\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#php","title":"PHP","text":"<pre><code>&lt;?php\n// M\u00e9thode 1 : file_get_contents avec context\n$auth = base64_encode('julien:DevAccess2025');\n$context = stream_context_create([\n    'http' =&gt; [\n        'header' =&gt; \"Authorization: Basic $auth\"\n    ]\n]);\n$response = file_get_contents('https://clemence.srv759970.hstgr.cloud', false, $context);\n\n// M\u00e9thode 2 : cURL\n$ch = curl_init('https://whisper.srv759970.hstgr.cloud/docs');\ncurl_setopt($ch, CURLOPT_USERPWD, 'julien:DevAccess2025');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$response = curl_exec($ch);\ncurl_close($ch);\n\n// Exemple Whisper API\n$ch = curl_init('https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions');\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_USERPWD, 'julien:DevAccess2025');\ncurl_setopt($ch, CURLOPT_POSTFIELDS, [\n    'file' =&gt; new CURLFile('audio.mp3'),\n    'model' =&gt; 'base'\n]);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$result = curl_exec($ch);\ncurl_close($ch);\n?&gt;\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#ajoutermodifier-des-utilisateurs","title":"\ud83d\udd27 Ajouter/Modifier des utilisateurs","text":""},{"location":"01-infrastructure/basic-auth/#ajouter-un-nouvel-utilisateur","title":"Ajouter un nouvel utilisateur","text":"<pre><code>ssh root@69.62.108.82\nhtpasswd -b /etc/nginx/.htpasswd clemence ClemPass2025\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#changer-le-mot-de-passe-dun-utilisateur-existant","title":"Changer le mot de passe d'un utilisateur existant","text":"<pre><code>ssh root@69.62.108.82\nhtpasswd -b /etc/nginx/.htpasswd julien NouveauMotDePasse\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#lister-tous-les-utilisateurs","title":"Lister tous les utilisateurs","text":"<pre><code>ssh root@69.62.108.82\ncat /etc/nginx/.htpasswd\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#supprimer-un-utilisateur","title":"Supprimer un utilisateur","text":"<pre><code>ssh root@69.62.108.82\nhtpasswd -D /etc/nginx/.htpasswd username\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#desactiver-lauthentification-si-besoin","title":"\ud83d\udeab D\u00e9sactiver l'authentification (si besoin)","text":""},{"location":"01-infrastructure/basic-auth/#pour-un-site-specifique","title":"Pour un site sp\u00e9cifique","text":"<pre><code>ssh root@69.62.108.82\n\n# Supprimer la ligne auth_basic du site\nsed -i '/include snippets\\/basic-auth.conf/d' /etc/nginx/sites-available/clemence\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#pour-tous-les-sites","title":"Pour tous les sites","text":"<pre><code>ssh root@69.62.108.82\n\n# Supprimer toutes les r\u00e9f\u00e9rences\nfor site in clemence cristina dashboard portal sharepoint strapi tika whisper wordpress; do\n  sed -i '/include snippets\\/basic-auth.conf/d' /etc/nginx/sites-available/$site\ndone\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#debugging","title":"\ud83d\udd0d Debugging","text":""},{"location":"01-infrastructure/basic-auth/#tester-si-lauth-fonctionne","title":"Tester si l'auth fonctionne","text":"<pre><code># Sans credentials (devrait retourner 401)\ncurl -I https://clemence.srv759970.hstgr.cloud\n\n# Avec credentials (devrait retourner 200)\ncurl -I -u julien:DevAccess2025 https://clemence.srv759970.hstgr.cloud\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#voir-les-logs-dauthentification","title":"Voir les logs d'authentification","text":"<pre><code>ssh root@69.62.108.82\ntail -f /var/log/nginx/clemence-error.log\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#verifier-le-fichier-de-mots-de-passe","title":"V\u00e9rifier le fichier de mots de passe","text":"<pre><code>ssh root@69.62.108.82\ncat /etc/nginx/.htpasswd\n# Devrait afficher : julien:$apr1$...\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#monitoring-des-acces","title":"\ud83d\udcca Monitoring des acc\u00e8s","text":""},{"location":"01-infrastructure/basic-auth/#voir-qui-accede-aux-sites","title":"Voir qui acc\u00e8de aux sites","text":"<pre><code>ssh root@69.62.108.82\n\n# Logs de tous les acc\u00e8s\ntail -f /var/log/nginx/clemence-access.log\n\n# Filtrer par username (julien)\ntail -f /var/log/nginx/clemence-access.log | grep julien\n\n# Compter les acc\u00e8s par IP\nawk '{print $1}' /var/log/nginx/clemence-access.log | sort | uniq -c | sort -rn\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#logs-derreurs-dauthentification","title":"Logs d'erreurs d'authentification","text":"<pre><code>ssh root@69.62.108.82\ngrep \"401\" /var/log/nginx/clemence-error.log\n</code></pre>"},{"location":"01-infrastructure/basic-auth/#notes-importantes","title":"\u26a0\ufe0f Notes importantes","text":""},{"location":"01-infrastructure/basic-auth/#securite","title":"S\u00e9curit\u00e9","text":"<ul> <li>\u26a0\ufe0f Basic Auth envoie le mot de passe encod\u00e9 en Base64 (facilement d\u00e9codable)</li> <li>\u2705 Toujours utiliser HTTPS pour chiffrer la transmission</li> <li>\u2705 Les credentials sont valides uniquement en HTTPS sur ce serveur</li> <li>\u2705 Le navigateur m\u00e9morise les credentials (cookies de session)</li> </ul>"},{"location":"01-infrastructure/basic-auth/#limites","title":"Limites","text":"<ul> <li>Pas de gestion fine des permissions : Tous les users ont acc\u00e8s \u00e0 tout</li> <li>Pas de rotation automatique : Changer le mot de passe manuellement</li> <li>Pas d'audit d\u00e9taill\u00e9 : Logs basiques seulement</li> </ul>"},{"location":"01-infrastructure/basic-auth/#pour-la-production","title":"Pour la production","text":"<p>Pour un environnement de production, consid\u00e9rer : - Cloudflare Access (Zero Trust) : Login par email, plus s\u00e9curis\u00e9 - OAuth2 / JWT : Authentification moderne avec tokens - VPN (Tailscale/WireGuard) : Acc\u00e8s r\u00e9seau s\u00e9curis\u00e9</p>"},{"location":"01-infrastructure/basic-auth/#migration-vers-cloudflare-plus-tard","title":"\ud83d\udd04 Migration vers Cloudflare (plus tard)","text":"<p>Si tu veux migrer vers Cloudflare Access plus tard :</p> <ol> <li>Configurer Cloudflare selon GUIDE_CLOUDFLARE_SETUP.md</li> <li>D\u00e9sactiver Basic Auth une fois Cloudflare actif</li> <li>Les APIs fonctionneront avec Service Tokens Cloudflare</li> </ol>"},{"location":"01-infrastructure/basic-auth/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Nginx Basic Auth Docs : http://nginx.org/en/docs/http/ngx_http_auth_basic_module.html</li> <li>htpasswd Docs : https://httpd.apache.org/docs/current/programs/htpasswd.html</li> </ul> <p>Cr\u00e9\u00e9 le : 2025-10-16 Identifiants actuels : <code>julien</code> / <code>DevAccess2025</code></p>"},{"location":"01-infrastructure/databases-shared-detailed/","title":"Bases de Donn\u00e9es Partag\u00e9es","text":"<p>Emplacement: <code>/opt/databases-shared/</code> Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"01-infrastructure/databases-shared-detailed/#vue-densemble","title":"Vue d'ensemble","text":"<p>Infrastructure de bases de donn\u00e9es mutualis\u00e9es pour les services de collaboration et applications modernes. Trois moteurs de bases de donn\u00e9es distincts pour diff\u00e9rents cas d'usage.</p>"},{"location":"01-infrastructure/databases-shared-detailed/#composants","title":"Composants","text":"<ul> <li>MongoDB : Base NoSQL pour Rocket.Chat</li> <li>PostgreSQL : Base relationnelle pour Nextcloud, ONLYOFFICE</li> <li>Redis : Cache et sessions</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#mongodb","title":"MongoDB","text":"<p>Image: <code>mongo:7</code> Port: <code>27017</code> (localhost only) Configuration: Replica Set (rs0)</p>"},{"location":"01-infrastructure/databases-shared-detailed/#utilisation","title":"Utilisation","text":"<p>MongoDB est configur\u00e9 en Replica Set pour supporter l'oplog (requis par Rocket.Chat pour le real-time).</p>"},{"location":"01-infrastructure/databases-shared-detailed/#bases-de-donnees","title":"Bases de donn\u00e9es","text":"Database Application User <code>rocketchat</code> Rocket.Chat <code>rocketchat</code> <code>nextcloud</code> Nextcloud (metadata) <code>nextcloud</code> <code>loadbalancer</code> Load Balancer (futur) <code>loadbalancer</code> <code>pipeline</code> Pipeline Transcription (futur) <code>pipeline</code>"},{"location":"01-infrastructure/databases-shared-detailed/#connexion","title":"Connexion","text":"<pre><code># Shell MongoDB\ndocker exec -it mongodb-shared mongosh -u root -p PASSWORD\n\n# Via application\nmongodb://USERNAME:PASSWORD@mongodb-shared:27017/DATABASE?authSource=DATABASE\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#replica-set","title":"Replica Set","text":"<pre><code># V\u00e9rifier statut replica set\ndocker exec mongodb-shared mongosh -u root -p PASSWORD --eval \"rs.status()\"\n\n# Membres du replica set\ndocker exec mongodb-shared mongosh -u root -p PASSWORD --eval \"rs.conf()\"\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#backup","title":"Backup","text":"<pre><code># Dump toutes les bases\ndocker exec mongodb-shared mongodump -u root -p PASSWORD --out=/backup\n\n# Dump une base sp\u00e9cifique\ndocker exec mongodb-shared mongodump -u rocketchat -p PASSWORD --db=rocketchat --out=/backup\n\n# Restore\ndocker exec mongodb-shared mongorestore -u root -p PASSWORD /backup\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql","title":"PostgreSQL","text":"<p>Image: <code>postgres:17-alpine</code> Port: <code>5432</code> (localhost only)</p>"},{"location":"01-infrastructure/databases-shared-detailed/#utilisation_1","title":"Utilisation","text":"<p>PostgreSQL est utilis\u00e9 pour les applications n\u00e9cessitant une base relationnelle avec support transactionnel complet.</p>"},{"location":"01-infrastructure/databases-shared-detailed/#bases-de-donnees_1","title":"Bases de donn\u00e9es","text":"Database Application User <code>nextcloud</code> Nextcloud <code>nextcloud</code> <code>onlyoffice</code> ONLYOFFICE <code>onlyoffice</code> <code>loadbalancer</code> Load Balancer (futur) <code>loadbalancer</code> <code>pipeline</code> Pipeline Transcription (futur) <code>pipeline</code>"},{"location":"01-infrastructure/databases-shared-detailed/#connexion_1","title":"Connexion","text":"<pre><code># psql shell\ndocker exec -it postgresql-shared psql -U postgres\n\n# Via application\npostgresql://USERNAME:PASSWORD@postgresql-shared:5432/DATABASE\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#commandes-utiles","title":"Commandes utiles","text":"<pre><code># Lister bases\ndocker exec postgresql-shared psql -U postgres -c \"\\l\"\n\n# Lister tables d'une base\ndocker exec postgresql-shared psql -U postgres -d nextcloud -c \"\\dt\"\n\n# Taille des bases\ndocker exec postgresql-shared psql -U postgres -c \"SELECT pg_database.datname, pg_size_pretty(pg_database_size(pg_database.datname)) FROM pg_database;\"\n\n# Vacuum\ndocker exec postgresql-shared psql -U postgres -d nextcloud -c \"VACUUM ANALYZE;\"\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#backup_1","title":"Backup","text":"<pre><code># Dump toutes les bases\ndocker exec postgresql-shared pg_dumpall -U postgres &gt; all-databases.sql\n\n# Dump une base sp\u00e9cifique\ndocker exec postgresql-shared pg_dump -U nextcloud nextcloud &gt; nextcloud.sql\n\n# Restore\ncat nextcloud.sql | docker exec -i postgresql-shared psql -U nextcloud -d nextcloud\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#redis","title":"Redis","text":"<p>Image: <code>redis:7-alpine</code> Port: <code>6379</code> (localhost only)</p>"},{"location":"01-infrastructure/databases-shared-detailed/#utilisation_2","title":"Utilisation","text":"<p>Redis est utilis\u00e9 comme cache applicatif et stockage de sessions. Distinct du Redis RQ (port 6380) utilis\u00e9 pour les queues de transcription.</p>"},{"location":"01-infrastructure/databases-shared-detailed/#usage-par-application","title":"Usage par application","text":"Application Usage DB Nextcloud Cache fichiers, sessions, locking DB 0 Rocket.Chat (futur) Cache DB 1 Load Balancer (futur) Rate limiting DB 2"},{"location":"01-infrastructure/databases-shared-detailed/#connexion_2","title":"Connexion","text":"<pre><code># Redis CLI\ndocker exec -it redis-shared redis-cli -a PASSWORD\n\n# Via application\nredis://redis-shared:6379?password=PASSWORD&amp;db=0\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#commandes-utiles_1","title":"Commandes utiles","text":"<pre><code># Info g\u00e9n\u00e9ral\ndocker exec redis-shared redis-cli -a PASSWORD INFO\n\n# Statistiques par DB\ndocker exec redis-shared redis-cli -a PASSWORD INFO keyspace\n\n# Nombre de cl\u00e9s\ndocker exec redis-shared redis-cli -a PASSWORD DBSIZE\n\n# Vider une DB (ATTENTION!)\ndocker exec redis-shared redis-cli -a PASSWORD -n 0 FLUSHDB\n\n# Monitor en temps r\u00e9el\ndocker exec redis-shared redis-cli -a PASSWORD MONITOR\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#configuration","title":"Configuration","text":"<ul> <li>maxmemory: 512MB</li> <li>maxmemory-policy: <code>allkeys-lru</code> (\u00e9viction LRU si m\u00e9moire pleine)</li> <li>Persistence: D\u00e9sactiv\u00e9e (cache volatile)</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#monitoring","title":"Monitoring","text":""},{"location":"01-infrastructure/databases-shared-detailed/#exporters-prometheus","title":"Exporters Prometheus","text":"<p>Trois exporters sont d\u00e9ploy\u00e9s pour collecter les m\u00e9triques :</p> Exporter Port Cible mongodb-exporter 9216 MongoDB postgres-exporter 9187 PostgreSQL redis-exporter 9121 Redis"},{"location":"01-infrastructure/databases-shared-detailed/#metriques-disponibles","title":"M\u00e9triques disponibles","text":"<p>MongoDB : - Connexions actives - Op\u00e9rations par seconde - Taille des bases - Replica set status</p> <p>PostgreSQL : - Connexions actives - Transactions par seconde - Taille des bases - Cache hit ratio</p> <p>Redis : - M\u00e9moire utilis\u00e9e - Hit/miss ratio - Commandes par seconde - Evictions</p>"},{"location":"01-infrastructure/databases-shared-detailed/#visualisation","title":"Visualisation","text":"<p>Les m\u00e9triques sont visibles dans Grafana : - URL: https://monitoring.srv759970.hstgr.cloud - Dashboards: \"Database Monitoring\"</p>"},{"location":"01-infrastructure/databases-shared-detailed/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"01-infrastructure/databases-shared-detailed/#authentification","title":"Authentification","text":"<ul> <li>\u2705 Authentification obligatoire sur toutes les bases</li> <li>\u2705 Utilisateurs d\u00e9di\u00e9s par application</li> <li>\u2705 Passwords stock\u00e9s dans <code>.env</code> (gitignored)</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#reseau","title":"R\u00e9seau","text":"<ul> <li>\u2705 Ports expos\u00e9s uniquement sur <code>127.0.0.1</code> (localhost)</li> <li>\u2705 R\u00e9seau Docker isol\u00e9 <code>databases-shared</code></li> <li>\u274c Pas d'acc\u00e8s direct depuis l'ext\u00e9rieur</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#permissions","title":"Permissions","text":""},{"location":"01-infrastructure/databases-shared-detailed/#mongodb_1","title":"MongoDB","text":"<pre><code>// Utilisateur application\n{\n  user: \"rocketchat\",\n  roles: [\n    { role: \"readWrite\", db: \"rocketchat\" }\n  ]\n}\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql_1","title":"PostgreSQL","text":"<pre><code>-- Utilisateur application\nGRANT ALL ON DATABASE nextcloud TO nextcloud;\nGRANT ALL ON SCHEMA public TO nextcloud;\nALTER DATABASE nextcloud OWNER TO nextcloud;\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#maintenance","title":"Maintenance","text":""},{"location":"01-infrastructure/databases-shared-detailed/#logs","title":"Logs","text":"<pre><code># MongoDB\ndocker logs mongodb-shared --tail 100 -f\n\n# PostgreSQL\ndocker logs postgresql-shared --tail 100 -f\n\n# Redis\ndocker logs redis-shared --tail 100 -f\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#redemarrage","title":"Red\u00e9marrage","text":"<pre><code># Red\u00e9marrer une base\ndocker restart mongodb-shared\ndocker restart postgresql-shared\ndocker restart redis-shared\n\n# Red\u00e9marrer toutes les bases (ATTENTION: downtime!)\ncd /opt/databases-shared &amp;&amp; docker-compose restart\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#nettoyage","title":"Nettoyage","text":""},{"location":"01-infrastructure/databases-shared-detailed/#mongodb_2","title":"MongoDB","text":"<pre><code># Compacter base\ndocker exec mongodb-shared mongosh -u root -p PASSWORD --eval \"db.runCommand({compact: 'collection'})\"\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql_2","title":"PostgreSQL","text":"<pre><code># Vacuum\ndocker exec postgresql-shared psql -U postgres -d nextcloud -c \"VACUUM FULL;\"\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#redis_1","title":"Redis","text":"<pre><code># Pas de nettoyage n\u00e9cessaire (\u00e9viction automatique LRU)\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#troubleshooting","title":"Troubleshooting","text":""},{"location":"01-infrastructure/databases-shared-detailed/#mongodb-replica-set-non-initialise","title":"MongoDB Replica Set non initialis\u00e9","text":"<p>Sympt\u00f4me: Rocket.Chat erreur \"oplog not available\"</p> <p>Solution: <pre><code>docker exec mongodb-shared mongosh -u root -p PASSWORD --eval \"rs.initiate({_id: 'rs0', members: [{_id: 0, host: 'mongodb-shared:27017'}]})\"\n</code></pre></p>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql-connexion-refusee","title":"PostgreSQL connexion refus\u00e9e","text":"<p>Sympt\u00f4me: Application ne peut pas se connecter</p> <p>Solution: <pre><code># V\u00e9rifier que conteneur tourne\ndocker ps --filter name=postgresql-shared\n\n# V\u00e9rifier logs\ndocker logs postgresql-shared --tail 50\n\n# V\u00e9rifier healthcheck\ndocker inspect postgresql-shared | grep -A 10 Health\n</code></pre></p>"},{"location":"01-infrastructure/databases-shared-detailed/#redis-memoire-pleine","title":"Redis m\u00e9moire pleine","text":"<p>Sympt\u00f4me: Erreur \"OOM command not allowed\"</p> <p>Solution: <pre><code># V\u00e9rifier m\u00e9moire utilis\u00e9e\ndocker exec redis-shared redis-cli -a PASSWORD INFO memory\n\n# Vider cache (si acceptable)\ndocker exec redis-shared redis-cli -a PASSWORD FLUSHALL\n</code></pre></p>"},{"location":"01-infrastructure/databases-shared-detailed/#limites-et-quotas","title":"Limites et quotas","text":""},{"location":"01-infrastructure/databases-shared-detailed/#mongodb_3","title":"MongoDB","text":"<ul> <li>Max connections: 1000 (configurable)</li> <li>Oplog size: 990 MB (5% de m\u00e9moire)</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql_3","title":"PostgreSQL","text":"<ul> <li>Max connections: 100 (configurable)</li> <li>Shared buffers: 128 MB</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#redis_2","title":"Redis","text":"<ul> <li>Max memory: 512 MB</li> <li>Eviction: Automatique (LRU)</li> </ul>"},{"location":"01-infrastructure/databases-shared-detailed/#ajout-dune-nouvelle-base","title":"Ajout d'une nouvelle base","text":""},{"location":"01-infrastructure/databases-shared-detailed/#mongodb_4","title":"MongoDB","text":"<pre><code># Cr\u00e9er base + user\ndocker exec mongodb-shared mongosh -u root -p ROOT_PASSWORD --eval '\nuse newdb\ndb.createUser({\n  user: \"newuser\",\n  pwd: \"newpassword\",\n  roles: [{role: \"readWrite\", db: \"newdb\"}]\n})\n'\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#postgresql_4","title":"PostgreSQL","text":"<pre><code># Cr\u00e9er base + user\ndocker exec postgresql-shared psql -U postgres -c \"CREATE USER newuser WITH PASSWORD 'newpassword';\"\ndocker exec postgresql-shared psql -U postgres -c \"CREATE DATABASE newdb OWNER newuser;\"\ndocker exec postgresql-shared psql -U postgres -d newdb -c \"GRANT ALL ON SCHEMA public TO newuser;\"\n</code></pre>"},{"location":"01-infrastructure/databases-shared-detailed/#backup-complet","title":"Backup complet","text":""},{"location":"01-infrastructure/databases-shared-detailed/#script-automatique","title":"Script automatique","text":"<pre><code>#!/bin/bash\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR=\"/backups/databases/$DATE\"\n\nmkdir -p $BACKUP_DIR\n\n# MongoDB\ndocker exec mongodb-shared mongodump -u root -p PASSWORD --out=$BACKUP_DIR/mongodb\n\n# PostgreSQL\ndocker exec postgresql-shared pg_dumpall -U postgres &gt; $BACKUP_DIR/postgresql-all.sql\n\n# Redis (pas n\u00e9cessaire, cache volatile)\n\necho \"Backup completed: $BACKUP_DIR\"\n</code></pre> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-21 Configuration: <code>/opt/databases-shared/docker-compose.yml</code></p>"},{"location":"01-infrastructure/databases/","title":"Bases de Donn\u00e9es Partag\u00e9es","text":"<p>Stack : databases-shared Localisation : <code>/opt/databases-shared/</code> Status : \ud83d\udfe2 Actif</p>"},{"location":"01-infrastructure/databases/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Infrastructure de bases de donn\u00e9es mutualis\u00e9es pour optimiser les ressources.</p>"},{"location":"01-infrastructure/databases/#services-inclus","title":"Services Inclus","text":"Service Image RAM Port Usage postgresql-shared postgres:17-alpine ~31 MB 5432 MemVid, Nextcloud redis-shared redis:7-alpine ~7 MB 6379 MemVid, WhisperX, Telegram Bot mongodb-shared mongo:7 ~101 MB 27017 (Actuellement inutilis\u00e9)"},{"location":"01-infrastructure/databases/#monitoring","title":"Monitoring","text":"Exporter Port Monitore postgres-exporter 9187 M\u00e9triques PostgreSQL \u2192 Prometheus redis-exporter 9121 M\u00e9triques Redis \u2192 Prometheus"},{"location":"01-infrastructure/databases/#postgresql-partage","title":"PostgreSQL Partag\u00e9","text":""},{"location":"01-infrastructure/databases/#bases-de-donnees-actives","title":"Bases de Donn\u00e9es Actives","text":"<pre><code># Lister les bases\ndocker exec postgresql-shared psql -U postgres -c '\\l'\n\n# Voir les connexions actives\ndocker exec postgresql-shared psql -U postgres -c \"SELECT datname, usename, client_addr FROM pg_stat_activity WHERE state = 'active';\"\n</code></pre>"},{"location":"01-infrastructure/databases/#services-utilisant-postgresql","title":"Services Utilisant PostgreSQL","text":"<ol> <li>memvid-api - Base de donn\u00e9es MemVid</li> <li>nextcloud - Donn\u00e9es Nextcloud (si actif)</li> </ol>"},{"location":"01-infrastructure/databases/#configuration","title":"Configuration","text":"<p>Credentials : Voir <code>/opt/databases-shared/.env</code></p> <pre><code>POSTGRES_USER=postgres\nPOSTGRES_PASSWORD=&lt;voir .env&gt;\nPOSTGRES_DB=postgres\n</code></pre>"},{"location":"01-infrastructure/databases/#redis-partage","title":"Redis Partag\u00e9","text":""},{"location":"01-infrastructure/databases/#databases-redis-db0-db15","title":"Databases Redis (DB0-DB15)","text":"DB Service Usage DB 0 WhisperX Queue RQ pour transcription DB 1 Faster-Whisper Queue RQ pour transcription DB 2 MemVid Cache + queue worker DB 3 Telegram Bot Cache sessions"},{"location":"01-infrastructure/databases/#commandes-utiles","title":"Commandes Utiles","text":"<pre><code># Voir les cl\u00e9s par DB\ndocker exec redis-shared redis-cli -n 0 KEYS '*'  # DB 0 (WhisperX)\ndocker exec redis-shared redis-cli -n 1 KEYS '*'  # DB 1 (Faster-Whisper)\n\n# Voir les connexions actives\ndocker exec redis-shared redis-cli CLIENT LIST\n\n# Info m\u00e9moire\ndocker exec redis-shared redis-cli INFO memory\n</code></pre>"},{"location":"01-infrastructure/databases/#mongodb-partage","title":"MongoDB Partag\u00e9","text":"<p>Status : \ud83d\udd34 Arr\u00eat\u00e9 (aucun service actif ne l'utilise)</p>"},{"location":"01-infrastructure/databases/#actions-possibles","title":"Actions Possibles","text":"<ol> <li> <p>Supprimer si inutilis\u00e9 <pre><code>cd /opt/databases-shared\ndocker-compose stop mongodb-shared\ndocker-compose rm -f mongodb-shared\ndocker volume rm databases-shared_mongo-data\n</code></pre></p> </li> <li> <p>Ou r\u00e9activer si besoin futur <pre><code>docker-compose up -d mongodb-shared\n</code></pre></p> </li> </ol>"},{"location":"01-infrastructure/databases/#backup-strategy","title":"Backup Strategy","text":""},{"location":"01-infrastructure/databases/#postgresql-backup","title":"PostgreSQL Backup","text":"<pre><code># Backup d'une base sp\u00e9cifique\ndocker exec postgresql-shared pg_dump -U postgres memvid_db &gt; backup-memvid-$(date +%Y%m%d).sql\n\n# Backup de toutes les bases\ndocker exec postgresql-shared pg_dumpall -U postgres &gt; backup-all-postgres-$(date +%Y%m%d).sql\n</code></pre>"},{"location":"01-infrastructure/databases/#redis-backup","title":"Redis Backup","text":"<pre><code># Redis persiste automatiquement dans /data\n# Backup du fichier RDB\ndocker cp postgresql-shared:/data/dump.rdb backup-redis-$(date +%Y%m%d).rdb\n</code></pre>"},{"location":"01-infrastructure/databases/#volumes","title":"Volumes","text":"<pre><code>databases-shared_postgres-data    # PostgreSQL data (actuellement vide)\ndatabases-shared_redis-data       # Redis persistence\ndatabases-shared_mongo-data       # MongoDB data (inutilis\u00e9)\n</code></pre>"},{"location":"01-infrastructure/databases/#monitoring_1","title":"Monitoring","text":""},{"location":"01-infrastructure/databases/#metriques-prometheus","title":"M\u00e9triques Prometheus","text":"<p>Les exporters exposent des m\u00e9triques pour Grafana :</p> <p>PostgreSQL Exporter : <code>http://localhost:9187/metrics</code> - Connexions actives - Transactions/sec - Taille des bases - Query performance</p> <p>Redis Exporter : <code>http://localhost:9121/metrics</code> - M\u00e9moire utilis\u00e9e - Hit rate cache - Connexions actives - Commandes/sec</p>"},{"location":"01-infrastructure/databases/#dependances-critiques","title":"D\u00e9pendances Critiques","text":"<p>\u26a0\ufe0f ATTENTION : Ces services sont des SPOF (Single Point of Failure)</p>"},{"location":"01-infrastructure/databases/#si-postgresql-down","title":"Si PostgreSQL down","text":"<ul> <li>\u274c MemVid API non fonctionnel</li> <li>\u274c Nextcloud non accessible (si actif)</li> </ul>"},{"location":"01-infrastructure/databases/#si-redis-down","title":"Si Redis down","text":"<ul> <li>\u274c WhisperX workers arr\u00eat\u00e9s</li> <li>\u274c Faster-Whisper workers arr\u00eat\u00e9s</li> <li>\u274c MemVid worker arr\u00eat\u00e9</li> <li>\u274c Telegram Bot d\u00e9connect\u00e9</li> </ul> <p>Recommandation : Monitoring actif + alertes si down</p>"},{"location":"01-infrastructure/databases/#troubleshooting","title":"Troubleshooting","text":""},{"location":"01-infrastructure/databases/#postgresql-ne-demarre-pas","title":"PostgreSQL ne d\u00e9marre pas","text":"<pre><code># Voir les logs\ndocker logs postgresql-shared --tail 50\n\n# V\u00e9rifier les permissions\ndocker exec postgresql-shared ls -la /var/lib/postgresql/data\n\n# Restart\ndocker restart postgresql-shared\n</code></pre>"},{"location":"01-infrastructure/databases/#redis-out-of-memory","title":"Redis out of memory","text":"<pre><code># Voir la m\u00e9moire utilis\u00e9e\ndocker exec redis-shared redis-cli INFO memory\n\n# Flush une DB si besoin\ndocker exec redis-shared redis-cli -n 2 FLUSHDB\n\n# Augmenter maxmemory dans docker-compose.yml\n# redis-cli CONFIG SET maxmemory 512mb\n</code></pre>"},{"location":"01-infrastructure/databases/#configuration-docker-compose","title":"Configuration Docker Compose","text":"<p>Fichier : <code>/opt/databases-shared/docker-compose.yml</code></p> <pre><code>services:\n  postgresql-shared:\n    image: postgres:17-alpine\n    container_name: postgresql-shared\n    restart: unless-stopped\n    ports:\n      - \"127.0.0.1:5432:5432\"\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    environment:\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n    networks:\n      - databases-shared\n\n  redis-shared:\n    image: redis:7-alpine\n    container_name: redis-shared\n    restart: unless-stopped\n    ports:\n      - \"127.0.0.1:6379:6379\"\n    volumes:\n      - redis-data:/data\n    networks:\n      - databases-shared\n\n  # ... (autres services)\n</code></pre> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28 Documentation compl\u00e8te : Voir <code>docs/services/infrastructure/databases-shared.md</code></p>"},{"location":"01-infrastructure/docker/","title":"Docker - Gestion des Conteneurs","text":""},{"location":"01-infrastructure/docker/#vue-densemble","title":"Vue d'ensemble","text":"<p>Tous les services de srv759970 sont d\u00e9ploy\u00e9s via Docker et Docker Compose pour assurer l'isolation, la portabilit\u00e9 et la facilit\u00e9 de gestion.</p>"},{"location":"01-infrastructure/docker/#installation-docker","title":"Installation Docker","text":""},{"location":"01-infrastructure/docker/#version-installee","title":"Version install\u00e9e","text":"<pre><code>docker --version\n# Docker version 24.0.x\n\ndocker-compose --version\n# Docker Compose version 2.x\n</code></pre>"},{"location":"01-infrastructure/docker/#structure-des-services","title":"Structure des Services","text":""},{"location":"01-infrastructure/docker/#organisation-des-dossiers","title":"Organisation des dossiers","text":"<pre><code>/opt/\n\u251c\u2500\u2500 whisperx/                   # WhisperX avec RQ queue\n\u251c\u2500\u2500 faster-whisper-queue/       # Faster-Whisper avec RQ queue\n\u251c\u2500\u2500 monitoring/                 # Stack Grafana + Prometheus + Loki\n\u251c\u2500\u2500 dashy/                      # Dashboard services\n\u251c\u2500\u2500 mkdocs/                     # Documentation site\n\u2514\u2500\u2500 wordpress-*/                # Sites WordPress\n</code></pre>"},{"location":"01-infrastructure/docker/#commandes-docker-essentielles","title":"Commandes Docker Essentielles","text":""},{"location":"01-infrastructure/docker/#gestion-des-conteneurs","title":"Gestion des conteneurs","text":"<pre><code># Lister tous les conteneurs en cours\ndocker ps\n\n# Lister tous les conteneurs (y compris arr\u00eat\u00e9s)\ndocker ps -a\n\n# Voir les logs d'un conteneur\ndocker logs &lt;container_name&gt;\ndocker logs -f &lt;container_name&gt;  # Mode suivi\ndocker logs --tail 50 &lt;container_name&gt;  # 50 derni\u00e8res lignes\n\n# Red\u00e9marrer un conteneur\ndocker restart &lt;container_name&gt;\n\n# Arr\u00eater un conteneur\ndocker stop &lt;container_name&gt;\n\n# Supprimer un conteneur\ndocker rm &lt;container_name&gt;\n\n# Ex\u00e9cuter une commande dans un conteneur\ndocker exec -it &lt;container_name&gt; bash\ndocker exec &lt;container_name&gt; &lt;commande&gt;\n</code></pre>"},{"location":"01-infrastructure/docker/#gestion-avec-docker-compose","title":"Gestion avec Docker Compose","text":"<pre><code># D\u00e9marrer tous les services\ndocker-compose up -d\n\n# Arr\u00eater tous les services\ndocker-compose down\n\n# Voir les logs\ndocker-compose logs -f\n\n# Red\u00e9marrer un service\ndocker-compose restart &lt;service_name&gt;\n\n# Reconstruire et red\u00e9marrer\ndocker-compose up -d --build\n\n# V\u00e9rifier le statut\ndocker-compose ps\n</code></pre>"},{"location":"01-infrastructure/docker/#gestion-des-images","title":"Gestion des images","text":"<pre><code># Lister les images\ndocker images\n\n# Supprimer une image\ndocker rmi &lt;image_id&gt;\n\n# Pull une nouvelle version\ndocker pull &lt;image_name&gt;\n\n# Nettoyer les images inutilis\u00e9es\ndocker image prune -a\n</code></pre>"},{"location":"01-infrastructure/docker/#gestion-des-volumes","title":"Gestion des volumes","text":"<pre><code># Lister les volumes\ndocker volume ls\n\n# Inspecter un volume\ndocker volume inspect &lt;volume_name&gt;\n\n# Supprimer un volume\ndocker volume rm &lt;volume_name&gt;\n\n# Nettoyer les volumes inutilis\u00e9s\ndocker volume prune\n</code></pre>"},{"location":"01-infrastructure/docker/#gestion-des-reseaux","title":"Gestion des r\u00e9seaux","text":"<pre><code># Lister les r\u00e9seaux\ndocker network ls\n\n# Inspecter un r\u00e9seau\ndocker network inspect &lt;network_name&gt;\n\n# Cr\u00e9er un r\u00e9seau\ndocker network create &lt;network_name&gt;\n\n# Connecter un conteneur \u00e0 un r\u00e9seau\ndocker network connect &lt;network_name&gt; &lt;container_name&gt;\n</code></pre>"},{"location":"01-infrastructure/docker/#reseaux-docker-utilises","title":"R\u00e9seaux Docker Utilis\u00e9s","text":""},{"location":"01-infrastructure/docker/#whisperx_whisperx","title":"whisperx_whisperx","text":"<p>R\u00e9seau partag\u00e9 pour tous les services de transcription: - rq-queue-redis (Redis partag\u00e9) - whisperx, whisperx-worker - faster-whisper, faster-whisper-queue-api, faster-whisper-worker - monitoring (rq-exporter)</p>"},{"location":"01-infrastructure/docker/#monitoring_monitoring","title":"monitoring_monitoring","text":"<p>R\u00e9seau pour la stack de monitoring: - prometheus - grafana - loki - promtail</p>"},{"location":"01-infrastructure/docker/#bonnes-pratiques","title":"Bonnes Pratiques","text":""},{"location":"01-infrastructure/docker/#healthchecks","title":"Healthchecks","text":"<p>Tous les services critiques ont des healthchecks configur\u00e9s:</p> <pre><code>healthcheck:\n  test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n  interval: 10s\n  timeout: 5s\n  retries: 3\n  start_period: 30s\n</code></pre>"},{"location":"01-infrastructure/docker/#logs","title":"Logs","text":"<p>Configuration de rotation des logs:</p> <pre><code>logging:\n  driver: json-file\n  options:\n    max-size: '10m'\n    max-file: '3'\n</code></pre>"},{"location":"01-infrastructure/docker/#restart-policy","title":"Restart Policy","text":"<pre><code>restart: unless-stopped\n</code></pre> <p>Garantit que les conteneurs red\u00e9marrent automatiquement sauf arr\u00eat manuel.</p>"},{"location":"01-infrastructure/docker/#monitoring-docker","title":"Monitoring Docker","text":""},{"location":"01-infrastructure/docker/#stats-en-temps-reel","title":"Stats en temps r\u00e9el","text":"<pre><code># Stats de tous les conteneurs\ndocker stats\n\n# Stats d'un conteneur sp\u00e9cifique\ndocker stats &lt;container_name&gt;\n</code></pre>"},{"location":"01-infrastructure/docker/#inspection-detaillee","title":"Inspection d\u00e9taill\u00e9e","text":"<pre><code># Inspecter un conteneur\ndocker inspect &lt;container_name&gt;\n\n# Voir les processus dans un conteneur\ndocker top &lt;container_name&gt;\n\n# Voir les ports mapp\u00e9s\ndocker port &lt;container_name&gt;\n</code></pre>"},{"location":"01-infrastructure/docker/#depannage","title":"D\u00e9pannage","text":""},{"location":"01-infrastructure/docker/#conteneur-qui-redemarre-en-boucle","title":"Conteneur qui red\u00e9marre en boucle","text":"<pre><code># Voir les logs\ndocker logs --tail 100 &lt;container_name&gt;\n\n# Inspecter le statut\ndocker inspect &lt;container_name&gt; | grep -A 10 \"State\"\n\n# V\u00e9rifier le healthcheck\ndocker inspect &lt;container_name&gt; | grep -A 20 \"Health\"\n</code></pre>"},{"location":"01-infrastructure/docker/#problemes-reseau","title":"Probl\u00e8mes r\u00e9seau","text":"<pre><code># V\u00e9rifier la connectivit\u00e9 entre conteneurs\ndocker exec &lt;container1&gt; ping &lt;container2&gt;\n\n# Inspecter le r\u00e9seau\ndocker network inspect &lt;network_name&gt;\n\n# Voir les r\u00e9seaux d'un conteneur\ndocker inspect &lt;container_name&gt; | grep -A 10 \"Networks\"\n</code></pre>"},{"location":"01-infrastructure/docker/#espace-disque","title":"Espace disque","text":"<pre><code># Voir l'utilisation disque de Docker\ndocker system df\n\n# Nettoyer tout ce qui est inutilis\u00e9\ndocker system prune -a --volumes\n\n# Nettoyer uniquement les conteneurs arr\u00eat\u00e9s\ndocker container prune\n\n# Nettoyer uniquement les images\ndocker image prune -a\n</code></pre>"},{"location":"01-infrastructure/docker/#backup-et-restore","title":"Backup et Restore","text":""},{"location":"01-infrastructure/docker/#backup-dun-volume","title":"Backup d'un volume","text":"<pre><code>docker run --rm \\\n  -v &lt;volume_name&gt;:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/&lt;volume_name&gt;-backup.tar.gz -C /data .\n</code></pre>"},{"location":"01-infrastructure/docker/#restore-dun-volume","title":"Restore d'un volume","text":"<pre><code>docker run --rm \\\n  -v &lt;volume_name&gt;:/data \\\n  -v $(pwd):/backup \\\n  alpine tar xzf /backup/&lt;volume_name&gt;-backup.tar.gz -C /data\n</code></pre>"},{"location":"01-infrastructure/docker/#services-demarres-au-boot","title":"Services D\u00e9marr\u00e9s au Boot","text":"<p>Les conteneurs avec <code>restart: unless-stopped</code> red\u00e9marrent automatiquement au boot du serveur.</p> <p>V\u00e9rifier que Docker d\u00e9marre au boot:</p> <pre><code>systemctl is-enabled docker\n# Devrait retourner: enabled\n\n# Si pas activ\u00e9:\nsystemctl enable docker\n</code></pre>"},{"location":"01-infrastructure/docker/#mise-a-jour-des-services","title":"Mise \u00e0 Jour des Services","text":""},{"location":"01-infrastructure/docker/#procedure-standard","title":"Proc\u00e9dure standard","text":"<pre><code>cd /opt/&lt;service_name&gt;\n\n# Pull les nouvelles images\ndocker-compose pull\n\n# Rebuild si custom Dockerfile\ndocker-compose build --no-cache\n\n# Red\u00e9marrer avec nouvelles versions\ndocker-compose up -d\n\n# V\u00e9rifier les logs\ndocker-compose logs -f\n</code></pre>"},{"location":"01-infrastructure/docker/#rollback-si-probleme","title":"Rollback si probl\u00e8me","text":"<pre><code># Lister les images disponibles\ndocker images\n\n# Retourner \u00e0 une ancienne image\ndocker tag &lt;old_image_id&gt; &lt;image_name&gt;:latest\ndocker-compose up -d\n</code></pre>"},{"location":"01-infrastructure/docker/#ressources","title":"Ressources","text":"<ul> <li>Docker Documentation</li> <li>Docker Compose Documentation</li> <li>Best Practices</li> </ul>"},{"location":"01-infrastructure/email-smtp/","title":"Configuration Email - Guide Complet","text":"<p>Guide complet pour la configuration de l'envoi d'emails depuis le serveur srv759970.hstgr.cloud.</p>"},{"location":"01-infrastructure/email-smtp/#vue-densemble","title":"Vue d'ensemble","text":"<p>Ce guide couvre 3 scenarios d'envoi d'emails :</p> <ol> <li>SMTP Relay externe (SendGrid/Mailgun) - Pour applications Docker</li> <li>Gmail SMTP - Pour WordPress</li> <li>Postfix local - Pour notifications syst\u00e8me</li> </ol>"},{"location":"01-infrastructure/email-smtp/#option-1-smtp-relay-externe-recommande-pour-apis","title":"Option 1 : SMTP Relay externe (Recommand\u00e9 pour APIs)","text":""},{"location":"01-infrastructure/email-smtp/#services-disponibles","title":"Services disponibles","text":"<ol> <li>SMTP Relay externe (recommand\u00e9)</li> <li>SendGrid (100 emails/jour gratuit)</li> <li>Mailgun</li> <li>Amazon SES</li> <li>SMTP2GO</li> </ol>"},{"location":"01-infrastructure/email-smtp/#configuration-avec-sendgrid","title":"Configuration avec SendGrid","text":""},{"location":"01-infrastructure/email-smtp/#1-creer-un-compte-sendgrid","title":"1. Cr\u00e9er un compte SendGrid","text":"<ol> <li>Aller sur sendgrid.com</li> <li>Cr\u00e9er un compte gratuit (100 emails/jour)</li> <li>Cr\u00e9er une API Key dans Settings &gt; API Keys</li> </ol>"},{"location":"01-infrastructure/email-smtp/#2-configuration-docker","title":"2. Configuration Docker","text":"<pre><code># Dans docker-compose.yml\nenvironment:\n  - SMTP_HOST=smtp.sendgrid.net\n  - SMTP_PORT=587\n  - SMTP_USER=apikey\n  - SMTP_PASSWORD=&lt;your_sendgrid_api_key&gt;\n  - SMTP_FROM=noreply@srv759970.hstgr.cloud\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#3-test-denvoi","title":"3. Test d'envoi","text":"<pre><code>import smtplib\nfrom email.mime.text import MIMEText\n\nmsg = MIMEText(\"Test email from srv759970\")\nmsg['Subject'] = 'Test'\nmsg['From'] = 'noreply@srv759970.hstgr.cloud'\nmsg['To'] = 'julien@julienfernandez.xyz'\n\nwith smtplib.SMTP('smtp.sendgrid.net', 587) as server:\n    server.starttls()\n    server.login('apikey', 'YOUR_API_KEY')\n    server.send_message(msg)\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#alertes-grafana-par-email","title":"Alertes Grafana par Email","text":""},{"location":"01-infrastructure/email-smtp/#configuration-dans-grafana","title":"Configuration dans Grafana","text":"<ol> <li>Aller dans Alerting &gt; Contact points</li> <li>Cr\u00e9er un nouveau contact point:</li> <li>Type: Email</li> <li>Addresses: julien@julienfernandez.xyz</li> <li>SMTP Host: smtp.sendgrid.net:587</li> <li>Username: apikey</li> <li>Password:  <li>From: grafana@srv759970.hstgr.cloud</li>"},{"location":"01-infrastructure/email-smtp/#exemple-dalerte","title":"Exemple d'alerte","text":"<pre><code># Alert: Jobs Failed\nexpr: rate(rq_jobs{status=\"failed\"}[5m]) &gt; 0.1\nfor: 5m\nlabels:\n  severity: warning\nannotations:\n  summary: \"Taux \u00e9lev\u00e9 d'\u00e9checs jobs WhisperX\"\n  description: \"{{ $value }} jobs/min \u00e9chouent\"\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#option-2-gmail-smtp-pour-wordpress","title":"Option 2 : Gmail SMTP (Pour WordPress)","text":""},{"location":"01-infrastructure/email-smtp/#prerequis","title":"Pr\u00e9requis","text":"<ol> <li>Un compte Gmail (ex: <code>clemsfou@gmail.com</code>)</li> <li>Validation en 2 \u00e9tapes activ\u00e9e sur le compte Gmail</li> <li>Un mot de passe d'application Gmail</li> </ol>"},{"location":"01-infrastructure/email-smtp/#etape-1-creer-un-mot-de-passe-dapplication-gmail","title":"\u00c9tape 1 : Cr\u00e9er un mot de passe d'application Gmail","text":""},{"location":"01-infrastructure/email-smtp/#11-activer-la-validation-en-2-etapes-si-pas-deja-fait","title":"1.1 Activer la validation en 2 \u00e9tapes (si pas d\u00e9j\u00e0 fait)","text":"<ol> <li>Aller sur https://myaccount.google.com/security</li> <li>Dans \"Connexion \u00e0 Google\", cliquer sur Validation en 2 \u00e9tapes</li> <li>Suivre les instructions pour activer</li> </ol>"},{"location":"01-infrastructure/email-smtp/#12-generer-un-mot-de-passe-dapplication","title":"1.2 G\u00e9n\u00e9rer un mot de passe d'application","text":"<ol> <li>Aller sur https://myaccount.google.com/apppasswords</li> <li>Se connecter si demand\u00e9</li> <li>Dans \"S\u00e9lectionner une application\", choisir Autre (nom personnalis\u00e9)</li> <li>Entrer : <code>WordPress srv759970</code></li> <li>Cliquer sur G\u00e9n\u00e9rer</li> <li>COPIER le mot de passe de 16 caract\u00e8res (format: <code>xxxx xxxx xxxx xxxx</code>)</li> <li>\u26a0\ufe0f IMPORTANT : Garder ce mot de passe, il ne sera affich\u00e9 qu'une fois !</li> </ol>"},{"location":"01-infrastructure/email-smtp/#etape-2-configuration-wordpress","title":"\u00c9tape 2 : Configuration WordPress","text":""},{"location":"01-infrastructure/email-smtp/#via-ssh-recommande","title":"Via SSH (Recommand\u00e9)","text":"<pre><code>ssh root@69.62.108.82\n\n# \u00c9diter wp-config.php\nnano /var/www/wordpress/wp-config.php\n</code></pre> <p>Ajouter cette section :</p> <pre><code>// WP Mail SMTP configuration for Gmail\ndefine( 'WPMS_ON', true );\ndefine( 'WPMS_MAIL_FROM', 'clemsfou@gmail.com' );\ndefine( 'WPMS_MAIL_FROM_NAME', 'Cl\u00e9mence - RH Diversit\u00e9 &amp; Inclusion' );\ndefine( 'WPMS_MAILER', 'smtp' );\ndefine( 'WPMS_SMTP_HOST', 'smtp.gmail.com' );\ndefine( 'WPMS_SMTP_PORT', 587 );\ndefine( 'WPMS_SSL', 'tls' );\ndefine( 'WPMS_SMTP_AUTH', true );\ndefine( 'WPMS_SMTP_USER', 'clemsfou@gmail.com' );\ndefine( 'WPMS_SMTP_PASS', 'VOTRE_MOT_DE_PASSE_APPLICATION' );  // \u26a0\ufe0f Remplacer\ndefine( 'WPMS_SMTP_AUTOTLS', true );\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#etape-3-test-denvoi","title":"\u00c9tape 3 : Test d'envoi","text":""},{"location":"01-infrastructure/email-smtp/#via-wordpress-admin","title":"Via WordPress Admin","text":"<ol> <li>Dans WP Mail SMTP \u2192 Email Test</li> <li>Entrer une adresse email de test</li> <li>Cliquer sur Send Email</li> <li>V\u00e9rifier la r\u00e9ception</li> </ol>"},{"location":"01-infrastructure/email-smtp/#via-ssh","title":"Via SSH","text":"<pre><code>ssh root@69.62.108.82\nwp --path=/var/www/wordpress eval 'wp_mail(\"test@example.com\", \"Test Gmail SMTP\", \"Test OK\");' --allow-root\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#limites-gmail","title":"Limites Gmail","text":""},{"location":"01-infrastructure/email-smtp/#quotas-denvoi","title":"Quotas d'envoi","text":"<ul> <li>Comptes Gmail gratuits : 500 emails/jour</li> <li>Google Workspace : 2000 emails/jour</li> </ul> <p>Si d\u00e9passement \u2192 compte bloqu\u00e9 temporairement (24h).</p>"},{"location":"01-infrastructure/email-smtp/#option-3-postfix-local-pour-systeme","title":"Option 3 : Postfix Local (Pour syst\u00e8me)","text":""},{"location":"01-infrastructure/email-smtp/#installation","title":"Installation","text":"<pre><code>apt-get install -y postfix mailutils opendkim opendkim-tools\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#configuration-de-base","title":"Configuration de base","text":"<pre><code># /etc/postfix/main.cf\nmyhostname = srv759970.hstgr.cloud\nmydomain = srv759970.hstgr.cloud\nmyorigin = $mydomain\ninet_interfaces = localhost\ninet_protocols = ipv4\nmydestination = $myhostname, localhost.$mydomain, localhost\nrelayhost =\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#restart","title":"Restart","text":"<pre><code>systemctl restart postfix\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#test","title":"Test","text":"<pre><code>echo \"Test email body\" | mail -s \"Test Subject\" julien@julienfernandez.xyz\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#configuration-dns-pour-delivrabilite","title":"Configuration DNS pour d\u00e9livrabilit\u00e9","text":"<p>Pour am\u00e9liorer la d\u00e9livrabilit\u00e9 avec Postfix, configurer les enregistrements DNS.</p>"},{"location":"01-infrastructure/email-smtp/#1-acceder-au-panneau-dns-hostinger","title":"1. Acc\u00e9der au panneau DNS Hostinger","text":"<ol> <li>Aller sur https://hpanel.hostinger.com/</li> <li>S\u00e9lectionner le VPS <code>srv759970.hstgr.cloud</code></li> <li>Cliquer sur DNS Zone ou DNS Management</li> </ol>"},{"location":"01-infrastructure/email-smtp/#2-ajouter-les-enregistrements-dns","title":"2. Ajouter les enregistrements DNS","text":""},{"location":"01-infrastructure/email-smtp/#enregistrement-spf","title":"Enregistrement SPF","text":"<p>Type : <code>TXT</code> Nom/Host : <code>@</code> ou <code>srv759970.hstgr.cloud</code> Valeur/Value : <pre><code>v=spf1 ip4:69.62.108.82 include:sendgrid.net a mx ~all\n</code></pre> TTL : 3600</p>"},{"location":"01-infrastructure/email-smtp/#enregistrement-dkim","title":"Enregistrement DKIM","text":"<p>Type : <code>TXT</code> Nom/Host : <code>mail._domainkey</code> Valeur/Value : <pre><code>v=DKIM1; h=sha256; k=rsa; p=&lt;votre_cle_publique_dkim&gt;\n</code></pre> TTL : 3600</p> <p>G\u00e9n\u00e9rer la cl\u00e9 DKIM : <pre><code>ssh root@69.62.108.82\nmkdir -p /etc/opendkim/keys/srv759970.hstgr.cloud\ncd /etc/opendkim/keys/srv759970.hstgr.cloud\nopendkim-genkey -s mail -d srv759970.hstgr.cloud\ncat mail.txt  # Copier la cl\u00e9 publique\n</code></pre></p>"},{"location":"01-infrastructure/email-smtp/#enregistrement-dmarc","title":"Enregistrement DMARC","text":"<p>Type : <code>TXT</code> Nom/Host : <code>_dmarc</code> Valeur/Value : <pre><code>v=DMARC1; p=quarantine; rua=mailto:postmaster@srv759970.hstgr.cloud; pct=100\n</code></pre> TTL : 3600</p>"},{"location":"01-infrastructure/email-smtp/#3-verification-apres-propagation-1-48h","title":"3. V\u00e9rification apr\u00e8s propagation (1-48h)","text":""},{"location":"01-infrastructure/email-smtp/#depuis-windows-powershell","title":"Depuis Windows (PowerShell)","text":"<pre><code># V\u00e9rifier SPF\nnslookup -type=TXT srv759970.hstgr.cloud\n\n# V\u00e9rifier DKIM\nnslookup -type=TXT mail._domainkey.srv759970.hstgr.cloud\n\n# V\u00e9rifier DMARC\nnslookup -type=TXT _dmarc.srv759970.hstgr.cloud\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#depuis-le-serveur-ssh","title":"Depuis le serveur (SSH)","text":"<pre><code>ssh root@69.62.108.82\n\n# V\u00e9rifier SPF\ndig +short TXT srv759970.hstgr.cloud\n\n# V\u00e9rifier DKIM\ndig +short TXT mail._domainkey.srv759970.hstgr.cloud\n\n# V\u00e9rifier DMARC\ndig +short TXT _dmarc.srv759970.hstgr.cloud\n\n# Tester la cl\u00e9 DKIM\nopendkim-testkey -d srv759970.hstgr.cloud -s mail -vvv\n</code></pre> <p>R\u00e9sultat attendu : <code>key OK</code></p>"},{"location":"01-infrastructure/email-smtp/#outils-de-test-en-ligne","title":"Outils de test en ligne","text":""},{"location":"01-infrastructure/email-smtp/#mxtoolbox-test-complet","title":"MXToolbox - Test complet","text":"<p>https://mxtoolbox.com/SuperTool.aspx - Entrer <code>srv759970.hstgr.cloud</code> - V\u00e9rifier SPF, DKIM, DMARC</p>"},{"location":"01-infrastructure/email-smtp/#google-admin-toolbox-test-headers","title":"Google Admin Toolbox - Test headers","text":"<p>https://toolbox.googleapps.com/apps/messageheader/ - Coller les headers d'un email re\u00e7u - Voir le r\u00e9sultat d'authentification</p>"},{"location":"01-infrastructure/email-smtp/#mail-tester-score-spam","title":"Mail Tester - Score spam","text":"<p>https://www.mail-tester.com/ - Envoyer un email \u00e0 l'adresse fournie - Voir le score /10</p>"},{"location":"01-infrastructure/email-smtp/#monitoring","title":"Monitoring","text":""},{"location":"01-infrastructure/email-smtp/#sendgrid-dashboard","title":"SendGrid Dashboard","text":"<ul> <li>Statistiques d'envoi</li> <li>Taux de d\u00e9livrabilit\u00e9</li> <li>Bounces et spam reports</li> </ul>"},{"location":"01-infrastructure/email-smtp/#logs-postfix","title":"Logs Postfix","text":"<pre><code>tail -f /var/log/mail.log\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#logs-wordpress","title":"Logs WordPress","text":"<pre><code>tail -50 /var/www/wordpress/wp-content/debug.log\n</code></pre>"},{"location":"01-infrastructure/email-smtp/#troubleshooting","title":"Troubleshooting","text":""},{"location":"01-infrastructure/email-smtp/#dns-ne-se-propagent-pas","title":"DNS ne se propagent pas","text":"<ol> <li>V\u00e9rifier que les enregistrements sont bien ajout\u00e9s dans le panneau Hostinger</li> <li>Attendre 24-48h (propagation mondiale)</li> <li>Vider le cache DNS local :    <pre><code>ipconfig /flushdns\n</code></pre></li> </ol>"},{"location":"01-infrastructure/email-smtp/#dkim-echoue-toujours","title":"DKIM \u00e9choue toujours","text":"<p>Reg\u00e9n\u00e9rer la cl\u00e9 DKIM : <pre><code>ssh root@69.62.108.82\ncd /etc/opendkim/keys/srv759970.hstgr.cloud\nrm mail.private mail.txt\nopendkim-genkey -s mail -d srv759970.hstgr.cloud\ncat mail.txt  # Copier la nouvelle cl\u00e9 publique\nsystemctl restart opendkim\n</code></pre></p> <p>Puis mettre \u00e0 jour l'enregistrement DNS DKIM avec la nouvelle cl\u00e9.</p>"},{"location":"01-infrastructure/email-smtp/#ressources","title":"Ressources","text":"<ul> <li>SendGrid Documentation</li> <li>Postfix Documentation</li> <li>Grafana Email Notifications</li> <li>Google App Passwords</li> <li>WP Mail SMTP Documentation</li> <li>Gmail SMTP Settings</li> </ul>"},{"location":"01-infrastructure/environment-setup/","title":"\ud83d\udda5\ufe0f Documentation Environnement Serveur - srv759970","text":"<p>Pour LLMs/IA d\u00e9ployant de nouveaux services</p> <p>Cette documentation d\u00e9crit l'infrastructure compl\u00e8te du serveur pour permettre une int\u00e9gration correcte de nouveaux services.</p>"},{"location":"01-infrastructure/environment-setup/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<ul> <li>Hostname : srv759970.hstgr.cloud</li> <li>IP Publique : 69.62.108.82</li> <li>OS : Ubuntu 22.04 LTS</li> <li>RAM : 16 GB (actuellement ~31% utilis\u00e9s)</li> <li>CPU : 4 vCPU</li> <li>Stockage : 193 GB total (112 GB utilis\u00e9s, 81 GB disponibles)</li> <li>Uptime : 206+ jours</li> </ul>"},{"location":"01-infrastructure/environment-setup/#stack-technique","title":"\ud83d\udd27 Stack Technique","text":""},{"location":"01-infrastructure/environment-setup/#1-orchestration-conteneurisation","title":"1. Orchestration &amp; Conteneurisation","text":""},{"location":"01-infrastructure/environment-setup/#docker-docker-compose","title":"Docker &amp; Docker Compose","text":"<ul> <li>Version Docker : 24.x</li> <li>Localisation configs : <code>/opt/&lt;nom-service&gt;/docker-compose.yml</code></li> <li>R\u00e9seau : Multiples r\u00e9seaux Docker isol\u00e9s par service</li> <li>Volumes : Named volumes pour persistence</li> </ul> <p>R\u00e9seaux Docker existants : <pre><code>- whisperx_whisperx              (Transcription stack)\n- faster-whisper-queue_faster-whisper-net\n- memvid_memvid-network          (Video RAG)\n- rag-anything_default           (RAG pipeline)\n- monitoring_monitoring          (Prometheus/Grafana/Loki)\n- sablier-network                (Auto-start services)\n- wordpress-shared-network       (WordPress mutualis\u00e9)\n- wordpress-clemence_clemence-network\n- wordpress-jesuishyperphagique_jesuishyperphagique-network\n- wordpress-panneauxsolidaires_panneauxsolidaires-network\n- neutts-network                 (Text-to-Speech)\n- rustdesk_rustdesk-net          (Remote desktop)\n- dashy_default\n- mkdocs_default\n- api-portal_default\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#auto-start-system-custom","title":"Auto-Start System (Custom)","text":"<ul> <li>Localisation : <code>/opt/docker-autostart/</code></li> <li>Fonction : D\u00e9marre/arr\u00eate automatiquement les conteneurs selon utilisation</li> <li>Config : <code>/opt/docker-autostart/config.json</code></li> <li>Port : 10000 (API interne)</li> <li>Principe : Nginx proxy_pass \u2192 Auto-start d\u00e9tecte requ\u00eate \u2192 Lance conteneur si stopped</li> </ul> <p>Services g\u00e9r\u00e9s par auto-start : - Tika Server (OCR/parsing) - Strapi (CMS headless) - N8N (Automatisation) - Et autres services peu utilis\u00e9s</p> <p>\u26a0\ufe0f Important pour nouveaux services : - Services critiques : <code>restart: unless-stopped</code> - Services occasionnels : <code>restart: \"no\"</code> + labels auto-start</p>"},{"location":"01-infrastructure/environment-setup/#2-reverse-proxy-ssl","title":"2. Reverse Proxy &amp; SSL","text":""},{"location":"01-infrastructure/environment-setup/#nginx","title":"Nginx","text":"<ul> <li>Config principale : <code>/etc/nginx/nginx.conf</code></li> <li>Sites disponibles : <code>/etc/nginx/sites-available/</code></li> <li>Sites actifs : <code>/etc/nginx/sites-enabled/</code> (symlinks)</li> <li>Snippets r\u00e9utilisables : <code>/etc/nginx/snippets/</code></li> </ul> <p>Snippets disponibles : <pre><code># /etc/nginx/snippets/basic-auth.conf\nauth_basic \"Restricted Access - Dev Server\";\nauth_basic_user_file /etc/nginx/.htpasswd;\n\n# /etc/nginx/snippets/auto-start-service.conf\n# D\u00e9tection auto-start pour services on-demand\n\n# /etc/nginx/snippets/wordpress-cache.conf\n# Cache FastCGI pour WordPress\n</code></pre></p> <p>Template vhost standard : <pre><code>server {\n    listen 443 ssl http2;\n    server_name monservice.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/monservice.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/monservice.srv759970.hstgr.cloud/privkey.pem;\n\n    # Auth si service interne\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://localhost:PORT;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    server_name monservice.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#certbot-lets-encrypt","title":"Certbot (Let's Encrypt)","text":"<ul> <li>Certificats : <code>/etc/letsencrypt/live/&lt;domain&gt;/</code></li> <li>Renouvellement : Automatique via systemd timer</li> <li>Email : julien.fernandez.work@gmail.com</li> </ul> <p>Obtenir nouveau certificat : <pre><code>certbot --nginx -d monservice.srv759970.hstgr.cloud \\\n  --non-interactive --agree-tos --email julien.fernandez.work@gmail.com\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#3-monitoring-observabilite","title":"3. Monitoring &amp; Observabilit\u00e9","text":""},{"location":"01-infrastructure/environment-setup/#prometheus","title":"Prometheus","text":"<ul> <li>URL : https://prometheus.srv759970.hstgr.cloud</li> <li>Port interne : 9090</li> <li>Config : <code>/opt/monitoring/prometheus/prometheus.yml</code></li> <li>Scrape interval : 15s</li> <li>R\u00e9tention : 30 jours</li> </ul> <p>Jobs configur\u00e9s : <pre><code>scrape_configs:\n  - job_name: 'node-exporter'        # M\u00e9triques syst\u00e8me\n  - job_name: 'cadvisor'             # M\u00e9triques Docker containers\n  - job_name: 'rq-whisperx'          # Queue WhisperX\n  - job_name: 'rq-faster-whisper'    # Queue Faster-Whisper\n  - job_name: 'prometheus'           # Self-monitoring\n</code></pre></p> <p>\u26a0\ufe0f Pour nouveau service avec m\u00e9triques : 1. Exposer endpoint <code>/metrics</code> (format Prometheus) 2. Ajouter job dans <code>/opt/monitoring/prometheus/prometheus.yml</code> 3. Red\u00e9marrer : <code>cd /opt/monitoring &amp;&amp; docker-compose restart prometheus</code></p>"},{"location":"01-infrastructure/environment-setup/#grafana","title":"Grafana","text":"<ul> <li>URL : https://monitoring.srv759970.hstgr.cloud</li> <li>Port interne : 3001</li> <li>Credentials : admin / [voir .env]</li> <li>Datasources :</li> <li>Prometheus (m\u00e9triques)</li> <li>Loki (logs)</li> <li>Redis (optionnel, plugin install\u00e9)</li> </ul> <p>Dashboards existants : - System metrics (CPU, RAM, disk) - Docker containers (cAdvisor) - RQ queues (WhisperX, Faster-Whisper) - Nginx logs</p>"},{"location":"01-infrastructure/environment-setup/#loki-promtail","title":"Loki + Promtail","text":"<ul> <li>Loki URL : http://localhost:3100 (interne)</li> <li>Fonction : Collecte logs containers Docker</li> <li>Config : <code>/opt/monitoring/loki/loki-config.yml</code></li> <li>Promtail : Scrape <code>/var/lib/docker/containers/</code> automatiquement</li> </ul> <p>\u26a0\ufe0f Logs automatiques : Tout conteneur Docker est automatiquement scraped par Promtail</p>"},{"location":"01-infrastructure/environment-setup/#netdata","title":"Netdata","text":"<ul> <li>URL : http://69.62.108.82:19999 (pas de SSL, localhost only)</li> <li>Fonction : Monitoring temps r\u00e9el syst\u00e8me</li> <li>RAM : ~360 MB (peut \u00eatre optimis\u00e9)</li> </ul>"},{"location":"01-infrastructure/environment-setup/#4-dashboards-documentation","title":"4. Dashboards &amp; Documentation","text":""},{"location":"01-infrastructure/environment-setup/#dashy-service-dashboard","title":"Dashy (Service Dashboard)","text":"<ul> <li>URL : https://dashy.srv759970.hstgr.cloud</li> <li>Port interne : 4000</li> <li>Config : <code>/opt/dashy/conf.yml</code></li> <li>Fonction : Landing page avec liens vers tous les services</li> </ul> <p>\u26a0\ufe0f Ajouter nouveau service dans Dashy : <pre><code># /opt/dashy/conf.yml\nsections:\n  - name: Mon Nouveau Service\n    items:\n      - title: Mon Service\n        description: Description courte\n        icon: hl-docker  # Ou autre ic\u00f4ne\n        url: https://monservice.srv759970.hstgr.cloud\n        statusCheck: true\n        statusCheckUrl: https://monservice.srv759970.hstgr.cloud/health\n</code></pre></p> <p>Puis : <code>cd /opt/dashy &amp;&amp; docker-compose restart</code></p>"},{"location":"01-infrastructure/environment-setup/#mkdocs-documentation","title":"MkDocs (Documentation)","text":"<ul> <li>URL : https://docs.srv759970.hstgr.cloud</li> <li>Port interne : 8005</li> <li>Config : <code>/opt/mkdocs/mkdocs.yml</code> (ou racine <code>/mkdocs.yml</code>)</li> <li>Source : <code>/docs/</code> (Markdown)</li> </ul> <p>\u26a0\ufe0f Ajouter doc nouveau service : 1. Cr\u00e9er <code>/docs/services/mon-service.md</code> 2. Ajouter dans <code>/mkdocs.yml</code> :    <pre><code>nav:\n  - Services:\n    - Mon Service: services/mon-service.md\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#swagger-ui-api-documentation","title":"Swagger UI (API Documentation)","text":"<ul> <li>URL : https://portal.srv759970.hstgr.cloud (ou swagger sp\u00e9cifique)</li> <li>Port interne : 8503</li> <li>Fonction : Documentation OpenAPI centralis\u00e9e</li> </ul> <p>\u26a0\ufe0f Si ton service expose OpenAPI/Swagger : - Fournir URL du spec JSON : <code>http://monservice:PORT/openapi.json</code> - Sera auto-d\u00e9couvert par Swagger UI</p>"},{"location":"01-infrastructure/environment-setup/#dozzle-docker-logs-viewer","title":"Dozzle (Docker Logs Viewer)","text":"<ul> <li>URL : https://dozzle.srv759970.hstgr.cloud</li> <li>Port interne : 8888</li> <li>Fonction : Interface web pour logs Docker temps r\u00e9el</li> <li>Auto-d\u00e9couverte : Tous les conteneurs visibles automatiquement</li> </ul>"},{"location":"01-infrastructure/environment-setup/#5-bases-de-donnees","title":"5. Bases de donn\u00e9es","text":""},{"location":"01-infrastructure/environment-setup/#mysql-wordpress","title":"MySQL (WordPress)","text":"<p>\u26a0\ufe0f Important : Chaque site WordPress a son MySQL d\u00e9di\u00e9 (probl\u00e8mes licensing plugins si mutualis\u00e9)</p> <p>Instances existantes : <pre><code>- mysql-clemence              (port interne 3306)\n- mysql-wordpress-shared      (port 3307, pour petits sites)\n- mysql-jesuishyperphagique   (port interne 3306)\n- mysql-panneauxsolidaires    (port interne 3306)\n</code></pre></p> <p>\u26a0\ufe0f Pour nouveau WordPress : - Cr\u00e9er instance MySQL d\u00e9di\u00e9e (ne PAS r\u00e9utiliser mysql-wordpress-shared) - Utiliser r\u00e9seau Docker isol\u00e9</p>"},{"location":"01-infrastructure/environment-setup/#redis-queues","title":"Redis (Queues)","text":"<p>Instance existante : <pre><code>- rq-queue-redis (port 6380)\n  - DB 0 : WhisperX queue\n  - DB 1 : Faster-Whisper queue\n</code></pre></p> <p>\u26a0\ufe0f Pour nouveau service avec queue RQ : - R\u00e9utiliser <code>rq-queue-redis</code> - Utiliser DB diff\u00e9rente (DB 2, 3, etc.) - Rejoindre r\u00e9seau <code>whisperx_whisperx</code></p>"},{"location":"01-infrastructure/environment-setup/#a-venir-phase-1-du-plan","title":"\u00c0 venir (Phase 1 du plan)","text":"<ul> <li>MongoDB partag\u00e9 (port 27017) : Rocket.Chat, MemVid</li> <li>PostgreSQL partag\u00e9 (port 5432) : Nextcloud, metadata transcription</li> <li>Redis cache partag\u00e9 (port 6379) : Cache applicatif (distinct de Redis RQ)</li> </ul>"},{"location":"01-infrastructure/environment-setup/#6-services-operationnels","title":"6. Services op\u00e9rationnels","text":""},{"location":"01-infrastructure/environment-setup/#transcription-tts","title":"Transcription &amp; TTS","text":"Service URL Port Capacit\u00e9s RAM WhisperX https://whisperx.srv759970.hstgr.cloud 8002 Transcription + diarization 40 MB WhisperX Dashboard https://whisperx-dashboard.srv759970.hstgr.cloud 9181 RQ Dashboard 20 MB Faster-Whisper https://faster-whisper.srv759970.hstgr.cloud 8001 Transcription rapide CPU 438 MB Faster-Whisper Queue https://faster-whisper.srv759970.hstgr.cloud 8003 API avec queue RQ 45 MB NeuTTS (\u00e0 retirer) http://localhost:8004 8004 Text-to-Speech 6.66 GB \ud83d\udd34 <p>R\u00e9seau : <code>whisperx_whisperx</code>, <code>faster-whisper-queue_faster-whisper-net</code></p>"},{"location":"01-infrastructure/environment-setup/#rag-semantic-search","title":"RAG &amp; Semantic Search","text":"Service URL Port Fonction RAM MemVid https://memvid.srv759970.hstgr.cloud 8506 Video encoding QR + search 468 MB MemVid UI https://memvid-ui.srv759970.hstgr.cloud 8507 Interface Streamlit 44 MB RAG-Anything https://rag-anything.srv759970.hstgr.cloud 9510 Pipeline RAG universel 212 MB RagFlow (stopped) https://ragflow.srv759970.hstgr.cloud - RAG orchestration 0 MB <p>R\u00e9seau : <code>memvid_memvid-network</code>, <code>rag-anything_default</code></p>"},{"location":"01-infrastructure/environment-setup/#ocr-parsing","title":"OCR &amp; Parsing","text":"Service URL Port Fonction RAM Auto-start Tika Server https://tika.srv759970.hstgr.cloud 9998 OCR Tesseract + parsing universel 0 MB \u2705 Sablier <p>R\u00e9seau : <code>sablier-network</code></p> <p>Formats support\u00e9s : PDF, DOCX, PPTX, XLSX, images, emails, archives, etc.</p>"},{"location":"01-infrastructure/environment-setup/#wordpress-sites","title":"WordPress Sites","text":"Site URL MySQL R\u00e9seau Cl\u00e9mence https://clemence.srv759970.hstgr.cloud mysql-clemence clemence-network JeSuisHyperphagique https://jesuishyperphagique.srv759970.hstgr.cloud mysql-jesuishyperphagique jesuishyperphagique-network PanneauxSolidaires https://panneauxsolidaires.srv759970.hstgr.cloud mysql-panneauxsolidaires panneauxsolidaires-network SolidarLink https://solidarlink.srv759970.hstgr.cloud mysql-wordpress-shared wordpress-shared-network <p>Stack : Nginx (Alpine) \u2192 WordPress (PHP-FPM) \u2192 MySQL</p>"},{"location":"01-infrastructure/environment-setup/#autres-services","title":"Autres Services","text":"Service URL Port Fonction Portainer http://69.62.108.82:9000 9000 Gestion Docker UI RustDesk https://rustdesk.srv759970.hstgr.cloud 21115-21119 Remote desktop (hbbs+hbbr) Ollama http://localhost:11434 11434 LLM inference (systemd, stopped) Strapi https://strapi.srv759970.hstgr.cloud - CMS headless (auto-start) N8N https://n8n.srv759970.hstgr.cloud - Workflow automation (auto-start)"},{"location":"01-infrastructure/environment-setup/#securite-acces","title":"\ud83d\udd10 S\u00e9curit\u00e9 &amp; Acc\u00e8s","text":""},{"location":"01-infrastructure/environment-setup/#authentification","title":"Authentification","text":"<p>Basic Auth : - Fichier : <code>/etc/nginx/.htpasswd</code> - Usage : Prot\u00e8ge tous les services internes - Snippet : <code>include snippets/basic-auth.conf;</code></p> <p>Services publics (sans auth) : - Sites WordPress (Cl\u00e9mence, JeSuisHyperphagique, etc.)</p> <p>Services internes (avec auth) : - Tous les dashboards (Grafana, Prometheus, Dashy) - APIs de d\u00e9veloppement - Services RAG/Transcription</p>"},{"location":"01-infrastructure/environment-setup/#firewall-ufw","title":"Firewall (UFW)","text":"<pre><code>Status: active\n\nTo                         Action      From\n--                         ------      ----\n22/tcp                     ALLOW       Anywhere\n80,443/tcp                 ALLOW       Anywhere\n21115:21119/tcp            ALLOW       Anywhere  # RustDesk\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#fail2ban","title":"Fail2ban","text":"<ul> <li>SSH : 3 tentatives \u2192 ban 1h</li> <li>Nginx HTTP Auth : 5 tentatives \u2192 ban 1h</li> </ul>"},{"location":"01-infrastructure/environment-setup/#ports-utilises","title":"\ud83d\udcca Ports utilis\u00e9s","text":""},{"location":"01-infrastructure/environment-setup/#ports-publics-exposes","title":"Ports publics (expos\u00e9s)","text":"<pre><code>80         HTTP (redirect \u2192 HTTPS)\n443        HTTPS (Nginx reverse proxy)\n3307       MySQL wordpress-shared\n6380       Redis RQ (pour workers externes)\n9000       Portainer\n19999      Netdata (localhost only)\n21115-21119 RustDesk\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#ports-internes-containers","title":"Ports internes (containers)","text":"<pre><code>3000       Grafana\n3001       Grafana (expos\u00e9 via Nginx monitoring)\n3100       Loki\n4000       Dashy\n8001       Faster-Whisper\n8002       WhisperX\n8003       Faster-Whisper Queue\n8004       NeuTTS (\u00e0 retirer)\n8005       MkDocs\n8080       cAdvisor\n8100       Node Exporter\n8503       Swagger UI\n8505       Nextcloud (\u00e0 venir)\n8506       MemVid API\n8507       MemVid UI\n8508       Jitsi (\u00e0 venir)\n8509       ONLYOFFICE (\u00e0 venir)\n8510       Transcription Pipeline (\u00e0 venir)\n8888       Dozzle\n9090       Prometheus\n9181       WhisperX Dashboard\n9187       PostgreSQL Exporter (\u00e0 venir)\n9216       MongoDB Exporter (\u00e0 venir)\n9510       RAG-Anything\n9726       RQ Exporter WhisperX\n9727       RQ Exporter Faster-Whisper\n9998       Tika Server\n10000      Docker Auto-start API\n11434      Ollama\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#structure-fichiers","title":"\ud83d\udcc1 Structure fichiers","text":"<pre><code>/opt/\n\u251c\u2500\u2500 api-portal/              # Swagger UI centralis\u00e9\n\u251c\u2500\u2500 cristina-backend/        # Backend Cristina (stopped)\n\u251c\u2500\u2500 cristina-site/           # Site Astro Cristina\n\u251c\u2500\u2500 dashy/                   # Dashboard services\n\u2502   \u2514\u2500\u2500 conf.yml\n\u251c\u2500\u2500 docker-autostart/        # Syst\u00e8me auto-start custom\n\u2502   \u251c\u2500\u2500 config.json\n\u2502   \u2514\u2500\u2500 server.js\n\u251c\u2500\u2500 faster-whisper-queue/    # Queue Faster-Whisper\n\u251c\u2500\u2500 memvid/                  # Video RAG\n\u251c\u2500\u2500 mkdocs/                  # Documentation\n\u251c\u2500\u2500 monitoring/              # Prometheus + Grafana + Loki\n\u2502   \u251c\u2500\u2500 prometheus/\n\u2502   \u2502   \u2514\u2500\u2500 prometheus.yml\n\u2502   \u251c\u2500\u2500 loki/\n\u2502   \u2514\u2500\u2500 grafana/\n\u251c\u2500\u2500 neutts-air/              # Text-to-Speech (\u00e0 retirer)\n\u251c\u2500\u2500 rag-anything/            # RAG pipeline\n\u251c\u2500\u2500 ragflow/                 # RAG orchestration (stopped)\n\u251c\u2500\u2500 rustdesk/                # Remote desktop\n\u251c\u2500\u2500 sablier/                 # Auto-start orchestrator\n\u251c\u2500\u2500 tika-server/             # OCR + parsing\n\u251c\u2500\u2500 whisperx/                # Transcription + diarization\n\u251c\u2500\u2500 wordpress-clemence/      # Site Cl\u00e9mence\n\u251c\u2500\u2500 wordpress-jesuishyperphagique/\n\u251c\u2500\u2500 wordpress-panneauxsolidaires/\n\u251c\u2500\u2500 wordpress-shared-db/     # MySQL mutualis\u00e9\n\u2514\u2500\u2500 wordpress-solidarlink/\n\n/etc/nginx/\n\u251c\u2500\u2500 nginx.conf               # Config principale\n\u251c\u2500\u2500 sites-available/         # Tous les vhosts\n\u251c\u2500\u2500 sites-enabled/           # Vhosts actifs (symlinks)\n\u2514\u2500\u2500 snippets/                # Configs r\u00e9utilisables\n    \u251c\u2500\u2500 basic-auth.conf\n    \u251c\u2500\u2500 auto-start-service.conf\n    \u2514\u2500\u2500 wordpress-cache.conf\n\n/etc/letsencrypt/\n\u2514\u2500\u2500 live/\n    \u251c\u2500\u2500 clemence.srv759970.hstgr.cloud/\n    \u251c\u2500\u2500 dashy.srv759970.hstgr.cloud/\n    \u251c\u2500\u2500 whisperx.srv759970.hstgr.cloud/\n    \u2514\u2500\u2500 [... tous les autres domaines]\n\n/var/log/\n\u251c\u2500\u2500 nginx/                   # Logs Nginx\n\u2502   \u251c\u2500\u2500 access.log\n\u2502   \u2514\u2500\u2500 error.log\n\u2514\u2500\u2500 [service]-access.log     # Logs par vhost\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#checklist-deploiement-nouveau-service","title":"\ud83d\ude80 Checklist d\u00e9ploiement nouveau service","text":""},{"location":"01-infrastructure/environment-setup/#1-preparation","title":"1. Pr\u00e9paration","text":"<ul> <li> Choisir nom de service (ex: <code>mon-service</code>)</li> <li> Choisir port interne unique (v\u00e9rifier liste ports ci-dessus)</li> <li> D\u00e9terminer si service critique (always-on) ou occasionnel (auto-start)</li> <li> Identifier d\u00e9pendances (DB, Redis, autres services)</li> </ul>"},{"location":"01-infrastructure/environment-setup/#2-docker","title":"2. Docker","text":"<pre><code># Cr\u00e9er structure\nmkdir -p /opt/mon-service\ncd /opt/mon-service\n\n# Cr\u00e9er docker-compose.yml\ncat &gt; docker-compose.yml &lt;&lt;'EOF'\nversion: '3.8'\n\nservices:\n  mon-service:\n    image: mon-image:latest\n    container_name: mon-service\n    restart: unless-stopped  # Ou \"no\" si auto-start\n    ports:\n      - \"PORT:PORT\"\n    environment:\n      - ENV_VAR=valeur\n    volumes:\n      - mon-service-data:/data\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:PORT/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - mon-service-network\n    # Si auto-start :\n    # labels:\n    #   - sablier.enable=true\n    #   - sablier.group=api-services\n\nvolumes:\n  mon-service-data:\n\nnetworks:\n  mon-service-network:\n    driver: bridge\n  # Si besoin acc\u00e8s autres services :\n  # whisperx_whisperx:\n  #   external: true\nEOF\n\n# D\u00e9marrer\ndocker-compose up -d\n\n# V\u00e9rifier logs\ndocker-compose logs -f\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#3-nginx","title":"3. Nginx","text":"<pre><code># Cr\u00e9er vhost\ncat &gt; /etc/nginx/sites-available/mon-service &lt;&lt;'NGINX'\nserver {\n    listen 443 ssl http2;\n    server_name mon-service.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/mon-service.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mon-service.srv759970.hstgr.cloud/privkey.pem;\n\n    # Si service interne\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://localhost:PORT;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Si WebSocket\n        # proxy_set_header Upgrade $http_upgrade;\n        # proxy_set_header Connection \"upgrade\";\n\n        # Timeouts si long processing\n        # proxy_read_timeout 600s;\n        # proxy_send_timeout 600s;\n    }\n}\n\nserver {\n    listen 80;\n    server_name mon-service.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\nNGINX\n\n# Activer\nln -sf /etc/nginx/sites-available/mon-service /etc/nginx/sites-enabled/\n\n# Tester config\nnginx -t\n\n# Recharger\nsystemctl reload nginx\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#4-ssl","title":"4. SSL","text":"<pre><code># Obtenir certificat\ncertbot --nginx -d mon-service.srv759970.hstgr.cloud \\\n  --non-interactive --agree-tos --email julien.fernandez.work@gmail.com\n\n# V\u00e9rifier renouvellement auto\ncertbot renew --dry-run\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#5-monitoring","title":"5. Monitoring","text":"<p>Si expose m\u00e9triques Prometheus : <pre><code># \u00c9diter /opt/monitoring/prometheus/prometheus.yml\n# Ajouter :\n  - job_name: 'mon-service'\n    static_configs:\n      - targets: ['mon-service:PORT']\n\n# Red\u00e9marrer Prometheus\ncd /opt/monitoring\ndocker-compose restart prometheus\n</code></pre></p> <p>Logs automatiques : D\u00e9j\u00e0 scraped par Promtail (rien \u00e0 faire)</p>"},{"location":"01-infrastructure/environment-setup/#6-dashboards","title":"6. Dashboards","text":"<p>Dashy : <pre><code># \u00c9diter /opt/dashy/conf.yml\n# Ajouter dans section appropri\u00e9e :\n  - title: Mon Service\n    description: Description\n    icon: hl-docker\n    url: https://mon-service.srv759970.hstgr.cloud\n    statusCheck: true\n\n# Red\u00e9marrer\ncd /opt/dashy\ndocker-compose restart\n</code></pre></p> <p>MkDocs : <pre><code># Cr\u00e9er doc\ncat &gt; /docs/services/mon-service.md &lt;&lt;'DOC'\n# Mon Service\n\nDescription...\n\n## API\n\n...\nDOC\n\n# Ajouter dans mkdocs.yml\n# Red\u00e9marrer mkdocs\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#7-tests","title":"7. Tests","text":"<pre><code># Health check\ncurl https://mon-service.srv759970.hstgr.cloud/health\n\n# Logs\ndocker logs mon-service --tail 50 -f\n\n# Prometheus metrics (si applicable)\ncurl http://localhost:PORT/metrics\n\n# V\u00e9rifier Grafana\n# V\u00e9rifier Dashy\n# V\u00e9rifier logs dans Dozzle\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#integration-avec-services-existants","title":"\ud83d\udd04 Int\u00e9gration avec services existants","text":""},{"location":"01-infrastructure/environment-setup/#se-connecter-a-whisperxfaster-whisper","title":"Se connecter \u00e0 WhisperX/Faster-Whisper","text":"<pre><code># docker-compose.yml\nservices:\n  mon-service:\n    environment:\n      - WHISPERX_URL=http://whisperx:8002\n      - FASTER_WHISPER_URL=http://faster-whisper:8001\n    networks:\n      - whisperx_whisperx  # Important !\n      - faster-whisper-queue_faster-whisper-net\n\nnetworks:\n  whisperx_whisperx:\n    external: true\n  faster-whisper-queue_faster-whisper-net:\n    external: true\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#utiliser-redis-rq-queue-jobs","title":"Utiliser Redis RQ (queue jobs)","text":"<pre><code>services:\n  mon-service:\n    environment:\n      - REDIS_URL=redis://rq-queue-redis:6379/2  # DB 2 (0=WhisperX, 1=Faster-Whisper)\n    networks:\n      - whisperx_whisperx\n\nnetworks:\n  whisperx_whisperx:\n    external: true\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#utiliser-tika-ocrparsing","title":"Utiliser Tika (OCR/parsing)","text":"<pre><code>import requests\n\n# Tika auto-d\u00e9marre via Sablier\nresponse = requests.put(\n    \"https://tika.srv759970.hstgr.cloud/tika\",\n    data=file_bytes,\n    headers={\"Accept\": \"text/plain\"}\n)\ntext = response.text\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#utiliser-memvid-semantic-search-video","title":"Utiliser MemVid (semantic search vid\u00e9o)","text":"<pre><code>response = requests.post(\n    \"https://memvid.srv759970.hstgr.cloud/search\",\n    json={\"query\": \"How does it work?\", \"top_k\": 5}\n)\nresults = response.json()\n</code></pre>"},{"location":"01-infrastructure/environment-setup/#maintenance","title":"\ud83d\udee0\ufe0f Maintenance","text":""},{"location":"01-infrastructure/environment-setup/#backups","title":"Backups","text":"<p>\u00c0 venir : Script automatique <code>/usr/local/bin/backup-vps.sh</code> - Databases : MongoDB, PostgreSQL, MySQL - Configs : <code>/opt/*/docker-compose.yml</code>, <code>/etc/nginx/</code> - Uploads : WordPress, Nextcloud</p>"},{"location":"01-infrastructure/environment-setup/#updates","title":"Updates","text":"<p>Containers : <pre><code>cd /opt/&lt;service&gt;\ndocker-compose pull\ndocker-compose up -d\n</code></pre></p> <p>Syst\u00e8me : <pre><code>apt update &amp;&amp; apt upgrade -y\n</code></pre></p> <p>Nginx : <pre><code>nginx -t &amp;&amp; systemctl reload nginx\n</code></pre></p>"},{"location":"01-infrastructure/environment-setup/#support-documentation","title":"\ud83d\udcde Support &amp; Documentation","text":"<ul> <li>Grafana : https://monitoring.srv759970.hstgr.cloud</li> <li>Prometheus : https://prometheus.srv759970.hstgr.cloud</li> <li>Dashy : https://dashy.srv759970.hstgr.cloud</li> <li>Docs : https://docs.srv759970.hstgr.cloud</li> <li>Logs : https://dozzle.srv759970.hstgr.cloud</li> </ul>"},{"location":"01-infrastructure/environment-setup/#points-dattention-pour-llms","title":"\u26a0\ufe0f Points d'attention pour LLMs","text":""},{"location":"01-infrastructure/environment-setup/#a-toujours-verifier-avant-deploiement","title":"\u00c0 TOUJOURS v\u00e9rifier avant d\u00e9ploiement","text":"<ol> <li>Port disponible : V\u00e9rifier liste ports ci-dessus</li> <li>R\u00e9seau Docker : Cr\u00e9er r\u00e9seau isol\u00e9 ou rejoindre existant</li> <li>Nginx vhost : Template standard + SSL</li> <li>Healthcheck : Endpoint <code>/health</code> recommand\u00e9</li> <li>Logs : JSON format si possible (meilleur parsing Loki)</li> <li>Monitoring : Exposer <code>/metrics</code> si Prometheus pertinent</li> <li>Dashy : Ajouter dans dashboard</li> <li>Documentation : Cr\u00e9er <code>/docs/services/&lt;nom&gt;.md</code></li> </ol>"},{"location":"01-infrastructure/environment-setup/#a-ne-pas-faire","title":"\u00c0 NE PAS faire","text":"<ul> <li>\u274c R\u00e9utiliser port d\u00e9j\u00e0 assign\u00e9</li> <li>\u274c Cr\u00e9er MySQL mutualis\u00e9 pour WordPress (probl\u00e8mes plugins)</li> <li>\u274c Oublier SSL (Certbot facile)</li> <li>\u274c Ignorer healthchecks (monitoring blind)</li> <li>\u274c Hardcoder credentials (utiliser .env)</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version : 1.0</p>"},{"location":"01-infrastructure/nginx-troubleshooting/","title":"Nginx - Guide de D\u00e9pannage","text":"<p>Solutions aux probl\u00e8mes Nginx r\u00e9els rencontr\u00e9s sur srv759970.hstgr.cloud.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#vue-densemble","title":"Vue d'ensemble","text":"<p>Ce guide couvre les probl\u00e8mes r\u00e9els rencontr\u00e9s lors du d\u00e9ploiement de services sur srv759970. Pour la configuration de base, voir infrastructure/nginx.md.</p> <p>Contenu : - Solutions \u00e0 5 probl\u00e8mes critiques rencontr\u00e9s en production - Checklist de d\u00e9ploiement condens\u00e9e - Commandes de diagnostic rapide</p> <p>Guides compl\u00e9mentaires : - Configuration Reference - Templates complets - Nginx Debugging - Commandes de diagnostic avanc\u00e9es - Certbot SSL - Gestion des certificats</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#problemes-courants","title":"Probl\u00e8mes Courants","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#probleme-1-les-redirections-https-bloquent-certbot","title":"Probl\u00e8me #1 : Les Redirections HTTPS Bloquent Certbot","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#symptomes","title":"Sympt\u00f4mes","text":"<ul> <li>Certbot \u00e9choue avec <code>unauthorized</code> ou <code>404</code> sur <code>.well-known/acme-challenge</code></li> <li>Le site redirige vers HTTPS alors qu'il n'a pas encore de certificat</li> <li>Erreur : <code>Invalid response from https://... 404</code></li> </ul>"},{"location":"01-infrastructure/nginx-troubleshooting/#cause","title":"Cause","text":"<p>Un autre serveur block ou une configuration globale redirige tout le trafic HTTP vers HTTPS avant m\u00eame que Certbot puisse valider le domaine.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#diagnostic","title":"Diagnostic","text":"<pre><code># Tester si l'acc\u00e8s HTTP redirige\ncurl -I http://whisper.srv759970.hstgr.cloud/\n\n# Si r\u00e9sultat : HTTP/1.1 301 \u2192 HTTPS, c'est le probl\u00e8me !\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution-1-utiliser-le-mode-standalone","title":"Solution 1 : Utiliser le mode standalone","text":"<pre><code># Arr\u00eater Nginx temporairement\nsystemctl stop nginx\n\n# Obtenir le certificat en mode standalone\ncertbot certonly --standalone -d whisper.srv759970.hstgr.cloud --non-interactive --agree-tos --email admin@srv759970.hstgr.cloud\n\n# Red\u00e9marrer Nginx\nsystemctl start nginx\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution-2-configurer-le-site-apres-avoir-le-certificat","title":"Solution 2 : Configurer le site apr\u00e8s avoir le certificat","text":"<pre><code># 1. Config initiale (SANS redirect HTTPS)\nserver {\n    listen 80;\n    server_name whisper.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:8001;\n    }\n}\n\n# 2. Obtenir le certificat\n# certbot certonly --standalone ...\n\n# 3. Ajouter le bloc HTTPS et la redirection\nserver {\n    listen 443 ssl http2;\n    server_name whisper.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        proxy_pass http://localhost:8001;\n    }\n}\n\nserver {\n    listen 80;\n    server_name whisper.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#prevention","title":"Pr\u00e9vention","text":"<ul> <li>Ne jamais ajouter de redirection HTTPS avant d'avoir le certificat</li> <li>Utiliser <code>certbot certonly --standalone</code> pour premier certificat</li> <li>Ensuite utiliser <code>certbot --nginx</code> pour renouvellements</li> </ul> <p>Voir aussi : Certbot SSL Reference pour toutes les m\u00e9thodes de validation et r\u00e9solution de probl\u00e8mes avanc\u00e9s.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#probleme-2-erreur-sni-certificate-doesnt-match","title":"Probl\u00e8me #2 : Erreur SNI \"Certificate Doesn't Match\"","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#symptomes_1","title":"Sympt\u00f4mes","text":"<ul> <li><code>https://sharepoint.srv759970.hstgr.cloud/</code> affiche le certificat de <code>blog.cristina.srv759970.hstgr.cloud</code></li> <li>Erreur SSL dans le navigateur : \"Certificate mismatch\"</li> <li>Le site affiche le contenu d'un autre site</li> </ul>"},{"location":"01-infrastructure/nginx-troubleshooting/#cause_1","title":"Cause","text":"<p>SNI (Server Name Indication) : Quand plusieurs sites HTTPS sont sur le m\u00eame serveur, Nginx utilise le premier bloc HTTPS par d\u00e9faut si SNI \u00e9choue ou si l'ordre est incorrect.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#diagnostic_1","title":"Diagnostic","text":"<pre><code># V\u00e9rifier quel certificat est servi\nopenssl s_client -connect sharepoint.srv759970.hstgr.cloud:443 -servername sharepoint.srv759970.hstgr.cloud | openssl x509 -noout -subject\n\n# R\u00e9sultat attendu : subject=CN = sharepoint.srv759970.hstgr.cloud\n# R\u00e9sultat probl\u00e8me : subject=CN = blog.cristina.srv759970.hstgr.cloud\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution","title":"Solution","text":"<p>Ordre des blocs server dans Nginx : 1. Les blocs HTTPS doivent avoir <code>listen 443 ssl http2;</code> ET <code>server_name</code> sp\u00e9cifique 2. \u00c9viter les blocs catch-all <code>server_name _;</code> en HTTPS 3. S'assurer que chaque domaine a son propre certificat</p> <pre><code># \u2705 BON : Certificat et server_name correspondent\nserver {\n    listen 443 ssl http2;\n    server_name sharepoint.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/sharepoint.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/sharepoint.srv759970.hstgr.cloud/privkey.pem;\n    # ...\n}\n\n# \u274c MAUVAIS : server_name _ en HTTPS\nserver {\n    listen 443 ssl;\n    server_name _;  # \u2190 Intercepte TOUS les domaines !\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#verifier-lordre-de-chargement","title":"V\u00e9rifier l'ordre de chargement","text":"<pre><code># Voir l'ordre des configs\nnginx -T | grep -E 'configuration file|server_name'\n\n# S'assurer que chaque domaine HTTPS a son bloc d\u00e9di\u00e9\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#probleme-3-docker-nginx-sert-la-page-par-defaut","title":"Probl\u00e8me #3 : Docker Nginx Sert la Page Par D\u00e9faut","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#symptomes_2","title":"Sympt\u00f4mes","text":"<ul> <li>Le site affiche \"Welcome to nginx!\" au lieu du vrai contenu</li> <li>Le conteneur tourne correctement (<code>docker ps</code> montre UP)</li> <li>Logs du conteneur montrent des 200 OK mais mauvaise page</li> </ul>"},{"location":"01-infrastructure/nginx-troubleshooting/#cause_2","title":"Cause","text":"<p>Double Nginx : Le conteneur Docker a son propre Nginx interne avec une configuration qui sert <code>/usr/share/nginx/html/index.html</code> (page par d\u00e9faut) au lieu du vrai contenu.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#diagnostic_2","title":"Diagnostic","text":"<pre><code># Tester le conteneur directement\ncurl http://localhost:8502/\n\n# Si r\u00e9sultat : \"Welcome to nginx!\", le probl\u00e8me est dans le conteneur\n\n# V\u00e9rifier la structure dans le conteneur\ndocker exec sharepoint-dashboards ls -la /usr/share/nginx/html/\n\n# Trouver o\u00f9 sont les vrais fichiers\ndocker exec sharepoint-dashboards find /usr/share/nginx/html -name \"*.html\" -type f\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution-1-redirection-nginx-externe","title":"Solution 1 : Redirection Nginx externe","text":"<p>Si les fichiers sont dans un sous-dossier (ex: <code>/html/</code>) :</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name sharepoint.srv759970.hstgr.cloud;\n\n    # Rediriger / vers /html/\n    location = / {\n        return 301 https://$host/html/;\n    }\n\n    location / {\n        proxy_pass http://localhost:8502;\n        # headers proxy...\n    }\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution-2-reconstruire-le-conteneur","title":"Solution 2 : Reconstruire le conteneur","text":"<p>Modifier le Dockerfile pour copier les fichiers \u00e0 la racine :</p> <pre><code># \u274c MAUVAIS\nCOPY html/ /usr/share/nginx/html/html/\n\n# \u2705 BON\nCOPY html/ /usr/share/nginx/html/\n</code></pre> <p>Puis reconstruire : <pre><code>cd /opt/sharepoint-dashboards\ndocker-compose down\ndocker-compose build --no-cache\ndocker-compose up -d\n</code></pre></p>"},{"location":"01-infrastructure/nginx-troubleshooting/#probleme-4-http-404-sur-tous-les-sous-domaines","title":"Probl\u00e8me #4 : HTTP 404 sur Tous les Sous-domaines","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#symptomes_3","title":"Sympt\u00f4mes","text":"<ul> <li>Tous les nouveaux sous-domaines retournent 404</li> <li>Dashboard, Whisper, etc. ne fonctionnent pas</li> <li>Nginx r\u00e9pond mais avec 404</li> </ul>"},{"location":"01-infrastructure/nginx-troubleshooting/#cause_3","title":"Cause","text":"<p>Les blocs server HTTP (port 80) configur\u00e9s par Certbot font <code>return 404;</code> au lieu de rediriger correctement vers HTTPS.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#exemple-de-mauvaise-config-generee-par-certbot","title":"Exemple de mauvaise config (g\u00e9n\u00e9r\u00e9e par Certbot)","text":"<pre><code>server {\n    if ($host = cristina.srv759970.hstgr.cloud) {\n        return 301 https://$host$request_uri;\n    }\n\n    listen 80;\n    server_name cristina.srv759970.hstgr.cloud;\n    return 404; # \u2190 PROBL\u00c8ME : si le if() ne match pas, retourne 404\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#solution-config-propre-http-https","title":"Solution : Config propre HTTP \u2192 HTTPS","text":"<pre><code># \u2705 BON : Redirection simple et claire\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name cristina.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name cristina.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/cristina.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/cristina.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    # Configuration du site...\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#correction-en-masse","title":"Correction en masse","text":"<pre><code># Lister tous les sites avec return 404\nnginx -T | grep -B 5 \"return 404\"\n\n# Pour chaque site, remplacer la config par le template propre ci-dessus\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#checklist-de-deploiement","title":"Checklist de D\u00e9ploiement","text":""},{"location":"01-infrastructure/nginx-troubleshooting/#etape-1-configuration-nginx-http-seulement","title":"\u00c9tape 1 : Configuration Nginx HTTP seulement","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    server_name nouveau-site.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:PORT;\n        # ou root /opt/nouveau-site;\n    }\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#etape-2-activer-et-tester","title":"\u00c9tape 2 : Activer et tester","text":"<pre><code># Cr\u00e9er et activer\nnano /etc/nginx/sites-available/nouveau-site\nln -s /etc/nginx/sites-available/nouveau-site /etc/nginx/sites-enabled/\n\n# Tester et recharger\nnginx -t &amp;&amp; systemctl reload nginx\n\n# V\u00e9rifier\ncurl -I http://nouveau-site.srv759970.hstgr.cloud/\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#etape-3-obtenir-le-certificat-ssl","title":"\u00c9tape 3 : Obtenir le certificat SSL","text":"<pre><code># M\u00e9thode standalone (recommand\u00e9e pour premi\u00e8re installation)\nsystemctl stop nginx\ncertbot certonly --standalone -d nouveau-site.srv759970.hstgr.cloud --email admin@srv759970.hstgr.cloud --agree-tos --non-interactive\nsystemctl start nginx\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#etape-4-ajouter-https-et-redirection","title":"\u00c9tape 4 : Ajouter HTTPS et redirection","text":"<pre><code># Bloc HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name nouveau-site.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/nouveau-site.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/nouveau-site.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        proxy_pass http://localhost:PORT;\n    }\n}\n\n# Bloc HTTP avec redirection\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name nouveau-site.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#etape-5-tester-et-recharger","title":"\u00c9tape 5 : Tester et recharger","text":"<pre><code>nginx -t &amp;&amp; systemctl reload nginx\n\n# Tester HTTPS\ncurl -skI https://nouveau-site.srv759970.hstgr.cloud/\n\n# Tester redirection HTTP \u2192 HTTPS\ncurl -I http://nouveau-site.srv759970.hstgr.cloud/\n</code></pre> <p>Voir aussi : Configuration Reference pour templates complets par cas d'usage.</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#diagnostic-rapide","title":"Diagnostic Rapide","text":"<p>Pour les commandes de diagnostic compl\u00e8tes, voir : - Nginx Debugging Reference - Common Commands</p>"},{"location":"01-infrastructure/nginx-troubleshooting/#verifications-rapides-essentielles","title":"V\u00e9rifications rapides essentielles","text":"<pre><code># V\u00e9rifier quelle config r\u00e9pond\ncurl -I -H \"Host: example.srv759970.hstgr.cloud\" http://localhost/\n\n# Tester le SSL\nopenssl s_client -connect example.srv759970.hstgr.cloud:443 -servername example.srv759970.hstgr.cloud | openssl x509 -noout -subject\n\n# Voir tous les server_name configur\u00e9s\nnginx -T | grep 'server_name' | grep -v '#' | sort | uniq\n\n# Tester les redirections\ncurl -L -I http://example.srv759970.hstgr.cloud/\n\n# Logs en temps r\u00e9el\ntail -f /var/log/nginx/access.log /var/log/nginx/error.log\n</code></pre>"},{"location":"01-infrastructure/nginx-troubleshooting/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Infrastructure Nginx - Configuration de base et architecture</li> <li>Configuration Reference - Templates complets</li> <li>Nginx Debugging - Commandes de diagnostic avanc\u00e9es</li> <li>Certbot SSL - Gestion des certificats SSL</li> <li>Docker Common Commands - Diagnostic conteneurs</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Bas\u00e9 sur : Probl\u00e8mes r\u00e9els rencontr\u00e9s lors du d\u00e9ploiement de 7 sites sur le VPS</p>"},{"location":"01-infrastructure/nginx/","title":"Nginx Manager","text":"<p>\u26a0\ufe0f Note : La configuration Nginx est g\u00e9r\u00e9e dans un repo externe actif.</p>"},{"location":"01-infrastructure/nginx/#repo-principal","title":"Repo Principal","text":"<p>\ud83d\udcc1 Localisation : <code>C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\2025.10 Nginx Manager</code></p> <p>Le Nginx Manager est un syst\u00e8me complet de gestion s\u00e9curis\u00e9e avec : - \u2705 Backup automatique avant toute modification - \u2705 Tests de configuration avant reload - \u2705 Rollback en un clic - \u2705 Health checks automatiques - \u2705 Versioning Git des configurations</p>"},{"location":"01-infrastructure/nginx/#status-securite","title":"Status S\u00e9curit\u00e9","text":"<p>Audit compl\u00e9t\u00e9 le 2025-10-28</p> M\u00e9trique Valeur Sites s\u00e9curis\u00e9s 4/4 WordPress (100%) Score moyen 85% (+39% d'am\u00e9lioration) Fail2ban jails 3 actifs (wordpress-auth, wordpress-hard, wordpress-xmlrpc)"},{"location":"01-infrastructure/nginx/#protections-actives","title":"Protections Actives","text":"<ul> <li>\u2705 Brute Force - Rate limiting + Fail2ban</li> <li>\u2705 XML-RPC DDoS - Bloqu\u00e9</li> <li>\u2705 XSS - Content Security Policy</li> <li>\u2705 Clickjacking - X-Frame-Options</li> <li>\u2705 PHP Backdoor - Ex\u00e9cution bloqu\u00e9e dans /uploads/</li> <li>\u2705 SSL - TLS 1.2/1.3 + OCSP Stapling</li> </ul>"},{"location":"01-infrastructure/nginx/#quick-commands","title":"Quick Commands","text":"<pre><code># Aller au repo Nginx Manager\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\2025.10 Nginx Manager\"\n\n# Health check\n./scripts/health-check.sh\n\n# Backup avant modification\n./scripts/nginx-backup.sh mon-site\n\n# D\u00e9ployer une config (avec backup + tests automatiques)\n./scripts/nginx-deploy.sh configs/sites-available/mon-site mon-site\n\n# Rollback si probl\u00e8me\n./scripts/nginx-rollback.sh --list mon-site\n./scripts/nginx-rollback.sh mon-site 20251028-082230\n</code></pre>"},{"location":"01-infrastructure/nginx/#sites-configures","title":"Sites Configur\u00e9s","text":""},{"location":"01-infrastructure/nginx/#wordpress-4-sites","title":"WordPress (4 sites)","text":"<ul> <li>clemence-multidomains - clemencefouquet.fr + alias</li> <li>jesuishyperphagique - jesuishyperphagique.srv759970.hstgr.cloud</li> <li>panneauxsolidaires - panneauxsolidaires.srv759970.hstgr.cloud</li> <li>solidarlink - solidarlink.srv759970.hstgr.cloud</li> </ul>"},{"location":"01-infrastructure/nginx/#services-30-sites","title":"Services (30+ sites)","text":"<p>Tous les services du serveur ont une config Nginx : - AI Services (WhisperX, RAGFlow, MemVid, etc.) - Dashboards (Dashy, Grafana, etc.) - Infrastructure (Portainer, Dozzle, etc.)</p>"},{"location":"01-infrastructure/nginx/#snippets-reutilisables","title":"Snippets R\u00e9utilisables","text":"<p>Les snippets Nginx sont dans <code>configs/snippets/</code> :</p> Snippet Usage <code>basic-auth.conf</code> Authentification HTTP Basic <code>bot-protection.conf</code> Protection contre les bots malveillants <code>bot-protection-wordpress.conf</code> Protection adapt\u00e9e WordPress (autorise wp-admin)"},{"location":"01-infrastructure/nginx/#documentation-complete","title":"Documentation Compl\u00e8te","text":"<p>Voir le repo Nginx Manager pour : - QUICKSTART.md - Guide de d\u00e9marrage rapide - README.md - Documentation compl\u00e8te - docs/WORDPRESS_SECURITY.md - Guide s\u00e9curit\u00e9 WordPress - docs/SECURITY_FINAL_REPORT.md - Rapport d'audit d\u00e9taill\u00e9 - docs/GIT_WORKFLOW.md - Workflow Git pour configs</p>"},{"location":"01-infrastructure/nginx/#integration-future","title":"Int\u00e9gration Future","text":"<p>Ce contenu sera migr\u00e9 ici dans <code>infrastructure/nginx/</code> une fois le repo stabilis\u00e9.</p> <p>Status actuel : \ud83d\udfe1 Repo externe actif - Voir lien ci-dessus</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28</p>"},{"location":"01-infrastructure/security/","title":"S\u00e9curit\u00e9 - SSL, Authentification et Bonnes Pratiques","text":""},{"location":"01-infrastructure/security/#vue-densemble","title":"Vue d'ensemble","text":"<p>Configuration de s\u00e9curit\u00e9 multi-couches pour prot\u00e9ger les services du serveur srv759970.</p>"},{"location":"01-infrastructure/security/#ssltls-avec-lets-encrypt","title":"SSL/TLS avec Let's Encrypt","text":""},{"location":"01-infrastructure/security/#certificats-deployes","title":"Certificats d\u00e9ploy\u00e9s","text":"Domaine Service Expiration Auto-renewal monitoring.srv759970.hstgr.cloud Grafana 2026-01-18 \u2705 whisperx.srv759970.hstgr.cloud WhisperX API 2026-01-18 \u2705 dozzle.srv759970.hstgr.cloud Dozzle 2026-01-18 \u2705 faster-whisper.srv759970.hstgr.cloud Faster-Whisper Queue API 2026-01-18 \u2705"},{"location":"01-infrastructure/security/#creation-dun-nouveau-certificat","title":"Cr\u00e9ation d'un nouveau certificat","text":"<pre><code>certbot certonly --nginx \\\n  -d &lt;subdomain&gt;.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"01-infrastructure/security/#configuration-ssl-nginx","title":"Configuration SSL Nginx","text":"<pre><code>ssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\ninclude /etc/letsencrypt/options-ssl-nginx.conf;\nssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n</code></pre>"},{"location":"01-infrastructure/security/#renouvellement-automatique","title":"Renouvellement automatique","text":"<pre><code># V\u00e9rifier le timer\nsystemctl status certbot.timer\n\n# Renouvellement manuel\ncertbot renew\n\n# V\u00e9rifier les certificats\ncertbot certificates\n</code></pre>"},{"location":"01-infrastructure/security/#authentification","title":"Authentification","text":""},{"location":"01-infrastructure/security/#basic-auth-nginx","title":"Basic Auth Nginx","text":"<p>Configuration pour services sensibles (Grafana, Dashy, Dozzle, RQ Dashboard):</p>"},{"location":"01-infrastructure/security/#creation-des-credentials","title":"Cr\u00e9ation des credentials","text":"<pre><code># Cr\u00e9er le fichier .htpasswd\nhtpasswd -c /etc/nginx/.htpasswd admin\n\n# Ajouter un utilisateur suppl\u00e9mentaire\nhtpasswd /etc/nginx/.htpasswd user2\n</code></pre>"},{"location":"01-infrastructure/security/#snippet-reutilisable","title":"Snippet r\u00e9utilisable","text":"<p>/etc/nginx/snippets/basic-auth.conf</p> <pre><code>auth_basic \"Restricted Access\";\nauth_basic_user_file /etc/nginx/.htpasswd;\n</code></pre>"},{"location":"01-infrastructure/security/#grafana-login","title":"Grafana Login","text":"<p>Double authentification:</p> <ol> <li>Basic Auth Nginx (premi\u00e8re couche)</li> <li>Grafana Login (deuxi\u00e8me couche)</li> <li>User: <code>admin</code></li> <li>Password: <code>YourSecurePassword2025!</code></li> </ol>"},{"location":"01-infrastructure/security/#services-proteges-vs-publics","title":"Services prot\u00e9g\u00e9s vs publics","text":"<p>Services prot\u00e9g\u00e9s par Basic Auth:</p> <ul> <li>Grafana (monitoring.srv759970.hstgr.cloud)</li> <li>Dashy (dashy.srv759970.hstgr.cloud)</li> <li>Dozzle (dozzle.srv759970.hstgr.cloud)</li> <li>RQ Dashboard (whisperx-dashboard.srv759970.hstgr.cloud)</li> </ul> <p>Services publics:</p> <ul> <li>WhisperX API (whisperx.srv759970.hstgr.cloud)</li> <li>Faster-Whisper API (faster-whisper.srv759970.hstgr.cloud)</li> <li>MkDocs Documentation (docs.srv759970.hstgr.cloud)</li> </ul>"},{"location":"01-infrastructure/security/#pare-feu-ufw","title":"Pare-feu (UFW)","text":""},{"location":"01-infrastructure/security/#ports-ouverts","title":"Ports ouverts","text":"<pre><code>ufw allow 22/tcp    # SSH\nufw allow 80/tcp    # HTTP\nufw allow 443/tcp   # HTTPS\nufw enable\n</code></pre>"},{"location":"01-infrastructure/security/#logs-et-audit","title":"Logs et Audit","text":""},{"location":"01-infrastructure/security/#logs-nginx","title":"Logs Nginx","text":"<pre><code>tail -f /var/log/nginx/access.log\ntail -f /var/log/nginx/error.log\n</code></pre>"},{"location":"01-infrastructure/security/#logs-docker","title":"Logs Docker","text":"<p>Via Dozzle: https://dozzle.srv759970.hstgr.cloud</p> <pre><code>docker logs &lt;container_name&gt;\n</code></pre>"},{"location":"01-infrastructure/security/#ssh-hardening","title":"SSH Hardening","text":""},{"location":"01-infrastructure/security/#configuration-recommandee","title":"Configuration recommand\u00e9e","text":"<pre><code>PermitRootLogin prohibit-password\nPasswordAuthentication no\nPubkeyAuthentication yes\n</code></pre>"},{"location":"01-infrastructure/security/#checklist-securite","title":"Checklist S\u00e9curit\u00e9","text":"<p>\u2705 Impl\u00e9ment\u00e9:</p> <ul> <li> Certificats SSL valides</li> <li> Renouvellement auto configur\u00e9</li> <li> Force HTTPS sur tous les services</li> <li> Basic Auth sur services sensibles</li> <li> UFW configur\u00e9</li> <li> Services internes sur 127.0.0.1</li> </ul> <p>\u26a0\ufe0f Recommandations:</p> <ul> <li> Installer fail2ban pour SSH</li> <li> Configurer alertes Grafana</li> <li> Backup automatique quotidien</li> <li> Rate limiting sur API endpoints</li> </ul>"},{"location":"01-infrastructure/security/#ressources","title":"Ressources","text":"<ul> <li>Mozilla SSL Configuration</li> <li>Let's Encrypt Documentation</li> <li>Docker Security</li> </ul>"},{"location":"01-infrastructure/server/","title":"Guide S\u00e9curit\u00e9 - Compte Automation","text":"<p>Derni\u00e8re mise \u00e0 jour : 18 octobre 2025 Serveur : srv759970.hstgr.cloud (69.62.108.82) Contexte : Migration de l'acc\u00e8s root SSH vers compte automation s\u00e9curis\u00e9</p>"},{"location":"01-infrastructure/server/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>Cr\u00e9er un compte <code>automation</code> avec privil\u00e8ges \u00e9tendus pour Claude Code, permettant : - \u2705 98% des capacit\u00e9s de root (debugging, configuration, d\u00e9ploiement) - \u2705 Tra\u00e7abilit\u00e9 des actions (logs s\u00e9par\u00e9s) - \u2705 R\u00e9vocabilit\u00e9 (d\u00e9sactiver automation sans casser le syst\u00e8me) - \u2705 Protection contre erreurs catastrophiques (garde-fous) - \u274c Sans bloquer Claude Code dans ses op\u00e9rations quotidiennes</p>"},{"location":"01-infrastructure/server/#etat-actuel","title":"\u2705 \u00c9tat actuel","text":""},{"location":"01-infrastructure/server/#compte-automation-cree-le-18102025","title":"Compte automation cr\u00e9\u00e9 le 18/10/2025","text":"<p>User : <code>automation</code> (UID 1001) Groupes : <code>automation</code>, <code>sudo</code>, <code>docker</code>, <code>users</code> Home : <code>/home/automation</code> SSH : Cl\u00e9s copi\u00e9es depuis root Sudo : Acc\u00e8s quasi-total (voir d\u00e9tails ci-dessous)</p>"},{"location":"01-infrastructure/server/#ce-que-automation-peut-faire-avec-sudo","title":"Ce que automation PEUT faire (avec sudo)","text":"<p>Quasi tout : - \u2705 G\u00e9rer services : <code>sudo systemctl restart nginx</code> - \u2705 Docker : <code>sudo docker-compose up -d</code> - \u2705 Modifier configs : <code>sudo nano /etc/nginx/sites-available/mon-site</code> - \u2705 SSL/Certbot : <code>sudo certbot --nginx</code> - \u2705 Pare-feu : <code>sudo ufw allow 8080</code> - \u2705 Installer packages : <code>sudo apt install python3-pip</code> - \u2705 Lire fichiers root : <code>sudo ls /root</code> - \u2705 Logs syst\u00e8me : <code>sudo journalctl -u service -f</code> - \u2705 Nginx logs : <code>sudo tail -f /var/log/nginx/error.log</code> - \u2705 Changer permissions : <code>sudo chown -R automation:automation /opt/mon-app</code> - \u2705 Cr\u00e9er/modifier fichiers syst\u00e8me : <code>sudo touch /etc/cron.d/backup</code></p>"},{"location":"01-infrastructure/server/#ce-que-automation-ne-peut-pas-faire","title":"Ce que automation NE PEUT PAS faire","text":"<p>Protections actives : - \u274c <code>sudo reboot</code> - Red\u00e9marrer le serveur - \u274c <code>sudo shutdown</code> - Arr\u00eater le serveur - \u274c <code>sudo poweroff</code> - \u00c9teindre le serveur - \u274c <code>sudo halt</code> - Stopper le serveur - \u274c <code>sudo visudo</code> - Modifier les droits sudo - \u274c <code>sudo nano /etc/sudoers.d/automation</code> - Modifier ses propres droits</p> <p>Pourquoi : Emp\u00eacher accidents/erreurs catastrophiques tout en gardant flexibilit\u00e9 maximale</p>"},{"location":"01-infrastructure/server/#logs-et-audit","title":"Logs et audit","text":"<p>Tous les <code>sudo</code> sont logg\u00e9s dans <code>/var/log/sudo-automation.log</code></p> <pre><code># Voir ce que automation a fait aujourd'hui\nssh automation@69.62.108.82 \"sudo tail -100 /var/log/sudo-automation.log\"\n\n# Surveiller en temps r\u00e9el\nssh automation@69.62.108.82 \"sudo tail -f /var/log/sudo-automation.log\"\n\n# Chercher commande sp\u00e9cifique\nssh automation@69.62.108.82 \"sudo grep 'docker-compose' /var/log/sudo-automation.log\"\n</code></pre>"},{"location":"01-infrastructure/server/#configuration-technique","title":"\ud83d\udd27 Configuration technique","text":""},{"location":"01-infrastructure/server/#fichier-sudoers-etcsudoersdautomation","title":"Fichier sudoers (<code>/etc/sudoers.d/automation</code>)","text":"<pre><code># Automation user - Acc\u00e8s quasi-root pour Claude Code debugging\n# Pas de password requis pour faciliter automatisation\n\n# Commandes syst\u00e8me (TOUT sauf reboot/shutdown)\nautomation ALL=(ALL) NOPASSWD: ALL, !/sbin/reboot, !/sbin/shutdown, !/sbin/poweroff, !/sbin/halt\n\n# Protection suppl\u00e9mentaire : pas de modification sudoers\nautomation ALL=(ALL) NOPASSWD: !/usr/bin/visudo, !/usr/bin/vim /etc/sudoers*, !/usr/bin/nano /etc/sudoers*\n\n# Logs s\u00e9par\u00e9s pour audit\nDefaults:automation logfile=\"/var/log/sudo-automation.log\"\n</code></pre>"},{"location":"01-infrastructure/server/#cles-ssh","title":"Cl\u00e9s SSH","text":"<p>Emplacement : <code>/home/automation/.ssh/authorized_keys</code> Source : Copie des cl\u00e9s de <code>/root/.ssh/authorized_keys</code> Permissions : - <code>/home/automation/.ssh/</code> : 700 (drwx------) - <code>/home/automation/.ssh/authorized_keys</code> : 600 (-rw-------)</p> <p>Test connexion : <pre><code>ssh automation@69.62.108.82 \"whoami\"\n# Doit afficher: automation\n</code></pre></p>"},{"location":"01-infrastructure/server/#migration-root-automation","title":"\ud83d\udcdd Migration root \u2192 automation","text":""},{"location":"01-infrastructure/server/#etape-1-backup-scripts-bat","title":"\u00c9tape 1 : Backup scripts .bat","text":"<pre><code>REM Depuis Windows PowerShell/CMD\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_r\u00e9f\u00e9rentiels de code\\Hostinger\"\n\ncopy deploy.bat deploy.bat.backup\ncopy update.bat update.bat.backup\ncopy manage.bat manage.bat.backup\n</code></pre>"},{"location":"01-infrastructure/server/#etape-2-modifier-scripts-bat","title":"\u00c9tape 2 : Modifier scripts .bat","text":"<p>Chercher/Remplacer dans TOUS les fichiers .bat : - Ancien : <code>root@69.62.108.82</code> - Nouveau : <code>automation@69.62.108.82</code></p> <p>Fichiers concern\u00e9s : - <code>deploy.bat</code> - <code>update.bat</code> - <code>manage.bat</code> - Tout autre script custom</p> <p>Exemple avant/apr\u00e8s :</p> <pre><code>REM AVANT\nssh root@69.62.108.82 \"systemctl restart nginx\"\n\nREM APR\u00c8S\nssh automation@69.62.108.82 \"sudo systemctl restart nginx\"\n</code></pre> <p>\u26a0\ufe0f Important : Ajouter <code>sudo</code> devant les commandes privil\u00e9gi\u00e9es : - <code>systemctl</code> \u2192 <code>sudo systemctl</code> - <code>docker-compose</code> \u2192 <code>sudo docker-compose</code> (ou pas, automation est dans groupe docker) - <code>nginx -t</code> \u2192 <code>sudo nginx -t</code> - <code>certbot</code> \u2192 <code>sudo certbot</code> - \u00c9dition fichiers syst\u00e8me \u2192 <code>sudo nano /etc/...</code></p>"},{"location":"01-infrastructure/server/#etape-3-tester-avec-automation","title":"\u00c9tape 3 : Tester avec automation","text":"<p>Test complet depuis Windows :</p> <pre><code># Test connexion\nssh automation@69.62.108.82 \"whoami\"\n\n# Test sudo\nssh automation@69.62.108.82 \"sudo whoami\"\n\n# Test services\nssh automation@69.62.108.82 \"sudo systemctl status nginx\"\n\n# Test Docker (pas besoin sudo, automation dans groupe docker)\nssh automation@69.62.108.82 \"docker ps\"\n\n# Test \u00e9criture config\nssh automation@69.62.108.82 \"sudo touch /etc/nginx/sites-available/test-automation &amp;&amp; sudo rm /etc/nginx/sites-available/test-automation\"\n\n# Test logs\nssh automation@69.62.108.82 \"sudo journalctl -u docker-autostart -n 5\"\n</code></pre> <p>Si TOUS les tests passent \u2192 Continuer \u00e9tape 4</p>"},{"location":"01-infrastructure/server/#etape-4-periode-de-test-1-semaine-recommandee","title":"\u00c9tape 4 : P\u00e9riode de test (1 semaine recommand\u00e9e)","text":"<p>Utiliser automation pour TOUTES les op\u00e9rations quotidiennes : - D\u00e9ploiements - Modifications config Nginx - Gestion Docker containers - Debugging</p> <p>V\u00e9rifier logs r\u00e9guli\u00e8rement : <pre><code>ssh automation@69.62.108.82 \"sudo tail -50 /var/log/sudo-automation.log\"\n</code></pre></p> <p>Si probl\u00e8me rencontr\u00e9 : 1. Noter la commande qui a \u00e9chou\u00e9 2. Tester avec root pour confirmer 3. Si besoin, modifier <code>/etc/sudoers.d/automation</code> pour autoriser</p>"},{"location":"01-infrastructure/server/#etape-5-desactiver-root-ssh-apres-validation-complete","title":"\u00c9tape 5 : D\u00e9sactiver root SSH (APR\u00c8S validation compl\u00e8te)","text":"<p>\u26a0\ufe0f NE PAS FAIRE AVANT d'\u00eatre 100% S\u00dbR que automation fonctionne</p> <pre><code># Depuis automation (pas root)\nssh automation@69.62.108.82 &lt;&lt;'EOF'\nsudo sed -i 's/^#\\?PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config\nsudo systemctl reload sshd\necho \"\u2705 Root SSH d\u00e9sactiv\u00e9 - utiliser automation@ uniquement\"\nEOF\n</code></pre> <p>V\u00e9rifier : <pre><code># Ceci doit \u00e9chouer\nssh root@69.62.108.82 \"whoami\"\n# Erreur attendue: Permission denied\n\n# Ceci doit fonctionner\nssh automation@69.62.108.82 \"whoami\"\n# R\u00e9sultat: automation\n</code></pre></p>"},{"location":"01-infrastructure/server/#rollback-et-depannage","title":"\ud83c\udd98 Rollback et d\u00e9pannage","text":""},{"location":"01-infrastructure/server/#si-automation-ne-fonctionne-plus","title":"Si automation ne fonctionne plus","text":"<p>Option 1 : R\u00e9activer root SSH</p> <p>Via Console Hostinger (Panel web \u2192 VPS \u2192 Open console) :</p> <pre><code># Login: root\n# Password: [mot de passe VPS]\n\n# R\u00e9activer root SSH\nsed -i 's/^PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config\nsystemctl reload sshd\n\n# Tester\nexit\nssh root@69.62.108.82  # Doit fonctionner\n</code></pre> <p>Option 2 : R\u00e9parer automation</p> <pre><code># Via root (apr\u00e8s r\u00e9activation SSH root)\nssh root@69.62.108.82\n\n# V\u00e9rifier cl\u00e9s SSH\nls -la /home/automation/.ssh/\n\n# Recopier cl\u00e9s si n\u00e9cessaire\ncp /root/.ssh/authorized_keys /home/automation/.ssh/\nchown -R automation:automation /home/automation/.ssh\nchmod 700 /home/automation/.ssh\nchmod 600 /home/automation/.ssh/authorized_keys\n\n# V\u00e9rifier sudoers\nsudo visudo -c  # Doit afficher \"parsed OK\"\n\n# Tester automation\nsu - automation\nsudo whoami  # Doit afficher \"root\"\n</code></pre>"},{"location":"01-infrastructure/server/#commandes-bloquees-par-erreur","title":"Commandes bloqu\u00e9es par erreur","text":"<p>Si une commande l\u00e9gitime est bloqu\u00e9e :</p> <pre><code># \u00c9diter sudoers (depuis root ou console Hostinger)\nsudo visudo /etc/sudoers.d/automation\n\n# Exemple : autoriser une commande sp\u00e9cifique\n# Ajouter AVANT la ligne \"automation ALL=(ALL)\"\nautomation ALL=(ALL) NOPASSWD: /chemin/vers/commande/specifique\n</code></pre>"},{"location":"01-infrastructure/server/#audit-des-actions-automation","title":"Audit des actions automation","text":"<pre><code># Derni\u00e8res 100 commandes sudo\nssh automation@69.62.108.82 \"sudo tail -100 /var/log/sudo-automation.log\"\n\n# Commandes dangereuses tent\u00e9es\nssh automation@69.62.108.82 \"sudo grep -E '(reboot|shutdown|rm -rf /)' /var/log/sudo-automation.log\"\n\n# Activit\u00e9 par date\nssh automation@69.62.108.82 \"sudo grep '2025-10-18' /var/log/sudo-automation.log | wc -l\"\n</code></pre>"},{"location":"01-infrastructure/server/#securite-additionnelle-optionnel","title":"\ud83d\udd10 S\u00e9curit\u00e9 additionnelle (optionnel)","text":""},{"location":"01-infrastructure/server/#protections-shell-alias-securite","title":"Protections shell (alias s\u00e9curit\u00e9)","text":"<p>Ajouter dans <code>/home/automation/.bashrc</code> :</p> <pre><code># Alias pour commandes dangereuses = demander confirmation\nalias rm='rm -i'\nalias mv='mv -i'\nalias cp='cp -i'\n\n# Fonction protection commandes destructives\nfunction sudo() {\n    # Si c'est une commande ultra-dangereuse, demander confirmation\n    if [[ \"$*\" =~ (rm[[:space:]]+-rf[[:space:]]+/[^/]|mkfs|dd[[:space:]]+if=|fdisk|parted) ]]; then\n        echo \"\u26a0\ufe0f  COMMANDE DANGEREUSE D\u00c9TECT\u00c9E: $*\"\n        read -p \"Confirmer ? Taper 'YES' en majuscules: \" confirm\n        [[ \"$confirm\" != \"YES\" ]] &amp;&amp; echo \"Annul\u00e9.\" &amp;&amp; return 1\n    fi\n\n    # Executer sudo normal\n    command sudo \"$@\"\n}\n</code></pre> <p>Activer : <pre><code>ssh automation@69.62.108.82 \"source ~/.bashrc\"\n</code></pre></p>"},{"location":"01-infrastructure/server/#alertes-commandes-sensibles","title":"Alertes commandes sensibles","text":"<pre><code># Script monitoring commandes dangereuses\nssh automation@69.62.108.82 \"sudo tee /usr/local/bin/monitor-dangerous-commands.sh &gt; /dev/null\" &lt;&lt;'SCRIPT'\n#!/bin/bash\ntail -f /var/log/sudo-automation.log | while read line; do\n    if echo \"$line\" | grep -E \"(rm -rf /|mkfs|dd if=|fdisk|parted|reboot|shutdown)\"; then\n        echo \"\ud83d\udea8 $(date): $line\" &gt;&gt; /var/log/dangerous-commands-alert.log\n        # TODO: Envoyer email/webhook Rocket.Chat\n    fi\ndone\nSCRIPT\n\nssh automation@69.62.108.82 \"sudo chmod +x /usr/local/bin/monitor-dangerous-commands.sh\"\n\n# Lancer en background (optionnel)\n# ssh automation@69.62.108.82 \"nohup sudo /usr/local/bin/monitor-dangerous-commands.sh &amp;\"\n</code></pre>"},{"location":"01-infrastructure/server/#comparaison-root-vs-automation","title":"\ud83d\udcca Comparaison root vs automation","text":"Aspect Root direct Automation sudo Gagnant Capacit\u00e9 debug 100% 98% \u2248 \u00c9galit\u00e9 S\u00e9curit\u00e9 0/10 7/10 \u2705 Automation Tra\u00e7abilit\u00e9 Aucune Logs s\u00e9par\u00e9s \u2705 Automation R\u00e9vocabilit\u00e9 Impossible <code>sudo userdel automation</code> \u2705 Automation Facilit\u00e9 Claude Code Max Presque max \u2248 \u00c9galit\u00e9 Protection erreurs 0% 90% (reboot/shutdown bloqu\u00e9s) \u2705 Automation Audit compliance \u274c \u2705 \u2705 Automation"},{"location":"01-infrastructure/server/#checklist-validation","title":"\u2705 Checklist validation","text":"<p>Avant de d\u00e9sactiver root SSH, v\u00e9rifier :</p> <ul> <li> <code>ssh automation@69.62.108.82 \"whoami\"</code> \u2192 Affiche \"automation\"</li> <li> <code>ssh automation@69.62.108.82 \"sudo whoami\"</code> \u2192 Affiche \"root\"</li> <li> <code>ssh automation@69.62.108.82 \"sudo systemctl status nginx\"</code> \u2192 Fonctionne</li> <li> <code>ssh automation@69.62.108.82 \"docker ps\"</code> \u2192 Fonctionne (groupe docker)</li> <li> <code>ssh automation@69.62.108.82 \"sudo docker-compose ps\"</code> \u2192 Fonctionne</li> <li> <code>ssh automation@69.62.108.82 \"sudo nano /etc/nginx/test\"</code> \u2192 Peut \u00e9diter</li> <li> <code>ssh automation@69.62.108.82 \"sudo journalctl -n 10\"</code> \u2192 Affiche logs</li> <li> Scripts .bat modifi\u00e9s pour utiliser <code>automation@</code></li> <li> Test complet d\u00e9ploiement via scripts .bat</li> <li> P\u00e9riode de test 1 semaine r\u00e9ussie</li> <li> Logs <code>/var/log/sudo-automation.log</code> consult\u00e9s et valid\u00e9s</li> <li> Acc\u00e8s console Hostinger v\u00e9rifi\u00e9 (backup si probl\u00e8me)</li> </ul> <p>Si TOUS coch\u00e9s \u2192 OK pour d\u00e9sactiver root SSH</p>"},{"location":"01-infrastructure/server/#support-et-contacts","title":"\ud83d\udcde Support et contacts","text":"<p>Console Hostinger de secours : Panel Hostinger \u2192 VPS srv759970 \u2192 Open console Login: <code>root</code> / Password VPS</p> <p>Logs importants : - <code>/var/log/sudo-automation.log</code> - Actions automation - <code>/var/log/auth.log</code> - Tentatives connexion SSH - <code>/var/log/syslog</code> - Logs syst\u00e8me g\u00e9n\u00e9raux</p> <p>Documentation li\u00e9e : - <code>ACTION_PLAN.md</code> - Priorit\u00e9 1 : S\u00e9curisation VPS - <code>GIT_POLICY.md</code> - Versioning configuration - <code>GUIDE_SERVICES_SYSTEMD.md</code> - Gestion services</p>"},{"location":"01-infrastructure/server/#historique","title":"\ud83d\udcdd Historique","text":"Date Action Statut 2025-10-18 Cr\u00e9ation compte automation \u2705 Fait 2025-10-18 Configuration sudo \u00e9tendu \u2705 Fait 2025-10-18 Copie cl\u00e9s SSH \u2705 Fait 2025-10-18 Tests validation \u2705 Fait 2025-10-XX Migration scripts .bat \u23f3 \u00c0 faire 2025-10-XX P\u00e9riode test 1 semaine \u23f3 \u00c0 faire 2025-10-XX D\u00e9sactivation root SSH \u23f3 \u00c0 planifier <p>Version : 1.0 Auteur : Claude Code + Julien Prochaine revue : Apr\u00e8s d\u00e9sactivation root SSH</p>"},{"location":"02-applications/","title":"Applications - Vue d'Ensemble","text":"<p>Total : 45 applications d\u00e9ploy\u00e9es Cat\u00e9gories : 13</p>"},{"location":"02-applications/#categories-dapplications","title":"Cat\u00e9gories d'Applications","text":""},{"location":"02-applications/#wordpress-5-apps","title":"\ud83c\udf10 WordPress (5 apps)","text":"<p>Sites WordPress pour clients : - Clemence - clemencefouquet.fr - <code>production</code> - SolidarLink - solidarlink.srv759970.hstgr.cloud - <code>staging</code> - JeSuisHyperphagique - jesuishyperphagique.srv759970.hstgr.cloud - <code>production</code> - PanneauxSolidaires - panneauxsolidaires.srv759970.hstgr.cloud - <code>production</code> - Shared Database - MySQL partag\u00e9 pour 2 sites</p>"},{"location":"02-applications/#ai-transcription-3-apps","title":"\ud83c\udfa4 AI Transcription (3 apps)","text":"<p>Services de transcription audio/vid\u00e9o : - WhisperX - Transcription avec diarization - <code>production</code> - Faster-Whisper Queue - API async avec queue - Whisper Faster - Transcription rapide OpenAI-compatible</p>"},{"location":"02-applications/#ai-rag-3-apps","title":"\ud83e\udd16 AI RAG (3 apps)","text":"<p>RAG et traitement de documents : - RAGFlow - RAG multimodal - <code>production</code> - MemVid - RAG avec encodage vid\u00e9o - RAG-Anything - RAG avec LightRAG</p>"},{"location":"02-applications/#ai-tts-2-apps","title":"\ud83d\udd0a AI TTS (2 apps)","text":"<p>Text-to-Speech services : - NeuTTS Air - TTS avec voice cloning - XTTS v2 - Coqui TTS</p>"},{"location":"02-applications/#ai-services-3-apps","title":"\ud83e\udde0 AI Services (3 apps)","text":"<p>Infrastructure IA : - Ollama - LLM inference (systemd service) - Tika Server - Extraction contenu documents - LangChain Service - Orchestration LangChain</p>"},{"location":"02-applications/#bots-2-apps","title":"\ud83d\udcac Bots (2 apps)","text":"<p>Chatbots vocaux : - Telegram Voice Bot - Bot Telegram avec voix - Discord Voice Bot - Bot Discord avec voix</p>"},{"location":"02-applications/#cms-sites-3-apps","title":"\ud83d\udcc4 CMS &amp; Sites (3 apps)","text":"<p>Sites custom et CMS : - Cristina Site - Site Astro statique - Cristina Backend - Strapi headless CMS - Impro Manager - Application m\u00e9tier</p>"},{"location":"02-applications/#collaboration-3-apps","title":"\ud83e\udd1d Collaboration (3 apps)","text":"<p>Outils collaboratifs : - Nextcloud - Cloud storage (arr\u00eat\u00e9) - RocketChat - Chat team (arr\u00eat\u00e9) - Jitsi - Visioconf\u00e9rence (arr\u00eat\u00e9)</p>"},{"location":"02-applications/#documents-3-apps","title":"\ud83d\udcda Documents (3 apps)","text":"<p>Gestion documentaire : - Paperless NGX - DMS principal (arr\u00eat\u00e9) - Paperless AI - Extension IA - Invidious - Archivage vid\u00e9os</p>"},{"location":"02-applications/#automation-2-apps","title":"\u2699\ufe0f Automation (2 apps)","text":"<p>Workflow et automatisation : - N8N - Workflow automation - RustDesk - Bureau \u00e0 distance</p>"},{"location":"02-applications/#dashboards-5-apps","title":"\ud83d\udcca Dashboards (5 apps)","text":"<p>Dashboards custom : - Energie Dashboard - DownTo40 projet - <code>production</code> \ud83d\udd34 - Support Dashboard - Dashboard support client - SharePoint Dashboards - Dashboards SharePoint - Photos Chantier - Galerie photos chantier - Energie 40\u20ac - Version optimis\u00e9e dashboard \u00e9nergie</p>"},{"location":"02-applications/#monitoring-2-apps","title":"\ud83d\udcc8 Monitoring (2 apps)","text":"<p>Monitoring et observabilit\u00e9 : - Monitoring Stack - Grafana + Prometheus + Loki (arr\u00eat\u00e9) - Dashy - Portal dashboard - <code>production</code></p>"},{"location":"02-applications/#infrastructure-5-apps","title":"\ud83d\udd27 Infrastructure (5 apps)","text":"<p>Services infrastructure : - Databases Shared - PostgreSQL + Redis + MongoDB - <code>critical</code> - Docker AutoStart - Auto-start/stop conteneurs - DockerWakeUp - Wake-up system - API Portal - Swagger UI centralis\u00e9 - MkDocs - Documentation (ce site)</p>"},{"location":"02-applications/#applications-par-statut","title":"Applications par Statut","text":""},{"location":"02-applications/#production-apps-critiques","title":"\ud83d\udfe2 Production (Apps Critiques)","text":"<ul> <li>Energie Dashboard (DownTo40 \ud83d\udd34 priorit\u00e9 haute)</li> <li>WordPress Clemence</li> <li>WhisperX</li> <li>RAGFlow</li> <li>Dashy</li> <li>Databases Shared</li> </ul>"},{"location":"02-applications/#stagingtest","title":"\ud83d\udfe1 Staging/Test","text":"<ul> <li>WordPress SolidarLink</li> <li>Support Dashboard</li> <li>SharePoint Dashboards</li> </ul>"},{"location":"02-applications/#arretees-optimisation-ram","title":"\ud83d\udd34 Arr\u00eat\u00e9es (Optimisation RAM)","text":"<ul> <li>Monitoring Stack (Grafana, Prometheus, Loki)</li> <li>Nextcloud</li> <li>RocketChat</li> <li>Jitsi</li> <li>Paperless NGX</li> <li>WordPress (certains sites)</li> </ul>"},{"location":"02-applications/#tags","title":"Tags","text":"<p>Filtrer les applications par tag :</p> <ul> <li><code>production</code> - Apps en production</li> <li><code>staging</code> - Apps de test</li> <li><code>wordpress</code> - Sites WordPress</li> <li><code>ai</code> - Services IA/ML</li> <li><code>dashboard</code> - Dashboards custom</li> <li><code>monitoring</code> - Services de monitoring</li> <li><code>critical</code> - Infrastructure critique (SPOF)</li> </ul>"},{"location":"02-applications/#quick-links","title":"Quick Links","text":"<ul> <li>Dashy Portal - Vue d'ensemble visuelle</li> <li>Grafana - M\u00e9triques (si actif)</li> <li>Portainer - Gestion Docker</li> <li>Dozzle - Logs temps r\u00e9el</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28</p>"},{"location":"02-applications/ai-rag/ragflow/","title":"\ud83e\udd16 RAGFlow &amp; RAG-Anything - Documentation","text":"<p>Installation et configuration de RAGFlow et RAG-Anything sur srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-rag/ragflow/#table-des-matieres","title":"\ud83d\udccb Table des mati\u00e8res","text":"<ol> <li>Vue d'ensemble</li> <li>RAGFlow</li> <li>RAG-Anything</li> <li>Configuration</li> <li>Utilisation</li> <li>Maintenance</li> </ol>"},{"location":"02-applications/ai-rag/ragflow/#vue-densemble","title":"\ud83c\udfaf Vue d'ensemble","text":""},{"location":"02-applications/ai-rag/ragflow/#ragflow","title":"RAGFlow","text":"<p>RAGFlow est un moteur RAG (Retrieval-Augmented Generation) open-source de pointe qui fusionne les capacit\u00e9s RAG avec des fonctionnalit\u00e9s d'Agent IA.</p> <p>Fonctionnalit\u00e9s cl\u00e9s: - Deep document understanding (analyse avanc\u00e9e avec DeepDoc) - Chunking intelligent bas\u00e9 sur templates - Citations tra\u00e7ables et r\u00e9duction des hallucinations - Support multi-formats (PDF, Word, Excel, images, pages web, etc.) - Interface web intuitive avec workflow automatis\u00e9 - Compatible avec workflows agentiques et MCP</p> <p>Acc\u00e8s : https://ragflow.srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything","title":"RAG-Anything","text":"<p>RAG-Anything est un framework RAG multimodal all-in-one bas\u00e9 sur LightRAG qui \u00e9tend les capacit\u00e9s traditionnelles de RAG.</p> <p>Fonctionnalit\u00e9s cl\u00e9s: - Pipeline multimodal end-to-end (texte, images, tableaux, \u00e9quations) - Extraction automatique de knowledge graph multimodal - Support de parsers avanc\u00e9s (MinerU, Docling) - Traitement adaptatif avec modes multiples - API REST FastAPI pour int\u00e9gration facile</p> <p>Acc\u00e8s API : https://rag-anything.srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-rag/ragflow/#ragflow_1","title":"\ud83d\ude80 RAGFlow","text":""},{"location":"02-applications/ai-rag/ragflow/#architecture","title":"Architecture","text":"<p>Stack Docker compl\u00e8te (5 conteneurs) :</p> <pre><code>ragflow-server     \u2192 Application principale (FastAPI)\nragflow-mysql      \u2192 Base de donn\u00e9es\nragflow-es-01      \u2192 Elasticsearch (recherche vectorielle)\nragflow-redis      \u2192 Cache et queue\nragflow-minio      \u2192 Stockage objet\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#emplacement","title":"Emplacement","text":"<pre><code>/opt/ragflow/\n\u251c\u2500\u2500 docker/\n\u2502   \u251c\u2500\u2500 docker-compose-full.yml     # Configuration Docker consolid\u00e9e\n\u2502   \u251c\u2500\u2500 .env                         # Variables d'environnement\n\u2502   \u251c\u2500\u2500 ragflow-logs/                # Logs applicatifs\n\u2502   \u251c\u2500\u2500 service_conf.yaml.template   # Configuration services\n\u2502   \u2514\u2500\u2500 init.sql                     # Init base de donn\u00e9es\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#ports","title":"Ports","text":"Service Port externe Port interne Usage API HTTP 9500 9380 API principale Admin HTTP 9501 9381 Interface admin MySQL 5456 3306 Base de donn\u00e9es Elasticsearch 1220 9200 Moteur de recherche Redis 6381 6379 Cache MinIO API 9502 9000 Stockage objet MinIO Console 9503 9001 Interface MinIO"},{"location":"02-applications/ai-rag/ragflow/#configuration-llm","title":"Configuration LLM","text":"<p>\u00c9diter <code>/opt/ragflow/docker/service_conf.yaml.template</code> :</p> <pre><code>user_default_llm:\n  factory: \"OpenAI\"              # OpenAI, Anthropic, Ollama, etc.\n  api_key: \"sk-your-key-here\"    # Votre cl\u00e9 API\n  base_url: \"\"                   # URL de base (optionnel)\n  model: \"gpt-4o-mini\"           # Mod\u00e8le par d\u00e9faut\n</code></pre> <p>Apr\u00e8s modification: <pre><code>cd /opt/ragflow/docker\ndocker-compose -f docker-compose-full.yml restart ragflow\n</code></pre></p>"},{"location":"02-applications/ai-rag/ragflow/#commandes-essentielles","title":"Commandes essentielles","text":"<pre><code># D\u00e9marrer\ncd /opt/ragflow/docker\ndocker-compose -f docker-compose-full.yml up -d\n\n# Arr\u00eater\ndocker-compose -f docker-compose-full.yml down\n\n# Logs\ndocker logs ragflow-server --tail=50 -f\ndocker logs ragflow-mysql --tail=50\n\n# Red\u00e9marrer\ndocker restart ragflow-server\n\n# Status complet\ndocker ps --filter name=ragflow\n\n# V\u00e9rifier sant\u00e9 Elasticsearch\ncurl -u elastic:infini_rag_flow http://localhost:1220/_cluster/health\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#systemd","title":"Systemd","text":"<p>Le service est configur\u00e9 pour d\u00e9marrage automatique :</p> <pre><code># Status\nsystemctl status ragflow.service\n\n# D\u00e9marrer/Arr\u00eater/Red\u00e9marrer\nsystemctl start ragflow.service\nsystemctl stop ragflow.service\nsystemctl restart ragflow.service\n\n# Logs\njournalctl -u ragflow.service -f\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything_1","title":"\ud83c\udfa8 RAG-Anything","text":""},{"location":"02-applications/ai-rag/ragflow/#architecture_1","title":"Architecture","text":"<p>API FastAPI personnalis\u00e9e conteneuris\u00e9e :</p> <pre><code>rag-anything-api   \u2192 Serveur FastAPI avec RAG-Anything int\u00e9gr\u00e9\nVolumes:\n  rag-anything-storage   \u2192 Knowledge graph et index\n  rag-anything-output    \u2192 Documents pars\u00e9s\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#emplacement_1","title":"Emplacement","text":"<pre><code>/opt/rag-anything/\n\u251c\u2500\u2500 Dockerfile              # Image Docker custom\n\u251c\u2500\u2500 docker-compose.yml      # Configuration Docker\n\u251c\u2500\u2500 api_server.py           # Serveur FastAPI\n\u251c\u2500\u2500 .env                    # Variables d'environnement\n\u251c\u2500\u2500 raganything/            # Package Python\n\u251c\u2500\u2500 examples/               # Exemples d'utilisation\n\u2514\u2500\u2500 requirements.txt        # D\u00e9pendances Python\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#configuration","title":"Configuration","text":"<p>Fichier <code>/opt/rag-anything/.env</code> :</p> <pre><code># OpenAI API Configuration\nOPENAI_API_KEY=sk-your-key-here\nOPENAI_BASE_URL=\n\n# Model Configuration\nLLM_MODEL=gpt-4o-mini\nVISION_MODEL=gpt-4o\nEMBEDDING_MODEL=text-embedding-3-large\nEMBEDDING_DIM=3072\nMAX_TOKEN_SIZE=8192\n\n# Parser Configuration\nPARSER=mineru                # ou docling\nPARSE_METHOD=auto            # auto, ocr, ou txt\n\n# HuggingFace Mirror (optionnel)\nHF_ENDPOINT=https://hf-mirror.com\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#api-endpoints","title":"API Endpoints","text":"<p>Base URL: <code>https://rag-anything.srv759970.hstgr.cloud</code></p>"},{"location":"02-applications/ai-rag/ragflow/#get","title":"GET /","text":"<p>Informations sur le service</p> <pre><code>curl https://rag-anything.srv759970.hstgr.cloud/\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#get-health","title":"GET /health","text":"<p>Health check</p> <pre><code>curl https://rag-anything.srv759970.hstgr.cloud/health\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#post-upload","title":"POST /upload","text":"<p>Upload et traitement d'un document</p> <pre><code>curl -X POST https://rag-anything.srv759970.hstgr.cloud/upload \\\n  -F \"file=@document.pdf\" \\\n  -F \"parse_method=auto\"\n</code></pre> <p>Param\u00e8tres: - <code>file</code>: Document \u00e0 traiter (PDF, DOCX, PPTX, images, etc.) - <code>parse_method</code>: <code>auto</code>, <code>ocr</code>, ou <code>txt</code></p> <p>R\u00e9ponse: <pre><code>{\n  \"status\": \"success\",\n  \"message\": \"Document document.pdf processed successfully\",\n  \"filename\": \"document.pdf\"\n}\n</code></pre></p>"},{"location":"02-applications/ai-rag/ragflow/#post-query","title":"POST /query","text":"<p>Interroger le knowledge base</p> <pre><code>curl -X POST https://rag-anything.srv759970.hstgr.cloud/query \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"query\": \"What are the main findings in the research?\",\n    \"mode\": \"hybrid\",\n    \"vlm_enhanced\": true\n  }'\n</code></pre> <p>Param\u00e8tres: - <code>query</code> (string): Question \u00e0 poser - <code>mode</code> (string): Mode de recherche   - <code>hybrid</code>: Combine vectoriel + knowledge graph (recommand\u00e9)   - <code>local</code>: Recherche locale uniquement   - <code>global</code>: Recherche globale uniquement   - <code>naive</code>: Recherche vectorielle simple - <code>vlm_enhanced</code> (boolean, optionnel): Utiliser VLM pour analyser les images</p> <p>R\u00e9ponse: <pre><code>{\n  \"answer\": \"The main findings indicate that...\",\n  \"status\": \"success\"\n}\n</code></pre></p>"},{"location":"02-applications/ai-rag/ragflow/#delete-clear","title":"DELETE /clear","text":"<p>Effacer le stockage RAG</p> <pre><code>curl -X DELETE https://rag-anything.srv759970.hstgr.cloud/clear\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#commandes-docker","title":"Commandes Docker","text":"<pre><code># D\u00e9marrer\ncd /opt/rag-anything\ndocker-compose up -d\n\n# Arr\u00eater\ndocker-compose down\n\n# Rebuild (apr\u00e8s modification du code)\ndocker-compose build --no-cache\ndocker-compose up -d --force-recreate\n\n# Logs\ndocker logs rag-anything-api --tail=50 -f\n\n# Status\ndocker ps --filter name=rag-anything\n\n# Acc\u00e9der au conteneur\ndocker exec -it rag-anything-api bash\n\n# V\u00e9rifier les volumes\ndocker volume ls | grep rag-anything\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#systemd_1","title":"Systemd","text":"<pre><code># Status\nsystemctl status rag-anything.service\n\n# D\u00e9marrer/Arr\u00eater\nsystemctl start rag-anything.service\nsystemctl stop rag-anything.service\n\n# Logs\njournalctl -u rag-anything.service -f\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#utilisation","title":"\ud83d\udca1 Utilisation","text":""},{"location":"02-applications/ai-rag/ragflow/#exemple-ragflow-interface-web","title":"Exemple RAGFlow (Interface Web)","text":"<ol> <li>Acc\u00e9der \u00e0 https://ragflow.srv759970.hstgr.cloud</li> <li>Cr\u00e9er un compte (premi\u00e8re utilisation)</li> <li>Cr\u00e9er une base de connaissances :</li> <li>Cliquer sur \"Knowledge Base\"</li> <li>\"Create Knowledge Base\"</li> <li>Choisir un template de chunking</li> <li>Uploader des documents</li> <li>Cr\u00e9er un assistant ou utiliser l'API</li> </ol>"},{"location":"02-applications/ai-rag/ragflow/#exemple-rag-anything-api-python","title":"Exemple RAG-Anything (API Python)","text":"<pre><code>import requests\n\nbase_url = \"https://rag-anything.srv759970.hstgr.cloud\"\n\n# 1. Upload un document\nwith open(\"research_paper.pdf\", \"rb\") as f:\n    response = requests.post(\n        f\"{base_url}/upload\",\n        files={\"file\": f},\n        data={\"parse_method\": \"auto\"}\n    )\n    print(response.json())\n    # Output: {\"status\": \"success\", \"message\": \"...\", \"filename\": \"...\"}\n\n# 2. Interroger avec mode hybrid\nresponse = requests.post(\n    f\"{base_url}/query\",\n    json={\n        \"query\": \"What methodology was used in this research?\",\n        \"mode\": \"hybrid\",\n        \"vlm_enhanced\": True  # Pour analyser les figures avec VLM\n    }\n)\nresult = response.json()\nprint(result[\"answer\"])\n\n# 3. Interroger avec mode global (pour questions g\u00e9n\u00e9rales)\nresponse = requests.post(\n    f\"{base_url}/query\",\n    json={\n        \"query\": \"Summarize the key contributions\",\n        \"mode\": \"global\"\n    }\n)\nprint(response.json()[\"answer\"])\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#exemple-rag-anything-curl","title":"Exemple RAG-Anything (cURL)","text":"<pre><code># Upload\ncurl -X POST https://rag-anything.srv759970.hstgr.cloud/upload \\\n  -F \"file=@presentation.pptx\" \\\n  -F \"parse_method=auto\"\n\n# Query simple\ncurl -X POST https://rag-anything.srv759970.hstgr.cloud/query \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"What are the conclusions?\", \"mode\": \"hybrid\"}'\n\n# Query avec VLM pour analyser les images\ncurl -X POST https://rag-anything.srv759970.hstgr.cloud/query \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"query\": \"Explain the charts and diagrams\",\n    \"mode\": \"hybrid\",\n    \"vlm_enhanced\": true\n  }'\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#maintenance","title":"\ud83d\udee0\ufe0f Maintenance","text":""},{"location":"02-applications/ai-rag/ragflow/#backup","title":"Backup","text":""},{"location":"02-applications/ai-rag/ragflow/#ragflow_2","title":"RAGFlow","text":"<pre><code># Backup MySQL\ndocker exec ragflow-mysql mysqldump -u root -pinfini_rag_flow rag_flow &gt; ragflow_backup_$(date +%Y%m%d).sql\n\n# Backup MinIO (stockage documents)\ndocker exec ragflow-minio mc mirror /data /backup\n\n# Backup volumes complet\ndocker run --rm \\\n  -v ragflow-mysql-data:/mysql \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/ragflow-volumes-backup-$(date +%Y%m%d).tar.gz -C /mysql .\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything_2","title":"RAG-Anything","text":"<pre><code># Backup storage (knowledge graph)\ndocker run --rm \\\n  -v rag-anything-storage:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/rag-anything-storage-$(date +%Y%m%d).tar.gz -C /data .\n\n# Backup output (documents pars\u00e9s)\ndocker run --rm \\\n  -v rag-anything-output:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/rag-anything-output-$(date +%Y%m%d).tar.gz -C /data .\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#monitoring","title":"Monitoring","text":"<pre><code># Ressources consomm\u00e9es\ndocker stats --no-stream | grep -E \"ragflow|rag-anything\"\n\n# Espace disque\ndocker system df\ndf -h /var/lib/docker\n\n# Logs d'erreurs\ndocker logs ragflow-server 2&gt;&amp;1 | grep ERROR | tail -20\ndocker logs rag-anything-api 2&gt;&amp;1 | grep ERROR | tail -20\n\n# Health checks\ncurl -f https://ragflow.srv759970.hstgr.cloud/ || echo \"RAGFlow DOWN\"\ncurl -f https://rag-anything.srv759970.hstgr.cloud/health || echo \"RAG-Anything DOWN\"\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#mises-a-jour","title":"Mises \u00e0 jour","text":""},{"location":"02-applications/ai-rag/ragflow/#ragflow_3","title":"RAGFlow","text":"<pre><code>cd /opt/ragflow/docker\n\n# 1. Backup d'abord !\ndocker exec ragflow-mysql mysqldump -u root -pinfini_rag_flow rag_flow &gt; backup_before_update.sql\n\n# 2. Modifier .env avec nouvelle version\n# RAGFLOW_IMAGE=infiniflow/ragflow:v0.22.0-slim\n\n# 3. Pull et red\u00e9ployer\ndocker-compose -f docker-compose-full.yml pull\ndocker-compose -f docker-compose-full.yml up -d --force-recreate\n\n# 4. V\u00e9rifier\ndocker logs ragflow-server --tail=50\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything_3","title":"RAG-Anything","text":"<pre><code>cd /opt/rag-anything\n\n# 1. Pull derni\u00e8res modifications (si git)\ngit pull\n\n# 2. Rebuild\ndocker-compose build --no-cache\n\n# 3. Red\u00e9ployer\ndocker-compose up -d --force-recreate\n\n# 4. V\u00e9rifier\ndocker logs rag-anything-api --tail=50\ncurl https://rag-anything.srv759970.hstgr.cloud/health\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/ai-rag/ragflow/#ragflow-ne-demarre-pas","title":"RAGFlow ne d\u00e9marre pas","text":"<pre><code># 1. V\u00e9rifier les logs\ndocker logs ragflow-server\n\n# 2. V\u00e9rifier Elasticsearch\ncurl -u elastic:infini_rag_flow http://localhost:1220/_cluster/health\n\n# 3. V\u00e9rifier MySQL\ndocker exec ragflow-mysql mysql -u root -pinfini_rag_flow -e \"SELECT 1\"\n\n# 4. V\u00e9rifier Redis\ndocker exec ragflow-redis redis-cli -a infini_rag_flow ping\n\n# 5. Red\u00e9marrer tous les services\ncd /opt/ragflow/docker\ndocker-compose -f docker-compose-full.yml restart\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything-timeout-sur-upload","title":"RAG-Anything timeout sur upload","text":"<pre><code># 1. Augmenter timeout Nginx\n# \u00c9diter /etc/nginx/sites-available/rag-anything\n# Ajouter: proxy_read_timeout 600;\nsystemctl reload nginx\n\n# 2. V\u00e9rifier MinerU\ndocker exec rag-anything-api python -c \"import magic_pdf; print('OK')\"\n\n# 3. V\u00e9rifier cl\u00e9 API\ndocker exec rag-anything-api env | grep OPENAI_API_KEY\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#problemes-de-memoire","title":"Probl\u00e8mes de m\u00e9moire","text":"<pre><code># RAGFlow consomme beaucoup (surtout Elasticsearch 8GB)\n# R\u00e9duire MEM_LIMIT dans .env\nMEM_LIMIT=4073741824  # 4GB au lieu de 8GB\n\n# Ou d\u00e9sactiver temporairement services non critiques\ndocker stop ragflow-es-01\n\n# Nettoyer Docker\ndocker system prune -a --volumes\n</code></pre>"},{"location":"02-applications/ai-rag/ragflow/#ressources","title":"\ud83d\udcda Ressources","text":""},{"location":"02-applications/ai-rag/ragflow/#ragflow_4","title":"RAGFlow","text":"<ul> <li>Documentation : https://ragflow.io/docs/dev/</li> <li>GitHub : https://github.com/infiniflow/ragflow</li> <li>Release notes : https://ragflow.io/docs/dev/release_notes</li> <li>Docker Hub : https://hub.docker.com/r/infiniflow/ragflow</li> </ul>"},{"location":"02-applications/ai-rag/ragflow/#rag-anything_4","title":"RAG-Anything","text":"<ul> <li>GitHub : https://github.com/HKUDS/RAG-Anything</li> <li>Paper : https://arxiv.org/abs/2510.12323</li> <li>PyPI : https://pypi.org/project/raganything/</li> <li>LightRAG : https://github.com/HKUDS/LightRAG</li> </ul>"},{"location":"02-applications/ai-rag/ragflow/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":""},{"location":"02-applications/ai-rag/ragflow/#credentials-par-defaut","title":"Credentials par d\u00e9faut","text":"<p>RAGFlow : - MySQL root: <code>infini_rag_flow</code> - Elasticsearch elastic: <code>infini_rag_flow</code> - Redis: <code>infini_rag_flow</code> - MinIO: <code>rag_flow</code> / <code>infini_rag_flow</code></p> <p>Important : Changez ces mots de passe en production !</p>"},{"location":"02-applications/ai-rag/ragflow/#ssltls","title":"SSL/TLS","text":"<ul> <li>Certificats Let's Encrypt auto-renouvel\u00e9s</li> <li>Domaines: <code>ragflow.srv759970.hstgr.cloud</code>, <code>rag-anything.srv759970.hstgr.cloud</code></li> <li>Renouvellement automatique via certbot</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025</p>"},{"location":"02-applications/ai-services/ollama/","title":"Ollama - Inf\u00e9rence LLM Locale","text":""},{"location":"02-applications/ai-services/ollama/#vue-densemble","title":"Vue d'ensemble","text":"<p>Ollama permet d'ex\u00e9cuter des mod\u00e8les de langage (LLM) localement sur le serveur.</p>"},{"location":"02-applications/ai-services/ollama/#acces","title":"Acc\u00e8s","text":"<ul> <li>API: https://ollama.srv759970.hstgr.cloud</li> <li>Port: 11434</li> </ul>"},{"location":"02-applications/ai-services/ollama/#modeles-disponibles","title":"Mod\u00e8les disponibles","text":"<ul> <li>Llama 3: Mod\u00e8le g\u00e9n\u00e9ral performant</li> <li>Mistral: Mod\u00e8le fran\u00e7ais optimis\u00e9</li> <li>Qwen: Mod\u00e8le multilingue</li> <li>Code Llama: Sp\u00e9cialis\u00e9 pour le code</li> </ul>"},{"location":"02-applications/ai-services/ollama/#endpoints","title":"Endpoints","text":""},{"location":"02-applications/ai-services/ollama/#post-apigenerate","title":"POST /api/generate","text":"<p>G\u00e9n\u00e9ration de texte.</p> <p>Exemple: <pre><code>curl https://ollama.srv759970.hstgr.cloud/api/generate   -d '{\n    \"model\": \"mistral\",\n    \"prompt\": \"Explique-moi le machine learning\"\n  }'\n</code></pre></p>"},{"location":"02-applications/ai-services/ollama/#post-apichat","title":"POST /api/chat","text":"<p>Mode conversation.</p> <p>Exemple: <pre><code>curl https://ollama.srv759970.hstgr.cloud/api/chat   -d '{\n    \"model\": \"llama3\",\n    \"messages\": [\n      {\"role\": \"user\", \"content\": \"Bonjour!\"}\n    ]\n  }'\n</code></pre></p>"},{"location":"02-applications/ai-services/ollama/#post-apiembeddings","title":"POST /api/embeddings","text":"<p>G\u00e9n\u00e9ration d'embeddings pour recherche s\u00e9mantique.</p> <p>Exemple: <pre><code>curl https://ollama.srv759970.hstgr.cloud/api/embeddings   -d '{\n    \"model\": \"nomic-embed-text\",\n    \"prompt\": \"Texte \u00e0 vectoriser\"\n  }'\n</code></pre></p>"},{"location":"02-applications/ai-services/ollama/#gestion-des-modeles","title":"Gestion des mod\u00e8les","text":""},{"location":"02-applications/ai-services/ollama/#lister-les-modeles","title":"Lister les mod\u00e8les","text":"<pre><code>curl https://ollama.srv759970.hstgr.cloud/api/tags\n</code></pre>"},{"location":"02-applications/ai-services/ollama/#telecharger-un-modele","title":"T\u00e9l\u00e9charger un mod\u00e8le","text":"<pre><code>ssh root@srv759970.hstgr.cloud \"ollama pull llama3\"\n</code></pre>"},{"location":"02-applications/ai-services/ollama/#configuration","title":"Configuration","text":"<ul> <li>GPU: Aucun (CPU uniquement)</li> <li>RAM: 8 GB recommand\u00e9s</li> <li>Stockage mod\u00e8les: /root/.ollama/models</li> </ul>"},{"location":"02-applications/ai-services/ollama/#performance","title":"Performance","text":"Mod\u00e8le Taille Vitesse (tokens/s) Llama 3 8B 4.7 GB ~15 Mistral 7B 4.1 GB ~20 Qwen 7B 4.4 GB ~18"},{"location":"02-applications/ai-services/ollama/#ressources","title":"Ressources","text":"<ul> <li>Ollama Documentation</li> <li>Liste des mod\u00e8les</li> </ul>"},{"location":"02-applications/ai-services/tika/","title":"Apache Tika - Parsing de Documents","text":""},{"location":"02-applications/ai-services/tika/#vue-densemble","title":"Vue d'ensemble","text":"<p>Apache Tika est un service de parsing de documents universel supportant plus de 1000 formats de fichiers.</p>"},{"location":"02-applications/ai-services/tika/#acces","title":"Acc\u00e8s","text":"<ul> <li>API: https://tika.srv759970.hstgr.cloud</li> <li>Port: 9998</li> </ul>"},{"location":"02-applications/ai-services/tika/#formats-supportes","title":"Formats support\u00e9s","text":"<ul> <li>Documents: PDF, DOC, DOCX, ODT, RTF</li> <li>Feuilles de calcul: XLS, XLSX, ODS, CSV</li> <li>Pr\u00e9sentations: PPT, PPTX, ODP</li> <li>Images: JPEG, PNG, TIFF, BMP (avec OCR)</li> <li>Archives: ZIP, TAR, 7Z, RAR</li> <li>Audio/Vid\u00e9o: MP3, MP4, AVI, MKV</li> <li>Emails: MSG, EML, MBOX</li> </ul>"},{"location":"02-applications/ai-services/tika/#endpoints","title":"Endpoints","text":""},{"location":"02-applications/ai-services/tika/#post-tika","title":"POST /tika","text":"<p>Parse un document et retourne le texte brut.</p> <p>Exemple: <pre><code>curl -X PUT https://tika.srv759970.hstgr.cloud/tika   --upload-file document.pdf   -H \"Accept: text/plain\"\n</code></pre></p>"},{"location":"02-applications/ai-services/tika/#post-meta","title":"POST /meta","text":"<p>Extrait les m\u00e9tadonn\u00e9es d'un fichier.</p> <p>Exemple: <pre><code>curl -X PUT https://tika.srv759970.hstgr.cloud/meta   --upload-file photo.jpg   -H \"Accept: application/json\"\n</code></pre></p>"},{"location":"02-applications/ai-services/tika/#post-detectstream","title":"POST /detect/stream","text":"<p>D\u00e9tecte le type MIME d'un fichier.</p>"},{"location":"02-applications/ai-services/tika/#configuration","title":"Configuration","text":"<ul> <li>Version: Apache Tika 3.2.3</li> <li>OCR: Tesseract int\u00e9gr\u00e9</li> <li>Langues OCR: Fran\u00e7ais, Anglais, Espagnol, etc.</li> <li>Taille max: 100 MB par fichier</li> </ul>"},{"location":"02-applications/ai-services/tika/#cas-dusage","title":"Cas d'usage","text":"<ol> <li>Indexation de documents: Extraire le texte pour recherche full-text</li> <li>OCR automatique: Scanner des images contenant du texte</li> <li>Extraction de m\u00e9tadonn\u00e9es: EXIF, auteur, date de cr\u00e9ation</li> <li>Conversion de formats: Normaliser diff\u00e9rents formats en texte</li> </ol>"},{"location":"02-applications/ai-services/tika/#ressources","title":"Ressources","text":"<ul> <li>Documentation Apache Tika</li> </ul>"},{"location":"02-applications/ai-transcription/faster-whisper/","title":"Guide Faster-Whisper avec Syst\u00e8me de Queue","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#vue-densemble","title":"Vue d'ensemble","text":"<p>Int\u00e9gration compl\u00e8te de Faster-Whisper avec le syst\u00e8me de queues Redis Queue (RQ), permettant le traitement asynchrone de transcriptions audio longues.</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Redis Partag\u00e9 (rq-queue-redis:6379) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                               \u2502\n\u2502  DB 0: Queue \"transcription\" (WhisperX)                      \u2502\n\u2502  DB 1: Queue \"faster-whisper-transcription\" (Faster-Whisper)\u2502\n\u2502                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193                                 \u2193\n   whisperx-worker              faster-whisper-worker\n         \u2193                                 \u2193\n   WhisperX API (:8002)         Faster-Whisper Queue API (:8003)\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#services-deployes","title":"Services D\u00e9ploy\u00e9s","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#1-faster-whisper-port-8001","title":"1. faster-whisper (Port 8001)","text":"<p>Service de base inchang\u00e9, utilisant l'image officielle <code>fedirz/faster-whisper-server:latest-cpu</code>.</p> <p>API: - <code>GET /health</code> - Health check - <code>POST /v1/audio/transcriptions</code> - Transcription directe (OpenAI-compatible)</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#2-faster-whisper-queue-api-port-8003","title":"2. faster-whisper-queue-api (Port 8003)","text":"<p>Wrapper FastAPI ajoutant les capacit\u00e9s de queuing.</p> <p>Endpoints: - <code>GET /</code> - Informations sur le service - <code>GET /health</code> - Health check (Redis + faster-whisper) - <code>POST /transcribe</code> - Transcription synchrone (passthrough vers faster-whisper) - <code>POST /transcribe/async</code> - Transcription asynchrone via RQ \u2728 - <code>GET /transcribe/status/{job_id}</code> - Statut du job async - <code>GET /queue/stats</code> - Statistiques de la queue</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#3-faster-whisper-worker","title":"3. faster-whisper-worker","text":"<p>Worker RQ d\u00e9di\u00e9 au traitement des transcriptions async.</p> <p>Configuration: - Queue: <code>faster-whisper-transcription</code> - Redis DB: 1 (isolation avec WhisperX) - Timeout: 30 minutes par job - Result TTL: 1 heure</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#installation","title":"Installation","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#structure-des-fichiers","title":"Structure des fichiers","text":"<pre><code>/opt/faster-whisper-queue/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 server.py      # API FastAPI avec endpoints async\n\u2514\u2500\u2500 worker.py      # RQ Worker\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  faster-whisper:\n    image: fedirz/faster-whisper-server:latest-cpu\n    container_name: faster-whisper\n    restart: unless-stopped\n    ports:\n      - '8001:8000'\n    volumes:\n      - /root/.cache/huggingface:/root/.cache/huggingface\n    environment:\n      - WHISPER__MODEL=Systran/faster-whisper-small\n      - WHISPER__INFERENCE_DEVICE=cpu\n      - UVICORN_HOST=0.0.0.0\n      - UVICORN_PORT=8000\n      - TZ=Europe/Paris\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n      start_period: 30s\n    logging:\n      driver: json-file\n      options:\n        max-size: '10m'\n        max-file: '3'\n    networks:\n      - faster-whisper-net\n      - whisperx_whisperx\n\n  faster-whisper-queue-api:\n    build: .\n    container_name: faster-whisper-queue-api\n    restart: unless-stopped\n    ports:\n      - '8003:8003'\n    environment:\n      - REDIS_URL=redis://rq-queue-redis:6379/1\n      - FASTER_WHISPER_URL=http://faster-whisper:8000\n    depends_on:\n      - faster-whisper\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8003/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n    logging:\n      driver: json-file\n      options:\n        max-size: '10m'\n        max-file: '3'\n    networks:\n      - faster-whisper-net\n      - whisperx_whisperx\n    volumes:\n      - /tmp/faster-whisper-uploads:/tmp/uploads\n\n  faster-whisper-worker:\n    build: .\n    container_name: faster-whisper-worker\n    restart: unless-stopped\n    command: python worker.py\n    environment:\n      - REDIS_URL=redis://rq-queue-redis:6379/1\n      - FASTER_WHISPER_URL=http://faster-whisper:8000\n    depends_on:\n      - faster-whisper\n    logging:\n      driver: json-file\n      options:\n        max-size: '10m'\n        max-file: '3'\n    networks:\n      - faster-whisper-net\n      - whisperx_whisperx\n\nnetworks:\n  faster-whisper-net:\n    driver: bridge\n  whisperx_whisperx:\n    external: true\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#demarrage","title":"D\u00e9marrage","text":"<pre><code>cd /opt/faster-whisper-queue\ndocker-compose up -d\n\n# V\u00e9rifier les logs\ndocker-compose logs -f faster-whisper-worker\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#transcription-synchrone","title":"Transcription Synchrone","text":"<pre><code>curl -X POST http://localhost:8003/transcribe \\\n  -F \"file=@audio.wav\" \\\n  -F \"language=fr\" \\\n  -F \"task=transcribe\"\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#transcription-asynchrone","title":"Transcription Asynchrone","text":"<p>1. Soumettre le job: <pre><code>curl -X POST http://localhost:8003/transcribe/async \\\n  -F \"file=@long_audio.wav\" \\\n  -F \"language=fr\" \\\n  | jq .\n</code></pre></p> <p>R\u00e9ponse: <pre><code>{\n  \"job_id\": \"c8b13006-fd93-4ea6-8a26-98c3807165b5\",\n  \"status\": \"queued\",\n  \"message\": \"Transcription job queued: long_audio.wav\",\n  \"queue_position\": 0,\n  \"estimated_wait\": \"0 minutes\"\n}\n</code></pre></p> <p>2. V\u00e9rifier le statut: <pre><code>curl http://localhost:8003/transcribe/status/c8b13006-fd93-4ea6-8a26-98c3807165b5 | jq .\n</code></pre></p> <p>R\u00e9ponses possibles:</p> <p>Job en attente: <pre><code>{\n  \"job_id\": \"c8b13006-fd93-4ea6-8a26-98c3807165b5\",\n  \"status\": \"queued\",\n  \"created_at\": \"2025-10-20T20:43:19.570894\",\n  \"queue_position\": 2,\n  \"message\": \"Waiting in queue\"\n}\n</code></pre></p> <p>Job en cours: <pre><code>{\n  \"job_id\": \"c8b13006-fd93-4ea6-8a26-98c3807165b5\",\n  \"status\": \"started\",\n  \"created_at\": \"2025-10-20T20:43:19.570894\",\n  \"started_at\": \"2025-10-20T20:43:25.591326\",\n  \"message\": \"Transcription in progress\"\n}\n</code></pre></p> <p>Job termin\u00e9: <pre><code>{\n  \"job_id\": \"c8b13006-fd93-4ea6-8a26-98c3807165b5\",\n  \"status\": \"finished\",\n  \"created_at\": \"2025-10-20T20:43:19.570894\",\n  \"started_at\": \"2025-10-20T20:43:25.591326\",\n  \"ended_at\": \"2025-10-20T20:45:10.578469\",\n  \"result\": {\n    \"text\": \"Bonjour, ceci est une transcription...\",\n    \"segments\": [...],\n    \"metadata\": {\n      \"filename\": \"long_audio.wav\",\n      \"processing_time\": 105.5,\n      \"language\": \"fr\",\n      \"task\": \"transcribe\",\n      \"service\": \"faster-whisper\"\n    }\n  },\n  \"message\": \"Transcription completed\"\n}\n</code></pre></p> <p>Job \u00e9chou\u00e9: <pre><code>{\n  \"job_id\": \"c8b13006-fd93-4ea6-8a26-98c3807165b5\",\n  \"status\": \"failed\",\n  \"created_at\": \"2025-10-20T20:43:19.570894\",\n  \"started_at\": \"2025-10-20T20:43:25.591326\",\n  \"ended_at\": \"2025-10-20T20:43:30.578469\",\n  \"error\": \"Faster-whisper API error: 500 Server Error...\",\n  \"message\": \"Transcription failed\"\n}\n</code></pre></p>"},{"location":"02-applications/ai-transcription/faster-whisper/#statistiques-de-la-queue","title":"Statistiques de la Queue","text":"<pre><code>curl http://localhost:8003/queue/stats | jq .\n</code></pre> <p>R\u00e9ponse: <pre><code>{\n  \"queue_name\": \"faster-whisper-transcription\",\n  \"queued\": 3,\n  \"workers\": 1,\n  \"failed\": 2,\n  \"finished\": 15,\n  \"started\": 1\n}\n</code></pre></p>"},{"location":"02-applications/ai-transcription/faster-whisper/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#grafanaloki","title":"Grafana/Loki","text":"<p>Logs collect\u00e9s: - <code>faster-whisper</code> - Service de base - <code>faster-whisper-queue-api</code> - API wrapper - <code>faster-whisper-worker</code> - Worker RQ</p> <p>Queries utiles: <pre><code># Logs du worker\n{container=\"faster-whisper-worker\"}\n\n# Jobs d\u00e9marr\u00e9s\n{container=\"faster-whisper-worker\"} |= \"Starting transcription\"\n\n# Erreurs\n{container=\"faster-whisper-worker\"} |= \"ERROR\"\n\n# Tous les services faster-whisper\n{container=~\"faster-whisper.*\"}\n</code></pre></p>"},{"location":"02-applications/ai-transcription/faster-whisper/#rq-dashboard","title":"RQ Dashboard","text":"<p>URL: https://whisperx-dashboard.srv759970.hstgr.cloud</p> <p>Affiche les queues de WhisperX et Faster-Whisper dans un seul dashboard.</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#comparaison-whisperx-vs-faster-whisper","title":"Comparaison WhisperX vs Faster-Whisper","text":"Caract\u00e9ristique WhisperX Faster-Whisper Port API 8002 8003 Queue Redis DB 0 1 Queue Name <code>transcription</code> <code>faster-whisper-transcription</code> Mod\u00e8le whisper-large-v2 faster-whisper-small Device CPU CPU Diarization \u2705 Oui \u274c Non Alignement \u2705 Oui \u274c Non Vitesse Moyen Rapide Qualit\u00e9 Excellente Bonne"},{"location":"02-applications/ai-transcription/faster-whisper/#urls-de-production","title":"URLs de Production","text":"<ul> <li>Faster-Whisper (direct): http://srv759970.hstgr.cloud:8001</li> <li>Faster-Whisper Queue API: http://srv759970.hstgr.cloud:8003</li> <li>WhisperX API: http://srv759970.hstgr.cloud:8002</li> <li>RQ Dashboard: https://whisperx-dashboard.srv759970.hstgr.cloud</li> <li>Grafana Monitoring: https://monitoring.srv759970.hstgr.cloud</li> </ul>"},{"location":"02-applications/ai-transcription/faster-whisper/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#worker-en-boucle-de-redemarrage","title":"Worker en boucle de red\u00e9marrage","text":"<pre><code>docker logs faster-whisper-worker --tail 50\n</code></pre> <p>Causes communes: - Redis non accessible \u2192 V\u00e9rifier le network <code>whisperx_whisperx</code> - faster-whisper service down \u2192 <code>docker ps | grep faster-whisper</code></p>"},{"location":"02-applications/ai-transcription/faster-whisper/#jobs-bloques-en-queued","title":"Jobs bloqu\u00e9s en \"queued\"","text":"<pre><code># V\u00e9rifier que le worker tourne\ndocker ps | grep faster-whisper-worker\n\n# Logs du worker\ndocker logs faster-whisper-worker --tail 30\n\n# Nombre de workers actifs\ncurl http://localhost:8003/queue/stats | jq '.workers'\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#erreurs-connection-refused","title":"Erreurs \"Connection refused\"","text":"<p>V\u00e9rifier que tous les services sont sur le bon network:</p> <pre><code>docker network inspect whisperx_whisperx | grep -E \"faster-whisper|rq-queue-redis\"\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#performance","title":"Performance","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#benchmarks","title":"Benchmarks","text":"<p>Tests avec fichier audio de 5 minutes (fran\u00e7ais):</p> Service Temps de traitement Qualit\u00e9 WER WhisperX (large-v2) ~180s 5.2% Faster-Whisper (small) ~45s 8.7%"},{"location":"02-applications/ai-transcription/faster-whisper/#recommandations","title":"Recommandations","text":"<p>Utiliser WhisperX si: - Besoin de diarization (qui parle quand) - Besoin d'alignement pr\u00e9cis des timestamps - Qualit\u00e9 de transcription critique - Fichiers &lt; 30 minutes</p> <p>Utiliser Faster-Whisper si: - Vitesse prioritaire - Pas besoin de diarization - Fichiers longs (&gt; 30 minutes) - Volume \u00e9lev\u00e9 de fichiers courts</p>"},{"location":"02-applications/ai-transcription/faster-whisper/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/ai-transcription/faster-whisper/#logs","title":"Logs","text":"<pre><code># Tous les services\ncd /opt/faster-whisper-queue &amp;&amp; docker-compose logs -f\n\n# Worker uniquement\ndocker logs -f faster-whisper-worker\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#restart","title":"Restart","text":"<pre><code>cd /opt/faster-whisper-queue\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#update","title":"Update","text":"<pre><code>cd /opt/faster-whisper-queue\ndocker-compose pull faster-whisper\ndocker-compose build --no-cache\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/ai-transcription/faster-whisper/#nettoyage-des-jobs","title":"Nettoyage des jobs","text":"<p>Les r\u00e9sultats sont automatiquement supprim\u00e9s apr\u00e8s 1 heure (TTL).</p> <p>Pour forcer un nettoyage: <pre><code>docker exec rq-queue-redis redis-cli -n 1 FLUSHDB\n</code></pre></p>"},{"location":"02-applications/ai-transcription/faster-whisper/#ressources","title":"Ressources","text":"<ul> <li>Faster-Whisper Server</li> <li>RQ Documentation</li> <li>Guide WhisperX</li> <li>Guide Monitoring</li> </ul>"},{"location":"02-applications/ai-transcription/faster-whisper/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Guide Whisper Services - Comparaison et choix entre services</li> <li>WhisperX Service - Service avec diarization</li> <li>Monitoring WhisperX - Stack Grafana + Prometheus + Loki</li> <li>Docker - Gestion des conteneurs</li> <li>Reference Docker Commands - Commandes Docker courantes</li> </ul>"},{"location":"02-applications/ai-transcription/whisperx/","title":"WhisperX - Transcription avec Diarization","text":"<p>Service de transcription audio avec diarization (identification des locuteurs).</p>"},{"location":"02-applications/ai-transcription/whisperx/#acces","title":"Acc\u00e8s","text":"<ul> <li>URL API: https://whisperx.srv759970.hstgr.cloud</li> <li>Documentation: https://whisperx.srv759970.hstgr.cloud/docs</li> <li>Port interne: 8002</li> <li>Auth: Basic Auth (julien:DevAccess2025)</li> </ul>"},{"location":"02-applications/ai-transcription/whisperx/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>Mod\u00e8le: <code>large-v2</code></li> <li>Diarization: \u2705 (qui parle quand)</li> <li>Alignment: \u2705 (timestamps pr\u00e9cis)</li> <li>Device: CUDA (GPU)</li> <li>Queue: Redis DB 0 (\"transcription\")</li> </ul>"},{"location":"02-applications/ai-transcription/whisperx/#quick-start-transcrivez-en-5-minutes","title":"\ud83d\ude80 Quick Start - Transcrivez en 5 Minutes","text":""},{"location":"02-applications/ai-transcription/whisperx/#exemple-curl","title":"Exemple curl","text":"<pre><code># Transcription asynchrone (recommand\u00e9)\ncurl -X POST \"https://whisperx.srv759970.hstgr.cloud/transcribe\" \\\n  -u julien:DevAccess2025 \\\n  -F \"file=@/path/to/audio.mp3\" \\\n  -F \"language=fr\"\n\n# R\u00e9ponse\n{\n  \"job_id\": \"abc123-def456\",\n  \"status\": \"queued\",\n  \"message\": \"Job submitted successfully\"\n}\n\n# V\u00e9rifier le statut\ncurl -X GET \"https://whisperx.srv759970.hstgr.cloud/job/abc123-def456\" \\\n  -u julien:DevAccess2025\n\n# R\u00e9ponse (processing)\n{\n  \"job_id\": \"abc123-def456\",\n  \"status\": \"processing\",\n  \"progress\": 45\n}\n\n# R\u00e9ponse (completed)\n{\n  \"job_id\": \"abc123-def456\",\n  \"status\": \"completed\",\n  \"result\": {\n    \"text\": \"Bonjour, voici la transcription compl\u00e8te...\",\n    \"segments\": [\n      {\n        \"start\": 0.0,\n        \"end\": 2.5,\n        \"text\": \"Bonjour\",\n        \"speaker\": \"SPEAKER_00\"\n      },\n      {\n        \"start\": 2.5,\n        \"end\": 5.8,\n        \"text\": \"voici la transcription\",\n        \"speaker\": \"SPEAKER_01\"\n      }\n    ],\n    \"language\": \"fr\"\n  }\n}\n</code></pre>"},{"location":"02-applications/ai-transcription/whisperx/#exemple-python","title":"Exemple Python","text":"<pre><code>import requests\nimport time\n\n# Configuration\nAPI_URL = \"https://whisperx.srv759970.hstgr.cloud\"\nAUTH = (\"julien\", \"DevAccess2025\")\n\n# 1. Soumettre le fichier audio\nwith open(\"meeting.mp3\", \"rb\") as audio_file:\n    response = requests.post(\n        f\"{API_URL}/transcribe\",\n        auth=AUTH,\n        files={\"file\": audio_file},\n        data={\"language\": \"fr\"}\n    )\n\njob_data = response.json()\njob_id = job_data[\"job_id\"]\nprint(f\"Job ID: {job_id}\")\n\n# 2. Attendre la fin du traitement\nwhile True:\n    status_response = requests.get(\n        f\"{API_URL}/job/{job_id}\",\n        auth=AUTH\n    )\n    status_data = status_response.json()\n\n    if status_data[\"status\"] == \"completed\":\n        result = status_data[\"result\"]\n        print(\"\\nTranscription compl\u00e8te:\")\n        print(result[\"text\"])\n\n        print(\"\\nSegments avec speakers:\")\n        for segment in result[\"segments\"]:\n            print(f\"[{segment['speaker']}] {segment['text']}\")\n        break\n\n    elif status_data[\"status\"] == \"failed\":\n        print(f\"Erreur: {status_data.get('error')}\")\n        break\n\n    else:\n        print(f\"Status: {status_data['status']}\")\n        time.sleep(5)\n</code></pre>"},{"location":"02-applications/ai-transcription/whisperx/#exemple-javascript-nodejs","title":"Exemple JavaScript (Node.js)","text":"<pre><code>const axios = require('axios');\nconst FormData = require('form-data');\nconst fs = require('fs');\n\nconst API_URL = 'https://whisperx.srv759970.hstgr.cloud';\nconst AUTH = {\n  username: 'julien',\n  password: 'DevAccess2025'\n};\n\nasync function transcribeAudio(filePath) {\n  // 1. Soumettre le fichier\n  const formData = new FormData();\n  formData.append('file', fs.createReadStream(filePath));\n  formData.append('language', 'fr');\n\n  const submitResponse = await axios.post(\n    `${API_URL}/transcribe`,\n    formData,\n    {\n      auth: AUTH,\n      headers: formData.getHeaders()\n    }\n  );\n\n  const jobId = submitResponse.data.job_id;\n  console.log(`Job ID: ${jobId}`);\n\n  // 2. Polling du statut\n  while (true) {\n    const statusResponse = await axios.get(\n      `${API_URL}/job/${jobId}`,\n      { auth: AUTH }\n    );\n\n    const { status, result, error } = statusResponse.data;\n\n    if (status === 'completed') {\n      console.log('\\nTranscription:');\n      console.log(result.text);\n\n      console.log('\\nSegments avec speakers:');\n      result.segments.forEach(seg =&gt; {\n        console.log(`[${seg.speaker}] ${seg.text}`);\n      });\n      break;\n    } else if (status === 'failed') {\n      console.error(`Erreur: ${error}`);\n      break;\n    } else {\n      console.log(`Status: ${status}`);\n      await new Promise(resolve =&gt; setTimeout(resolve, 5000));\n    }\n  }\n}\n\n// Utilisation\ntranscribeAudio('./meeting.mp3');\n</code></pre>"},{"location":"02-applications/ai-transcription/whisperx/#endpoints-principaux","title":"Endpoints Principaux","text":""},{"location":"02-applications/ai-transcription/whisperx/#post-transcribe","title":"POST /transcribe","text":"<p>Upload audio file for transcription with diarization.</p> <p>Param\u00e8tres: - <code>file</code> (multipart/form-data): Fichier audio - <code>language</code> (optionnel): Code langue (fr, en, es, etc.)</p> <p>Retour: Job ID pour tracking</p>"},{"location":"02-applications/ai-transcription/whisperx/#get-jobjob_id","title":"GET /job/{job_id}","text":"<p>Check job status and retrieve results.</p> <p>Retour: Status (queued, processing, completed, failed) + r\u00e9sultats si completed</p> <p>See API Documentation for complete reference.</p>"},{"location":"02-applications/ai-transcription/whisperx/#limites-performances","title":"Limites &amp; Performances","text":"Limite Valeur Taille max fichier 100MB Formats support\u00e9s mp3, wav, m4a, ogg, flac, webm Dur\u00e9e max audio 2 heures Rate limit 10 requ\u00eates/minute Temps de traitement ~1min pour 10min d'audio (avec GPU) Langues support\u00e9es 90+ langues (voir doc Swagger) <p>Performance moyenne: - Audio 10 min \u2192 Transcription en ~1 minute - Audio 1 heure \u2192 Transcription en ~6 minutes - Diarization ajoute ~20% au temps de traitement</p>"},{"location":"02-applications/ai-transcription/whisperx/#dependances","title":"D\u00e9pendances","text":"Service R\u00f4le Impact si down Redis (rq-queue-redis:6379, DB 0) Queue de jobs \u274c Aucune transcription possible WhisperX Worker Processing audio \u274c Jobs restent en queue Nginx Reverse proxy HTTPS \u274c API inaccessible Certbot/SSL Certificat HTTPS \u26a0\ufe0f Erreur SSL <p>V\u00e9rifier d\u00e9pendances: <pre><code># Redis\ndocker exec -it rq-queue-redis redis-cli ping\n\n# Worker\ndocker ps | grep whisperx-worker\n\n# Queue status\ndocker exec -it rq-queue-redis redis-cli\nSELECT 0\nLLEN transcription\n</code></pre></p>"},{"location":"02-applications/ai-transcription/whisperx/#guides-complets","title":"Guides Complets","text":"<ul> <li>Guide Whisper Services - D\u00e9ploiement et configuration des deux services</li> <li>Faster-Whisper Queue - Alternative async avec queue RQ</li> <li>Monitoring WhisperX - Stack Grafana + Prometheus + Loki</li> </ul>"},{"location":"02-applications/ai-transcription/whisperx/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Docker - Gestion des conteneurs</li> <li>Nginx - Reverse proxy configuration</li> </ul>"},{"location":"02-applications/ai-tts/neutts/","title":"NeuTTS - Neural Text-to-Speech &amp; Voice Cloning","text":"<p>API URL: https://neutts-api.srv759970.hstgr.cloud UI URL: https://neutts-ui.srv759970.hstgr.cloud Container: <code>neutts-api</code>, <code>neutts-ui</code> Stack: FastAPI + Streamlit + Coqui TTS</p>"},{"location":"02-applications/ai-tts/neutts/#vue-densemble","title":"Vue d'Ensemble","text":"<p>NeuTTS est une solution de synth\u00e8se vocale neuronale avec capacit\u00e9s de clonage de voix, bas\u00e9e sur la technologie Coqui TTS.</p>"},{"location":"02-applications/ai-tts/neutts/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s Principales","text":"<ul> <li>\ud83c\udf99\ufe0f Voice Cloning - Clonage de voix \u00e0 partir de quelques secondes d'audio</li> <li>\ud83d\udde3\ufe0f Multi-speakers - Voix pr\u00e9-entra\u00een\u00e9es en plusieurs langues</li> <li>\u26a1 Synth\u00e8se rapide - G\u00e9n\u00e9ration TTS optimis\u00e9e</li> <li>\ud83c\udfb5 Contr\u00f4le prosodique - Ajustement de l'intonation et du rythme</li> <li>\ud83d\udcca API REST - Int\u00e9gration facile dans vos applications</li> <li>\ud83d\udda5\ufe0f Interface Web - UI Streamlit pour tests et d\u00e9mos</li> </ul>"},{"location":"02-applications/ai-tts/neutts/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           NeuTTS UI (Streamlit)             \u2502\n\u2502         Port 8501 - Interface Web           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                            \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  NeuTTS API    \u2502      \u2502  Voice Samples   \u2502\n\u2502  (FastAPI)     \u2502      \u2502     Storage      \u2502\n\u2502  Port 5002     \u2502      \u2502                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n    \u2502         \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Coqui  \u2502  \u2502 XTTS-v2\u2502\n\u2502  TTS   \u2502  \u2502 Models \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#installation-configuration","title":"Installation &amp; Configuration","text":""},{"location":"02-applications/ai-tts/neutts/#docker-compose","title":"Docker Compose","text":"<pre><code>version: '3.8'\n\nservices:\n  neutts-api:\n    image: ghcr.io/neutts/neutts-api:latest\n    container_name: neutts-api\n    restart: unless-stopped\n    ports:\n      - \"5002:5002\"\n    volumes:\n      - /opt/neutts/models:/models\n      - /opt/neutts/voices:/voices\n      - /opt/neutts/output:/output\n    environment:\n      - MODEL_PATH=/models/tts_models\n      - VOICE_SAMPLES_PATH=/voices\n      - OUTPUT_PATH=/output\n      - MAX_TEXT_LENGTH=1000\n      - CACHE_ENABLED=true\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - driver: nvidia\n              count: 1\n              capabilities: [gpu]\n\n  neutts-ui:\n    image: ghcr.io/neutts/neutts-ui:latest\n    container_name: neutts-ui\n    restart: unless-stopped\n    ports:\n      - \"8501:8501\"\n    environment:\n      - NEUTTS_API_URL=http://neutts-api:5002\n    depends_on:\n      - neutts-api\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#configuration","title":"Configuration","text":"<pre><code># /opt/neutts/config.yml\nmodels:\n  default: \"tts_models/multilingual/multi-dataset/xtts_v2\"\n  available:\n    - \"tts_models/fr/mai/tacotron2-DDC\"\n    - \"tts_models/en/ljspeech/tacotron2-DDC\"\n\nvoice_cloning:\n  min_audio_length: 6  # secondes\n  max_audio_length: 30\n  sample_rate: 22050\n  supported_formats: [\"wav\", \"mp3\", \"ogg\", \"flac\"]\n\noutput:\n  format: \"wav\"\n  sample_rate: 22050\n  bitrate: 192\n\ncache:\n  enabled: true\n  ttl: 3600  # 1 heure\n  max_size: 1000  # entr\u00e9es\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/ai-tts/neutts/#interface-web-streamlit","title":"Interface Web (Streamlit)","text":"<p>URL: https://neutts-ui.srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-tts/neutts/#onglet-text-to-speech","title":"Onglet \"Text-to-Speech\"","text":"<ol> <li>Saisir le texte \u00e0 synth\u00e9tiser</li> <li>S\u00e9lectionner la voix (pr\u00e9-entra\u00een\u00e9e ou clon\u00e9e)</li> <li>Ajuster les param\u00e8tres (vitesse, pitch)</li> <li>Cliquer sur \"Generate\"</li> <li>\u00c9couter et t\u00e9l\u00e9charger le r\u00e9sultat</li> </ol>"},{"location":"02-applications/ai-tts/neutts/#onglet-voice-cloning","title":"Onglet \"Voice Cloning\"","text":"<ol> <li>Uploader un \u00e9chantillon audio (6-30 secondes)</li> <li>Saisir le texte de l'\u00e9chantillon (transcription)</li> <li>Donner un nom \u00e0 la voix</li> <li>Cliquer sur \"Clone Voice\"</li> <li>Utiliser la voix clon\u00e9e dans l'onglet TTS</li> </ol>"},{"location":"02-applications/ai-tts/neutts/#onglet-batch-processing","title":"Onglet \"Batch Processing\"","text":"<ol> <li>Uploader un fichier CSV (text, output_filename)</li> <li>S\u00e9lectionner la voix</li> <li>Lancer le traitement</li> <li>T\u00e9l\u00e9charger l'archive ZIP</li> </ol>"},{"location":"02-applications/ai-tts/neutts/#api-rest","title":"API REST","text":"<p>Documentation: https://neutts-api.srv759970.hstgr.cloud/docs</p>"},{"location":"02-applications/ai-tts/neutts/#endpoints-principaux","title":"Endpoints Principaux","text":"<pre><code># TTS Simple\nPOST /api/v1/tts\nContent-Type: application/json\n{\n  \"text\": \"Bonjour, comment allez-vous ?\",\n  \"speaker\": \"default\",\n  \"language\": \"fr\",\n  \"speed\": 1.0\n}\n\n# TTS avec voix clon\u00e9e\nPOST /api/v1/tts/clone\nContent-Type: multipart/form-data\n{\n  \"text\": \"Texte \u00e0 synth\u00e9tiser\",\n  \"reference_audio\": &lt;file&gt;,\n  \"reference_text\": \"Transcription de l'audio\"\n}\n\n# Lister les voix disponibles\nGET /api/v1/voices\n\n# Upload voix clon\u00e9e\nPOST /api/v1/voices/upload\nContent-Type: multipart/form-data\n{\n  \"name\": \"my_voice\",\n  \"audio_file\": &lt;file&gt;,\n  \"transcript\": \"Texte de l'\u00e9chantillon\"\n}\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#exemples","title":"Exemples","text":"<p>Python: <pre><code>import requests\n\nAPI_URL = \"https://neutts-api.srv759970.hstgr.cloud/api/v1\"\n\n# Synth\u00e8se simple\nresponse = requests.post(\n    f\"{API_URL}/tts\",\n    json={\n        \"text\": \"Bonjour le monde !\",\n        \"speaker\": \"default\",\n        \"language\": \"fr\"\n    }\n)\n\n# Sauvegarder l'audio\nwith open(\"output.wav\", \"wb\") as f:\n    f.write(response.content)\n\n# Voice cloning\nwith open(\"voice_sample.wav\", \"rb\") as audio:\n    response = requests.post(\n        f\"{API_URL}/tts/clone\",\n        files={\"reference_audio\": audio},\n        data={\n            \"text\": \"Texte \u00e0 synth\u00e9tiser avec voix clon\u00e9e\",\n            \"reference_text\": \"Transcription de l'\u00e9chantillon audio\"\n        }\n    )\n\nwith open(\"cloned_output.wav\", \"wb\") as f:\n    f.write(response.content)\n</code></pre></p> <p>cURL: <pre><code># TTS simple\ncurl -X POST https://neutts-api.srv759970.hstgr.cloud/api/v1/tts \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"text\": \"Bonjour\", \"speaker\": \"default\", \"language\": \"fr\"}' \\\n  --output output.wav\n\n# Lister les voix\ncurl https://neutts-api.srv759970.hstgr.cloud/api/v1/voices\n\n# Voice cloning\ncurl -X POST https://neutts-api.srv759970.hstgr.cloud/api/v1/tts/clone \\\n  -F \"reference_audio=@voice_sample.wav\" \\\n  -F \"reference_text=Bonjour comment allez-vous\" \\\n  -F \"text=Texte \u00e0 synth\u00e9tiser\" \\\n  --output cloned.wav\n</code></pre></p> <p>JavaScript: <pre><code>// TTS avec Fetch API\nasync function synthesizeSpeech(text, speaker = 'default') {\n  const response = await fetch('https://neutts-api.srv759970.hstgr.cloud/api/v1/tts', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      text: text,\n      speaker: speaker,\n      language: 'fr'\n    })\n  });\n\n  const blob = await response.blob();\n  const url = URL.createObjectURL(blob);\n\n  // Jouer l'audio\n  const audio = new Audio(url);\n  audio.play();\n}\n\nsynthesizeSpeech(\"Bonjour le monde !\");\n</code></pre></p>"},{"location":"02-applications/ai-tts/neutts/#modeles-disponibles","title":"Mod\u00e8les Disponibles","text":""},{"location":"02-applications/ai-tts/neutts/#xtts-v2-recommande","title":"XTTS-v2 (Recommand\u00e9)","text":"<p>Caract\u00e9ristiques: - Multi-lingue (17 langues) - Voice cloning avec 6 secondes d'audio - Qualit\u00e9 studio - Latence: ~2-3 secondes</p> <p>Langues support\u00e9es: - Fran\u00e7ais, Anglais, Espagnol, Allemand, Italien - Portugais, Polonais, Turc, Russe, N\u00e9erlandais - Tch\u00e8que, Arabe, Chinois, Japonais, Hongrois, Cor\u00e9en, Hindi</p>"},{"location":"02-applications/ai-tts/neutts/#tacotron2-ddc","title":"Tacotron2-DDC","text":"<p>Caract\u00e9ristiques: - Haute qualit\u00e9 - Latence plus faible (~1 seconde) - Pas de voice cloning - N\u00e9cessite voix pr\u00e9-entra\u00een\u00e9e</p>"},{"location":"02-applications/ai-tts/neutts/#integrations","title":"Int\u00e9grations","text":""},{"location":"02-applications/ai-tts/neutts/#whisperx-neutts-boucle-stttts","title":"WhisperX + NeuTTS (Boucle STT\u2192TTS)","text":"<pre><code># Transcription \u2192 Traduction \u2192 TTS\nimport requests\n\n# 1. Transcription avec WhisperX\naudio_file = open(\"recording.mp3\", \"rb\")\ntranscription = requests.post(\n    \"https://whisperx.srv759970.hstgr.cloud/transcribe\",\n    files={\"file\": audio_file}\n).json()\n\n# 2. Synth\u00e8se avec NeuTTS\nsynthesized = requests.post(\n    \"https://neutts-api.srv759970.hstgr.cloud/api/v1/tts\",\n    json={\n        \"text\": transcription[\"text\"],\n        \"speaker\": \"default\",\n        \"language\": \"fr\"\n    }\n)\n\nwith open(\"synthesized.wav\", \"wb\") as f:\n    f.write(synthesized.content)\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#n8n-workflow","title":"n8n Workflow","text":"<pre><code>{\n  \"nodes\": [\n    {\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"parameters\": {\n        \"url\": \"https://neutts-api.srv759970.hstgr.cloud/api/v1/tts\",\n        \"method\": \"POST\",\n        \"jsonParameters\": true,\n        \"options\": {\n          \"response\": {\n            \"responseFormat\": \"file\"\n          }\n        },\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"text\",\n              \"value\": \"={{$json[\\\"text\\\"]}}\"\n            },\n            {\n              \"name\": \"speaker\",\n              \"value\": \"default\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#performance","title":"Performance","text":""},{"location":"02-applications/ai-tts/neutts/#benchmarks","title":"Benchmarks","text":"Mod\u00e8le Latence Qualit\u00e9 RAM GPU XTTS-v2 2-3s \u2b50\u2b50\u2b50\u2b50\u2b50 4GB Recommand\u00e9 Tacotron2 1s \u2b50\u2b50\u2b50\u2b50 2GB Optionnel"},{"location":"02-applications/ai-tts/neutts/#optimisations","title":"Optimisations","text":"<p>1. GPU Acceleration: <pre><code>deploy:\n  resources:\n    reservations:\n      devices:\n        - driver: nvidia\n          capabilities: [gpu]\n</code></pre></p> <p>2. Cache: <pre><code>environment:\n  - CACHE_ENABLED=true\n  - CACHE_TTL=3600\n</code></pre></p> <p>3. Batch Processing: <pre><code># G\u00e9n\u00e9rer plusieurs audios en parall\u00e8le\ntexts = [\"Texte 1\", \"Texte 2\", \"Texte 3\"]\nwith ThreadPoolExecutor(max_workers=3) as executor:\n    futures = [executor.submit(tts, text) for text in texts]\n</code></pre></p>"},{"location":"02-applications/ai-tts/neutts/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/ai-tts/neutts/#health-check","title":"Health Check","text":"<pre><code>curl https://neutts-api.srv759970.hstgr.cloud/health\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#logs","title":"Logs","text":"<pre><code># API logs\ndocker logs -f neutts-api\n\n# UI logs\ndocker logs -f neutts-ui\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#metriques","title":"M\u00e9triques","text":"<pre><code># Prometheus metrics sur /metrics\n- neutts_requests_total\n- neutts_generation_time_seconds\n- neutts_cache_hits_total\n- neutts_model_load_time_seconds\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/ai-tts/neutts/#synthese-lente","title":"Synth\u00e8se Lente","text":"<p>Activer GPU: <pre><code># V\u00e9rifier GPU disponible\ndocker exec neutts-api nvidia-smi\n\n# Si pas de GPU, optimiser CPU\nenvironment:\n  - NUM_THREADS=4\n  - USE_GPU=false\n</code></pre></p>"},{"location":"02-applications/ai-tts/neutts/#voice-cloning-de-mauvaise-qualite","title":"Voice Cloning de Mauvaise Qualit\u00e9","text":"<p>Am\u00e9liorer l'\u00e9chantillon: - Utiliser 10-15 secondes d'audio - Enregistrement propre (pas de bruit de fond) - Voix expressive et claire - Format WAV 22050 Hz recommand\u00e9</p>"},{"location":"02-applications/ai-tts/neutts/#erreurs-de-memoire","title":"Erreurs de M\u00e9moire","text":"<p>R\u00e9duire la longueur du texte: <pre><code>environment:\n  - MAX_TEXT_LENGTH=500\n  - BATCH_SIZE=1\n</code></pre></p>"},{"location":"02-applications/ai-tts/neutts/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/ai-tts/neutts/#protection","title":"Protection","text":"<ul> <li>\u2705 HTTPS - Let's Encrypt SSL/TLS</li> <li>\u2705 Rate Limiting - 100 req/min par IP</li> <li>\u2705 File Upload Limits - Max 30MB</li> <li>\u2705 Content-Type Validation - Audio formats uniquement</li> </ul>"},{"location":"02-applications/ai-tts/neutts/#recommandations","title":"Recommandations","text":"<ol> <li>\u2705 Limiter la longueur du texte (&lt; 1000 caract\u00e8res)</li> <li>\u2705 Valider les formats audio upload\u00e9s</li> <li>\u2705 Nettoyer les fichiers temporaires r\u00e9guli\u00e8rement</li> <li>\u26a0\ufe0f Consid\u00e9rer authentification pour API publique</li> </ol>"},{"location":"02-applications/ai-tts/neutts/#cas-dusage","title":"Cas d'Usage","text":""},{"location":"02-applications/ai-tts/neutts/#1-audiobooks","title":"1. Audiobooks","text":"<pre><code># Convertir livre en audio\nchapters = load_book_chapters()\nfor i, chapter in enumerate(chapters):\n    audio = synthesize(chapter, speaker=\"narrator\")\n    save_audio(f\"chapter_{i}.wav\", audio)\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#2-assistants-vocaux","title":"2. Assistants Vocaux","text":"<pre><code># R\u00e9ponse vocale chatbot\nuser_query = \"Quelle est la m\u00e9t\u00e9o ?\"\nresponse = chatbot.answer(user_query)\naudio = neutts_synthesize(response)\nplay_audio(audio)\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#3-accessibilite","title":"3. Accessibilit\u00e9","text":"<pre><code># Lecture de contenu web\nwebpage_text = extract_text(url)\naudio = neutts_synthesize(webpage_text)\nreturn audio_stream\n</code></pre>"},{"location":"02-applications/ai-tts/neutts/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>WhisperX - Transcription (STT)</li> <li>XTTS-v2 - Alternative TTS</li> <li>Ollama - LLM pour g\u00e9n\u00e9ration de texte</li> </ul>"},{"location":"02-applications/ai-tts/neutts/#liens-externes","title":"Liens Externes","text":"<ul> <li>Coqui TTS: https://github.com/coqui-ai/TTS</li> <li>XTTS-v2 Paper: https://arxiv.org/abs/2311.18271</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 Status: \ud83d\udfe2 Production</p>"},{"location":"02-applications/ai-tts/xtts/","title":"XTTS-v2 - Synth\u00e8se Vocale avec Clonage de Voix","text":""},{"location":"02-applications/ai-tts/xtts/#vue-densemble","title":"Vue d'ensemble","text":"<p>XTTS-v2 (eXtended Text-to-Speech) est un syst\u00e8me de synth\u00e8se vocale avanc\u00e9 avec capacit\u00e9 de clonage de voix d\u00e9velopp\u00e9 par Coqui AI. Il permet de g\u00e9n\u00e9rer de la parole dans 17 langues \u00e0 partir de seulement 6 secondes d'audio de r\u00e9f\u00e9rence.</p>"},{"location":"02-applications/ai-tts/xtts/#caracteristiques-principales","title":"Caract\u00e9ristiques principales","text":"<ul> <li>Clonage vocal ultra-rapide : 6-30 secondes d'audio suffisent</li> <li>Support multilingue : 17 langues dont fran\u00e7ais, anglais, espagnol, allemand, italien, arabe, chinois, japonais</li> <li>Qualit\u00e9 audio : 24kHz mono WAV</li> <li>Clonage cross-langue : Utilisez une voix en fran\u00e7ais pour parler en anglais</li> <li>API REST : FastAPI avec endpoints <code>/synthesize</code> et <code>/stream</code></li> <li>Interface web : Streamlit avec enregistrement vocal int\u00e9gr\u00e9</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Nginx (Reverse Proxy)                     \u2502\n\u2502  xtts-api.srv759970.hstgr.cloud + xtts.srv759970.hstgr.cloud\u2502\n\u2502                     SSL/TLS (Let's Encrypt)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502                      \u2502\n                 \u2502                      \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502   xtts-api      \u2502    \u2502 xtts-streamlit  \u2502\n        \u2502   Port: 8004    \u2502    \u2502  Port: 8501     \u2502\n        \u2502   FastAPI       \u2502    \u2502  Streamlit UI   \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  Prometheus Metrics (/metrics)      \u2502\n        \u2502  - Synthesis requests counter       \u2502\n        \u2502  - Duration histogram               \u2502\n        \u2502  - Audio size histogram             \u2502\n        \u2502  - Model loaded gauge               \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  Loki Logs (via Promtail)          \u2502\n        \u2502  - Container logs                   \u2502\n        \u2502  - API requests/errors              \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#endpoints-api","title":"Endpoints API","text":""},{"location":"02-applications/ai-tts/xtts/#get","title":"GET /","text":"<p>Informations g\u00e9n\u00e9rales sur l'API</p> <p>R\u00e9ponse : <pre><code>{\n  \"name\": \"XTTS-v2 API\",\n  \"version\": \"1.0.0\",\n  \"supported_languages\": [\"fr\", \"en\", \"es\", ...],\n  \"model_loaded\": true,\n  \"device\": \"cpu\"\n}\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#get-health","title":"GET /health","text":"<p>V\u00e9rification de l'\u00e9tat de sant\u00e9 de l'API</p> <p>R\u00e9ponse : <pre><code>{\n  \"status\": \"healthy\",\n  \"model_loaded\": true,\n  \"device\": \"cpu\"\n}\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#get-languages","title":"GET /languages","text":"<p>Liste compl\u00e8te des langues support\u00e9es</p> <p>R\u00e9ponse : <pre><code>{\n  \"supported_languages\": [\"fr\", \"en\", \"es\", \"de\", \"it\", \"pt\", \"pl\", \"tr\", \"ru\", \"nl\", \"cs\", \"ar\", \"zh\", \"hu\", \"ko\", \"ja\", \"hi\"],\n  \"count\": 17,\n  \"languages_details\": {\n    \"fr\": \"Fran\u00e7ais\",\n    \"en\": \"English\",\n    ...\n  }\n}\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#post-synthesize","title":"POST /synthesize","text":"<p>Synth\u00e8se vocale standard avec clonage de voix</p> <p>Param\u00e8tres (multipart/form-data) : - <code>text</code> (string, requis) : Texte \u00e0 synth\u00e9tiser - <code>language</code> (string, d\u00e9faut: \"fr\") : Code langue (fr, en, es, etc.) - <code>reference_audio</code> (file, requis) : Fichier audio de r\u00e9f\u00e9rence (WAV, MP3, FLAC)</p> <p>Exemple cURL : <pre><code>curl -X POST https://xtts-api.srv759970.hstgr.cloud/synthesize \\\n  -F \"text=Bonjour, ceci est un test de synth\u00e8se vocale\" \\\n  -F \"language=fr\" \\\n  -F \"reference_audio=@ma_voix.wav\" \\\n  -o resultat.wav\n</code></pre></p> <p>R\u00e9ponse : Fichier audio WAV 24kHz mono</p>"},{"location":"02-applications/ai-tts/xtts/#post-stream","title":"POST /stream","text":"<p>Synth\u00e8se vocale en mode streaming (optimis\u00e9 pour textes longs)</p> <p>Param\u00e8tres : - <code>text</code> (string, requis) - <code>language</code> (string, d\u00e9faut: \"fr\") - <code>reference_audio</code> (file, requis) - <code>enable_text_splitting</code> (bool, d\u00e9faut: true)</p> <p>Exemple cURL : <pre><code>curl -X POST https://xtts-api.srv759970.hstgr.cloud/stream \\\n  -F \"text=Texte tr\u00e8s long \u00e0 synth\u00e9tiser...\" \\\n  -F \"language=fr\" \\\n  -F \"reference_audio=@ma_voix.wav\" \\\n  -F \"enable_text_splitting=true\" \\\n  -o resultat_stream.wav\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#get-metrics","title":"GET /metrics","text":"<p>M\u00e9triques Prometheus pour le monitoring</p> <p>M\u00e9triques disponibles : - <code>xtts_synthesis_requests_total</code> : Nombre total de requ\u00eates (labels: language, endpoint, status) - <code>xtts_synthesis_duration_seconds</code> : Dur\u00e9e des synth\u00e8ses (histogram) - <code>xtts_audio_output_bytes</code> : Taille des fichiers g\u00e9n\u00e9r\u00e9s (histogram) - <code>xtts_model_loaded</code> : \u00c9tat du mod\u00e8le (1=charg\u00e9, 0=non charg\u00e9)</p>"},{"location":"02-applications/ai-tts/xtts/#interface-web-streamlit","title":"Interface Web Streamlit","text":"<p>L'interface Streamlit est accessible \u00e0 : https://xtts.srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-tts/xtts/#onglets-disponibles","title":"Onglets disponibles","text":""},{"location":"02-applications/ai-tts/xtts/#synthese-rapide","title":"\ud83c\udf99\ufe0f Synth\u00e8se Rapide","text":"<ul> <li>Upload d'audio de r\u00e9f\u00e9rence</li> <li>S\u00e9lection de langue</li> <li>Saisie de texte</li> <li>Choix du mode (Standard / Streaming)</li> <li>G\u00e9n\u00e9ration et t\u00e9l\u00e9chargement</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#enregistrer-ma-voix","title":"\ud83c\udfa4 Enregistrer ma Voix","text":"<ul> <li>Enregistrement vocal direct depuis le navigateur</li> <li>Utilise <code>st.audio_input()</code> (Streamlit 1.50.0+)</li> <li>Aper\u00e7u et t\u00e9l\u00e9chargement de l'enregistrement</li> <li>Test de clonage imm\u00e9diat</li> <li>Sauvegarde en session pour r\u00e9utilisation</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#lecture-de-texte","title":"\ud83d\udce2 Lecture de Texte","text":"<ul> <li>Faire lire n'importe quel texte</li> <li>Deux sources de voix :</li> <li>Voix enregistr\u00e9e (depuis l'onglet pr\u00e9c\u00e9dent)</li> <li>Upload de fichier</li> <li>Textes pr\u00e9-d\u00e9finis (conte, actualit\u00e9s, po\u00e9sie)</li> <li>Lecture et t\u00e9l\u00e9chargement du r\u00e9sultat</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#test-de-langues","title":"\ud83d\udcca Test de Langues","text":"<ul> <li>Test multi-langues simultan\u00e9</li> <li>M\u00eame audio de r\u00e9f\u00e9rence pour toutes les langues</li> <li>Textes de test pr\u00e9-configur\u00e9s par langue</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#parametres-avances","title":"\u2699\ufe0f Param\u00e8tres Avanc\u00e9s","text":"<ul> <li>Informations API</li> <li>Liste des langues</li> <li>Documentation endpoints</li> <li>Exemples cURL</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/ai-tts/xtts/#pre-requis","title":"Pr\u00e9-requis","text":"<ul> <li>Docker et Docker Compose</li> <li>Nginx avec SSL (Let's Encrypt)</li> <li>Prometheus, Grafana, Loki (monitoring)</li> <li>Minimum 4 GB RAM (8 GB recommand\u00e9)</li> <li>~2 GB d'espace disque pour le mod\u00e8le XTTS-v2</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#structure-des-fichiers","title":"Structure des fichiers","text":"<pre><code>/opt/coqui-tts/deploy/\n\u251c\u2500\u2500 api.py                  # FastAPI server\n\u251c\u2500\u2500 streamlit_app.py        # Interface Streamlit\n\u251c\u2500\u2500 Dockerfile              # Image Docker pour l'API\n\u251c\u2500\u2500 docker-compose.yml      # Orchestration des services\n\u251c\u2500\u2500 samples/                # Fichiers audio de test\n\u251c\u2500\u2500 outputs/                # Fichiers g\u00e9n\u00e9r\u00e9s\n\u2514\u2500\u2500 nginx-xtts.conf        # Configuration Nginx\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#installation","title":"Installation","text":"<ol> <li>Cloner le d\u00e9p\u00f4t local vers le serveur</li> </ol> <pre><code># Sur le serveur\nmkdir -p /opt/coqui-tts/deploy\ncd /opt/coqui-tts/deploy\n\n# Copier les fichiers depuis votre machine locale\nscp api.py streamlit_app.py Dockerfile docker-compose.yml root@srv759970:/opt/coqui-tts/deploy/\n</code></pre> <ol> <li>Cr\u00e9er les r\u00e9pertoires</li> </ol> <pre><code>mkdir -p samples outputs\n</code></pre> <ol> <li>D\u00e9marrer les services</li> </ol> <pre><code>docker-compose up -d\n</code></pre> <p>Le premier d\u00e9marrage t\u00e9l\u00e9charge le mod\u00e8le XTTS-v2 (1.87 GB) depuis Hugging Face. Cela prend 3-5 minutes.</p> <ol> <li>Configurer SSL avec Certbot</li> </ol> <pre><code># Certificat pour l'API\ncertbot certonly --nginx -d xtts-api.srv759970.hstgr.cloud\n\n# Certificat pour l'interface (utilise le m\u00eame certificat)\ncertbot certonly --nginx -d xtts.srv759970.hstgr.cloud \\\n  --cert-name xtts-api.srv759970.hstgr.cloud\n</code></pre> <ol> <li>Configurer Nginx</li> </ol> <pre><code># Copier la configuration\ncp nginx-xtts.conf /etc/nginx/sites-available/xtts\nln -s /etc/nginx/sites-available/xtts /etc/nginx/sites-enabled/\n\n# Tester et recharger\nnginx -t\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#verification-du-deploiement","title":"V\u00e9rification du d\u00e9ploiement","text":"<pre><code># V\u00e9rifier les conteneurs\ndocker ps --filter name=xtts\n\n# V\u00e9rifier les logs\ndocker logs xtts-api --tail 50\ndocker logs xtts-streamlit --tail 50\n\n# Tester l'API\ncurl -s https://xtts-api.srv759970.hstgr.cloud/health | jq .\n\n# Tester l'interface\ncurl -I https://xtts.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#configuration-docker","title":"Configuration Docker","text":""},{"location":"02-applications/ai-tts/xtts/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  xtts-api:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: xtts-api\n    restart: unless-stopped\n    ports:\n      - \"8004:8004\"\n    volumes:\n      - ./samples:/app/samples\n      - ./outputs:/app/outputs\n      - xtts-models:/app/models\n      - /root/.cache/huggingface:/root/.cache/huggingface\n    environment:\n      - PYTHONUNBUFFERED=1\n      - COQUI_TOS_AGREED=1\n      - HF_HOME=/root/.cache/huggingface\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8004/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 360s  # 6 minutes pour le chargement du mod\u00e8le\n    networks:\n      - xtts-network\n      - monitoring_monitoring\n    labels:\n      - \"prometheus.scrape=true\"\n      - \"prometheus.port=8004\"\n      - \"prometheus.path=/metrics\"\n\n  xtts-streamlit:\n    image: python:3.10-slim\n    container_name: xtts-streamlit\n    restart: unless-stopped\n    ports:\n      - \"8501:8501\"\n    volumes:\n      - ./streamlit_app.py:/app/streamlit_app.py\n      - ./samples:/app/samples\n    working_dir: /app\n    environment:\n      - XTTS_API_URL=http://xtts-api:8004\n    command: &gt;\n      sh -c \"pip install --no-cache-dir streamlit requests &amp;&amp;\n             streamlit run streamlit_app.py --server.port 8501 --server.address 0.0.0.0 --server.maxUploadSize 200\"\n    depends_on:\n      - xtts-api\n    networks:\n      - xtts-network\n\nvolumes:\n  xtts-models:\n    driver: local\n\nnetworks:\n  xtts-network:\n    name: xtts-network\n  monitoring_monitoring:\n    external: true\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#points-importants","title":"Points importants","text":"<ul> <li>start_period: 360s : Le mod\u00e8le XTTS-v2 prend 3-5 minutes \u00e0 charger. Le healthcheck attend 6 minutes avant de commencer les v\u00e9rifications.</li> <li>HF_HOME : Cache Hugging Face pour \u00e9viter de re-t\u00e9l\u00e9charger le mod\u00e8le</li> <li>monitoring_monitoring : R\u00e9seau externe pour Prometheus/Loki</li> <li>maxUploadSize: 200 : Permet l'upload de fichiers audio jusqu'\u00e0 200 MB</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/ai-tts/xtts/#ssltls","title":"SSL/TLS","text":"<ul> <li>Certificats Let's Encrypt via Certbot</li> <li>Renouvellement automatique : <code>certbot renew --dry-run</code></li> <li>Protocoles : TLS 1.2, TLS 1.3</li> <li>Ciphers : Configuration Mozilla Modern</li> </ul> <p>Configuration Nginx : <pre><code>ssl_certificate /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/privkey.pem;\ninclude /etc/letsencrypt/options-ssl-nginx.conf;\nssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#nginx-reverse-proxy","title":"Nginx (Reverse Proxy)","text":"<pre><code># API XTTS-v2\nserver {\n    listen 443 ssl http2;\n    server_name xtts-api.srv759970.hstgr.cloud;\n\n    # SSL configuration\n    ssl_certificate /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/privkey.pem;\n\n    access_log /var/log/nginx/xtts-api-access.log;\n    error_log /var/log/nginx/xtts-api-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:8004;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts pour synth\u00e8se longue\n        proxy_read_timeout 600;\n        proxy_connect_timeout 600;\n        proxy_send_timeout 600;\n\n        # Upload de fichiers audio\n        client_max_body_size 200M;\n    }\n}\n\n# Interface Streamlit\nserver {\n    listen 443 ssl http2;\n    server_name xtts.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/xtts-api.srv759970.hstgr.cloud/privkey.pem;\n\n    location / {\n        proxy_pass http://127.0.0.1:8501;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n\n        # WebSocket support for Streamlit\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_read_timeout 86400;\n        client_max_body_size 200M;\n    }\n\n    location /_stcore/stream {\n        proxy_pass http://127.0.0.1:8501/_stcore/stream;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#basic-auth-optionnel","title":"Basic Auth (optionnel)","text":"<p>Pour prot\u00e9ger l'interface Streamlit avec Basic Auth :</p> <pre><code>location / {\n    auth_basic \"XTTS-v2 Interface\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n\n    proxy_pass http://127.0.0.1:8501;\n    # ... reste de la config\n}\n</code></pre> <p>Cr\u00e9er le fichier .htpasswd : <pre><code>htpasswd -c /etc/nginx/.htpasswd username\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/ai-tts/xtts/#prometheus","title":"Prometheus","text":"<p>Le service XTTS-v2 expose des m\u00e9triques Prometheus sur <code>http://xtts-api:8004/metrics</code>.</p> <p>Configuration Prometheus (<code>/opt/monitoring/prometheus/prometheus.yml</code>) :</p> <pre><code>scrape_configs:\n  - job_name: 'xtts-api'\n    static_configs:\n      - targets: ['xtts-api:8004']\n        labels:\n          service: 'xtts'\n          env: 'production'\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: instance\n        replacement: 'xtts-api'\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#grafana","title":"Grafana","text":"<p>Dashboards recommand\u00e9s :</p> <p>1. XTTS-v2 Performance - Nombre de requ\u00eates par langue - Dur\u00e9e moyenne de synth\u00e8se - Taille moyenne des audios g\u00e9n\u00e9r\u00e9s - Taux d'erreur par endpoint</p> <p>Exemples de requ\u00eates PromQL :</p> <pre><code># Nombre de requ\u00eates par minute\nrate(xtts_synthesis_requests_total[5m])\n\n# Dur\u00e9e moyenne de synth\u00e8se par langue\nhistogram_quantile(0.95,\n  rate(xtts_synthesis_duration_seconds_bucket[5m])\n) by (language)\n\n# Taux d'erreur\nsum(rate(xtts_synthesis_requests_total{status=\"error\"}[5m]))\n/\nsum(rate(xtts_synthesis_requests_total[5m]))\n\n# Taille moyenne des fichiers audio\navg(rate(xtts_audio_output_bytes_sum[5m]))\n</code></pre> <p>2. XTTS-v2 Health - \u00c9tat du mod\u00e8le (charg\u00e9/non charg\u00e9) - Statut des conteneurs - Utilisation CPU/RAM - Logs d'erreur</p>"},{"location":"02-applications/ai-tts/xtts/#loki","title":"Loki","text":"<p>Les logs des conteneurs sont collect\u00e9s via Promtail et envoy\u00e9s \u00e0 Loki.</p> <p>Configuration Promtail (<code>/opt/monitoring/loki/promtail-config.yml</code>) :</p> <pre><code>scrape_configs:\n  - job_name: xtts\n    static_configs:\n      - targets:\n          - localhost\n        labels:\n          job: xtts-logs\n          __path__: /var/lib/docker/containers/*-xtts-*/*.log\n    pipeline_stages:\n      - json:\n          expressions:\n            output: log\n            stream: stream\n            attrs: attrs\n      - labels:\n          stream:\n</code></pre> <p>Requ\u00eates LogQL utiles :</p> <pre><code># Erreurs dans les logs XTTS\n{job=\"xtts-logs\"} |= \"ERROR\"\n\n# Requ\u00eates de synth\u00e8se\n{job=\"xtts-logs\"} |= \"Synthesizing text\"\n\n# Temps de chargement du mod\u00e8le\n{job=\"xtts-logs\"} |= \"Model loaded successfully\"\n\n# Erreurs HTTP 500\n{job=\"xtts-logs\"} |= \"status_code=500\"\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#performance","title":"Performance","text":""},{"location":"02-applications/ai-tts/xtts/#benchmarks","title":"Benchmarks","text":"<p>Sur un serveur CPU (sans GPU) :</p> Dur\u00e9e texte Temps synth\u00e8se Ratio temps r\u00e9el 10s ~30-60s 3-6x 30s ~90-180s 3-6x 60s ~180-360s 3-6x <p>Sur un serveur GPU (NVIDIA) :</p> Dur\u00e9e texte Temps synth\u00e8se Ratio temps r\u00e9el 10s ~3-10s 0.3-1x 30s ~9-30s 0.3-1x 60s ~18-60s 0.3-1x"},{"location":"02-applications/ai-tts/xtts/#optimisations","title":"Optimisations","text":"<ol> <li>GPU : Pour des performances optimales, d\u00e9commenter la section GPU dans <code>docker-compose.yml</code> :</li> </ol> <pre><code>deploy:\n  resources:\n    reservations:\n      devices:\n        - driver: nvidia\n          count: 1\n          capabilities: [gpu]\n</code></pre> <ol> <li> <p>Cache mod\u00e8le : Le mod\u00e8le est mis en cache dans <code>/root/.cache/huggingface</code> pour \u00e9viter les re-t\u00e9l\u00e9chargements</p> </li> <li> <p>Streaming : Pour les textes longs (&gt;200 mots), utilisez <code>/stream</code> au lieu de <code>/synthesize</code></p> </li> </ol>"},{"location":"02-applications/ai-tts/xtts/#depannage","title":"D\u00e9pannage","text":""},{"location":"02-applications/ai-tts/xtts/#le-modele-ne-se-charge-pas","title":"Le mod\u00e8le ne se charge pas","text":"<p>Sympt\u00f4me : <code>model_loaded: false</code> dans <code>/health</code></p> <p>Solution : <pre><code># V\u00e9rifier les logs\ndocker logs xtts-api --tail 100\n\n# Red\u00e9marrer le conteneur\ndocker-compose restart xtts-api\n\n# V\u00e9rifier l'espace disque\ndf -h\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#container-restart-loop","title":"Container restart loop","text":"<p>Sympt\u00f4me : Le conteneur red\u00e9marre en boucle</p> <p>Cause : Healthcheck d\u00e9marre trop t\u00f4t (avant le chargement du mod\u00e8le)</p> <p>Solution : Augmenter <code>start_period</code> dans <code>docker-compose.yml</code> : <pre><code>healthcheck:\n  start_period: 480s  # 8 minutes au lieu de 6\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#erreur-model-download-failed","title":"Erreur \"Model download failed\"","text":"<p>Cause : Probl\u00e8me de connexion \u00e0 Hugging Face</p> <p>Solution : <pre><code># Tester la connexion\ncurl -I https://huggingface.co\n\n# V\u00e9rifier le cache\nls -lh /root/.cache/huggingface/\n\n# Nettoyer et ret\u00e9l\u00e9charger\nrm -rf /root/.cache/huggingface/hub/models--coqui--XTTS-v2\ndocker-compose restart xtts-api\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#synthese-tres-lente-cpu","title":"Synth\u00e8se tr\u00e8s lente (CPU)","text":"<p>Cause : Pas de GPU disponible</p> <p>Solutions : - Ajouter un GPU NVIDIA - Utiliser un serveur avec GPU (recommand\u00e9 pour production) - Accepter le temps de traitement (~3-6x le temps r\u00e9el sur CPU)</p>"},{"location":"02-applications/ai-tts/xtts/#erreur-audio-file-too-large","title":"Erreur \"Audio file too large\"","text":"<p>Cause : <code>client_max_body_size</code> trop petit dans Nginx</p> <p>Solution : <pre><code>location / {\n    client_max_body_size 200M;  # Augmenter si besoin\n    # ...\n}\n</code></pre></p> <p>Puis recharger Nginx : <pre><code>nginx -t &amp;&amp; systemctl reload nginx\n</code></pre></p>"},{"location":"02-applications/ai-tts/xtts/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/ai-tts/xtts/#mise-a-jour-du-modele","title":"Mise \u00e0 jour du mod\u00e8le","text":"<pre><code># Supprimer le cache\nrm -rf /root/.cache/huggingface/hub/models--coqui--XTTS-v2\n\n# Red\u00e9marrer (re-t\u00e9l\u00e9charge automatiquement)\ndocker-compose restart xtts-api\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#sauvegarde","title":"Sauvegarde","text":"<p>Fichiers \u00e0 sauvegarder : - <code>/opt/coqui-tts/deploy/</code> : Configuration et code - <code>/opt/coqui-tts/deploy/samples/</code> : Fichiers audio de r\u00e9f\u00e9rence - Configuration Nginx : <code>/etc/nginx/sites-available/xtts</code></p> <p>Pas besoin de sauvegarder : - <code>/root/.cache/huggingface/</code> : Peut \u00eatre re-t\u00e9l\u00e9charg\u00e9 - <code>/opt/coqui-tts/deploy/outputs/</code> : Fichiers temporaires</p>"},{"location":"02-applications/ai-tts/xtts/#restauration","title":"Restauration","text":"<pre><code># Restaurer les fichiers\nrsync -av backup/coqui-tts/ /opt/coqui-tts/\n\n# Restaurer Nginx\ncp backup/nginx/xtts /etc/nginx/sites-available/\nln -sf /etc/nginx/sites-available/xtts /etc/nginx/sites-enabled/\n\n# Red\u00e9marrer\ndocker-compose up -d\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"02-applications/ai-tts/xtts/#licence-et-limitations","title":"Licence et Limitations","text":""},{"location":"02-applications/ai-tts/xtts/#coqui-public-model-license-cpml","title":"Coqui Public Model License (CPML)","text":"<p>XTTS-v2 utilise la licence Coqui Public Model License qui impose des restrictions :</p> <ul> <li>\u2705 Autoris\u00e9 : Usage personnel, recherche, \u00e9ducation, prototypage</li> <li>\u274c Non autoris\u00e9 : Usage commercial sans licence commerciale</li> <li>\u26a0\ufe0f Restriction : Pas d'utilisation pour g\u00e9n\u00e9rer des revenus sans accord explicite</li> </ul> <p>Pour un usage commercial, contacter Idiap Research Institute qui maintient le fork PyPI.</p>"},{"location":"02-applications/ai-tts/xtts/#alternatives-commerciales","title":"Alternatives commerciales","text":"<p>Si vous avez besoin d'une licence commerciale :</p> <ol> <li>ElevenLabs : TTS cloud avec clonage vocal (API payante)</li> <li>PlayHT : Service cloud similaire</li> <li>Coqui Studio : Version commerciale (si disponible)</li> </ol>"},{"location":"02-applications/ai-tts/xtts/#ressources","title":"Ressources","text":""},{"location":"02-applications/ai-tts/xtts/#documentation-officielle","title":"Documentation officielle","text":"<ul> <li>Coqui TTS (archived) : https://github.com/coqui-ai/TTS</li> <li>Idiap Fork (maintained) : https://github.com/idiap/coqui-ai-TTS</li> <li>PyPI Package : https://pypi.org/project/coqui-tts/</li> <li>Hugging Face Model : https://huggingface.co/coqui/XTTS-v2</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#exemples-et-tutoriels","title":"Exemples et Tutoriels","text":"<ul> <li>Google Colab Demo : https://colab.research.google.com/github/coqui-ai/TTS/blob/dev/notebooks/XTTS_v2_demo.ipynb</li> <li>Paper XTTS : https://arxiv.org/abs/2406.04904</li> </ul>"},{"location":"02-applications/ai-tts/xtts/#support","title":"Support","text":"<p>Pour des questions sur le d\u00e9ploiement sur srv759970 : - Consulter les logs : <code>docker logs xtts-api</code> - V\u00e9rifier Grafana : https://grafana.srv759970.hstgr.cloud - Consulter la documentation : https://docs.srv759970.hstgr.cloud</p>"},{"location":"02-applications/ai-tts/xtts/#changelog","title":"Changelog","text":""},{"location":"02-applications/ai-tts/xtts/#v100-2025-10-21","title":"v1.0.0 (2025-10-21)","text":"<ul> <li>D\u00e9ploiement initial XTTS-v2</li> <li>FastAPI avec endpoints <code>/synthesize</code> et <code>/stream</code></li> <li>Interface Streamlit avec 5 onglets</li> <li>Enregistrement vocal direct depuis le navigateur</li> <li>Lecture de texte avec voix upload\u00e9e ou enregistr\u00e9e</li> <li>Support de 17 langues</li> <li>Int\u00e9gration Prometheus/Grafana/Loki</li> <li>SSL/TLS avec Let's Encrypt</li> <li>Nginx reverse proxy</li> <li>Healthcheck avec <code>start_period: 360s</code></li> </ul>"},{"location":"02-applications/automation/n8n/","title":"n8n - Workflow Automation &amp; Integration","text":"<p>Type: Workflow Automation Platform URL: https://n8n.srv759970.hstgr.cloud Port interne: 5678 Authentification: Basic Auth (cf. <code>/etc/nginx/.htpasswd</code>)</p>"},{"location":"02-applications/automation/n8n/#vue-densemble","title":"Vue d'Ensemble","text":"<p>n8n est une plateforme d'automatisation de workflows puissante et extensible qui permet de connecter diff\u00e9rents services et APIs ensemble. Alternative open-source \u00e0 Zapier et Integromat (Make), n8n offre une interface visuelle pour cr\u00e9er des automatisations complexes.</p>"},{"location":"02-applications/automation/n8n/#caracteristiques-principales","title":"Caract\u00e9ristiques Principales","text":"<ul> <li>Interface visuelle - \u00c9diteur de workflows par glisser-d\u00e9poser</li> <li>400+ int\u00e9grations - Connecteurs pr\u00e9-construits pour les services populaires</li> <li>Webhooks - D\u00e9clenchement via HTTP/HTTPS</li> <li>Cron Jobs - Ex\u00e9cution programm\u00e9e</li> <li>JavaScript - Code personnalis\u00e9 dans les workflows</li> <li>Self-hosted - Contr\u00f4le total des donn\u00e9es</li> <li>API REST - Gestion programmatique des workflows</li> <li>Ex\u00e9cution asynchrone - Support des t\u00e2ches longues</li> </ul>"},{"location":"02-applications/automation/n8n/#acces","title":"Acc\u00e8s","text":""},{"location":"02-applications/automation/n8n/#interface-web","title":"Interface Web","text":"<p>URL principale: https://n8n.srv759970.hstgr.cloud</p> <p>Authentification: - M\u00e9thode: HTTP Basic Auth (nginx) - Fichier: <code>/etc/nginx/.htpasswd</code> - Utilisateurs configur\u00e9s: voir avec l'administrateur</p>"},{"location":"02-applications/automation/n8n/#api-rest","title":"API REST","text":"<p>Base URL: https://n8n.srv759970.hstgr.cloud/api/v1</p> <p>Exemple - Lister les workflows: <pre><code>curl -u username:password https://n8n.srv759970.hstgr.cloud/api/v1/workflows\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Internet                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502 HTTPS (443)\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         Nginx Reverse Proxy + Basic Auth           \u2502\n\u2502         /etc/nginx/sites-available/n8n             \u2502\n\u2502                                                     \u2502\n\u2502  \u2022 SSL: Let's Encrypt                              \u2502\n\u2502  \u2022 Basic Auth: .htpasswd                           \u2502\n\u2502  \u2022 Headers: WebSocket support                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502 HTTP\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            n8n Container (Port 5678)                \u2502\n\u2502            /opt/n8n/docker-compose.yml              \u2502\n\u2502                                                     \u2502\n\u2502  \u2022 Image: n8nio/n8n:latest                         \u2502\n\u2502  \u2022 Data: /opt/n8n/data                             \u2502\n\u2502  \u2022 Files: /opt/n8n/files                           \u2502\n\u2502  \u2022 Execution Mode: main                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/automation/n8n/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/automation/n8n/#docker-compose","title":"Docker Compose","text":"<p>Emplacement: <code>/opt/n8n/docker-compose.yml</code></p> <pre><code>version: '3.8'\n\nservices:\n  n8n:\n    image: n8nio/n8n:latest\n    container_name: n8n\n    restart: unless-stopped\n    ports:\n      - '127.0.0.1:5678:5678'\n    environment:\n      - N8N_HOST=n8n.srv759970.hstgr.cloud\n      - N8N_PROTOCOL=https\n      - N8N_PORT=5678\n      - WEBHOOK_URL=https://n8n.srv759970.hstgr.cloud/\n      - GENERIC_TIMEZONE=Europe/Paris\n      - N8N_LOG_LEVEL=info\n    volumes:\n      - /opt/n8n/data:/home/node/.n8n\n      - /opt/n8n/files:/files\n    user: \"1000:1000\"\n</code></pre>"},{"location":"02-applications/automation/n8n/#commandes-docker","title":"Commandes Docker","text":"<p>D\u00e9marrage: <pre><code>cd /opt/n8n\ndocker-compose up -d\n</code></pre></p> <p>Arr\u00eat: <pre><code>cd /opt/n8n\ndocker-compose down\n</code></pre></p> <p>Red\u00e9marrage: <pre><code>cd /opt/n8n\ndocker-compose restart\n</code></pre></p> <p>Logs: <pre><code># Logs en temps r\u00e9el\ndocker logs -f n8n\n\n# Derni\u00e8res 100 lignes\ndocker logs n8n --tail 100\n</code></pre></p> <p>Rebuild (apr\u00e8s mise \u00e0 jour): <pre><code>cd /opt/n8n\ndocker-compose pull\ndocker-compose up -d\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#configuration-nginx","title":"Configuration Nginx","text":"<p>Fichier: <code>/etc/nginx/sites-available/n8n</code></p>"},{"location":"02-applications/automation/n8n/#configuration-https","title":"Configuration HTTPS","text":"<pre><code># HTTPS - n8n Workflow Automation\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name n8n.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/n8n.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/n8n.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/n8n-access.log;\n    error_log /var/log/nginx/n8n-error.log;\n\n    # Basic Auth protection\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://127.0.0.1:5678;\n        proxy_http_version 1.1;\n\n        # Headers pour WebSockets\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        # Headers standards\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts pour workflows longs\n        proxy_read_timeout 600s;\n        proxy_connect_timeout 600s;\n        proxy_send_timeout 600s;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name n8n.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Activer la configuration: <pre><code>ln -sf /etc/nginx/sites-available/n8n /etc/nginx/sites-enabled/\nnginx -t\nsystemctl reload nginx\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#variables-denvironnement","title":"Variables d'Environnement","text":""},{"location":"02-applications/automation/n8n/#variables-essentielles","title":"Variables Essentielles","text":"Variable Valeur Description <code>N8N_HOST</code> n8n.srv759970.hstgr.cloud Hostname du serveur <code>N8N_PROTOCOL</code> https Protocole d'acc\u00e8s <code>N8N_PORT</code> 5678 Port interne <code>WEBHOOK_URL</code> https://n8n.srv759970.hstgr.cloud/ URL des webhooks <code>GENERIC_TIMEZONE</code> Europe/Paris Timezone pour les cron jobs <code>N8N_LOG_LEVEL</code> info Niveau de logs"},{"location":"02-applications/automation/n8n/#variables-optionnelles","title":"Variables Optionnelles","text":"<p>Authentification (si besoin d'un second niveau): <pre><code>- N8N_BASIC_AUTH_ACTIVE=true\n- N8N_BASIC_AUTH_USER=admin\n- N8N_BASIC_AUTH_PASSWORD=secure_password\n</code></pre></p> <p>Base de donn\u00e9es externe (PostgreSQL): <pre><code>- DB_TYPE=postgresdb\n- DB_POSTGRESDB_HOST=postgresql-shared\n- DB_POSTGRESDB_PORT=5432\n- DB_POSTGRESDB_DATABASE=n8n\n- DB_POSTGRESDB_USER=n8n_user\n- DB_POSTGRESDB_PASSWORD=password\n</code></pre></p> <p>Ex\u00e9cution en mode queue: <pre><code>- EXECUTIONS_MODE=queue\n- QUEUE_BULL_REDIS_HOST=redis-shared\n- QUEUE_BULL_REDIS_PORT=6379\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/automation/n8n/#creer-un-workflow-simple","title":"Cr\u00e9er un Workflow Simple","text":"<ol> <li>Acc\u00e9der \u00e0 n8n: https://n8n.srv759970.hstgr.cloud</li> <li>Cr\u00e9er un nouveau workflow - Cliquer sur \"+ New workflow\"</li> <li>Ajouter un trigger - Ex: \"Webhook\", \"Cron\", \"Manual\"</li> <li>Ajouter des nodes - Ex: \"HTTP Request\", \"Set\", \"IF\"</li> <li>Connecter les nodes - Glisser-d\u00e9poser entre les points de connexion</li> <li>Configurer chaque node - Param\u00e8tres et donn\u00e9es</li> <li>Tester - Bouton \"Execute Workflow\"</li> <li>Activer - Toggle \"Active\" en haut \u00e0 droite</li> </ol>"},{"location":"02-applications/automation/n8n/#exemples-de-workflows","title":"Exemples de Workflows","text":""},{"location":"02-applications/automation/n8n/#1-webhook-vers-discord","title":"1. Webhook vers Discord","text":"<pre><code>Webhook (Trigger)\n  \u2192 Set (Formatter les donn\u00e9es)\n  \u2192 HTTP Request (POST vers Discord webhook)\n</code></pre> <p>Configuration Webhook: - Method: POST - Path: /webhook/discord-notification</p> <p>Configuration HTTP Request: - Method: POST - URL: https://discord.com/api/webhooks/YOUR_WEBHOOK_ID - Body: JSON avec le message</p>"},{"location":"02-applications/automation/n8n/#2-transcription-automatique","title":"2. Transcription Automatique","text":"<pre><code>Webhook (Receive audio file URL)\n  \u2192 HTTP Request (Download audio)\n  \u2192 HTTP Request (POST to WhisperX)\n  \u2192 Set (Format transcript)\n  \u2192 HTTP Request (Send results)\n</code></pre>"},{"location":"02-applications/automation/n8n/#3-surveillance-de-services","title":"3. Surveillance de Services","text":"<pre><code>Cron (Every 5 minutes)\n  \u2192 HTTP Request (Check service health)\n  \u2192 IF (Status != 200)\n    \u2192 HTTP Request (Send alert to Rocket.Chat)\n</code></pre>"},{"location":"02-applications/automation/n8n/#integrations-disponibles","title":"Int\u00e9grations Disponibles","text":"<p>Services IA: - Ollama (LLM local) - OpenAI - Anthropic Claude - Hugging Face</p> <p>Transcription: - WhisperX API (local) - Faster-Whisper Queue - Whisper.cpp</p> <p>Communication: - Rocket.Chat - Discord - Slack - Telegram - Email (SMTP/SendGrid)</p> <p>Stockage: - Nextcloud - Paperless-ngx (webhooks) - S3 compatible - Local filesystem</p> <p>Bases de donn\u00e9es: - PostgreSQL (local) - MongoDB (local) - Redis (local) - MySQL</p> <p>Outils: - HTTP Request (universel) - Code (JavaScript/Python) - Webhook - Cron</p>"},{"location":"02-applications/automation/n8n/#webhooks","title":"Webhooks","text":""},{"location":"02-applications/automation/n8n/#url-des-webhooks","title":"URL des Webhooks","text":"<p>Format: <code>https://n8n.srv759970.hstgr.cloud/webhook/&lt;webhook-path&gt;</code></p> <p>Exemple: <pre><code>curl -X POST https://n8n.srv759970.hstgr.cloud/webhook/my-workflow \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"Hello from external system\"}'\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#webhooks-de-test-vs-production","title":"Webhooks de Test vs Production","text":"<ul> <li>Test: <code>/webhook-test/&lt;path&gt;</code> - Ex\u00e9cution unique pour debug</li> <li>Production: <code>/webhook/&lt;path&gt;</code> - Workflow activ\u00e9 en permanence</li> </ul>"},{"location":"02-applications/automation/n8n/#authentification-des-webhooks","title":"Authentification des Webhooks","text":"<p>Option 1 - Header Authorization: <pre><code>// Dans le node Webhook, activer \"Authentication\"\nheaders: {\n  \"Authorization\": \"Bearer your-secret-token\"\n}\n</code></pre></p> <p>Option 2 - Query parameter: <pre><code>curl https://n8n.srv759970.hstgr.cloud/webhook/secure?token=SECRET\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#integrations-avec-les-services-srv759970","title":"Int\u00e9grations avec les Services srv759970","text":""},{"location":"02-applications/automation/n8n/#1-transcription-avec-whisperx","title":"1. Transcription avec WhisperX","text":"<p>Workflow: Upload audio \u2192 Transcription \u2192 Stockage</p> <pre><code>Nodes:\n  1. Webhook (Receive audio URL)\n  2. HTTP Request (POST to https://whisperx.srv759970.hstgr.cloud/transcribe)\n     - Headers: {\"Content-Type\": \"multipart/form-data\"}\n     - Body: File from previous node\n  3. Set (Extract transcript)\n  4. HTTP Request (Save to Paperless-ngx or Nextcloud)\n</code></pre>"},{"location":"02-applications/automation/n8n/#2-document-ocr-avec-paperless","title":"2. Document OCR avec Paperless","text":"<p>Workflow: Upload PDF \u2192 Paperless \u2192 Webhook callback</p> <pre><code>Nodes:\n  1. Webhook (Receive document)\n  2. HTTP Request (POST to Paperless-ngx API)\n  3. Wait (Wait for OCR completion)\n  4. HTTP Request (Get processed document)\n  5. Notification (Rocket.Chat or Email)\n</code></pre>"},{"location":"02-applications/automation/n8n/#3-monitoring-avec-grafana","title":"3. Monitoring avec Grafana","text":"<p>Workflow: Cron \u2192 Check services \u2192 Alert si down</p> <pre><code>Nodes:\n  1. Cron (Every 5 minutes)\n  2. HTTP Request (Check /health endpoints)\n  3. IF (Status != healthy)\n  4. HTTP Request (Create Grafana annotation)\n  5. HTTP Request (Send alert to Rocket.Chat)\n</code></pre>"},{"location":"02-applications/automation/n8n/#4-synthese-vocale-avec-xtts","title":"4. Synth\u00e8se Vocale avec XTTS","text":"<p>Workflow: Texte \u2192 TTS \u2192 Audio file</p> <pre><code>Nodes:\n  1. Webhook (Receive text)\n  2. HTTP Request (POST to https://xtts-api.srv759970.hstgr.cloud/tts)\n  3. Binary Data (Save audio)\n  4. HTTP Request (Upload to Nextcloud)\n  5. Response (Return download URL)\n</code></pre>"},{"location":"02-applications/automation/n8n/#monitoring-logs","title":"Monitoring &amp; Logs","text":""},{"location":"02-applications/automation/n8n/#logs-docker","title":"Logs Docker","text":"<p>Voir les logs en temps r\u00e9el: <pre><code>docker logs -f n8n\n</code></pre></p> <p>Filtrer par niveau: <pre><code>docker logs n8n 2&gt;&amp;1 | grep ERROR\ndocker logs n8n 2&gt;&amp;1 | grep WARN\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#logs-nginx","title":"Logs Nginx","text":"<p>Access logs: <pre><code>tail -f /var/log/nginx/n8n-access.log\n</code></pre></p> <p>Error logs: <pre><code>tail -f /var/log/nginx/n8n-error.log\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#metriques-dexecution","title":"M\u00e9triques d'Ex\u00e9cution","text":"<p>Dans l'interface n8n: - Executions - Liste toutes les ex\u00e9cutions - Workflows - Statut actif/inactif - Credentials - Connexions configur\u00e9es</p> <p>Via logs Docker: <pre><code># Compter les ex\u00e9cutions r\u00e9ussies\ndocker logs n8n 2&gt;&amp;1 | grep \"Workflow execution finished\" | wc -l\n\n# Compter les erreurs\ndocker logs n8n 2&gt;&amp;1 | grep \"Workflow execution error\" | wc -l\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#backup-restauration","title":"Backup &amp; Restauration","text":""},{"location":"02-applications/automation/n8n/#backup-des-donnees","title":"Backup des Donn\u00e9es","text":"<p>R\u00e9pertoires \u00e0 sauvegarder: <pre><code>/opt/n8n/data/          # Base de donn\u00e9es SQLite et configurations\n/opt/n8n/files/         # Fichiers upload\u00e9s dans les workflows\n</code></pre></p> <p>Script de backup: <pre><code>#!/bin/bash\nBACKUP_DIR=\"/backup/n8n/$(date +%Y%m%d_%H%M%S)\"\nmkdir -p \"$BACKUP_DIR\"\n\n# Arr\u00eater n8n temporairement\ncd /opt/n8n &amp;&amp; docker-compose stop\n\n# Copier les donn\u00e9es\ncp -r /opt/n8n/data \"$BACKUP_DIR/\"\ncp -r /opt/n8n/files \"$BACKUP_DIR/\"\ncp /opt/n8n/docker-compose.yml \"$BACKUP_DIR/\"\n\n# Red\u00e9marrer n8n\ncd /opt/n8n &amp;&amp; docker-compose start\n\necho \"Backup saved to $BACKUP_DIR\"\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#restauration","title":"Restauration","text":"<pre><code># Arr\u00eater n8n\ncd /opt/n8n &amp;&amp; docker-compose down\n\n# Restaurer depuis backup\nBACKUP_PATH=\"/backup/n8n/20251023_120000\"\nrm -rf /opt/n8n/data /opt/n8n/files\ncp -r \"$BACKUP_PATH/data\" /opt/n8n/\ncp -r \"$BACKUP_PATH/files\" /opt/n8n/\n\n# V\u00e9rifier les permissions\nchown -R 1000:1000 /opt/n8n/data /opt/n8n/files\n\n# Red\u00e9marrer\ncd /opt/n8n &amp;&amp; docker-compose up -d\n</code></pre>"},{"location":"02-applications/automation/n8n/#exportimport-de-workflows","title":"Export/Import de Workflows","text":"<p>Export d'un workflow: 1. Ouvrir le workflow dans n8n 2. Menu \"...\" \u2192 \"Download\" 3. Fichier JSON t\u00e9l\u00e9charg\u00e9</p> <p>Import d'un workflow: 1. Page d'accueil n8n 2. \"Import from File\" 3. S\u00e9lectionner le fichier JSON</p> <p>Export via CLI: <pre><code># Copier la base de donn\u00e9es\ndocker cp n8n:/home/node/.n8n/database.sqlite /tmp/n8n-backup.sqlite\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#mise-a-jour","title":"Mise \u00e0 Jour","text":""},{"location":"02-applications/automation/n8n/#update-de-limage-docker","title":"Update de l'Image Docker","text":"<pre><code>cd /opt/n8n\n\n# Pull la derni\u00e8re version\ndocker-compose pull\n\n# Red\u00e9marrer avec la nouvelle image\ndocker-compose up -d\n\n# V\u00e9rifier les logs\ndocker logs n8n --tail 50\n</code></pre>"},{"location":"02-applications/automation/n8n/#versions-specifiques","title":"Versions Sp\u00e9cifiques","text":"<p>Modifier docker-compose.yml: <pre><code>services:\n  n8n:\n    image: n8nio/n8n:1.58.0  # Version sp\u00e9cifique au lieu de :latest\n</code></pre></p> <p>Appliquer: <pre><code>cd /opt/n8n\ndocker-compose up -d\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/automation/n8n/#protection-par-basic-auth-nginx","title":"Protection par Basic Auth (Nginx)","text":"<p>D\u00e9j\u00e0 configur\u00e9e via <code>include snippets/basic-auth.conf</code></p> <p>Ajouter/modifier des utilisateurs: <pre><code># Ajouter un utilisateur\nhtpasswd /etc/nginx/.htpasswd newuser\n\n# Modifier un mot de passe\nhtpasswd /etc/nginx/.htpasswd existinguser\n\n# Supprimer un utilisateur\nhtpasswd -D /etc/nginx/.htpasswd olduser\n\n# Recharger nginx\nsystemctl reload nginx\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#credentials-dans-n8n","title":"Credentials dans n8n","text":"<p>Bonnes pratiques: - Ne jamais hardcoder les credentials dans les workflows - Utiliser le syst\u00e8me de \"Credentials\" de n8n - Stocker les secrets dans des variables d'environnement</p> <p>Exemple - Configurer une API key: 1. Settings \u2192 Credentials \u2192 Add Credential 2. Choisir le type (HTTP Header Auth, OAuth2, etc.) 3. Nom: \"Ollama API\" 4. Configuration selon le type 5. Save</p>"},{"location":"02-applications/automation/n8n/#webhooks-securises","title":"Webhooks S\u00e9curis\u00e9s","text":"<p>M\u00e9thode 1 - Token dans l'URL: <pre><code>// Dans le workflow, v\u00e9rifier le token\n{{ $json.query.token === 'SECRET_TOKEN' }}\n</code></pre></p> <p>M\u00e9thode 2 - Header Authorization: <pre><code>// Node Webhook \u2192 Authentication \u2192 Header Auth\n{{ $json.headers.authorization === 'Bearer SECRET_TOKEN' }}\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/automation/n8n/#n8n-ne-demarre-pas","title":"n8n ne d\u00e9marre pas","text":"<p>V\u00e9rifier les logs: <pre><code>docker logs n8n\n</code></pre></p> <p>Erreurs courantes:</p> <p>1. Permission denied: <pre><code># Fix: V\u00e9rifier les permissions\nls -la /opt/n8n/data\nchown -R 1000:1000 /opt/n8n/data /opt/n8n/files\n</code></pre></p> <p>2. Port d\u00e9j\u00e0 utilis\u00e9: <pre><code># V\u00e9rifier qui utilise le port 5678\nss -tlnp | grep 5678\n\n# Modifier le port dans docker-compose.yml si n\u00e9cessaire\n</code></pre></p> <p>3. Erreur de base de donn\u00e9es: <pre><code># Supprimer la base corrompue (\u26a0\ufe0f perte de donn\u00e9es!)\nrm /opt/n8n/data/database.sqlite\ndocker-compose restart\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#workflows-ne-sexecutent-pas","title":"Workflows ne s'ex\u00e9cutent pas","text":"<p>V\u00e9rifier: 1. Le workflow est-il activ\u00e9? (Toggle \"Active\") 2. Les credentials sont-elles valides? 3. Les URLs des APIs sont-elles correctes? 4. Les logs d'ex\u00e9cution (page \"Executions\")</p> <p>Debug mode: <pre><code># Ajouter dans docker-compose.yml\nenvironment:\n  - N8N_LOG_LEVEL=debug\n\n# Red\u00e9marrer\ndocker-compose up -d\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#webhooks-ne-fonctionnent-pas","title":"Webhooks ne fonctionnent pas","text":"<p>Test du webhook: <pre><code># Test direct sur le container\ncurl -X POST http://localhost:5678/webhook/test \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"test\": \"data\"}'\n\n# Test via nginx\ncurl -X POST https://n8n.srv759970.hstgr.cloud/webhook/test \\\n  -u username:password \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"test\": \"data\"}'\n</code></pre></p> <p>V\u00e9rifier nginx: <pre><code># Logs d'acc\u00e8s\ntail -f /var/log/nginx/n8n-access.log\n\n# Logs d'erreur\ntail -f /var/log/nginx/n8n-error.log\n\n# Test de config\nnginx -t\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#performance-lente","title":"Performance lente","text":"<p>Causes possibles: 1. Workflows trop complexes 2. Trop d'ex\u00e9cutions concurrentes 3. Base de donn\u00e9es SQLite limit\u00e9e</p> <p>Solutions:</p> <p>1. Activer le mode Queue (Redis): <pre><code>environment:\n  - EXECUTIONS_MODE=queue\n  - QUEUE_BULL_REDIS_HOST=redis-shared\n  - QUEUE_BULL_REDIS_PORT=6379\n</code></pre></p> <p>2. Utiliser PostgreSQL: <pre><code>environment:\n  - DB_TYPE=postgresdb\n  - DB_POSTGRESDB_HOST=postgresql-shared\n  - DB_POSTGRESDB_DATABASE=n8n\n</code></pre></p> <p>3. Limiter les ex\u00e9cutions: <pre><code>environment:\n  - N8N_PAYLOAD_SIZE_MAX=16\n  - EXECUTIONS_TIMEOUT=300\n</code></pre></p>"},{"location":"02-applications/automation/n8n/#ressources","title":"Ressources","text":""},{"location":"02-applications/automation/n8n/#documentation-officielle","title":"Documentation Officielle","text":"<ul> <li>Site officiel: https://n8n.io</li> <li>Documentation: https://docs.n8n.io</li> <li>Community: https://community.n8n.io</li> <li>GitHub: https://github.com/n8n-io/n8n</li> </ul>"},{"location":"02-applications/automation/n8n/#tutoriels-templates","title":"Tutoriels &amp; Templates","text":"<ul> <li>Templates: https://n8n.io/workflows</li> <li>YouTube: Channel officiel n8n</li> <li>Blog: https://blog.n8n.io</li> </ul>"},{"location":"02-applications/automation/n8n/#support-srv759970","title":"Support srv759970","text":"<ul> <li>Logs: <code>/var/log/nginx/n8n-*.log</code></li> <li>Config: <code>/opt/n8n/docker-compose.yml</code></li> <li>Donn\u00e9es: <code>/opt/n8n/data</code></li> <li>Dashy: https://dashy.srv759970.hstgr.cloud</li> <li>Docs: https://docs.srv759970.hstgr.cloud</li> </ul>"},{"location":"02-applications/automation/n8n/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>WhisperX - Transcription audio</li> <li>Paperless-ngx - Gestion documentaire</li> <li>Ollama - LLM local</li> <li>Rocket.Chat - Messagerie d'\u00e9quipe</li> <li>Nextcloud - Cloud storage</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 Status: \u2705 Production Maintenance: Automatique (Docker restart policy)</p>"},{"location":"02-applications/bots/telegram-bot/","title":"Telegram Voice Transcription Bot - WhisperX Direct","text":""},{"location":"02-applications/bots/telegram-bot/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>Bot Telegram s\u00e9curis\u00e9 qui transcrit automatiquement les messages vocaux en utilisant WhisperX avec polling asynchrone. Con\u00e7u comme premi\u00e8re \u00e9tape d'un pipeline IA de traitement de transcriptions.</p>"},{"location":"02-applications/bots/telegram-bot/#informations-de-deploiement","title":"\ud83d\udccb Informations de d\u00e9ploiement","text":"<p>R\u00e9pertoire : <code>/opt/telegram-bot/</code> Container : <code>telegram-voice-bot</code> R\u00e9seau : <code>telegram-bot_default</code> + <code>whisperx_whisperx</code> Bot Telegram : <code>@transcripteur_vocal_bot</code> Token : <code>7867830645:AAGSgh5xUIeeMPVWJN2ska7qsTN4hcZgHAQ</code></p>"},{"location":"02-applications/bots/telegram-bot/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<pre><code>Utilisateur Telegram\n    \u2193 \ud83c\udfa4 Message vocal (.ogg)\nBot Python (telegram-voice-bot)\n    \u2193 \ud83d\udce5 T\u00e9l\u00e9chargement audio\n    \u2193 \ud83d\udce4 POST /transcribe\nWhisperX API (job queue Redis)\n    \u2193 \ud83c\udd94 job_id + status: \"queued\"\nBot Python (polling async)\n    \u2193 \ud83d\udd04 GET /status/{job_id} toutes les 2s\n    \u2193 \ud83d\udcca Status: queued \u2192 processing \u2192 completed\nBot Python\n    \u2193 \ud83d\udcdd Formatage r\u00e9sultat\nUtilisateur Telegram\n    \u2193 \u2705 Transcription + m\u00e9tadonn\u00e9es\n\n[FUTUR] \u2192 Pipeline IA (LangChain/LlamaIndex)\n    \u2193 Clarification, grammaire, ponctuation\n    \u2193 Tagging, cat\u00e9gorisation\n    \u2193 Enrichissement s\u00e9mantique\n[FUTUR] \u2192 Notion API\n    \u2193 Stockage structur\u00e9\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#securite-implementee","title":"\ud83d\udd12 S\u00e9curit\u00e9 impl\u00e9ment\u00e9e","text":""},{"location":"02-applications/bots/telegram-bot/#whitelist-dutilisateurs","title":"Whitelist d'utilisateurs","text":"<pre><code>ALLOWED_USERS=1699768293  # ID Telegram autoris\u00e9\nALLOW_ALL_USERS=false     # Mode priv\u00e9 (recommand\u00e9)\n</code></pre> <p>Comment obtenir un Telegram ID : - M\u00e9thode 1 : Envoyer un message \u00e0 <code>@userinfobot</code> - M\u00e9thode 2 : Envoyer <code>/start</code> au bot (affichera votre ID)</p>"},{"location":"02-applications/bots/telegram-bot/#rate-limiting","title":"Rate Limiting","text":"Limite Valeur Configurable Vocaux/minute 20 <code>MAX_REQUESTS_PER_MINUTE</code> Vocaux/heure 100 <code>MAX_REQUESTS_PER_HOUR</code> Dur\u00e9e max vocal 20 min (1200s) <code>MAX_VOICE_DURATION</code> Taille max 100 MB <code>MAX_VOICE_SIZE_MB</code>"},{"location":"02-applications/bots/telegram-bot/#logs-et-audit","title":"Logs et audit","text":"<p>Tous les acc\u00e8s sont logg\u00e9s avec: - User ID Telegram - Timestamp - Fichier audio (taille, dur\u00e9e) - Job WhisperX ID - Statut de transcription</p> <pre><code># Voir les logs en temps r\u00e9el\ndocker logs -f telegram-voice-bot\n\n# Exemple de log\n2025-10-24 11:45:10 - telegram_bot - INFO - \ud83d\udce8 Message vocal autoris\u00e9 de Julien (ID: 1699768293, dur\u00e9e: 27s)\n2025-10-24 11:45:11 - telegram_bot - INFO - \u2705 Job soumis: f9a60a07-068b-4f3b-9b38-2ffa267ae36b (user: 1699768293)\n2025-10-24 11:45:18 - telegram_bot - INFO - \u2705 Transcription OK: 145 chars (user: 1699768293)\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#structure-des-fichiers","title":"\ud83d\udcc1 Structure des fichiers","text":"<pre><code>/opt/telegram-bot/\n\u251c\u2500\u2500 bot.py                 # Code principal (version s\u00e9curis\u00e9e)\n\u251c\u2500\u2500 Dockerfile             # Image Python 3.11 slim\n\u251c\u2500\u2500 docker-compose.yml     # Orchestration container\n\u251c\u2500\u2500 requirements.txt       # python-telegram-bot==21.3, aiohttp==3.9.5\n\u251c\u2500\u2500 .env                   # Configuration (token, limits, whitelist)\n\u2514\u2500\u2500 .env.example          # Template de configuration\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#deploiement","title":"\ud83d\ude80 D\u00e9ploiement","text":""},{"location":"02-applications/bots/telegram-bot/#installation-initiale","title":"Installation initiale","text":"<pre><code># 1. Cr\u00e9er le r\u00e9pertoire\nssh root@69.62.108.82\nmkdir -p /opt/telegram-bot\ncd /opt/telegram-bot\n\n# 2. Cr\u00e9er les fichiers (bot.py, Dockerfile, docker-compose.yml, requirements.txt)\n# Voir section \"Fichiers de configuration\" ci-dessous\n\n# 3. Configuration\ncp .env.example .env\nnano .env\n# Modifier TELEGRAM_BOT_TOKEN et ALLOWED_USERS\n\n# 4. Build et d\u00e9marrage\ndocker-compose up --build -d\n\n# 5. Connexion au r\u00e9seau WhisperX\ndocker network connect whisperx_whisperx telegram-voice-bot\n\n# 6. V\u00e9rifier les logs\ndocker logs -f telegram-voice-bot\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#mise-a-jour-du-code","title":"Mise \u00e0 jour du code","text":"<pre><code>cd /opt/telegram-bot\nnano bot.py  # Modifier le code\ndocker-compose up --build -d  # Rebuild et red\u00e9marrage\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#configuration-env","title":"\u2699\ufe0f Configuration (.env)","text":"<pre><code># Token Telegram (obligatoire)\nTELEGRAM_BOT_TOKEN=7867830645:AAGSgh5xUIeeMPVWJN2ska7qsTN4hcZgHAQ\n\n# URL WhisperX\nWHISPERX_URL=http://whisperx:8002\n\n# S\u00e9curit\u00e9: Liste des IDs autoris\u00e9s (s\u00e9par\u00e9s par virgule)\n# Exemple: ALLOWED_USERS=1699768293,987654321\nALLOWED_USERS=1699768293\nALLOW_ALL_USERS=false\n\n# Limites de s\u00e9curit\u00e9 (adapt\u00e9es usage intensif)\nMAX_VOICE_DURATION=1200       # 20 minutes\nMAX_VOICE_SIZE_MB=100         # 100 MB\nMAX_REQUESTS_PER_MINUTE=20    # 20 vocaux/minute\nMAX_REQUESTS_PER_HOUR=100     # 100 vocaux/heure\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#utilisation","title":"\ud83d\udcf1 Utilisation","text":""},{"location":"02-applications/bots/telegram-bot/#commandes-disponibles","title":"Commandes disponibles","text":"Commande Description <code>/start</code> Affiche votre ID et statut d'acc\u00e8s <code>/help</code> Aide et limites de s\u00e9curit\u00e9 <code>/status</code> \u00c9tat de WhisperX et du syst\u00e8me <code>/stats</code> Voir votre quota restant"},{"location":"02-applications/bots/telegram-bot/#workflow-utilisateur","title":"Workflow utilisateur","text":"<ol> <li>Ouvrir Telegram \u2192 Chercher <code>@transcripteur_vocal_bot</code></li> <li>Envoyer un vocal \ud83c\udfa4 (appuyer sur le micro, enregistrer, envoyer)</li> <li>Attendre 10-30s (selon dur\u00e9e du vocal)</li> <li>Recevoir la transcription avec:</li> <li>\u2705 Texte complet</li> <li>\ud83d\udde3\ufe0f Langue d\u00e9tect\u00e9e</li> <li>\u23f1\ufe0f Dur\u00e9e</li> <li>\ud83d\udccf Nombre de segments</li> </ol>"},{"location":"02-applications/bots/telegram-bot/#format-de-reponse","title":"Format de r\u00e9ponse","text":"<pre><code>\u2705 Transcription termin\u00e9e\n\n\ud83d\udde3\ufe0f Langue: fr\n\u23f1\ufe0f Dur\u00e9e: 27.5s\n\ud83d\udccf Segments: 4\n\n\ud83d\udcdd Texte:\nBonjour, je teste le bot de transcription vocale.\nIl fonctionne parfaitement et la qualit\u00e9 est excellente.\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#maintenance","title":"\ud83d\udd27 Maintenance","text":""},{"location":"02-applications/bots/telegram-bot/#commandes-courantes","title":"Commandes courantes","text":"<pre><code># Logs en temps r\u00e9el\ndocker logs -f telegram-voice-bot\n\n# Red\u00e9marrer\ncd /opt/telegram-bot &amp;&amp; docker-compose restart\n\n# Arr\u00eater\ndocker-compose stop\n\n# Rebuild complet\ndocker-compose down\ndocker-compose up --build -d\ndocker network connect whisperx_whisperx telegram-voice-bot\n\n# V\u00e9rifier la connexion WhisperX\ndocker exec telegram-voice-bot python3 -c \"import urllib.request; print(urllib.request.urlopen('http://whisperx:8002/').read().decode())\"\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#ajouter-un-utilisateur-a-la-whitelist","title":"Ajouter un utilisateur \u00e0 la whitelist","text":"<pre><code># 1. Demander \u00e0 l'utilisateur d'envoyer /start au bot\n# Il recevra : \"Votre Telegram ID: 123456789\"\n\n# 2. Modifier .env\ncd /opt/telegram-bot\nnano .env\n# Ajouter l'ID: ALLOWED_USERS=1699768293,123456789\n\n# 3. Red\u00e9marrer\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#problemes-courants","title":"Probl\u00e8mes courants","text":"<p>Bot ne r\u00e9pond pas : <pre><code>docker logs telegram-voice-bot --tail 50\n# V\u00e9rifier les erreurs de token ou connexion\n</code></pre></p> <p>Erreur \"Cannot connect to host whisperx:8002\" : <pre><code># V\u00e9rifier la connexion r\u00e9seau\ndocker network connect whisperx_whisperx telegram-voice-bot\n</code></pre></p> <p>Rate limit trop restrictif : <pre><code>nano .env\n# Modifier MAX_REQUESTS_PER_MINUTE et MAX_REQUESTS_PER_HOUR\ndocker-compose restart\n</code></pre></p>"},{"location":"02-applications/bots/telegram-bot/#evolution-future-pipeline-ia","title":"\ud83d\udd2e \u00c9volution future : Pipeline IA","text":""},{"location":"02-applications/bots/telegram-bot/#architecture-prevue","title":"Architecture pr\u00e9vue","text":"<pre><code>Telegram Voice\n    \u2193\nBot Python (transcription)\n    \u2193\nWebhook n8n\n    \u2193\n[Noeud 1] LangChain - Clarification\n    \u2193 Nettoie la transcription, ajoute ponctuation\n[Noeud 2] LlamaIndex - Enrichissement\n    \u2193 Extrait concepts, tags, cat\u00e9gories\n[Noeud 3] Ollama/LLM - Analyse s\u00e9mantique\n    \u2193 G\u00e9n\u00e8re r\u00e9sum\u00e9, action items, sentiment\n[Noeud 4] Formatage structur\u00e9\n    \u2193 JSON avec m\u00e9tadonn\u00e9es enrichies\nNotion API\n    \u2193 Stockage dans base de donn\u00e9es Notion\n</code></pre>"},{"location":"02-applications/bots/telegram-bot/#technologies-envisagees","title":"Technologies envisag\u00e9es","text":"Composant Technologie Raison Orchestration n8n Workflows visuels, d\u00e9j\u00e0 d\u00e9ploy\u00e9 LLM Framework LangChain Cha\u00eenes de traitement, prompt templates Vector DB LlamaIndex Indexation s\u00e9mantique, RAG LLM Ollama (llama3.2) D\u00e9j\u00e0 d\u00e9ploy\u00e9, local, gratuit Stockage Notion API Interface utilisateur, flexible"},{"location":"02-applications/bots/telegram-bot/#workflow-n8n-prevu","title":"Workflow n8n pr\u00e9vu","text":"<p>Trigger : Webhook POST depuis bot Telegram</p> <p>Noeud 1 - Code: Pr\u00e9paration <pre><code>// Extraire texte transcription\nconst text = $input.item.json.transcription;\nreturn {\n  json: {\n    raw_text: text,\n    metadata: {\n      user_id: $input.item.json.user_id,\n      duration: $input.item.json.duration,\n      language: $input.item.json.language\n    }\n  }\n};\n</code></pre></p> <p>Noeud 2 - HTTP Request: LangChain Clarification <pre><code>POST https://ollama.srv759970.hstgr.cloud/api/generate\nBody:\n{\n  \"model\": \"llama3.2\",\n  \"prompt\": \"Corrige la ponctuation et la grammaire de ce texte transcrit : {{ $json.raw_text }}\",\n  \"stream\": false\n}\n</code></pre></p> <p>Noeud 3 - HTTP Request: Extraction de tags <pre><code>POST https://ollama.srv759970.hstgr.cloud/api/generate\nBody:\n{\n  \"model\": \"llama3.2\",\n  \"prompt\": \"Extrais les tags, cat\u00e9gories et concepts cl\u00e9s : {{ $json.clarified_text }}\",\n  \"format\": \"json\"\n}\n</code></pre></p> <p>Noeud 4 - HTTP Request: Notion Create Page <pre><code>POST https://api.notion.com/v1/pages\nHeaders:\n  Authorization: Bearer {NOTION_TOKEN}\n  Notion-Version: 2022-06-28\nBody:\n{\n  \"parent\": { \"database_id\": \"{DATABASE_ID}\" },\n  \"properties\": {\n    \"Titre\": { \"title\": [{ \"text\": { \"content\": \"{{ $json.summary }}\" }}] },\n    \"Transcription\": { \"rich_text\": [{ \"text\": { \"content\": \"{{ $json.clarified_text }}\" }}] },\n    \"Tags\": { \"multi_select\": {{ $json.tags }} },\n    \"Dur\u00e9e\": { \"number\": {{ $json.metadata.duration }} },\n    \"Date\": { \"date\": { \"start\": \"{{ $now }}\" } }\n  }\n}\n</code></pre></p> <p>Noeud 5 - Respond to Webhook <pre><code>return {\n  json: {\n    status: \"success\",\n    notion_url: $json.url,\n    processed_at: new Date().toISOString()\n  }\n};\n</code></pre></p>"},{"location":"02-applications/bots/telegram-bot/#points-dextension","title":"Points d'extension","text":"<ol> <li>Diarization : Identifier les locuteurs diff\u00e9rents</li> <li>R\u00e9sum\u00e9 : G\u00e9n\u00e9rer un r\u00e9sum\u00e9 court automatique</li> <li>Action Items : Extraire les t\u00e2ches \u00e0 faire</li> <li>Sentiment Analysis : Analyser le ton (positif/n\u00e9gatif)</li> <li>Relations : Lier aux notes Notion existantes</li> <li>Notifications : Envoyer email/Slack si action critique</li> </ol>"},{"location":"02-applications/bots/telegram-bot/#metriques-et-monitoring","title":"\ud83d\udcca M\u00e9triques et monitoring","text":"<p>\u00c0 impl\u00e9menter (voir <code>GUIDE_MONITORING_WHISPERX.md</code>) :</p> <ul> <li>Nombre de transcriptions/jour</li> <li>Temps moyen de traitement</li> <li>Taux d'erreur WhisperX</li> <li>Usage CPU/RAM du bot</li> <li>Quotas utilisateurs</li> </ul>"},{"location":"02-applications/bots/telegram-bot/#liens-connexes","title":"\ud83d\udd17 Liens connexes","text":"<ul> <li>WhisperX API : <code>/opt/whisperx/</code> - docs/services/ai/whisperx.md</li> <li>n8n Automation : https://n8n.srv759970.hstgr.cloud - docs/services/apps/n8n.md</li> <li>Ollama LLM : https://ollama.srv759970.hstgr.cloud - docs/services/ai/ollama.md</li> </ul>"},{"location":"02-applications/bots/telegram-bot/#changelog","title":"\ud83d\udcdd Changelog","text":"<p>2025-10-24 : D\u00e9ploiement initial version s\u00e9curis\u00e9e - Bot Telegram avec whitelist ID - Polling asynchrone WhisperX - Rate limiting (20/min, 100/h) - Limites fichiers (20 min, 100 MB) - Commandes: /start, /help, /status, /stats - Documentation compl\u00e8te</p> <p>Pr\u00eat pour \u00e9volution vers pipeline IA complet avec n8n + LangChain + Notion</p>"},{"location":"02-applications/cms-sites/cristina-site/","title":"Cristina - Site Astro","text":"<p>URL: https://cristina.srv759970.hstgr.cloud Type: Site statique Astro SSG Statut: \u2705 Op\u00e9rationnel (Basic Auth)</p>"},{"location":"02-applications/cms-sites/cristina-site/#vue-densemble","title":"Vue d'ensemble","text":"<p>Site web professionnel pour Cristina, construit avec Astro (Static Site Generator). Le site est prot\u00e9g\u00e9 par Basic Auth pour environnement de d\u00e9veloppement.</p>"},{"location":"02-applications/cms-sites/cristina-site/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>Framework: Astro SSG</li> <li>Type: Site statique (HTML/CSS/JS pr\u00e9-g\u00e9n\u00e9r\u00e9)</li> <li>H\u00e9bergement: Nginx direct (pas de Docker)</li> <li>S\u00e9curit\u00e9: Basic Auth activ\u00e9</li> <li>HTTPS: \u2705 Let's Encrypt</li> </ul>"},{"location":"02-applications/cms-sites/cristina-site/#architecture","title":"Architecture","text":"<pre><code>Internet (HTTPS 443)\n    \u2193\nNginx (reverse proxy + Basic Auth)\n    \u2193\n/opt/cristina-site/ (fichiers statiques)\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#emplacements","title":"Emplacements","text":"<ul> <li>R\u00e9pertoire site: <code>/opt/cristina-site/</code></li> <li>Backend (optionnel): <code>/opt/cristina-backend/</code></li> <li>Nginx config: <code>/etc/nginx/sites-available/cristina</code></li> <li>Certificat SSL: Let's Encrypt</li> </ul>"},{"location":"02-applications/cms-sites/cristina-site/#structure-du-site","title":"Structure du site","text":"<pre><code>/opt/cristina-site/\n\u251c\u2500\u2500 index.html           # Page d'accueil\n\u251c\u2500\u2500 _astro/              # Assets Astro (CSS, JS)\n\u251c\u2500\u2500 a-propos/            # Page \u00e0 propos\n\u251c\u2500\u2500 ateliers/            # Page ateliers\n\u251c\u2500\u2500 contact/             # Page contact\n\u251c\u2500\u2500 cristina-photo.jpg   # Photo\n\u251c\u2500\u2500 favicon.svg          # Favicon\n\u251c\u2500\u2500 robots.txt           # SEO\n\u2514\u2500\u2500 sitemap.xml          # Sitemap\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#acces","title":"Acc\u00e8s","text":""},{"location":"02-applications/cms-sites/cristina-site/#site-web","title":"Site Web","text":"<p>URL: https://cristina.srv759970.hstgr.cloud</p> <p>Credentials Basic Auth: - User: Voir <code>/etc/nginx/.htpasswd</code> - Pass: Voir configuration nginx</p>"},{"location":"02-applications/cms-sites/cristina-site/#ssh","title":"SSH","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/cristina-site\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#gestion","title":"Gestion","text":""},{"location":"02-applications/cms-sites/cristina-site/#deploiement-mise-a-jour","title":"D\u00e9ploiement / Mise \u00e0 jour","text":"<p>Le site est statique, donc mis \u00e0 jour par build Astro local puis upload :</p> <pre><code># Sur votre machine locale (o\u00f9 le code source existe)\ncd cristina-site-source\nnpm run build\n\n# Upload vers le serveur\nscp -r dist/* root@69.62.108.82:/opt/cristina-site/\n\n# Ou via rsync\nrsync -avz --delete dist/ root@69.62.108.82:/opt/cristina-site/\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#rebuild-depuis-le-serveur-si-code-source-present","title":"Rebuild depuis le serveur (si code source pr\u00e9sent)","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/cristina-site\n# Si package.json existe\nnpm install\nnpm run build\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#verifier-les-permissions","title":"V\u00e9rifier les permissions","text":"<pre><code>ssh root@69.62.108.82\nls -la /opt/cristina-site/\n# S'assurer que nginx peut lire\nchown -R www-data:www-data /opt/cristina-site/\nchmod -R 755 /opt/cristina-site/\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#reload-nginx-apres-changements","title":"Reload Nginx apr\u00e8s changements","text":"<pre><code>ssh root@69.62.108.82\nnginx -t\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#configuration-nginx","title":"Configuration Nginx","text":"<p>Fichier: <code>/etc/nginx/sites-available/cristina</code></p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name cristina.srv759970.hstgr.cloud;\n\n    # SSL certificates\n    ssl_certificate /etc/letsencrypt/live/cristina.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/cristina.srv759970.hstgr.cloud/privkey.pem;\n\n    # Basic Auth (dev environment)\n    include snippets/basic-auth.conf;\n\n    root /opt/cristina-site;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n\nserver {\n    listen 80;\n    server_name cristina.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#basic-auth","title":"Basic Auth","text":""},{"location":"02-applications/cms-sites/cristina-site/#gerer-les-utilisateurs","title":"G\u00e9rer les utilisateurs","text":"<pre><code># Ajouter un utilisateur\nhtpasswd /etc/nginx/.htpasswd username\n\n# Changer le mot de passe\nhtpasswd /etc/nginx/.htpasswd username\n\n# Supprimer un utilisateur\nhtpasswd -D /etc/nginx/.htpasswd username\n\n# Reload nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#desactiver-basic-auth-production","title":"D\u00e9sactiver Basic Auth (production)","text":"<pre><code>nano /etc/nginx/sites-available/cristina\n# Commenter la ligne:\n# include snippets/basic-auth.conf;\n\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#backend-optionnel","title":"Backend (Optionnel)","text":"<p>Le dossier <code>/opt/cristina-backend/</code> existe mais n'est pas utilis\u00e9 actuellement. Il pourrait contenir : - Une API Strapi/Node.js - Un backend de gestion de contenu - Des scripts de build</p> <p>Status actuel : Backend non actif, site 100% statique.</p>"},{"location":"02-applications/cms-sites/cristina-site/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/cms-sites/cristina-site/#logs-nginx","title":"Logs Nginx","text":"<pre><code># Access logs\ntail -f /var/log/nginx/access.log | grep cristina\n\n# Error logs\ntail -f /var/log/nginx/error.log | grep cristina\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#test-disponibilite","title":"Test disponibilit\u00e9","text":"<pre><code># Depuis le serveur\ncurl -I https://cristina.srv759970.hstgr.cloud\n\n# Avec Basic Auth\ncurl -u username:password https://cristina.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#seo","title":"SEO","text":""},{"location":"02-applications/cms-sites/cristina-site/#fichiers-presents","title":"Fichiers pr\u00e9sents","text":"<ul> <li>\u2705 <code>robots.txt</code> - Configuration robots</li> <li>\u2705 <code>sitemap.xml</code> - Plan du site</li> <li>\u2705 <code>favicon.svg</code> - Ic\u00f4ne du site</li> </ul>"},{"location":"02-applications/cms-sites/cristina-site/#verifier-le-sitemap","title":"V\u00e9rifier le sitemap","text":"<pre><code>curl https://cristina.srv759970.hstgr.cloud/sitemap.xml\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#backup","title":"Backup","text":""},{"location":"02-applications/cms-sites/cristina-site/#backup-du-site","title":"Backup du site","text":"<pre><code># Backup fichiers\ntar -czf backup_cristina_$(date +%Y%m%d).tar.gz /opt/cristina-site/\n\n# Backup config Nginx\ncp /etc/nginx/sites-available/cristina backup_cristina_nginx_$(date +%Y%m%d).conf\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#restauration","title":"Restauration","text":"<pre><code># Restaurer fichiers\ntar -xzf backup_cristina_YYYYMMDD.tar.gz -C /\n\n# V\u00e9rifier permissions\nchown -R www-data:www-data /opt/cristina-site/\nchmod -R 755 /opt/cristina-site/\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/cms-sites/cristina-site/#site-inaccessible-404","title":"Site inaccessible (404)","text":"<pre><code># V\u00e9rifier que le site existe\nls -la /opt/cristina-site/index.html\n\n# V\u00e9rifier config nginx\nnginx -t\ncat /etc/nginx/sites-available/cristina\n\n# V\u00e9rifier symlink\nls -la /etc/nginx/sites-enabled/ | grep cristina\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#probleme-basic-auth","title":"Probl\u00e8me Basic Auth","text":"<pre><code># V\u00e9rifier que le fichier htpasswd existe\ncat /etc/nginx/.htpasswd\n\n# Tester avec curl\ncurl -u username:password https://cristina.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#erreur-ssl","title":"Erreur SSL","text":"<pre><code># V\u00e9rifier certificat\ncertbot certificates | grep cristina\n\n# Renouveler si expir\u00e9\ncertbot renew --cert-name cristina.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/cms-sites/cristina-site/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Guide Astro - D\u00e9ploiement sites Astro</li> <li>Guide Nginx - Configuration Nginx</li> <li>Guide Basic Auth - Configuration Basic Auth</li> <li>Guide Cloudflare - Setup DNS/CDN</li> </ul>"},{"location":"02-applications/cms-sites/impro-manager/","title":"Impro Manager","text":"<p>URL: https://impro.srv759970.hstgr.cloud Port interne: 3001 Statut: \u2705 Running (unhealthy)</p>"},{"location":"02-applications/cms-sites/impro-manager/#vue-densemble","title":"Vue d'ensemble","text":"<p>Application web de gestion pour troupes d'improvisation th\u00e9\u00e2trale. Interface moderne construite avec Next.js et base de donn\u00e9es PostgreSQL.</p>"},{"location":"02-applications/cms-sites/impro-manager/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Gestion des membres de la troupe</li> <li>Planification des r\u00e9p\u00e9titions et spectacles</li> <li>Biblioth\u00e8que d'exercices d'improvisation</li> <li>Gestion des cat\u00e9gories d'impro</li> <li>Gestion des matchs et \u00e9v\u00e9nements</li> </ul>"},{"location":"02-applications/cms-sites/impro-manager/#architecture","title":"Architecture","text":"<pre><code>Internet (HTTPS 443)\n    \u2193\nNginx (reverse proxy)\n    \u2193\nimpro-manager (:3001) - Next.js\n    \u2193\nPostgreSQL (databases-shared:5432)\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#stack-technique","title":"Stack technique","text":"<ul> <li>Frontend: Next.js 14 + React</li> <li>Backend: Next.js API Routes</li> <li>Base de donn\u00e9es: PostgreSQL (partag\u00e9e)</li> <li>Conteneur: Docker</li> </ul>"},{"location":"02-applications/cms-sites/impro-manager/#emplacements","title":"Emplacements","text":"<ul> <li>R\u00e9pertoire: <code>/opt/impro-manager/</code></li> <li>Docker Compose: <code>/opt/impro-manager/docker-compose.yml</code></li> <li>Nginx config: <code>/etc/nginx/sites-available/impro-manager</code></li> <li>Documentation: <code>/opt/impro-manager/DEPLOYMENT_GUIDE.md</code></li> <li>PRD: <code>/opt/impro-manager/PRD.md</code></li> </ul>"},{"location":"02-applications/cms-sites/impro-manager/#gestion","title":"Gestion","text":""},{"location":"02-applications/cms-sites/impro-manager/#demarragearret","title":"D\u00e9marrage/Arr\u00eat","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/impro-manager\ndocker-compose up -d\ndocker-compose down\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#logs","title":"Logs","text":"<pre><code># Logs en temps r\u00e9el\ndocker logs impro-manager -f\n\n# Derni\u00e8res 100 lignes\ndocker logs impro-manager --tail=100\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#status","title":"Status","text":"<pre><code>docker ps | grep impro-manager\ndocker inspect impro-manager\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#configuration","title":"Configuration","text":""},{"location":"02-applications/cms-sites/impro-manager/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Fichier: <code>/opt/impro-manager/.env</code></p> <pre><code>DATABASE_URL=postgresql://user:pass@postgresql-shared:5432/impro_manager\nNEXT_PUBLIC_API_URL=https://impro.srv759970.hstgr.cloud\nNODE_ENV=production\nPORT=3001\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#base-de-donnees","title":"Base de donn\u00e9es","text":"<ul> <li>Host: <code>postgresql-shared</code> (container)</li> <li>Port: 5432</li> <li>Database: <code>impro_manager</code></li> <li>User: Voir <code>.env</code></li> </ul> <p>Acc\u00e8s: <pre><code>docker exec -it postgresql-shared psql -U postgres -d impro_manager\n</code></pre></p>"},{"location":"02-applications/cms-sites/impro-manager/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/cms-sites/impro-manager/#container-unhealthy","title":"Container unhealthy","text":"<p>Le container est marqu\u00e9 \"unhealthy\" mais fonctionne. Cela peut indiquer :</p> <ol> <li>Health check trop strict</li> <li>Temps de d\u00e9marrage long</li> <li>Probl\u00e8me de connexion DB</li> </ol> <p>V\u00e9rifier les logs : <pre><code>docker logs impro-manager --tail=50\ncurl -I https://impro.srv759970.hstgr.cloud\n</code></pre></p>"},{"location":"02-applications/cms-sites/impro-manager/#rebuild-de-limage","title":"Rebuild de l'image","text":"<pre><code>cd /opt/impro-manager\ndocker-compose build --no-cache\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#documentation-complete","title":"Documentation compl\u00e8te","text":"<p>Documentation d\u00e9taill\u00e9e disponible dans le repo :</p> <ul> <li>DEPLOYMENT_GUIDE.md - Guide de d\u00e9ploiement</li> <li>PRD.md - Product Requirements Document</li> <li>ACTION_PLAN.md - Plan d'action d\u00e9veloppement</li> <li>README.md - Vue d'ensemble technique</li> </ul>"},{"location":"02-applications/cms-sites/impro-manager/#backup","title":"Backup","text":""},{"location":"02-applications/cms-sites/impro-manager/#base-de-donnees_1","title":"Base de donn\u00e9es","text":"<pre><code>docker exec postgresql-shared pg_dump -U postgres impro_manager &gt; backup_impro_$(date +%Y%m%d).sql\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#code-et-assets","title":"Code et assets","text":"<pre><code>cd /opt/impro-manager\ngit pull  # Si g\u00e9r\u00e9 via git\ntar -czf backup_impro_files_$(date +%Y%m%d).tar.gz /opt/impro-manager/\n</code></pre>"},{"location":"02-applications/cms-sites/impro-manager/#voir-aussi","title":"Voir aussi","text":"<ul> <li>PostgreSQL Shared</li> <li>Nginx</li> </ul>"},{"location":"02-applications/collaboration/jitsi/","title":"Jitsi Meet","text":"<p>URL: https://meet.srv759970.hstgr.cloud Ports: 8510 (HTTP), 8511 (HTTPS), 10000/UDP (Media) Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"02-applications/collaboration/jitsi/#vue-densemble","title":"Vue d'ensemble","text":"<p>Jitsi Meet est une solution de visioconf\u00e9rence open-source s\u00e9curis\u00e9e, sans inscription requise. Compatible avec tous les navigateurs modernes.</p>"},{"location":"02-applications/collaboration/jitsi/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Visioconf\u00e9rence : Audio/vid\u00e9o HD jusqu'\u00e0 75 participants</li> <li>Partage d'\u00e9cran : Partage fen\u00eatre ou \u00e9cran complet</li> <li>Chat textuel : Chat en parall\u00e8le de la vid\u00e9o</li> <li>Enregistrement : Enregistrement local (navigateur)</li> <li>Streaming : Live streaming YouTube possible</li> <li>Sans inscription : Cr\u00e9er/rejoindre une r\u00e9union instantan\u00e9ment</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#architecture","title":"Architecture","text":"<p>Jitsi Meet est compos\u00e9 de 4 conteneurs Docker :</p> <pre><code>jitsi-web (Frontend)\n    \u2193\njitsi-prosody (XMPP server)\n    \u2193\njitsi-jicofo (Conference focus)\n    \u2193\njitsi-jvb (Video bridge - WebRTC)\n</code></pre>"},{"location":"02-applications/collaboration/jitsi/#conteneurs","title":"Conteneurs","text":"<ul> <li>jitsi-web : Interface web (port 8510)</li> <li>jitsi-prosody : Serveur XMPP pour signaling</li> <li>jitsi-jicofo : Coordonnateur de conf\u00e9rences</li> <li>jitsi-jvb : Bridge vid\u00e9o WebRTC (port 10000/UDP)</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#configuration","title":"Configuration","text":""},{"location":"02-applications/collaboration/jitsi/#emplacement","title":"Emplacement","text":"<ul> <li>R\u00e9pertoire: <code>/opt/jitsi/</code></li> <li>Config: <code>/opt/jitsi/.env</code></li> <li>Data prosody: <code>/opt/jitsi/prosody/config/</code></li> <li>Data jicofo: <code>/opt/jitsi/jicofo/</code></li> <li>Data jvb: <code>/opt/jitsi/jvb/</code></li> </ul>"},{"location":"02-applications/collaboration/jitsi/#parametres-cles","title":"Param\u00e8tres cl\u00e9s","text":"<ul> <li>PUBLIC_URL: <code>https://meet.srv759970.hstgr.cloud</code></li> <li>ENABLE_AUTH: <code>0</code> (authentification d\u00e9sactiv\u00e9e)</li> <li>ENABLE_GUESTS: <code>1</code> (acc\u00e8s guest activ\u00e9)</li> <li>TZ: <code>Europe/Paris</code></li> </ul>"},{"location":"02-applications/collaboration/jitsi/#ports-reseau","title":"Ports r\u00e9seau","text":"<ul> <li>8510 : HTTP (interne, proxy Nginx)</li> <li>8511 : HTTPS (interne, proxy Nginx)</li> <li>10000/UDP : WebRTC media (expos\u00e9 publiquement)</li> </ul> <p>\u26a0\ufe0f Important: Le port 10000/UDP DOIT \u00eatre ouvert dans le firewall pour le m\u00e9dia WebRTC.</p>"},{"location":"02-applications/collaboration/jitsi/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/collaboration/jitsi/#creer-une-reunion","title":"Cr\u00e9er une r\u00e9union","text":"<ol> <li>Aller sur https://meet.srv759970.hstgr.cloud</li> <li>Entrer un nom de r\u00e9union (ex: <code>reunion-equipe-2025</code>)</li> <li>Cliquer \"Go\" ou appuyer sur Entr\u00e9e</li> <li>Autoriser micro/cam\u00e9ra dans le navigateur</li> <li>Partager le lien avec les participants</li> </ol>"},{"location":"02-applications/collaboration/jitsi/#rejoindre-une-reunion","title":"Rejoindre une r\u00e9union","text":"<ul> <li>URL directe: <code>https://meet.srv759970.hstgr.cloud/NomDeLaReunion</code></li> <li>Depuis Rocket.Chat: Commande <code>/jitsi NomDeLaReunion</code></li> </ul>"},{"location":"02-applications/collaboration/jitsi/#fonctionnalites-durant-lappel","title":"Fonctionnalit\u00e9s durant l'appel","text":"<ul> <li>Micro/Cam\u00e9ra: Boutons en bas pour activer/d\u00e9sactiver</li> <li>Partage d'\u00e9cran: Bouton \"Share screen\"</li> <li>Chat: Ic\u00f4ne bulle de dialogue</li> <li>Lever la main: Ic\u00f4ne main lev\u00e9e</li> <li>Param\u00e8tres: Ic\u00f4ne engrenage (qualit\u00e9 vid\u00e9o, devices)</li> <li>Quitter: Raccrocher (ic\u00f4ne t\u00e9l\u00e9phone rouge)</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#integration-rocketchat","title":"Int\u00e9gration Rocket.Chat","text":"<p>Jitsi Meet est pr\u00e9configur\u00e9 pour fonctionner avec Rocket.Chat.</p>"},{"location":"02-applications/collaboration/jitsi/#dans-rocketchat","title":"Dans Rocket.Chat","text":"<p>Configuration Admin: 1. Admin \u2192 Video Conference \u2192 Jitsi 2. Domain: <code>meet.srv759970.hstgr.cloud</code> 3. Enable SSL: <code>true</code> 4. URL Prefix: <code>https://</code></p> <p>Utilisation: - Cliquer sur l'ic\u00f4ne cam\u00e9ra dans un channel/DM - Ou taper <code>/jitsi NomReunion</code></p>"},{"location":"02-applications/collaboration/jitsi/#administration","title":"Administration","text":""},{"location":"02-applications/collaboration/jitsi/#verifier-les-conteneurs","title":"V\u00e9rifier les conteneurs","text":"<pre><code># Statut\ndocker ps --filter name=jitsi-\n\n# Logs\ndocker logs jitsi-web --tail 50\ndocker logs jitsi-prosody --tail 50\ndocker logs jitsi-jicofo --tail 50\ndocker logs jitsi-jvb --tail 50\n\n# Stats\ndocker stats jitsi-web jitsi-prosody jitsi-jicofo jitsi-jvb\n</code></pre>"},{"location":"02-applications/collaboration/jitsi/#redemarrer","title":"Red\u00e9marrer","text":"<pre><code># Tous les conteneurs\ndocker restart jitsi-web jitsi-prosody jitsi-jicofo jitsi-jvb\n\n# Un seul\ndocker restart jitsi-jvb\n</code></pre>"},{"location":"02-applications/collaboration/jitsi/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/collaboration/jitsi/#https","title":"HTTPS","text":"<ul> <li>\u2705 Certificat Let's Encrypt</li> <li>\u2705 Renouvellement automatique (expire 2026-01-19)</li> <li>\u2705 HTTP/2 activ\u00e9</li> <li>\u2705 WebSocket over HTTPS</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#authentification","title":"Authentification","text":"<p>Mode actuel: Guest access (pas d'authentification)</p> <p>Pour activer l'auth (optionnel): <pre><code># Dans /opt/jitsi/.env\nENABLE_AUTH=1\nENABLE_GUESTS=0\n\n# Red\u00e9marrer\ndocker restart jitsi-prosody jitsi-web\n</code></pre></p>"},{"location":"02-applications/collaboration/jitsi/#chiffrement","title":"Chiffrement","text":"<ul> <li>\u2705 Signaling chiffr\u00e9 (HTTPS/WSS)</li> <li>\u2705 Media chiffr\u00e9 (DTLS-SRTP)</li> <li>\u2705 End-to-end encryption disponible (E2EE)</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#limites-et-quotas","title":"Limites et quotas","text":""},{"location":"02-applications/collaboration/jitsi/#participants","title":"Participants","text":"<ul> <li>Recommand\u00e9: Jusqu'\u00e0 35 participants avec vid\u00e9o</li> <li>Maximum test\u00e9: 75 participants (audio only recommand\u00e9 au-del\u00e0 de 35)</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#bande-passante","title":"Bande passante","text":"<ul> <li>Par participant: ~2-4 Mbps (vid\u00e9o HD)</li> <li>Total serveur: Limit\u00e9 par bande passante r\u00e9seau serveur</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#qualite-video","title":"Qualit\u00e9 vid\u00e9o","text":"<ul> <li>SD: 180p, 360p</li> <li>HD: 720p (par d\u00e9faut)</li> <li>Full HD: 1080p (optionnel, consomme plus)</li> </ul>"},{"location":"02-applications/collaboration/jitsi/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/collaboration/jitsi/#pas-de-videoaudio","title":"Pas de vid\u00e9o/audio","text":"<p>Sympt\u00f4me: Participant ne voit/entend rien</p> <p>Solutions: 1. V\u00e9rifier permissions navigateur (micro/cam\u00e9ra) 2. V\u00e9rifier port 10000/UDP ouvert dans firewall 3. Tester connection: https://meet.srv759970.hstgr.cloud avec 2 onglets</p>"},{"location":"02-applications/collaboration/jitsi/#erreur-room-not-found","title":"Erreur \"Room not found\"","text":"<p>Sympt\u00f4me: Erreur au chargement de la salle</p> <p>Solution: <pre><code># V\u00e9rifier Prosody\ndocker logs jitsi-prosody --tail 50\n\n# Red\u00e9marrer Prosody\ndocker restart jitsi-prosody\n</code></pre></p>"},{"location":"02-applications/collaboration/jitsi/#probleme-de-qualite-lag-freeze","title":"Probl\u00e8me de qualit\u00e9 (lag, freeze)","text":"<p>Solutions: 1. R\u00e9duire qualit\u00e9 vid\u00e9o dans param\u00e8tres 2. D\u00e9sactiver cam\u00e9ra (audio only) 3. V\u00e9rifier logs JVB: <pre><code>docker logs jitsi-jvb --tail 100 | grep ERROR\n</code></pre></p>"},{"location":"02-applications/collaboration/jitsi/#erreur-502-bad-gateway","title":"Erreur 502 Bad Gateway","text":"<p>Solution: <pre><code># V\u00e9rifier que tous les conteneurs tournent\ndocker ps --filter name=jitsi-\n\n# Red\u00e9marrer jitsi-web\ndocker restart jitsi-web\n</code></pre></p>"},{"location":"02-applications/collaboration/jitsi/#optimisations","title":"Optimisations","text":""},{"location":"02-applications/collaboration/jitsi/#qualite-adaptative","title":"Qualit\u00e9 adaptative","text":"<p>Jitsi ajuste automatiquement la qualit\u00e9 selon: - Bande passante disponible - Nombre de participants - Capacit\u00e9 CPU du serveur</p>"},{"location":"02-applications/collaboration/jitsi/#simulcast","title":"Simulcast","text":"<p>Activ\u00e9 par d\u00e9faut - Chaque participant envoie plusieurs qualit\u00e9s, le serveur s\u00e9lectionne la meilleure selon r\u00e9ception.</p>"},{"location":"02-applications/collaboration/jitsi/#comparaison-avec-alternatives","title":"Comparaison avec alternatives","text":"Feature Jitsi Meet Zoom Google Meet Self-hosted \u2705 Oui \u274c Non \u274c Non Open Source \u2705 Oui \u274c Non \u274c Non Sans compte \u2705 Oui \u274c Non \u26a0\ufe0f Limit\u00e9 Chiffrement E2E \u2705 Oui \u2705 Oui \u274c Non Participants max 75+ 100-1000 100-250 Enregistrement \u26a0\ufe0f Local \u2705 Cloud \u2705 Cloud Co\u00fbt \u2705 Gratuit \ud83d\udcb0 Payant \ud83d\udcb0 Payant"},{"location":"02-applications/collaboration/jitsi/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Documentation officielle: https://jitsi.github.io/handbook/</li> <li>FAQ: https://jitsi.github.io/handbook/docs/faq</li> <li>Dev guide: https://jitsi.github.io/handbook/docs/devops-guide/</li> <li>Community: https://community.jitsi.org</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-21 Version Jitsi: unstable (latest Docker images)</p>"},{"location":"02-applications/collaboration/nextcloud/","title":"Nextcloud","text":"<p>URL: https://nextcloud.srv759970.hstgr.cloud Port interne: 8505 Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"02-applications/collaboration/nextcloud/#vue-densemble","title":"Vue d'ensemble","text":"<p>Nextcloud est une plateforme de stockage cloud et de synchronisation de fichiers self-hosted. Elle permet le partage de fichiers, la collaboration en temps r\u00e9el, et l'int\u00e9gration avec ONLYOFFICE pour l'\u00e9dition de documents.</p>"},{"location":"02-applications/collaboration/nextcloud/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Stockage cloud : Upload, download, synchronisation fichiers</li> <li>Partage : Partage interne/externe avec liens et permissions</li> <li>Collaboration : Co-\u00e9dition documents via ONLYOFFICE</li> <li>Calendrier &amp; Contacts : CalDAV/CardDAV int\u00e9gr\u00e9</li> <li>Notes : Application Notes int\u00e9gr\u00e9e</li> <li>Photos : Galerie photos avec reconnaissance faciale</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#architecture","title":"Architecture","text":"<pre><code>Nextcloud (port 8505)\n    \u2193\nPostgreSQL (databases-shared)\n    \u2193\nRedis (cache sessions)\n    \u2193\nONLYOFFICE (port 8508) - \u00c9dition documents Office\n</code></pre>"},{"location":"02-applications/collaboration/nextcloud/#conteneurs","title":"Conteneurs","text":"<ul> <li>nextcloud : Application Nextcloud principale</li> <li>nextcloud-cron : T\u00e2ches planifi\u00e9es (cleanup, preview generation)</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#configuration","title":"Configuration","text":""},{"location":"02-applications/collaboration/nextcloud/#emplacement","title":"Emplacement","text":"<ul> <li>R\u00e9pertoire: <code>/opt/nextcloud/</code></li> <li>Data: <code>/opt/nextcloud/data/</code></li> <li>Config: <code>/opt/nextcloud/config/config.php</code></li> <li>Apps: <code>/opt/nextcloud/custom_apps/</code></li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#base-de-donnees","title":"Base de donn\u00e9es","text":"<ul> <li>Type: PostgreSQL</li> <li>Host: <code>postgresql-shared</code></li> <li>Database: <code>nextcloud</code></li> <li>User: <code>nextcloud</code></li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#cache-redis","title":"Cache Redis","text":"<ul> <li>Host: <code>redis-shared</code></li> <li>Port: 6379</li> <li>Usage: Sessions, file locking, cache applicatif</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/collaboration/nextcloud/#acces-web","title":"Acc\u00e8s Web","text":"<p>URL: https://nextcloud.srv759970.hstgr.cloud</p> <p>Compte admin : - User: <code>admin</code> - Password: Voir <code>/opt/nextcloud/.env</code></p>"},{"location":"02-applications/collaboration/nextcloud/#clients-de-synchronisation","title":"Clients de synchronisation","text":"<p>Desktop : - Nextcloud Desktop Client (Windows, macOS, Linux)</p> <p>Mobile : - Android - iOS</p>"},{"location":"02-applications/collaboration/nextcloud/#webdav","title":"WebDAV","text":"<ul> <li>URL: <code>https://nextcloud.srv759970.hstgr.cloud/remote.php/dav/files/USERNAME/</code></li> <li>Usage: Monter comme lecteur r\u00e9seau</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#integration-onlyoffice","title":"Int\u00e9gration ONLYOFFICE","text":"<p>Nextcloud est configur\u00e9 pour utiliser ONLYOFFICE Document Server pour l'\u00e9dition collaborative de documents Office.</p>"},{"location":"02-applications/collaboration/nextcloud/#documents-supportes","title":"Documents support\u00e9s","text":"<ul> <li>Word: <code>.docx</code>, <code>.doc</code></li> <li>Excel: <code>.xlsx</code>, <code>.xls</code></li> <li>PowerPoint: <code>.pptx</code>, <code>.ppt</code></li> <li>PDF: Lecture seule</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#co-edition","title":"Co-\u00e9dition","text":"<ul> <li>Plusieurs utilisateurs peuvent \u00e9diter simultan\u00e9ment</li> <li>Modifications en temps r\u00e9el</li> <li>Commentaires et r\u00e9visions</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#configuration_1","title":"Configuration","text":"<p>L'int\u00e9gration est d\u00e9j\u00e0 configur\u00e9e :</p> <ul> <li>Document Server URL: <code>https://onlyoffice.srv759970.hstgr.cloud</code></li> <li>JWT Secret: Configur\u00e9 pour s\u00e9curit\u00e9</li> <li>App Nextcloud: ONLYOFFICE install\u00e9e et active</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#commandes-utiles","title":"Commandes utiles","text":""},{"location":"02-applications/collaboration/nextcloud/#via-cli-occ","title":"Via CLI (occ)","text":"<pre><code># Se connecter au conteneur\ndocker exec -u www-data nextcloud php occ\n\n# Lister utilisateurs\ndocker exec -u www-data nextcloud php occ user:list\n\n# Cr\u00e9er utilisateur\ndocker exec -u www-data nextcloud php occ user:add USERNAME\n\n# Scanner fichiers\ndocker exec -u www-data nextcloud php occ files:scan --all\n\n# V\u00e9rifier config\ndocker exec -u www-data nextcloud php occ config:list system\n\n# Mode maintenance\ndocker exec -u www-data nextcloud php occ maintenance:mode --on\ndocker exec -u www-data nextcloud php occ maintenance:mode --off\n</code></pre>"},{"location":"02-applications/collaboration/nextcloud/#gestion-conteneurs","title":"Gestion conteneurs","text":"<pre><code># V\u00e9rifier logs\ndocker logs nextcloud --tail 50 -f\ndocker logs nextcloud-cron --tail 50 -f\n\n# Red\u00e9marrer\ndocker restart nextcloud nextcloud-cron\n\n# Stats\ndocker stats nextcloud nextcloud-cron\n</code></pre>"},{"location":"02-applications/collaboration/nextcloud/#taches-de-maintenance","title":"T\u00e2ches de maintenance","text":""},{"location":"02-applications/collaboration/nextcloud/#cron-jobs","title":"Cron jobs","text":"<p>Le conteneur <code>nextcloud-cron</code> ex\u00e9cute automatiquement les t\u00e2ches planifi\u00e9es toutes les 5 minutes :</p> <ul> <li>Nettoyage fichiers temporaires</li> <li>G\u00e9n\u00e9ration previews</li> <li>Mise \u00e0 jour indexes</li> <li>Synchronisation calendriers</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#logs","title":"Logs","text":"<pre><code># Logs Nextcloud\ndocker exec nextcloud tail -f /var/www/html/data/nextcloud.log\n\n# Logs Nginx interne\ndocker logs nextcloud | grep nginx\n</code></pre>"},{"location":"02-applications/collaboration/nextcloud/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/collaboration/nextcloud/#probleme-de-connexion","title":"Probl\u00e8me de connexion","text":"<p>Sympt\u00f4me: Erreur \"Trusted domain\"</p> <p>Solution: <pre><code>docker exec -u www-data nextcloud php occ config:system:set trusted_domains 1 --value='nextcloud.srv759970.hstgr.cloud'\n</code></pre></p>"},{"location":"02-applications/collaboration/nextcloud/#probleme-onlyoffice","title":"Probl\u00e8me ONLYOFFICE","text":"<p>Sympt\u00f4me: \"Document editing service is not available\"</p> <p>Solution: <pre><code># V\u00e9rifier ONLYOFFICE\ncurl -I https://onlyoffice.srv759970.hstgr.cloud\n\n# Revalider config\ndocker exec -u www-data nextcloud php occ config:app:get onlyoffice DocumentServerUrl\n</code></pre></p>"},{"location":"02-applications/collaboration/nextcloud/#probleme-de-performance","title":"Probl\u00e8me de performance","text":"<p>Solution: Vider cache Redis <pre><code>docker exec redis-shared redis-cli -a PASSWORD FLUSHDB\ndocker restart nextcloud\n</code></pre></p>"},{"location":"02-applications/collaboration/nextcloud/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/collaboration/nextcloud/#https","title":"HTTPS","text":"<ul> <li>\u2705 Certificat Let's Encrypt automatique</li> <li>\u2705 Renouvellement automatique</li> <li>\u2705 HTTP/2 activ\u00e9</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#authentification","title":"Authentification","text":"<ul> <li>Authentification locale Nextcloud</li> <li>Support 2FA disponible (app Two-Factor TOTP)</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#permissions","title":"Permissions","text":"<ul> <li>Syst\u00e8me de partage granulaire</li> <li>Permissions lecture/\u00e9criture/partage configurables</li> <li>Liens publics avec expiration optionnelle</li> </ul>"},{"location":"02-applications/collaboration/nextcloud/#backup","title":"Backup","text":""},{"location":"02-applications/collaboration/nextcloud/#donnees-a-sauvegarder","title":"Donn\u00e9es \u00e0 sauvegarder","text":"<ol> <li>Data directory: <code>/opt/nextcloud/data/</code></li> <li>Database PostgreSQL: <code>nextcloud</code> database</li> <li>Config: <code>/opt/nextcloud/config/config.php</code></li> </ol>"},{"location":"02-applications/collaboration/nextcloud/#script-backup","title":"Script backup","text":"<pre><code># Backup data\ntar czf nextcloud-data-$(date +%Y%m%d).tar.gz /opt/nextcloud/data/\n\n# Backup database\ndocker exec postgresql-shared pg_dump -U nextcloud nextcloud &gt; nextcloud-db-$(date +%Y%m%d).sql\n</code></pre>"},{"location":"02-applications/collaboration/nextcloud/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Documentation officielle: https://docs.nextcloud.com</li> <li>Admin manual: https://docs.nextcloud.com/server/stable/admin_manual/</li> <li>Apps store: https://apps.nextcloud.com</li> <li>Community: https://help.nextcloud.com</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-21 Version Nextcloud: Latest (Docker image officiel)</p>"},{"location":"02-applications/collaboration/rocketchat/","title":"Rocket.Chat","text":"<p>URL: https://chat.srv759970.hstgr.cloud Port interne: 3002 Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"02-applications/collaboration/rocketchat/#vue-densemble","title":"Vue d'ensemble","text":"<p>Rocket.Chat est une plateforme de messagerie instantan\u00e9e et collaboration d'\u00e9quipe open-source, alternative \u00e0 Slack et Microsoft Teams.</p>"},{"location":"02-applications/collaboration/rocketchat/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Chat en temps r\u00e9el : Channels publics/priv\u00e9s, messages directs</li> <li>Visioconf\u00e9rence : Int\u00e9gration Jitsi Meet</li> <li>Partage fichiers : Upload images, documents, vid\u00e9os</li> <li>Threads : Conversations organis\u00e9es par fils de discussion</li> <li>Notifications : Desktop, mobile, email</li> <li>Apps &amp; Int\u00e9grations : Webhooks, bots, int\u00e9grations tierces</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#architecture","title":"Architecture","text":"<pre><code>Rocket.Chat (port 3002)\n    \u2193\nMongoDB Replica Set (rs0)\n    \u2193\nMongoDB Oplog (pour real-time sync)\n</code></pre>"},{"location":"02-applications/collaboration/rocketchat/#conteneur","title":"Conteneur","text":"<ul> <li>rocketchat : Application Rocket.Chat compl\u00e8te</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#configuration","title":"Configuration","text":""},{"location":"02-applications/collaboration/rocketchat/#emplacement","title":"Emplacement","text":"<ul> <li>R\u00e9pertoire: <code>/opt/rocketchat/</code></li> <li>Uploads: <code>/opt/rocketchat/uploads/</code></li> <li>Data: <code>/opt/rocketchat/data/</code></li> <li>Environment: <code>/opt/rocketchat/.env</code></li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#base-de-donnees","title":"Base de donn\u00e9es","text":"<ul> <li>Type: MongoDB (Replica Set rs0)</li> <li>Host: <code>mongodb-shared</code></li> <li>Database: <code>rocketchat</code></li> <li>User: <code>rocketchat</code></li> <li>Oplog: Activ\u00e9 (requis pour real-time)</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/collaboration/rocketchat/#acces-web","title":"Acc\u00e8s Web","text":"<p>URL: https://chat.srv759970.hstgr.cloud</p> <p>Premier d\u00e9marrage : - Cr\u00e9er compte administrateur lors de la premi\u00e8re connexion - Configurer nom de l'organisation - Param\u00e9trer les channels par d\u00e9faut</p>"},{"location":"02-applications/collaboration/rocketchat/#clients","title":"Clients","text":"<p>Desktop : - Rocket.Chat Desktop (Windows, macOS, Linux)</p> <p>Mobile : - Android - iOS</p>"},{"location":"02-applications/collaboration/rocketchat/#integration-jitsi-meet","title":"Int\u00e9gration Jitsi Meet","text":"<p>Rocket.Chat est pr\u00e9configur\u00e9 pour utiliser Jitsi Meet pour la visioconf\u00e9rence.</p>"},{"location":"02-applications/collaboration/rocketchat/#configuration_1","title":"Configuration","text":"<ul> <li>Jitsi Domain: <code>meet.srv759970.hstgr.cloud</code></li> <li>Enable SSL: Oui</li> <li>URL Prefix: <code>https://</code></li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#utilisation_1","title":"Utilisation","text":"<p>Dans un channel ou message direct : 1. Cliquer sur l'ic\u00f4ne cam\u00e9ra 2. Ou taper <code>/jitsi NomDeLaReunion</code> 3. Jitsi s'ouvre dans un nouvel onglet</p>"},{"location":"02-applications/collaboration/rocketchat/#administration","title":"Administration","text":""},{"location":"02-applications/collaboration/rocketchat/#panneau-admin","title":"Panneau Admin","text":"<p>Acc\u00e8s: Menu \u2192 Administration (ic\u00f4ne engrenage)</p> <p>Sections importantes : - Users: Gestion utilisateurs - Rooms: Channels et groupes - Settings: Configuration globale - Integrations: Webhooks et bots</p>"},{"location":"02-applications/collaboration/rocketchat/#commandes-utiles","title":"Commandes utiles","text":"<pre><code># Logs en temps r\u00e9el\ndocker logs rocketchat --tail 100 -f\n\n# Red\u00e9marrer\ndocker restart rocketchat\n\n# Shell MongoDB (debug)\ndocker exec -it mongodb-shared mongosh rocketchat -u rocketchat -p PASSWORD\n\n# Stats\ndocker stats rocketchat\n</code></pre>"},{"location":"02-applications/collaboration/rocketchat/#channels","title":"Channels","text":""},{"location":"02-applications/collaboration/rocketchat/#types-de-channels","title":"Types de channels","text":"<ul> <li>Public Channel : Visible par tous, n'importe qui peut rejoindre</li> <li>Private Group : Invitation uniquement</li> <li>Direct Message : Message priv\u00e9 1-1</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#creer-un-channel","title":"Cr\u00e9er un channel","text":"<ol> <li>Cliquer sur <code>+</code> \u00e0 c\u00f4t\u00e9 de \"Channels\"</li> <li>Choisir Public/Private</li> <li>Nommer le channel (ex: <code>#general</code>, <code>#dev</code>)</li> <li>Inviter membres</li> </ol>"},{"location":"02-applications/collaboration/rocketchat/#webhooks-integrations","title":"Webhooks &amp; Int\u00e9grations","text":""},{"location":"02-applications/collaboration/rocketchat/#incoming-webhooks","title":"Incoming Webhooks","text":"<p>Usage: Recevoir notifications externes (GitHub, GitLab, monitoring, etc.)</p> <p>Cr\u00e9ation: 1. Admin \u2192 Integrations \u2192 New Integration \u2192 Incoming Webhook 2. Choisir channel de destination 3. Copier Webhook URL 4. Utiliser dans service externe</p> <p>Exemple curl: <pre><code>curl -X POST https://chat.srv759970.hstgr.cloud/hooks/WEBHOOK_ID \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"text\": \"Hello from external service!\"}'\n</code></pre></p>"},{"location":"02-applications/collaboration/rocketchat/#outgoing-webhooks","title":"Outgoing Webhooks","text":"<p>Usage: D\u00e9clencher actions externes depuis Rocket.Chat</p>"},{"location":"02-applications/collaboration/rocketchat/#notifications","title":"Notifications","text":""},{"location":"02-applications/collaboration/rocketchat/#desktop","title":"Desktop","text":"<ul> <li>Notifications natives browser/app desktop</li> <li>Configuration par channel (All messages, Mentions, Nothing)</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#mobile","title":"Mobile","text":"<ul> <li>Push notifications via app mobile</li> <li>Configuration par utilisateur</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#email","title":"Email","text":"<ul> <li>Notifications email configurables</li> <li>SMTP requis (voir configuration serveur)</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/collaboration/rocketchat/#https","title":"HTTPS","text":"<ul> <li>\u2705 Certificat Let's Encrypt</li> <li>\u2705 Renouvellement automatique</li> <li>\u2705 WebSocket over HTTPS</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#authentification","title":"Authentification","text":"<ul> <li>Authentification locale Rocket.Chat</li> <li>Support 2FA (TOTP)</li> <li>OAuth2 disponible (Google, GitHub, etc.)</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#permissions","title":"Permissions","text":"<ul> <li>R\u00f4les: Admin, Moderator, User, Guest</li> <li>Permissions granulaires par channel</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#backup","title":"Backup","text":""},{"location":"02-applications/collaboration/rocketchat/#donnees-a-sauvegarder","title":"Donn\u00e9es \u00e0 sauvegarder","text":"<ol> <li>MongoDB database: <code>rocketchat</code></li> <li>Uploads: <code>/opt/rocketchat/uploads/</code></li> <li>Config: <code>/opt/rocketchat/.env</code></li> </ol>"},{"location":"02-applications/collaboration/rocketchat/#script-backup","title":"Script backup","text":"<pre><code># Backup MongoDB\ndocker exec mongodb-shared mongodump --db=rocketchat --username=rocketchat --password=PASSWORD --out=/backup\n\n# Backup uploads\ntar czf rocketchat-uploads-$(date +%Y%m%d).tar.gz /opt/rocketchat/uploads/\n</code></pre>"},{"location":"02-applications/collaboration/rocketchat/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/collaboration/rocketchat/#probleme-de-connexion","title":"Probl\u00e8me de connexion","text":"<p>Sympt\u00f4me: \"Cannot connect to server\"</p> <p>Solution: <pre><code># V\u00e9rifier logs\ndocker logs rocketchat --tail 50\n\n# V\u00e9rifier MongoDB\ndocker exec mongodb-shared mongosh --eval \"rs.status()\"\n</code></pre></p>"},{"location":"02-applications/collaboration/rocketchat/#probleme-jitsi","title":"Probl\u00e8me Jitsi","text":"<p>Sympt\u00f4me: Vid\u00e9o ne d\u00e9marre pas</p> <p>Solution: 1. V\u00e9rifier config dans Admin \u2192 Video Conference \u2192 Jitsi 2. Tester Jitsi directement: https://meet.srv759970.hstgr.cloud 3. V\u00e9rifier logs Jitsi</p>"},{"location":"02-applications/collaboration/rocketchat/#messages-ne-saffichent-pas","title":"Messages ne s'affichent pas","text":"<p>Sympt\u00f4me: Messages en retard ou ne s'affichent pas</p> <p>Solution: V\u00e9rifier MongoDB oplog <pre><code>docker exec mongodb-shared mongosh --eval \"rs.status()\" | grep -A 5 oplog\n</code></pre></p>"},{"location":"02-applications/collaboration/rocketchat/#limites-et-quotas","title":"Limites et quotas","text":""},{"location":"02-applications/collaboration/rocketchat/#uploads","title":"Uploads","text":"<ul> <li>Taille max fichier: Configurable dans Admin \u2192 File Upload</li> <li>Stockage: Limit\u00e9 par espace disque serveur</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#users","title":"Users","text":"<ul> <li>Nombre max: Aucune limite technique (version Community)</li> <li>Concurrent users: Limit\u00e9 par ressources serveur</li> </ul>"},{"location":"02-applications/collaboration/rocketchat/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Documentation officielle: https://docs.rocket.chat</li> <li>API documentation: https://developer.rocket.chat/reference/api</li> <li>Marketplace apps: https://rocket.chat/marketplace</li> <li>Community: https://open.rocket.chat</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-21 Version Rocket.Chat: Latest (Docker image officiel)</p>"},{"location":"02-applications/dashboards/energie-dashboard/","title":"Energie Dashboard - Projet DownTo40","text":"<p>Tags : <code>production</code>, <code>dashboard</code>, <code>streamlit</code>, <code>downto40</code></p> <p>Status : \ud83d\udfe2 Actif en production URL : https://energie.srv759970.hstgr.cloud Localisation : <code>/opt/energie-40eur-dashboard/</code></p>"},{"location":"02-applications/dashboards/energie-dashboard/#description","title":"Description","text":"<p>Dashboard Streamlit pour visualisation et analyse des prix de l'\u00e9lectricit\u00e9 dans le cadre du projet DownTo40.</p>"},{"location":"02-applications/dashboards/energie-dashboard/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>\ud83d\udcca Visualisation prix \u00e9lectricit\u00e9 temps r\u00e9el</li> <li>\ud83d\udcc8 Graphiques historiques</li> <li>\ud83d\udd14 Alertes seuils de prix</li> <li>\ud83d\udca1 Recommandations optimisation</li> </ul>"},{"location":"02-applications/dashboards/energie-dashboard/#architecture","title":"Architecture","text":""},{"location":"02-applications/dashboards/energie-dashboard/#stack-technique","title":"Stack Technique","text":"Composant Technologie Frontend Streamlit Backend Python 3.11 Data Source API externe (prix \u00e9lectricit\u00e9) D\u00e9ploiement Docker Compose"},{"location":"02-applications/dashboards/energie-dashboard/#docker-compose","title":"Docker Compose","text":"<pre><code>services:\n  energie-40eur-dashboard:\n    build: .\n    container_name: energie-40eur-dashboard\n    restart: unless-stopped\n    ports:\n      - \"8501:8501\"\n    environment:\n      - API_KEY=${ELECTRICITY_API_KEY}\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#configuration-nginx","title":"Configuration Nginx","text":"<p>Site : <code>energie.srv759970.hstgr.cloud</code></p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name energie.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/energie.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/energie.srv759970.hstgr.cloud/privkey.pem;\n\n    location / {\n        proxy_pass http://localhost:8501;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/dashboards/energie-dashboard/#initial-setup","title":"Initial Setup","text":"<pre><code># Depuis le serveur\ncd /opt/energie-40eur-dashboard\ndocker-compose up -d\n\n# V\u00e9rifier les logs\ndocker logs -f energie-40eur-dashboard\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#mise-a-jour","title":"Mise \u00e0 Jour","text":"<pre><code># Pull latest code\ncd /opt/energie-40eur-dashboard\ngit pull origin main\n\n# Rebuild et red\u00e9marrer\ndocker-compose down\ndocker-compose build --no-cache\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#donnees-et-api","title":"Donn\u00e9es et API","text":""},{"location":"02-applications/dashboards/energie-dashboard/#source-de-donnees","title":"Source de Donn\u00e9es","text":"<p>L'application r\u00e9cup\u00e8re les donn\u00e9es depuis l'API publique des prix de l'\u00e9lectricit\u00e9.</p> <p>Configuration : Voir <code>/opt/energie-40eur-dashboard/.env</code></p> <pre><code>ELECTRICITY_API_KEY=&lt;cl\u00e9 API&gt;\nELECTRICITY_API_URL=https://api.example.com/v1/prices\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/dashboards/energie-dashboard/#health-check","title":"Health Check","text":"<pre><code># V\u00e9rifier que le container tourne\ndocker ps | grep energie-40eur-dashboard\n\n# Tester l'acc\u00e8s HTTP\ncurl -I https://energie.srv759970.hstgr.cloud\n\n# Logs en direct\ndocker logs -f energie-40eur-dashboard\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#metriques","title":"M\u00e9triques","text":"<ul> <li>Uptime : Visible dans Dashy portal</li> <li>Usage m\u00e9moire : ~123 MB</li> <li>CPU : Faible (dashboard statique principalement)</li> </ul>"},{"location":"02-applications/dashboards/energie-dashboard/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/dashboards/energie-dashboard/#dashboard-ne-charge-pas","title":"Dashboard ne charge pas","text":"<pre><code># 1. V\u00e9rifier que le container tourne\ndocker ps | grep energie\n\n# 2. Voir les logs\ndocker logs energie-40eur-dashboard --tail 50\n\n# 3. Restart si besoin\ndocker restart energie-40eur-dashboard\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#erreur-api","title":"Erreur API","text":"<pre><code># V\u00e9rifier que la cl\u00e9 API est valide\ndocker exec energie-40eur-dashboard env | grep API_KEY\n\n# Tester l'API manuellement\ncurl -H \"Authorization: Bearer $API_KEY\" https://api.example.com/v1/prices\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#backup","title":"Backup","text":""},{"location":"02-applications/dashboards/energie-dashboard/#code","title":"Code","text":"<p>Le code est versionn\u00e9 dans un repo Git (priv\u00e9 ou local).</p> <pre><code># Backup manuel\ncd /opt/energie-40eur-dashboard\ntar czf ~/backups/energie-dashboard-$(date +%Y%m%d).tar.gz .\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#configuration","title":"Configuration","text":"<pre><code># Backup du .env\ncp /opt/energie-40eur-dashboard/.env ~/backups/.env.energie-dashboard-$(date +%Y%m%d)\n</code></pre>"},{"location":"02-applications/dashboards/energie-dashboard/#liens-utiles","title":"Liens Utiles","text":"<ul> <li>Dashboard Live : https://energie.srv759970.hstgr.cloud</li> <li>Dashy Portal : https://dashy.srv759970.hstgr.cloud</li> <li>Logs Dozzle : https://dozzle.srv759970.hstgr.cloud (chercher <code>energie</code>)</li> </ul>"},{"location":"02-applications/dashboards/energie-dashboard/#notes-projet-downto40","title":"Notes Projet DownTo40","text":"<p>Ce dashboard est au c\u0153ur du projet DownTo40 visant \u00e0 : - R\u00e9duire la facture d'\u00e9lectricit\u00e9 \u00e0 40\u20ac/mois - Optimiser la consommation selon les heures creuses - Alerter sur les pics de prix</p> <p>Priorit\u00e9 : \ud83d\udd34 Haute - Dashboard principal du projet</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-28 Responsable : Julien Fernandez</p>"},{"location":"02-applications/documents/paperless-ai/","title":"Paperless AI - Intelligent Document Assistant","text":"<p>URL: https://paperless-ai.srv759970.hstgr.cloud Container: <code>paperless-ai</code> Stack: FastAPI + Ollama + Paperless-ngx API</p>"},{"location":"02-applications/documents/paperless-ai/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Paperless AI est un assistant intelligent qui s'int\u00e8gre avec Paperless-ngx pour fournir des capacit\u00e9s de traitement documentaire avanc\u00e9es bas\u00e9es sur l'IA.</p>"},{"location":"02-applications/documents/paperless-ai/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>\ud83e\udd16 Analyse s\u00e9mantique - Compr\u00e9hension du contenu des documents</li> <li>\ud83c\udff7\ufe0f Auto-tagging intelligent - Classification par LLM</li> <li>\ud83d\udcac Q&amp;A documentaire - Posez des questions sur vos documents</li> <li>\ud83d\udcca Extraction de donn\u00e9es - Extraction structur\u00e9e d'informations (montants, dates, etc.)</li> <li>\ud83d\udd0d Recherche s\u00e9mantique - Au-del\u00e0 de la recherche par mots-cl\u00e9s</li> <li>\ud83d\udcdd R\u00e9sum\u00e9s automatiques - G\u00e9n\u00e9ration de r\u00e9sum\u00e9s de documents longs</li> </ul>"},{"location":"02-applications/documents/paperless-ai/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           Paperless AI API                  \u2502\n\u2502         (FastAPI - Port 8001)               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502                       \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502  Paperless-ngx \u2502    \u2502     Ollama       \u2502\n    \u2502      API       \u2502    \u2502  (LLM Inference) \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502   PostgreSQL   \u2502\n    \u2502   (Documents)  \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#configuration","title":"Configuration","text":""},{"location":"02-applications/documents/paperless-ai/#docker-compose","title":"Docker Compose","text":"<pre><code>services:\n  paperless-ai:\n    image: paperless-ai:latest\n    container_name: paperless-ai\n    restart: unless-stopped\n    ports:\n      - \"8001:8000\"\n    environment:\n      - PAPERLESS_API_URL=https://paperless.srv759970.hstgr.cloud/api\n      - PAPERLESS_API_TOKEN=${PAPERLESS_TOKEN}\n      - OLLAMA_API_URL=http://ollama:11434\n      - DEFAULT_MODEL=qwen2.5:7b\n      - EMBEDDING_MODEL=nomic-embed-text\n    depends_on:\n      - ollama\n      - paperless-ngx\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#variables-denvironnement","title":"Variables d'Environnement","text":"<pre><code>PAPERLESS_API_URL=https://paperless.srv759970.hstgr.cloud/api\nPAPERLESS_API_TOKEN=&lt;paperless-token&gt;\nOLLAMA_API_URL=http://69.62.108.82:11434\nDEFAULT_MODEL=qwen2.5:7b\nEMBEDDING_MODEL=nomic-embed-text\nMAX_CONTEXT_LENGTH=4096\nTEMPERATURE=0.1\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#api-endpoints","title":"API Endpoints","text":""},{"location":"02-applications/documents/paperless-ai/#documentation-interactive","title":"Documentation Interactive","text":"<p>Swagger UI: https://paperless-ai.srv759970.hstgr.cloud/docs ReDoc: https://paperless-ai.srv759970.hstgr.cloud/redoc</p>"},{"location":"02-applications/documents/paperless-ai/#endpoints-principaux","title":"Endpoints Principaux","text":""},{"location":"02-applications/documents/paperless-ai/#1-analyse-de-document","title":"1. Analyse de Document","text":"<pre><code>POST /api/v1/analyze\nContent-Type: application/json\n\n{\n  \"document_id\": 123,\n  \"analysis_type\": \"summary|tags|extract|qa\"\n}\n</code></pre> <p>Exemple: <pre><code>curl -X POST https://paperless-ai.srv759970.hstgr.cloud/api/v1/analyze \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"document_id\": 123,\n    \"analysis_type\": \"summary\"\n  }'\n</code></pre></p> <p>R\u00e9ponse: <pre><code>{\n  \"document_id\": 123,\n  \"analysis_type\": \"summary\",\n  \"result\": {\n    \"summary\": \"Facture EDF pour la p\u00e9riode janvier 2024. Montant total: 156.23\u20ac. Consommation: 450 kWh.\",\n    \"confidence\": 0.95\n  },\n  \"processing_time\": 2.3\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#2-auto-tagging-intelligent","title":"2. Auto-Tagging Intelligent","text":"<pre><code>POST /api/v1/auto-tag\nContent-Type: application/json\n\n{\n  \"document_id\": 123,\n  \"suggest_only\": false\n}\n</code></pre> <p>Exemple: <pre><code>curl -X POST https://paperless-ai.srv759970.hstgr.cloud/api/v1/auto-tag \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"document_id\": 123,\n    \"suggest_only\": true\n  }'\n</code></pre></p> <p>R\u00e9ponse: <pre><code>{\n  \"document_id\": 123,\n  \"suggested_tags\": [\n    {\"name\": \"facture\", \"confidence\": 0.98},\n    {\"name\": \"edf\", \"confidence\": 0.95},\n    {\"name\": \"energie\", \"confidence\": 0.87}\n  ],\n  \"applied\": false\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#3-questions-reponses","title":"3. Questions-R\u00e9ponses","text":"<pre><code>POST /api/v1/qa\nContent-Type: application/json\n\n{\n  \"document_id\": 123,\n  \"question\": \"Quel est le montant total?\"\n}\n</code></pre> <p>Exemple: <pre><code>curl -X POST https://paperless-ai.srv759970.hstgr.cloud/api/v1/qa \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"document_id\": 123,\n    \"question\": \"Quel est le montant de cette facture?\"\n  }'\n</code></pre></p> <p>R\u00e9ponse: <pre><code>{\n  \"document_id\": 123,\n  \"question\": \"Quel est le montant de cette facture?\",\n  \"answer\": \"Le montant total de la facture est de 156,23 euros.\",\n  \"confidence\": 0.92,\n  \"sources\": [\"page 1\"]\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#4-extraction-de-donnees","title":"4. Extraction de Donn\u00e9es","text":"<pre><code>POST /api/v1/extract\nContent-Type: application/json\n\n{\n  \"document_id\": 123,\n  \"fields\": [\"amount\", \"date\", \"vendor\", \"invoice_number\"]\n}\n</code></pre> <p>Exemple: <pre><code>curl -X POST https://paperless-ai.srv759970.hstgr.cloud/api/v1/extract \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"document_id\": 123,\n    \"fields\": [\"amount\", \"date\", \"vendor\"]\n  }'\n</code></pre></p> <p>R\u00e9ponse: <pre><code>{\n  \"document_id\": 123,\n  \"extracted_data\": {\n    \"amount\": {\"value\": \"156.23\", \"currency\": \"EUR\", \"confidence\": 0.98},\n    \"date\": {\"value\": \"2024-01-15\", \"confidence\": 0.95},\n    \"vendor\": {\"value\": \"EDF\", \"confidence\": 1.0}\n  }\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#5-recherche-semantique","title":"5. Recherche S\u00e9mantique","text":"<pre><code>POST /api/v1/semantic-search\nContent-Type: application/json\n\n{\n  \"query\": \"factures d'\u00e9lectricit\u00e9 de janvier\",\n  \"top_k\": 5\n}\n</code></pre> <p>R\u00e9ponse: <pre><code>{\n  \"query\": \"factures d'\u00e9lectricit\u00e9 de janvier\",\n  \"results\": [\n    {\n      \"document_id\": 123,\n      \"title\": \"Facture EDF Janvier 2024\",\n      \"similarity\": 0.94,\n      \"snippet\": \"Facture pour la p\u00e9riode du 01/01/2024 au 31/01/2024...\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#integrations","title":"Int\u00e9grations","text":""},{"location":"02-applications/documents/paperless-ai/#paperless-ngx","title":"Paperless-ngx","text":"<p>Paperless AI se connecte \u00e0 Paperless-ngx via son API pour: - R\u00e9cup\u00e9rer le contenu des documents - Appliquer automatiquement les tags sugg\u00e9r\u00e9s - Mettre \u00e0 jour les m\u00e9tadonn\u00e9es</p>"},{"location":"02-applications/documents/paperless-ai/#ollama","title":"Ollama","text":"<p>Utilise les mod\u00e8les LLM locaux pour: - Analyse s\u00e9mantique (qwen2.5:7b) - G\u00e9n\u00e9ration d'embeddings (nomic-embed-text) - Classification et extraction</p> <p>Mod\u00e8les recommand\u00e9s: - <code>qwen2.5:7b</code> - Analyse g\u00e9n\u00e9rale et Q&amp;A - <code>mistral:7b</code> - Alternative performante - <code>nomic-embed-text</code> - Embeddings pour recherche s\u00e9mantique</p>"},{"location":"02-applications/documents/paperless-ai/#workflows-automatises","title":"Workflows Automatis\u00e9s","text":""},{"location":"02-applications/documents/paperless-ai/#auto-processing-pipeline","title":"Auto-Processing Pipeline","text":"<pre><code>1. Nouveau document d\u00e9tect\u00e9 dans Paperless\n   \u2193\n2. Paperless AI analyse le contenu\n   \u2193\n3. Extraction automatique (montant, date, vendeur)\n   \u2193\n4. G\u00e9n\u00e9ration de tags intelligents\n   \u2193\n5. Classification par type de document\n   \u2193\n6. Application des tags et m\u00e9tadonn\u00e9es\n   \u2193\n7. Indexation pour recherche s\u00e9mantique\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#configuration-du-webhook","title":"Configuration du Webhook","text":"<p>Dans Paperless-ngx, configurez un webhook pour d\u00e9clencher l'analyse automatique:</p> <pre><code># Webhook URL\nPOST https://paperless-ai.srv759970.hstgr.cloud/api/v1/webhook/document-added\n\n# Payload\n{\n  \"document_id\": 123,\n  \"event\": \"document_added\"\n}\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#cas-dusage","title":"Cas d'Usage","text":""},{"location":"02-applications/documents/paperless-ai/#1-traitement-de-factures","title":"1. Traitement de Factures","text":"<pre><code>import requests\n\n# Analyser une facture\nresponse = requests.post(\n    \"https://paperless-ai.srv759970.hstgr.cloud/api/v1/extract\",\n    json={\n        \"document_id\": 123,\n        \"fields\": [\"amount\", \"due_date\", \"vendor\", \"invoice_number\"]\n    }\n)\n\ndata = response.json()\nprint(f\"Montant: {data['extracted_data']['amount']['value']} EUR\")\nprint(f\"Vendeur: {data['extracted_data']['vendor']['value']}\")\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#2-qa-sur-documents-juridiques","title":"2. Q&amp;A sur Documents Juridiques","text":"<pre><code># Poser une question\nresponse = requests.post(\n    \"https://paperless-ai.srv759970.hstgr.cloud/api/v1/qa\",\n    json={\n        \"document_id\": 456,\n        \"question\": \"Quelles sont les clauses de r\u00e9siliation?\"\n    }\n)\n\nanswer = response.json()\nprint(f\"R\u00e9ponse: {answer['answer']}\")\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#3-recherche-semantique","title":"3. Recherche S\u00e9mantique","text":"<pre><code># Rechercher des documents similaires\nresponse = requests.post(\n    \"https://paperless-ai.srv759970.hstgr.cloud/api/v1/semantic-search\",\n    json={\n        \"query\": \"documents relatifs au bail commercial\",\n        \"top_k\": 10\n    }\n)\n\nresults = response.json()\nfor doc in results['results']:\n    print(f\"{doc['title']} - Similarit\u00e9: {doc['similarity']}\")\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#performance","title":"Performance","text":""},{"location":"02-applications/documents/paperless-ai/#temps-de-traitement-moyens","title":"Temps de Traitement Moyens","text":"<ul> <li>Analyse/R\u00e9sum\u00e9: 2-5 secondes</li> <li>Auto-tagging: 1-3 secondes</li> <li>Extraction de donn\u00e9es: 3-7 secondes</li> <li>Q&amp;A: 2-4 secondes</li> <li>Recherche s\u00e9mantique: &lt; 1 seconde</li> </ul>"},{"location":"02-applications/documents/paperless-ai/#optimisations","title":"Optimisations","text":"<pre><code># Utiliser un mod\u00e8le plus l\u00e9ger pour production\nDEFAULT_MODEL=qwen2.5:3b  # Plus rapide\n\n# Augmenter le cache\nCACHE_SIZE=1000\n\n# Batch processing\nBATCH_SIZE=10\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/documents/paperless-ai/#metriques","title":"M\u00e9triques","text":"<pre><code>GET /api/v1/metrics\n</code></pre> <p>R\u00e9ponse: <pre><code>{\n  \"total_analyses\": 1234,\n  \"avg_processing_time\": 3.2,\n  \"cache_hit_rate\": 0.65,\n  \"active_connections\": 5,\n  \"model_status\": \"healthy\"\n}\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#logs","title":"Logs","text":"<pre><code># Logs en temps r\u00e9el\ndocker logs -f paperless-ai\n\n# Filtrer par niveau\ndocker logs paperless-ai | grep ERROR\n</code></pre>"},{"location":"02-applications/documents/paperless-ai/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/documents/paperless-ai/#le-modele-est-lent","title":"Le Mod\u00e8le est Lent","text":"<p>Solution: Utiliser un mod\u00e8le plus l\u00e9ger <pre><code># Changer le mod\u00e8le par d\u00e9faut\ndocker exec paperless-ai \\\n  sed -i 's/qwen2.5:7b/qwen2.5:3b/g' /app/.env\ndocker restart paperless-ai\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#erreur-de-connexion-a-paperless","title":"Erreur de Connexion \u00e0 Paperless","text":"<p>V\u00e9rifier le token: <pre><code>curl -H \"Authorization: Token YOUR_TOKEN\" \\\n  https://paperless.srv759970.hstgr.cloud/api/documents/\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#ollama-inaccessible","title":"Ollama Inaccessible","text":"<p>V\u00e9rifier le service: <pre><code>curl http://69.62.108.82:11434/api/tags\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ai/#securite","title":"S\u00e9curit\u00e9","text":"<ul> <li>\u2705 HTTPS - Connexions chiffr\u00e9es</li> <li>\u2705 API Token - Authentification requise</li> <li>\u2705 Rate Limiting - Protection contre abus</li> <li>\u2705 Validation des entr\u00e9es - Pr\u00e9vention injection</li> </ul>"},{"location":"02-applications/documents/paperless-ai/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Paperless-ngx - Syst\u00e8me de GED principal</li> <li>Ollama - Service d'inf\u00e9rence LLM</li> <li>Monitoring - Stack de monitoring</li> </ul>"},{"location":"02-applications/documents/paperless-ai/#liens-externes","title":"Liens Externes","text":"<ul> <li>Documentation FastAPI: https://fastapi.tiangolo.com/</li> <li>Ollama Models: https://ollama.com/library</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 Prochaine r\u00e9vision: Apr\u00e8s ajout de nouveaux mod\u00e8les</p>"},{"location":"02-applications/documents/paperless-ngx/","title":"Paperless-ngx - Document Management System","text":"<p>URL: https://paperless.srv759970.hstgr.cloud Container: <code>paperless-ngx</code> Stack: Paperless-ngx + PostgreSQL + Redis + Tika</p>"},{"location":"02-applications/documents/paperless-ngx/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Paperless-ngx est un syst\u00e8me de gestion documentaire intelligent qui num\u00e9rise, indexe et organise automatiquement vos documents papier et num\u00e9riques.</p>"},{"location":"02-applications/documents/paperless-ngx/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s Principales","text":"<ul> <li>\ud83d\udcc4 Num\u00e9risation intelligente - Import automatique depuis scanners, email, FTP</li> <li>\ud83d\udd0d OCR avanc\u00e9 - Reconnaissance de texte avec Tesseract + Apache Tika</li> <li>\ud83c\udff7\ufe0f Auto-tagging - Classification automatique par machine learning</li> <li>\ud83d\udcca Correspondants &amp; Types - Organisation par exp\u00e9diteur/destinataire et cat\u00e9gories</li> <li>\ud83d\udd10 Chiffrement - Stockage s\u00e9curis\u00e9 des documents sensibles</li> <li>\ud83d\udcf1 Interface moderne - UI responsive Angular avec dark mode</li> <li>\ud83d\udd0e Recherche full-text - Indexation compl\u00e8te avec filtres avanc\u00e9s</li> <li>\ud83d\udce7 Import email - Consommation automatique depuis bo\u00eetes mail IMAP</li> </ul>"},{"location":"02-applications/documents/paperless-ngx/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          Paperless-ngx Frontend             \u2502\n\u2502         (Angular SPA - Port 8000)           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                            \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 PostgreSQL \u2502          \u2502    Redis     \u2502\n\u2502  Database  \u2502          \u2502    Cache     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502                      \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502   Tika    \u2502         \u2502  Gotenberg  \u2502\n              \u2502 (OCR/Parse)\u2502         \u2502    (PDF)    \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#configuration","title":"Configuration","text":""},{"location":"02-applications/documents/paperless-ngx/#variables-denvironnement","title":"Variables d'Environnement","text":"<pre><code>environment:\n  - PAPERLESS_REDIS=redis://redis:6379\n  - PAPERLESS_DBHOST=db\n  - PAPERLESS_DBNAME=paperless\n  - PAPERLESS_DBUSER=paperless\n  - PAPERLESS_DBPASS=&lt;password&gt;\n  - PAPERLESS_TIKA_ENABLED=1\n  - PAPERLESS_TIKA_ENDPOINT=http://tika:9998\n  - PAPERLESS_TIKA_GOTENBERG_ENDPOINT=http://gotenberg:3000\n  - PAPERLESS_OCR_LANGUAGE=fra+eng\n  - PAPERLESS_TIME_ZONE=Europe/Paris\n  - PAPERLESS_ADMIN_USER=admin\n  - PAPERLESS_URL=https://paperless.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#volumes","title":"Volumes","text":"<pre><code>volumes:\n  - /opt/paperless/data:/usr/src/paperless/data\n  - /opt/paperless/media:/usr/src/paperless/media\n  - /opt/paperless/export:/usr/src/paperless/export\n  - /opt/paperless/consume:/usr/src/paperless/consume\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/documents/paperless-ngx/#import-de-documents","title":"Import de Documents","text":"<p>1. Via Interface Web - Glisser-d\u00e9poser dans l'interface - Upload multiple support\u00e9</p> <p>2. Via Dossier de Consommation <pre><code># Copier documents dans le dossier consume\ncp document.pdf /opt/paperless/consume/\n\n# Paperless d\u00e9tecte et traite automatiquement\n</code></pre></p> <p>3. Via Email <pre><code># Configuration IMAP dans Admin &gt; Mail\n# Paperless r\u00e9cup\u00e8re automatiquement les pi\u00e8ces jointes\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#workflow-de-traitement","title":"Workflow de Traitement","text":"<pre><code>Upload \u2192 OCR/Parsing \u2192 Classification \u2192 Tagging \u2192 Indexation \u2192 Archivage\n</code></pre> <ol> <li>OCR/Parsing - Extraction texte via Tesseract + Tika</li> <li>Classification - D\u00e9tection automatique du type de document</li> <li>Tagging - Application des tags par r\u00e8gles ou ML</li> <li>Indexation - Ajout au moteur de recherche full-text</li> <li>Archivage - Stockage s\u00e9curis\u00e9 avec versioning</li> </ol>"},{"location":"02-applications/documents/paperless-ngx/#recherche-avancee","title":"Recherche Avanc\u00e9e","text":"<p>Syntaxe de recherche: <pre><code># Recherche simple\nfacture edf\n\n# Avec tags\ntag:facture tag:edf\n\n# Avec correspondant\ncorrespondent:edf\n\n# Par date\ncreated:[2024-01-01 to 2024-12-31]\n\n# Combinaison\ntag:facture correspondent:edf created:[2024-01-01 to *]\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#integrations","title":"Int\u00e9grations","text":""},{"location":"02-applications/documents/paperless-ngx/#apache-tika","title":"Apache Tika","text":"<p>Paperless utilise Tika pour: - Parsing de formats complexes (Office, iWork, etc.) - OCR avanc\u00e9 pour images et PDF scann\u00e9s - Extraction de m\u00e9tadonn\u00e9es</p> <p>Endpoint Tika: http://tika.srv759970.hstgr.cloud</p>"},{"location":"02-applications/documents/paperless-ngx/#gotenberg","title":"Gotenberg","text":"<p>Service de conversion PDF pour: - G\u00e9n\u00e9ration de previews - Conversion Office \u2192 PDF - Fusion de documents</p>"},{"location":"02-applications/documents/paperless-ngx/#redis","title":"Redis","text":"<p>Cache pour: - Sessions utilisateurs - R\u00e9sultats de recherche - Tasks Celery (processing asynchrone)</p>"},{"location":"02-applications/documents/paperless-ngx/#api","title":"API","text":""},{"location":"02-applications/documents/paperless-ngx/#documentation","title":"Documentation","text":"<p>Swagger UI: https://paperless.srv759970.hstgr.cloud/api/docs/</p>"},{"location":"02-applications/documents/paperless-ngx/#endpoints-principaux","title":"Endpoints Principaux","text":"<pre><code># Authentification\nPOST /api/token/\nPOST /api/token/refresh/\n\n# Documents\nGET /api/documents/\nGET /api/documents/{id}/\nPOST /api/documents/\nDELETE /api/documents/{id}/\n\n# T\u00e9l\u00e9chargement\nGET /api/documents/{id}/download/\nGET /api/documents/{id}/preview/\n\n# Recherche\nGET /api/documents/?query=facture&amp;tags__id__in=1,2\n\n# Tags\nGET /api/tags/\nPOST /api/tags/\n\n# Correspondants\nGET /api/correspondents/\nPOST /api/correspondents/\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#exemple-dutilisation","title":"Exemple d'Utilisation","text":"<pre><code># Obtenir un token\nTOKEN=$(curl -X POST https://paperless.srv759970.hstgr.cloud/api/token/ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"admin\",\"password\":\"&lt;password&gt;\"}' \\\n  | jq -r .access)\n\n# Lister les documents\ncurl https://paperless.srv759970.hstgr.cloud/api/documents/ \\\n  -H \"Authorization: Bearer $TOKEN\"\n\n# Upload d'un document\ncurl -X POST https://paperless.srv759970.hstgr.cloud/api/documents/post_document/ \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -F \"document=@facture.pdf\" \\\n  -F \"title=Facture EDF Janvier 2024\"\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#administration","title":"Administration","text":""},{"location":"02-applications/documents/paperless-ngx/#acces-admin","title":"Acc\u00e8s Admin","text":"<p>URL: https://paperless.srv759970.hstgr.cloud/admin/ Username: <code>admin</code> Password: Voir <code>/opt/paperless/.env</code></p>"},{"location":"02-applications/documents/paperless-ngx/#commandes-de-gestion","title":"Commandes de Gestion","text":"<pre><code># Acc\u00e9der au container\ndocker exec -it paperless-ngx bash\n\n# Cr\u00e9er un superuser\ndocker exec -it paperless-ngx python3 manage.py createsuperuser\n\n# Re-indexer tous les documents\ndocker exec -it paperless-ngx python3 manage.py document_index reindex\n\n# Lancer OCR sur documents existants\ndocker exec -it paperless-ngx python3 manage.py document_retagger --tags\n\n# Backup\ndocker exec -it paperless-ngx python3 manage.py document_exporter /export/backup/\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#maintenance","title":"Maintenance","text":"<p>Nettoyage des vignettes: <pre><code>docker exec -it paperless-ngx python3 manage.py document_thumbnails --recreate\n</code></pre></p> <p>V\u00e9rification de l'index: <pre><code>docker exec -it paperless-ngx python3 manage.py document_index check\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/documents/paperless-ngx/#protection","title":"Protection","text":"<ul> <li>\u2705 HTTPS - Let's Encrypt SSL/TLS</li> <li>\u2705 Authentification - Comptes utilisateurs avec permissions</li> <li>\u2705 Basic Auth Nginx - Protection suppl\u00e9mentaire au niveau proxy</li> <li>\u2705 CORS - Configur\u00e9 pour l'API</li> </ul>"},{"location":"02-applications/documents/paperless-ngx/#recommandations","title":"Recommandations","text":"<ol> <li>\u2705 Activer 2FA pour les comptes admin</li> <li>\u2705 Rotation r\u00e9guli\u00e8re des tokens API</li> <li>\u2705 Limiter les permissions par utilisateur</li> <li>\u2705 Chiffrer les documents sensibles</li> </ol>"},{"location":"02-applications/documents/paperless-ngx/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/documents/paperless-ngx/#les-documents-ne-sont-pas-traites","title":"Les Documents ne Sont pas Trait\u00e9s","text":"<p>V\u00e9rifier les workers: <pre><code>docker logs paperless-ngx | grep celery\ndocker exec -it paperless-ngx celery -A paperless inspect active\n</code></pre></p> <p>V\u00e9rifier la queue: <pre><code>docker exec -it paperless-ngx celery -A paperless inspect reserved\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#ocr-echoue","title":"OCR \u00c9choue","text":"<p>V\u00e9rifier Tika: <pre><code>curl http://tika.srv759970.hstgr.cloud\n</code></pre></p> <p>V\u00e9rifier les logs OCR: <pre><code>docker logs paperless-ngx | grep -i ocr\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#problemes-de-performance","title":"Probl\u00e8mes de Performance","text":"<p>Augmenter les workers: <pre><code>environment:\n  - PAPERLESS_TASK_WORKERS=4\n  - PAPERLESS_THREADS_PER_WORKER=2\n</code></pre></p>"},{"location":"02-applications/documents/paperless-ngx/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/documents/paperless-ngx/#metriques","title":"M\u00e9triques","text":"<ul> <li>Documents totaux</li> <li>Documents trait\u00e9s aujourd'hui</li> <li>Queue size</li> <li>Temps moyen de traitement</li> <li>Espace disque utilis\u00e9</li> </ul>"},{"location":"02-applications/documents/paperless-ngx/#logs","title":"Logs","text":"<pre><code># Logs temps r\u00e9el\ndocker logs -f paperless-ngx\n\n# Logs Celery\ndocker logs paperless-ngx | grep celery\n\n# Logs OCR\ndocker logs paperless-ngx | grep tesseract\n</code></pre>"},{"location":"02-applications/documents/paperless-ngx/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Apache Tika - Service de parsing utilis\u00e9 par Paperless</li> <li>Monitoring - Stack Grafana + Prometheus</li> <li>Infrastructure &gt; Backup</li> </ul>"},{"location":"02-applications/documents/paperless-ngx/#liens-externes","title":"Liens Externes","text":"<ul> <li>Documentation officielle: https://docs.paperless-ngx.com/</li> <li>GitHub: https://github.com/paperless-ngx/paperless-ngx</li> <li>Forum: https://github.com/paperless-ngx/paperless-ngx/discussions</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 Prochaine r\u00e9vision: Apr\u00e8s optimisation OCR</p>"},{"location":"02-applications/guides/astro-deployment/","title":"\ud83d\ude80 Guide Astro - D\u00e9ploiement sur VPS","text":"<p>Guide complet pour d\u00e9ployer des sites Astro sur VPS Hostinger avec Nginx</p>"},{"location":"02-applications/guides/astro-deployment/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<p>Astro : Framework SSG (Static Site Generator) qui g\u00e9n\u00e8re du HTML/CSS/JS pur Avantage : Sites ultra-rapides, z\u00e9ro JavaScript c\u00f4t\u00e9 client par d\u00e9faut D\u00e9ploiement : Fichiers statiques servis par Nginx (pas de Node.js n\u00e9cessaire en prod)</p>"},{"location":"02-applications/guides/astro-deployment/#architecture-de-deploiement","title":"\ud83c\udfd7\ufe0f Architecture de d\u00e9ploiement","text":"<pre><code>D\u00e9veloppement local (Windows)\n\u2502\n\u251c\u2500\u2500 pnpm dev          # Serveur de d\u00e9veloppement (port 4321)\n\u2514\u2500\u2500 pnpm build        # G\u00e9n\u00e8re le dossier dist/\n    \u2502\n    \u2514\u2500\u2500 dist/         # Fichiers statiques optimis\u00e9s\n        \u251c\u2500\u2500 index.html\n        \u251c\u2500\u2500 about/index.html\n        \u251c\u2500\u2500 contact/index.html\n        \u2514\u2500\u2500 _astro/   # Assets (CSS, JS, fonts)\n\n\u2193 Transfer (scp)\n\nVPS Hostinger (69.62.108.82)\n\u2502\n\u2514\u2500\u2500 /opt/mon-site/    # Contenu de dist/\n    \u2502\n    \u2514\u2500\u2500 Nginx (port 80/443)\n        \u2514\u2500\u2500 Servir fichiers statiques\n</code></pre> <p>R\u00e9sultat : Site ultra-rapide, pas de serveur Node.js n\u00e9cessaire</p>"},{"location":"02-applications/guides/astro-deployment/#workflow-de-deploiement","title":"\ud83d\ude80 Workflow de d\u00e9ploiement","text":""},{"location":"02-applications/guides/astro-deployment/#etape-1-build-local","title":"\u00c9tape 1 : Build local","text":"<pre><code>cd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\"\n\n# Build pour production\npnpm build\n# Ou : npm run build\n\n# V\u00e9rifier le dossier dist/ cr\u00e9\u00e9\nls dist/\n</code></pre> <p>R\u00e9sultat : Dossier <code>dist/</code> avec tous les fichiers optimis\u00e9s</p>"},{"location":"02-applications/guides/astro-deployment/#etape-2-creer-la-structure-sur-vps","title":"\u00c9tape 2 : Cr\u00e9er la structure sur VPS","text":"<pre><code># Cr\u00e9er le dossier destination\nssh root@69.62.108.82 \"mkdir -p /opt/mon-site\"\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#etape-3-transferer-les-fichiers","title":"\u00c9tape 3 : Transf\u00e9rer les fichiers","text":"<pre><code># Depuis le dossier du projet local\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\"\n\n# Transf\u00e9rer le contenu de dist/\nscp -r dist/* root@69.62.108.82:/opt/mon-site/\n\n# Alternative : rsync (plus rapide pour mise \u00e0 jour)\n# rsync -avz --delete dist/ root@69.62.108.82:/opt/mon-site/\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#etape-4-configurer-nginx","title":"\u00c9tape 4 : Configurer Nginx","text":"<p>Cr\u00e9er le fichier de configuration :</p> <pre><code>ssh root@69.62.108.82 \"cat &gt; /etc/nginx/sites-available/mon-site\" &lt;&lt;'EOF'\nserver {\n    listen 80;\n    server_name mon-site.srv759970.hstgr.cloud;\n\n    root /opt/mon-site;\n    index index.html;\n\n    # Logs\n    access_log /var/log/nginx/mon-site-access.log;\n    error_log /var/log/nginx/mon-site-error.log;\n\n    # Servir fichiers Astro\n    location / {\n        # Ordre important pour Astro !\n        # 1. Fichier exact\n        # 2. Fichier avec .html\n        # 3. R\u00e9pertoire avec trailing slash\n        # 4. R\u00e9pertoire/index.html\n        # 5. 404\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    # Cache assets statiques (CSS, JS, images, fonts)\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n\n    # Gzip compression\n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;\n    gzip_comp_level 6;\n}\nEOF\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#etape-5-activer-le-site","title":"\u00c9tape 5 : Activer le site","text":"<pre><code># Cr\u00e9er le symlink\nssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/mon-site /etc/nginx/sites-enabled/\"\n\n# Tester la config\nssh root@69.62.108.82 \"nginx -t\"\n\n# Recharger Nginx\nssh root@69.62.108.82 \"systemctl reload nginx\"\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#etape-6-configurer-sslhttps-recommande","title":"\u00c9tape 6 : Configurer SSL/HTTPS (recommand\u00e9)","text":""},{"location":"02-applications/guides/astro-deployment/#methode-certbot-standalone","title":"M\u00e9thode Certbot Standalone","text":"<p>Cette m\u00e9thode est recommand\u00e9e pour les sites statiques car elle est simple et fiable.</p> <pre><code># 1. Arr\u00eater Nginx temporairement\nssh root@69.62.108.82 \"systemctl stop nginx\"\n\n# 2. Obtenir le certificat SSL avec Certbot\nssh root@69.62.108.82 \"certbot certonly --standalone -d mon-site.srv759970.hstgr.cloud --non-interactive --agree-tos --email contact@srv759970.hstgr.cloud\"\n\n# 3. Red\u00e9marrer Nginx\nssh root@69.62.108.82 \"systemctl start nginx\"\n</code></pre> <p>R\u00e9sultat : Certificat SSL install\u00e9 dans <code>/etc/letsencrypt/live/mon-site.srv759970.hstgr.cloud/</code></p>"},{"location":"02-applications/guides/astro-deployment/#mettre-a-jour-la-config-nginx-avec-https","title":"Mettre \u00e0 jour la config Nginx avec HTTPS","text":"<pre><code>ssh root@69.62.108.82 'cat &gt; /etc/nginx/sites-available/mon-site &lt;&lt;'\"'\"'EOF'\"'\"'\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mon-site.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n\n# HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name mon-site.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/mon-site.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mon-site.srv759970.hstgr.cloud/privkey.pem;\n\n    root /opt/mon-site;\n    index index.html;\n\n    # Logs\n    access_log /var/log/nginx/mon-site-access.log;\n    error_log /var/log/nginx/mon-site-error.log;\n\n    # Pages Astro\n    location / {\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    # Cache assets statiques\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|webp|avif)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n\n    # Compression Gzip\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;\n\n    # Security headers\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n}\nEOF\n'\n\n# Tester et recharger\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#etape-7-verifier","title":"\u00c9tape 7 : V\u00e9rifier","text":"<pre><code># Tester HTTPS\ncurl -I https://mon-site.srv759970.hstgr.cloud/\n\n# Tester toutes les pages\ncurl -I https://mon-site.srv759970.hstgr.cloud/about/\ncurl -I https://mon-site.srv759970.hstgr.cloud/contact/\n</code></pre> <p>Attendu : HTTP 200 pour toutes les pages, redirection HTTP\u2192HTTPS</p>"},{"location":"02-applications/guides/astro-deployment/#problemes-courants-astro-specifiques","title":"\u26a0\ufe0f Probl\u00e8mes courants - Astro sp\u00e9cifiques","text":""},{"location":"02-applications/guides/astro-deployment/#probleme-1-404-sur-pages-secondaires","title":"Probl\u00e8me 1 : 404 sur pages secondaires","text":"<p>Sympt\u00f4mes : - Homepage (/) fonctionne - /about, /contact retournent 404</p> <p>Cause : Mauvaise config <code>try_files</code> dans Nginx</p> <p>Diagnostic : <pre><code># V\u00e9rifier structure dist/\nssh root@69.62.108.82 \"ls -la /opt/mon-site/\"\nssh root@69.62.108.82 \"ls -la /opt/mon-site/about/\"\n\n# Astro g\u00e9n\u00e8re : about/index.html\n</code></pre></p> <p>Solution : Utiliser le bon ordre <code>try_files</code></p> <pre><code>location / {\n    # \u2705 CORRECT pour Astro\n    try_files $uri $uri.html $uri/ $uri/index.html =404;\n}\n\n# \u274c INCORRECT (manque $uri/)\nlocation / {\n    try_files $uri $uri.html $uri/index.html =404;\n}\n</code></pre> <p>Pourquoi : Astro g\u00e9n\u00e8re <code>about/index.html</code>, donc Nginx doit essayer <code>$uri/</code> puis <code>$uri/index.html</code></p>"},{"location":"02-applications/guides/astro-deployment/#probleme-2-assets-cssjs-ne-chargent-pas-404","title":"Probl\u00e8me 2 : Assets (CSS/JS) ne chargent pas (404)","text":"<p>Sympt\u00f4mes : - HTML charge mais pas de style - Console navigateur : <code>404 Not Found</code> sur <code>/_astro/xxx.css</code></p> <p>Cause : Chemin incorrect ou fichiers non transf\u00e9r\u00e9s</p> <p>Diagnostic : <pre><code># V\u00e9rifier que _astro/ existe\nssh root@69.62.108.82 \"ls -la /opt/mon-site/_astro/\"\n\n# Tester un asset\nssh root@69.62.108.82 \"curl -I http://localhost/_astro/index.xxx.css\"\n</code></pre></p> <p>Solution : 1. V\u00e9rifier que <code>dist/_astro/</code> a bien \u00e9t\u00e9 transf\u00e9r\u00e9 2. Retransf\u00e9rer : <pre><code>scp -r dist/_astro root@69.62.108.82:/opt/mon-site/\n</code></pre></p>"},{"location":"02-applications/guides/astro-deployment/#probleme-3-rewrite-loop-500-internal-server-error","title":"Probl\u00e8me 3 : Rewrite loop (500 Internal Server Error)","text":"<p>Sympt\u00f4mes : - Erreur 500 - Logs Nginx : <code>rewrite or internal redirection cycle</code></p> <p>Cause : <code>error_page 404 /index.html</code> combin\u00e9 avec <code>try_files</code></p> <p>Mauvaise config : <pre><code>location / {\n    try_files $uri $uri/ /index.html;\n    error_page 404 /index.html;  # \u2190 BOUCLE !\n}\n</code></pre></p> <p>Bonne config : <pre><code>location / {\n    try_files $uri $uri.html $uri/ $uri/index.html =404;\n    # Pas de error_page 404 !\n}\n</code></pre></p>"},{"location":"02-applications/guides/astro-deployment/#probleme-4-spa-mode-client-side-routing-ne-fonctionne-pas","title":"Probl\u00e8me 4 : SPA mode (client-side routing) ne fonctionne pas","text":"<p>Sympt\u00f4mes : - Liens internes cass\u00e9s - Refresh sur <code>/about</code> \u2192 404</p> <p>Cause : Astro en mode SPA n\u00e9cessite une config diff\u00e9rente</p> <p>Solution : Si vous utilisez <code>@astrojs/react</code> ou <code>@astrojs/vue</code> avec client-side routing :</p> <pre><code>location / {\n    # SPA mode : toujours servir index.html\n    try_files $uri $uri/ /index.html;\n}\n</code></pre> <p>Note : Pour Astro en mode SSG normal (d\u00e9faut), utiliser la config standard.</p>"},{"location":"02-applications/guides/astro-deployment/#configuration-nginx-optimale-pour-astro","title":"\ud83d\udd27 Configuration Nginx optimale pour Astro","text":""},{"location":"02-applications/guides/astro-deployment/#configuration-de-base-recommandee","title":"Configuration de base (recommand\u00e9e)","text":"<pre><code>server {\n    listen 80;\n    server_name mon-site.srv759970.hstgr.cloud;\n\n    root /opt/mon-site;\n    index index.html;\n\n    # Logs\n    access_log /var/log/nginx/mon-site-access.log;\n    error_log /var/log/nginx/mon-site-error.log;\n\n    # Pages Astro (SSG mode)\n    location / {\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    # Cache assets statiques\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|webp|avif)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n\n    # Compression Gzip\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;\n}\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#configuration-avancee-avec-brotli","title":"Configuration avanc\u00e9e (avec Brotli)","text":"<pre><code>server {\n    listen 80;\n    server_name mon-site.srv759970.hstgr.cloud;\n\n    root /opt/mon-site;\n    index index.html;\n\n    # Logs\n    access_log /var/log/nginx/mon-site-access.log;\n    error_log /var/log/nginx/mon-site-error.log;\n\n    # Pages Astro\n    location / {\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    # Cache assets avec hash (Astro g\u00e9n\u00e8re des noms de fichiers avec hash)\n    location /_astro/ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n        # Pas besoin de revalidation, hash change = nouveau fichier\n    }\n\n    # Images et fonts\n    location ~* \\.(png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|webp|avif)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n\n    # Compression Gzip\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;\n\n    # S\u00e9curit\u00e9 headers\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n}\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#workflow-de-mise-a-jour","title":"\ud83d\udd04 Workflow de mise \u00e0 jour","text":""},{"location":"02-applications/guides/astro-deployment/#mise-a-jour-complete","title":"Mise \u00e0 jour compl\u00e8te","text":"<pre><code># 1. Local : Rebuild\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\"\npnpm build\n\n# 2. Transf\u00e9rer (\u00e9crase tout)\nscp -r dist/* root@69.62.108.82:/opt/mon-site/\n\n# 3. Pas de red\u00e9marrage n\u00e9cessaire (fichiers statiques)\n# Optionnel : vider cache Nginx\nssh root@69.62.108.82 \"nginx -s reload\"\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#mise-a-jour-partielle-plus-rapide","title":"Mise \u00e0 jour partielle (plus rapide)","text":"<pre><code># Utiliser rsync (ne transf\u00e8re que les diff\u00e9rences)\nrsync -avz --delete dist/ root@69.62.108.82:/opt/mon-site/\n</code></pre> <p>Avantage rsync : - Transf\u00e8re seulement les fichiers modifi\u00e9s - <code>--delete</code> supprime les vieux fichiers sur le VPS - Plus rapide pour gros sites</p>"},{"location":"02-applications/guides/astro-deployment/#scripts-de-deploiement-automatises","title":"\ud83e\udd16 Scripts de d\u00e9ploiement automatis\u00e9s","text":""},{"location":"02-applications/guides/astro-deployment/#script-bash-linuxmac","title":"Script Bash (Linux/Mac)","text":"<p>Cr\u00e9er <code>deploy.sh</code> dans votre projet :</p> <pre><code>#!/bin/bash\n\n# Script de d\u00e9ploiement automatis\u00e9 pour Astro sur VPS Hostinger\nset -e\n\n# Configuration\nVPS_HOST=\"root@69.62.108.82\"\nVPS_PATH=\"/opt/mon-site\"\nDOMAIN=\"mon-site.srv759970.hstgr.cloud\"\n\n# Couleurs\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\necho -e \"${BLUE}\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501${NC}\"\necho -e \"${BLUE}  D\u00e9ploiement du site sur Hostinger VPS${NC}\"\necho -e \"${BLUE}\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501${NC}\"\necho \"\"\n\n# \u00c9tape 1: Build local\necho -e \"${YELLOW}[1/5]${NC} Build du site Astro...\"\npnpm build\n\nif [ $? -eq 0 ]; then\n    echo -e \"${GREEN}\u2713${NC} Build r\u00e9ussi\"\nelse\n    echo -e \"${RED}\u2717${NC} Erreur lors du build\"\n    exit 1\nfi\necho \"\"\n\n# \u00c9tape 2: Sauvegarde du site actuel\necho -e \"${YELLOW}[2/5]${NC} Sauvegarde du site actuel sur le VPS...\"\nssh $VPS_HOST \"if [ -d $VPS_PATH ]; then cp -r $VPS_PATH ${VPS_PATH}_backup_\\$(date +%Y%m%d_%H%M%S); echo 'Sauvegarde cr\u00e9\u00e9e'; else echo 'Pas de site existant \u00e0 sauvegarder'; fi\"\necho -e \"${GREEN}\u2713${NC} Sauvegarde effectu\u00e9e\"\necho \"\"\n\n# \u00c9tape 3: Nettoyage du r\u00e9pertoire cible\necho -e \"${YELLOW}[3/5]${NC} Nettoyage du r\u00e9pertoire cible...\"\nssh $VPS_HOST \"rm -rf $VPS_PATH/* &amp;&amp; mkdir -p $VPS_PATH\"\necho -e \"${GREEN}\u2713${NC} R\u00e9pertoire nettoy\u00e9\"\necho \"\"\n\n# \u00c9tape 4: Transfer des fichiers\necho -e \"${YELLOW}[4/5]${NC} Transfer des fichiers vers le VPS...\"\nscp -r dist/* $VPS_HOST:$VPS_PATH/\n\nif [ $? -eq 0 ]; then\n    echo -e \"${GREEN}\u2713${NC} Fichiers transf\u00e9r\u00e9s avec succ\u00e8s\"\nelse\n    echo -e \"${RED}\u2717${NC} Erreur lors du transfert\"\n    echo -e \"${YELLOW}Restauration de la sauvegarde...${NC}\"\n    ssh $VPS_HOST \"BACKUP=\\$(ls -t ${VPS_PATH}_backup_* 2&gt;/dev/null | head -1); if [ -n \\\"\\$BACKUP\\\" ]; then rm -rf $VPS_PATH &amp;&amp; mv \\$BACKUP $VPS_PATH; echo 'Sauvegarde restaur\u00e9e'; fi\"\n    exit 1\nfi\necho \"\"\n\n# \u00c9tape 5: V\u00e9rification du d\u00e9ploiement\necho -e \"${YELLOW}[5/5]${NC} V\u00e9rification du d\u00e9ploiement...\"\nssh $VPS_HOST \"ls -lh $VPS_PATH | head -10\"\n\n# Test HTTP\nHTTP_CODE=$(curl -o /dev/null -s -w \"%{http_code}\" https://$DOMAIN/)\nif [ \"$HTTP_CODE\" -eq 200 ]; then\n    echo -e \"${GREEN}\u2713${NC} Site accessible (HTTP $HTTP_CODE)\"\nelse\n    echo -e \"${RED}\u2717${NC} Site non accessible (HTTP $HTTP_CODE)\"\nfi\necho \"\"\n\n# R\u00e9sum\u00e9\necho -e \"${BLUE}\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501${NC}\"\necho -e \"${GREEN}\u2713 D\u00e9ploiement termin\u00e9 avec succ\u00e8s !${NC}\"\necho -e \"${BLUE}\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501${NC}\"\necho \"\"\necho -e \"Site accessible sur: ${GREEN}https://$DOMAIN${NC}\"\necho \"\"\n</code></pre> <p>Utilisation : <pre><code>chmod +x deploy.sh\n./deploy.sh\n</code></pre></p>"},{"location":"02-applications/guides/astro-deployment/#script-powershell-windows","title":"Script PowerShell (Windows)","text":"<p>Cr\u00e9er <code>deploy.ps1</code> dans votre projet :</p> <pre><code># Script de d\u00e9ploiement automatis\u00e9 pour Astro sur VPS Hostinger\n\n# Configuration\n$VPS_HOST = \"root@69.62.108.82\"\n$VPS_PATH = \"/opt/mon-site\"\n$DOMAIN = \"mon-site.srv759970.hstgr.cloud\"\n\nWrite-Host \"`n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\" -ForegroundColor Blue\nWrite-Host \"  D\u00e9ploiement du site sur Hostinger VPS\" -ForegroundColor Blue\nWrite-Host \"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`n\" -ForegroundColor Blue\n\n# \u00c9tape 1: Build local\nWrite-Host \"[1/5] Build du site Astro...\" -ForegroundColor Yellow\npnpm build\n\nif ($LASTEXITCODE -eq 0) {\n    Write-Host \"\u2713 Build r\u00e9ussi`n\" -ForegroundColor Green\n} else {\n    Write-Host \"\u2717 Erreur lors du build\" -ForegroundColor Red\n    exit 1\n}\n\n# \u00c9tape 2: Sauvegarde\nWrite-Host \"[2/5] Sauvegarde du site actuel sur le VPS...\" -ForegroundColor Yellow\nssh $VPS_HOST \"if [ -d $VPS_PATH ]; then cp -r $VPS_PATH ${VPS_PATH}_backup_`$(date +%Y%m%d_%H%M%S); echo 'Sauvegarde cr\u00e9\u00e9e'; else echo 'Pas de site existant \u00e0 sauvegarder'; fi\"\nWrite-Host \"\u2713 Sauvegarde effectu\u00e9e`n\" -ForegroundColor Green\n\n# \u00c9tape 3: Nettoyage\nWrite-Host \"[3/5] Nettoyage du r\u00e9pertoire cible...\" -ForegroundColor Yellow\nssh $VPS_HOST \"rm -rf $VPS_PATH/* &amp;&amp; mkdir -p $VPS_PATH\"\nWrite-Host \"\u2713 R\u00e9pertoire nettoy\u00e9`n\" -ForegroundColor Green\n\n# \u00c9tape 4: Transfer\nWrite-Host \"[4/5] Transfer des fichiers vers le VPS...\" -ForegroundColor Yellow\nscp -r dist/* \"${VPS_HOST}:${VPS_PATH}/\"\n\nif ($LASTEXITCODE -eq 0) {\n    Write-Host \"\u2713 Fichiers transf\u00e9r\u00e9s avec succ\u00e8s`n\" -ForegroundColor Green\n} else {\n    Write-Host \"\u2717 Erreur lors du transfert\" -ForegroundColor Red\n    Write-Host \"Restauration de la sauvegarde...\" -ForegroundColor Yellow\n    ssh $VPS_HOST \"BACKUP=`$(ls -t ${VPS_PATH}_backup_* 2&gt;/dev/null | head -1); if [ -n `\"`$BACKUP`\" ]; then rm -rf $VPS_PATH &amp;&amp; mv `$BACKUP $VPS_PATH; echo 'Sauvegarde restaur\u00e9e'; fi\"\n    exit 1\n}\n\n# \u00c9tape 5: V\u00e9rification\nWrite-Host \"[5/5] V\u00e9rification du d\u00e9ploiement...\" -ForegroundColor Yellow\nssh $VPS_HOST \"ls -lh $VPS_PATH | head -10\"\n\n# Test HTTP\ntry {\n    $response = Invoke-WebRequest -Uri \"https://$DOMAIN/\" -Method Head -UseBasicParsing\n    if ($response.StatusCode -eq 200) {\n        Write-Host \"\u2713 Site accessible (HTTP $($response.StatusCode))`n\" -ForegroundColor Green\n    }\n} catch {\n    Write-Host \"\u2717 Site non accessible`n\" -ForegroundColor Red\n}\n\n# R\u00e9sum\u00e9\nWrite-Host \"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\" -ForegroundColor Blue\nWrite-Host \"\u2713 D\u00e9ploiement termin\u00e9 avec succ\u00e8s !\" -ForegroundColor Green\nWrite-Host \"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`n\" -ForegroundColor Blue\n\nWrite-Host \"Site accessible sur: https://$DOMAIN`n\" -ForegroundColor Green\n</code></pre> <p>Utilisation : <pre><code>.\\deploy.ps1\n</code></pre></p>"},{"location":"02-applications/guides/astro-deployment/#fonctionnalites-des-scripts","title":"Fonctionnalit\u00e9s des scripts","text":"<p>Les deux scripts automatisent : - \u2705 Build avec <code>pnpm build</code> - \u2705 Sauvegarde automatique du site actuel avec timestamp - \u2705 Nettoyage du r\u00e9pertoire cible - \u2705 Transfer SCP vers le VPS - \u2705 V\u00e9rification HTTP post-d\u00e9ploiement - \u2705 Rollback automatique en cas d'erreur de transfert - \u2705 Interface color\u00e9e avec progression</p>"},{"location":"02-applications/guides/astro-deployment/#optimisations-performance","title":"\ud83d\udcca Optimisations performance","text":""},{"location":"02-applications/guides/astro-deployment/#1-verifier-la-taille-du-build","title":"1. V\u00e9rifier la taille du build","text":"<pre><code># Analyser la taille des assets\ncd dist\ndu -sh *\ndu -sh _astro/*\n</code></pre> <p>Si trop gros : - Optimiser les images (WebP, AVIF) - V\u00e9rifier que les node_modules ne sont pas inclus (ne devrait pas) - Utiliser <code>astro build --mode production</code></p>"},{"location":"02-applications/guides/astro-deployment/#2-preload-des-ressources-critiques","title":"2. Preload des ressources critiques","text":"<p>Dans <code>Layout.astro</code> :</p> <pre><code>---\n// Layout.astro\n---\n&lt;head&gt;\n  &lt;!-- Preload font critique --&gt;\n  &lt;link rel=\"preload\" href=\"/fonts/main.woff2\" as=\"font\" type=\"font/woff2\" crossorigin&gt;\n\n  &lt;!-- Preconnect CDN --&gt;\n  &lt;link rel=\"preconnect\" href=\"https://fonts.googleapis.com\"&gt;\n  &lt;link rel=\"dns-prefetch\" href=\"https://fonts.googleapis.com\"&gt;\n&lt;/head&gt;\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#3-compression-brotli-meilleure-que-gzip","title":"3. Compression Brotli (meilleure que Gzip)","text":"<pre><code># Installer module Brotli (si pas d\u00e9j\u00e0 install\u00e9)\nssh root@69.62.108.82 \"apt install -y nginx-module-brotli\"\n</code></pre> <pre><code># Dans nginx.conf ou site config\nbrotli on;\nbrotli_comp_level 6;\nbrotli_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;\n</code></pre>"},{"location":"02-applications/guides/astro-deployment/#checklist-de-deploiement","title":"\ud83d\udd0d Checklist de d\u00e9ploiement","text":"<p>Avant de d\u00e9ployer un site Astro :</p> <ul> <li> Build local r\u00e9ussi (<code>pnpm build</code>)</li> <li> Dossier <code>dist/</code> g\u00e9n\u00e9r\u00e9</li> <li> Structure v\u00e9rifi\u00e9e : <code>index.html</code>, <code>about/index.html</code>, <code>_astro/</code></li> <li> Structure cr\u00e9\u00e9e sur VPS (<code>/opt/mon-site/</code>)</li> <li> Fichiers transf\u00e9r\u00e9s (<code>scp -r dist/*</code>)</li> <li> Config Nginx cr\u00e9\u00e9e avec bon <code>try_files</code></li> <li> Config Nginx test\u00e9e (<code>nginx -t</code>)</li> <li> Site activ\u00e9 (symlink dans <code>sites-enabled/</code>)</li> <li> Nginx recharg\u00e9 (<code>systemctl reload nginx</code>)</li> <li> Toutes les pages test\u00e9es (HTTP 200)</li> <li> Assets chargent correctement (CSS, JS, images)</li> <li> Pas d'erreurs dans logs Nginx</li> </ul>"},{"location":"02-applications/guides/astro-deployment/#cas-reels-deployes","title":"\ud83c\udfaf Cas r\u00e9els d\u00e9ploy\u00e9s","text":""},{"location":"02-applications/guides/astro-deployment/#site-1-cristina-astro-514-tailwind-css","title":"Site 1 : Cristina (Astro 5.14 + Tailwind CSS)","text":"<p>Structure : <pre><code>dist/\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 ateliers/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 a-propos/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 contact/\n\u2502   \u2514\u2500\u2500 index.html\n\u2514\u2500\u2500 _astro/\n    \u251c\u2500\u2500 index.xxx.css\n    \u2514\u2500\u2500 index.xxx.js\n</code></pre></p> <p>Config Nginx : <code>/etc/nginx/sites-available/cristina</code> URL : https://cristina.srv759970.hstgr.cloud SSL : \u2705 Let's Encrypt</p> <p>Probl\u00e8mes rencontr\u00e9s : 1. \u274c 404 sur <code>/ateliers</code> \u2192 Solution : <code>try_files $uri $uri.html $uri/ $uri/index.html</code> 2. \u274c Conflit avec autre site (<code>server_name _</code>) \u2192 Solution : server_name sp\u00e9cifique</p> <p>R\u00e9sultat : \u2705 Toutes pages en HTTP 200, HTTPS actif</p>"},{"location":"02-applications/guides/astro-deployment/#site-2-clemence-astro-514-site-rh-diversite-inclusion","title":"Site 2 : Cl\u00e9mence (Astro 5.14 - Site RH Diversit\u00e9 &amp; Inclusion)","text":"<p>Structure : <pre><code>dist/\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 a-propos/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 services/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 projets-engages/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 cadre-juridique/\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 contact/\n\u2502   \u2514\u2500\u2500 index.html\n\u2514\u2500\u2500 _astro/\n    \u251c\u2500\u2500 index.xxx.css\n    \u2514\u2500\u2500 index.xxx.js\n</code></pre></p> <p>Config Nginx : <code>/etc/nginx/sites-available/clemence</code> URL : https://clemence.srv759970.hstgr.cloud Path VPS : <code>/opt/clemence-site</code> SSL : \u2705 Let's Encrypt (Certbot standalone)</p> <p>Fonctionnalit\u00e9s : - 6 pages : Accueil, \u00c0 propos, Services, Projets engag\u00e9s, Cadre juridique, Contact - Layout partag\u00e9 avec navigation - Design system avec couleurs personnalis\u00e9es - Scripts de d\u00e9ploiement automatis\u00e9s (deploy.sh + deploy.ps1)</p> <p>D\u00e9ploiement : - M\u00e9thode : Certbot standalone pour SSL - HTTP\u2192HTTPS redirect configur\u00e9 - Security headers ajout\u00e9s</p> <p>R\u00e9sultat : \u2705 Toutes pages en HTTP 200, HTTPS actif, navigation fonctionnelle</p>"},{"location":"02-applications/guides/astro-deployment/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Astro Documentation</li> <li>Astro Deployment Guide</li> <li>Nginx Documentation</li> <li>Guide Nginx VPS</li> </ul>"},{"location":"02-applications/guides/astro-deployment/#troubleshooting-rapide","title":"\ud83c\udd98 Troubleshooting rapide","text":"Sympt\u00f4me Cause probable Solution 404 sur pages secondaires <code>try_files</code> mal configur\u00e9 <code>try_files $uri $uri.html $uri/ $uri/index.html =404;</code> 404 sur assets CSS/JS Dossier <code>_astro/</code> non transf\u00e9r\u00e9 <code>scp -r dist/_astro root@69.62.108.82:/opt/mon-site/</code> 500 rewrite loop <code>error_page 404</code> + <code>try_files</code> Supprimer <code>error_page 404</code> Homepage OK mais autres 404 Conflit avec autre site V\u00e9rifier <code>server_name</code> (pas de <code>_</code>) Assets ne chargent pas Mauvais cache headers V\u00e9rifier config cache dans Nginx <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version : 2.0 Sites Astro d\u00e9ploy\u00e9s : 2 (Cristina, Cl\u00e9mence) Nouvelles sections (v2.0) : SSL/HTTPS avec Certbot standalone, Scripts de d\u00e9ploiement automatis\u00e9s</p>"},{"location":"02-applications/guides/cache-wordpress/","title":"Guide Cache Nginx pour WordPress","text":"<p>Derni\u00e8re mise \u00e0 jour : 18 octobre 2025 Serveur : srv759970.hstgr.cloud (69.62.108.82) Sites concern\u00e9s : clemence.srv759970.hstgr.cloud, solidarlink.srv759970.hstgr.cloud</p>"},{"location":"02-applications/guides/cache-wordpress/#objectif","title":"Objectif","text":"<p>Am\u00e9liorer les performances des sites WordPress en mettant en cache les r\u00e9ponses HTTP au niveau du reverse proxy Nginx, r\u00e9duisant ainsi la charge sur les containers WordPress et acc\u00e9l\u00e9rant le temps de r\u00e9ponse pour les visiteurs.</p> <p>B\u00e9n\u00e9fices attendus : - \u2705 Temps de chargement 2-3x plus rapide pour les pages mises en cache - \u2705 R\u00e9duction de la charge CPU/RAM sur les containers WordPress - \u2705 Meilleure exp\u00e9rience utilisateur - \u2705 Gestion automatique du cache (purge, invalidation)</p>"},{"location":"02-applications/guides/cache-wordpress/#architecture","title":"Architecture","text":"<pre><code>Client HTTPS Request\n     \u2193\nNginx (Port 443) - SSL Termination + Basic Auth\n     \u2193\nProxy Cache Layer \u2190 NOUVEAU !\n     \u2193\nAuto-Start Proxy (Port 8890)\n     \u2193\nWordPress Container (Port 9002 ou 9003)\n</code></pre> <p>Le cache intercepte les r\u00e9ponses des containers WordPress et les stocke sur disque. Les requ\u00eates suivantes sont servies directement depuis le cache sans solliciter le container.</p>"},{"location":"02-applications/guides/cache-wordpress/#configuration","title":"Configuration","text":""},{"location":"02-applications/guides/cache-wordpress/#1-zone-de-cache-globale","title":"1. Zone de cache globale","text":"<p>Fichier : <code>/etc/nginx/snippets/wordpress-cache.conf</code></p> <pre><code># WordPress Proxy Cache Configuration\nproxy_cache_path /var/cache/nginx/wordpress levels=1:2 keys_zone=WORDPRESS:100m max_size=500m inactive=60m use_temp_path=off;\nproxy_cache_key $scheme$request_method$host$request_uri;\n\n# Bypass cache pour m\u00e9thodes POST\nmap $request_method $skip_cache_method {\n    default 0;\n    POST    1;\n}\n\n# Bypass cache pour URIs admin WordPress\nmap $request_uri $skip_cache_uri {\n    default 0;\n    ~*wp-admin  1;\n    ~*wp-login  1;\n    ~*wp-cron   1;\n    ~*xmlrpc    1;\n}\n\n# Bypass cache pour utilisateurs connect\u00e9s\nmap $http_cookie $skip_cache_cookie {\n    default 0;\n    ~*wordpress_logged_in  1;\n    ~*comment_author       1;\n    ~*wp-postpass          1;\n}\n\n# Combinaison finale\nmap $skip_cache_method$skip_cache_uri$skip_cache_cookie $skip_cache {\n    default 1;\n    000     0;\n}\n</code></pre> <p>Param\u00e8tres : - <code>keys_zone=WORDPRESS:100m</code> : 100MB pour stocker les cl\u00e9s de cache (\u2248800k pages) - <code>max_size=500m</code> : Taille maximale du cache sur disque (500MB) - <code>inactive=60m</code> : Supprimer les entr\u00e9es non acc\u00e9d\u00e9es depuis 60 minutes - <code>levels=1:2</code> : Structure de r\u00e9pertoires pour optimiser les acc\u00e8s disque</p>"},{"location":"02-applications/guides/cache-wordpress/#2-inclusion-dans-nginxconf","title":"2. Inclusion dans nginx.conf","text":"<p>Fichier : <code>/etc/nginx/nginx.conf</code></p> <p>Ajout\u00e9 dans le bloc <code>http {}</code> (ligne 61) :</p> <pre><code># WordPress cache configuration\ninclude /etc/nginx/snippets/wordpress-cache.conf;\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#3-configuration-par-site","title":"3. Configuration par site","text":""},{"location":"02-applications/guides/cache-wordpress/#clemence","title":"Cl\u00e9mence","text":"<p>Fichier : <code>/etc/nginx/sites-available/clemence</code></p> <pre><code>location / {\n    proxy_pass http://127.0.0.1:8890;\n\n    # WordPress Proxy Cache\n    proxy_cache WORDPRESS;\n    proxy_cache_bypass $skip_cache;\n    proxy_no_cache $skip_cache;\n    proxy_cache_valid 200 60m;\n    proxy_cache_valid 404 10m;\n    proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\n    proxy_cache_lock on;\n    add_header X-Cache-Status $upstream_cache_status;\n\n    # ... reste de la config proxy ...\n}\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#solidarlink","title":"SolidarLink","text":"<p>Fichier : <code>/etc/nginx/sites-available/solidarlink</code></p> <p>Configuration identique \u00e0 clemence (directives <code>proxy_cache*</code> ajout\u00e9es).</p>"},{"location":"02-applications/guides/cache-wordpress/#directives-importantes","title":"Directives importantes","text":""},{"location":"02-applications/guides/cache-wordpress/#proxy_cache-wordpress","title":"proxy_cache WORDPRESS","text":"<p>Active le cache en utilisant la zone \"WORDPRESS\" d\u00e9finie dans wordpress-cache.conf.</p>"},{"location":"02-applications/guides/cache-wordpress/#proxy_cache_bypass-skip_cache","title":"proxy_cache_bypass $skip_cache","text":"<p>Ne pas lire depuis le cache si <code>$skip_cache</code> vaut 1 (admin, POST, logged in).</p>"},{"location":"02-applications/guides/cache-wordpress/#proxy_no_cache-skip_cache","title":"proxy_no_cache $skip_cache","text":"<p>Ne pas \u00e9crire dans le cache si <code>$skip_cache</code> vaut 1.</p>"},{"location":"02-applications/guides/cache-wordpress/#proxy_cache_valid","title":"proxy_cache_valid","text":"<ul> <li><code>proxy_cache_valid 200 60m</code> : Cache les r\u00e9ponses 200 OK pendant 60 minutes</li> <li><code>proxy_cache_valid 404 10m</code> : Cache les 404 pendant 10 minutes seulement</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#proxy_cache_use_stale","title":"proxy_cache_use_stale","text":"<p>En cas d'erreur du backend (502, 503, timeout), servir une version stale (p\u00e9rim\u00e9e) du cache plut\u00f4t qu'une erreur. Tr\u00e8s important pour la disponibilit\u00e9 !</p>"},{"location":"02-applications/guides/cache-wordpress/#proxy_cache_lock","title":"proxy_cache_lock","text":"<p>Si plusieurs requ\u00eates demandent la m\u00eame ressource absente du cache, une seule va au backend, les autres attendent. \u00c9vite le \"cache stampede\".</p>"},{"location":"02-applications/guides/cache-wordpress/#add_header-x-cache-status","title":"add_header X-Cache-Status","text":"<p>Ajoute un header HTTP indiquant le statut du cache : - <code>MISS</code> : Pas en cache, r\u00e9cup\u00e9r\u00e9 depuis le backend - <code>HIT</code> : Servi depuis le cache - <code>BYPASS</code> : Cache ignor\u00e9 (admin, POST, logged in) - <code>STALE</code> : Version p\u00e9rim\u00e9e servie suite \u00e0 erreur backend - <code>UPDATING</code> : Mise \u00e0 jour en cours, version stale servie temporairement - <code>REVALIDATED</code> : Cache valid\u00e9 avec backend (304 Not Modified)</p>"},{"location":"02-applications/guides/cache-wordpress/#quand-le-cache-est-il-utilise","title":"Quand le cache est-il utilis\u00e9 ?","text":""},{"location":"02-applications/guides/cache-wordpress/#pages-mises-en-cache","title":"\u2705 Pages mises en cache","text":"<ul> <li>Pages publiques (homepage, articles, pages statiques)</li> <li>Archives (cat\u00e9gories, tags, dates)</li> <li>Flux RSS</li> <li>R\u00e9ponses JSON API publiques</li> </ul> <p>Conditions : - M\u00e9thode HTTP : <code>GET</code> ou <code>HEAD</code> - Pas de cookie <code>wordpress_logged_in</code> - Pas d'URL contenant <code>wp-admin</code>, <code>wp-login</code>, <code>wp-cron</code></p>"},{"location":"02-applications/guides/cache-wordpress/#pages-non-mises-en-cache","title":"\u274c Pages NON mises en cache","text":"<ul> <li>Toutes les requ\u00eates <code>POST</code> (formulaires, commentaires)</li> <li>URLs contenant <code>wp-admin</code>, <code>wp-login.php</code>, <code>wp-cron.php</code>, <code>xmlrpc.php</code></li> <li>Utilisateurs connect\u00e9s (cookie <code>wordpress_logged_in</code> pr\u00e9sent)</li> <li>Auteurs de commentaires (cookie <code>comment_author</code>)</li> <li>Pages prot\u00e9g\u00e9es par mot de passe (<code>wp-postpass</code> cookie)</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#verification-et-monitoring","title":"V\u00e9rification et monitoring","text":""},{"location":"02-applications/guides/cache-wordpress/#verifier-que-le-cache-fonctionne","title":"V\u00e9rifier que le cache fonctionne","text":"<pre><code># Depuis le serveur\ncurl -I https://clemence.srv759970.hstgr.cloud/ -k | grep X-Cache-Status\n# Devrait afficher : X-Cache-Status: MISS (premi\u00e8re requ\u00eate)\n\n# Deuxi\u00e8me requ\u00eate\ncurl -I https://clemence.srv759970.hstgr.cloud/ -k | grep X-Cache-Status\n# Devrait afficher : X-Cache-Status: HIT (deuxi\u00e8me requ\u00eate)\n</code></pre> <p>Note : Basic Auth requis pour clemence, utiliser <code>-u user:password</code>.</p>"},{"location":"02-applications/guides/cache-wordpress/#statistiques-du-cache","title":"Statistiques du cache","text":"<pre><code># Taille actuelle du cache\ndu -sh /var/cache/nginx/wordpress/\n\n# Nombre de fichiers en cache\nfind /var/cache/nginx/wordpress/ -type f | wc -l\n\n# Fichiers les plus r\u00e9cents (derni\u00e8res entr\u00e9es)\nfind /var/cache/nginx/wordpress/ -type f -mmin -10\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#logs","title":"Logs","text":"<p>Les logs Nginx access montrent les requ\u00eates :</p> <pre><code># Voir les requ\u00eates avec statut cache\ntail -f /var/log/nginx/clemence-access.log\ntail -f /var/log/nginx/solidarlink-access.log\n</code></pre> <p>L'en-t\u00eate <code>X-Cache-Status</code> est visible dans les logs si configur\u00e9 dans le format de log (actuellement format par d\u00e9faut, ne le montre pas).</p>"},{"location":"02-applications/guides/cache-wordpress/#gestion-du-cache","title":"Gestion du cache","text":""},{"location":"02-applications/guides/cache-wordpress/#purger-tout-le-cache","title":"Purger tout le cache","text":"<pre><code># Supprimer tous les fichiers de cache\nsudo rm -rf /var/cache/nginx/wordpress/*\n\n# Ou recr\u00e9er le r\u00e9pertoire avec bonnes permissions\nsudo rm -rf /var/cache/nginx/wordpress\nsudo mkdir -p /var/cache/nginx/wordpress\nsudo chown www-data:www-data /var/cache/nginx/wordpress\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#purger-le-cache-dun-site-specifique","title":"Purger le cache d'un site sp\u00e9cifique","text":"<p>Le cache utilise une cl\u00e9 bas\u00e9e sur <code>$scheme$request_method$host$request_uri</code>, donc les deux sites ont des cl\u00e9s diff\u00e9rentes. Cependant, ils partagent le m\u00eame r\u00e9pertoire <code>/var/cache/nginx/wordpress/</code>.</p> <p>Solution manuelle : Supprimer tout et laisser se reconstruire (WordPress met \u00e0 jour rarement).</p> <p>Solution avanc\u00e9e : Utiliser un plugin WordPress comme \"Nginx Helper\" qui envoie des purges au cache via des requ\u00eates PURGE HTTP (n\u00e9cessite configuration suppl\u00e9mentaire).</p>"},{"location":"02-applications/guides/cache-wordpress/#recharger-la-configuration","title":"Recharger la configuration","text":"<p>Apr\u00e8s modification des fichiers de configuration :</p> <pre><code># Tester la syntaxe\nsudo nginx -t\n\n# Recharger (sans downtime)\nsudo systemctl reload nginx\n\n# Red\u00e9marrer (si probl\u00e8me)\nsudo systemctl restart nginx\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#tuning-et-optimisation","title":"Tuning et optimisation","text":""},{"location":"02-applications/guides/cache-wordpress/#augmenter-la-taille-du-cache","title":"Augmenter la taille du cache","text":"<p>Si 500MB ne suffit pas :</p> <pre><code># Dans /etc/nginx/snippets/wordpress-cache.conf\nproxy_cache_path /var/cache/nginx/wordpress levels=1:2 keys_zone=WORDPRESS:200m max_size=2g inactive=120m use_temp_path=off;\n</code></pre> <ul> <li><code>keys_zone=200m</code> : 200MB de cl\u00e9s (\u22481.6M pages)</li> <li><code>max_size=2g</code> : 2GB de cache disque</li> <li><code>inactive=120m</code> : Garder les entr\u00e9es 2 heures</li> </ul> <p>Puis :</p> <pre><code>sudo systemctl reload nginx\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#ajuster-la-duree-de-cache","title":"Ajuster la dur\u00e9e de cache","text":"<p>Pour cacher plus longtemps les pages :</p> <pre><code># Dans les vhosts clemence et solidarlink\nproxy_cache_valid 200 120m;  # 2 heures au lieu de 60min\nproxy_cache_valid 404 30m;   # 30min pour 404\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#exclure-des-uris-supplementaires","title":"Exclure des URIs suppl\u00e9mentaires","text":"<p>Si certaines pages dynamiques sont mises en cache par erreur :</p> <pre><code># Dans /etc/nginx/snippets/wordpress-cache.conf\nmap $request_uri $skip_cache_uri {\n    default 0;\n    ~*wp-admin  1;\n    ~*wp-login  1;\n    ~*wp-cron   1;\n    ~*xmlrpc    1;\n    ~*/cart     1;  # Panier WooCommerce\n    ~*/checkout 1;  # Page de paiement\n    ~*/my-account 1; # Compte utilisateur\n}\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#cache-conditionnel-par-query-string","title":"Cache conditionnel par query string","text":"<p>Actuellement, toute query string cr\u00e9e une cl\u00e9 de cache unique. Pour ignorer certains param\u00e8tres :</p> <pre><code># Cl\u00e9 de cache sans query string inutiles\nproxy_cache_key \"$scheme$request_method$host$uri$is_args$filtered_args\";\n</code></pre> <p>(N\u00e9cessite configuration avanc\u00e9e avec <code>map</code> pour filtrer les args).</p>"},{"location":"02-applications/guides/cache-wordpress/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/guides/cache-wordpress/#cache-ne-semble-pas-fonctionner","title":"Cache ne semble pas fonctionner","text":"<p>V\u00e9rifications :</p> <ol> <li>Header X-Cache-Status pr\u00e9sent ? <pre><code>curl -I https://clemence.srv759970.hstgr.cloud/ -k | grep X-Cache\n</code></pre></li> </ol> <p>Si absent \u2192 Configuration proxy_cache non appliqu\u00e9e, v\u00e9rifier vhost et reload nginx.</p> <ol> <li>Toujours MISS ou BYPASS ?</li> <li>MISS : Normal premi\u00e8re requ\u00eate, deuxi\u00e8me devrait \u00eatre HIT</li> <li> <p>BYPASS : V\u00e9rifier que vous n'\u00eates pas logu\u00e9 (cookies), pas de POST, pas d'URL admin</p> </li> <li> <p>R\u00e9pertoire cache vide ? <pre><code>ls /var/cache/nginx/wordpress/\n</code></pre></p> </li> </ol> <p>Si vide \u2192 V\u00e9rifier permissions (doit \u00eatre <code>www-data:www-data</code>).</p> <ol> <li>Erreurs dans logs Nginx ? <pre><code>tail -50 /var/log/nginx/error.log | grep cache\n</code></pre></li> </ol>"},{"location":"02-applications/guides/cache-wordpress/#reponses-stale-servies-trop-souvent","title":"R\u00e9ponses stale servies trop souvent","text":"<p>Si <code>X-Cache-Status: STALE</code> appara\u00eet fr\u00e9quemment, le backend a des probl\u00e8mes. V\u00e9rifier :</p> <pre><code># Logs containers WordPress\ndocker logs -f wordpress-clemence\ndocker logs -f wordpress-solidarlink\n\n# Logs auto-start\njournalctl -u docker-autostart -f\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#espace-disque-plein","title":"Espace disque plein","text":"<p>Le cache est limit\u00e9 \u00e0 500MB (<code>max_size=500m</code>), mais si le disque se remplit :</p> <pre><code># V\u00e9rifier espace disque\ndf -h /var/cache\n\n# Purger manuellement\nsudo rm -rf /var/cache/nginx/wordpress/*\n</code></pre>"},{"location":"02-applications/guides/cache-wordpress/#cache-invalide-apres-mise-a-jour-wordpress","title":"Cache invalide apr\u00e8s mise \u00e0 jour WordPress","text":"<p>Apr\u00e8s mise \u00e0 jour de contenu WordPress, le cache peut servir des anciennes versions.</p> <p>Solution 1 : Attendre expiration (60min par d\u00e9faut)</p> <p>Solution 2 : Purge manuelle <pre><code>sudo rm -rf /var/cache/nginx/wordpress/*\n</code></pre></p> <p>Solution 3 : Plugin WordPress (Nginx Helper) pour purge automatique lors de publications.</p>"},{"location":"02-applications/guides/cache-wordpress/#performance-attendue","title":"Performance attendue","text":""},{"location":"02-applications/guides/cache-wordpress/#avant-cache-proxy-direct","title":"Avant cache (proxy direct)","text":"<ul> <li>Premi\u00e8re requ\u00eate : 500-1000ms (d\u00e9marrage container via auto-start)</li> <li>Requ\u00eates suivantes : 200-400ms (container chaud)</li> <li>RAM container : 150-300MB</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#apres-cache","title":"Apr\u00e8s cache","text":"<ul> <li>Premi\u00e8re requ\u00eate (MISS) : Identique (500-1000ms)</li> <li>Requ\u00eates suivantes (HIT) : 50-100ms (depuis Nginx cache)</li> <li>RAM \u00e9conomis\u00e9e : Container peut s'arr\u00eater plus vite (auto-start idle)</li> </ul> <p>Gain net : 5-10x plus rapide pour pages en cache, r\u00e9duction significative de la charge backend.</p>"},{"location":"02-applications/guides/cache-wordpress/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/cache-wordpress/#considerations","title":"Consid\u00e9rations","text":"<ol> <li> <p>Pas de cache pour contenu sensible : Les r\u00e8gles <code>$skip_cache</code> excluent d\u00e9j\u00e0 les zones admin et utilisateurs connect\u00e9s.</p> </li> <li> <p>Cache partag\u00e9 : Les deux sites (clemence + solidarlink) utilisent la m\u00eame zone de cache, mais les cl\u00e9s incluent <code>$host</code>, donc pas de collision.</p> </li> <li> <p>Headers de s\u00e9curit\u00e9 pr\u00e9serv\u00e9s : Le cache transmet les headers SSL/TLS et Security headers du backend.</p> </li> <li> <p>Basic Auth avant cache : Le basic auth Nginx s'applique avant le cache, donc pas de bypass possible.</p> </li> </ol>"},{"location":"02-applications/guides/cache-wordpress/#risques-potentiels","title":"Risques potentiels","text":"<ul> <li>\u274c Cache poisoning : Si un attaquant injecte des headers malicieux, ils peuvent \u00eatre cach\u00e9s. Risque faible avec configuration actuelle.</li> <li>\u274c Donn\u00e9es personnelles : V\u00e9rifier que les pages cach\u00e9es ne contiennent pas de donn\u00e9es sp\u00e9cifiques utilisateur.</li> <li>\u274c Stale content : Pages p\u00e9rim\u00e9es servies en cas d'erreur backend (voulu pour disponibilit\u00e9).</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#compatibilite","title":"Compatibilit\u00e9","text":""},{"location":"02-applications/guides/cache-wordpress/#plugins-wordpress","title":"Plugins WordPress","text":"<p>Compatible : - \u2705 Yoast SEO - \u2705 WooCommerce (avec exclusions <code>/cart</code>, <code>/checkout</code> si ajout\u00e9es) - \u2705 Contact Form 7 - \u2705 Elementor (pages statiques)</p> <p>Peut n\u00e9cessiter ajustements : - \u26a0\ufe0f Plugins de cache WordPress (W3 Total Cache, WP Super Cache) : D\u00e9sactiver ou coordonner - \u26a0\ufe0f Plugins e-commerce : Exclure panier, checkout, account pages - \u26a0\ufe0f Plugins de personnalisation dynamique : Peuvent \u00eatre affect\u00e9s</p> <p>Recommandation : D\u00e9sactiver les plugins de cache WordPress (inutiles avec cache Nginx).</p>"},{"location":"02-applications/guides/cache-wordpress/#auto-start-system","title":"Auto-Start System","text":"<p>Le cache Nginx fonctionne en amont de l'auto-start, donc :</p> <ul> <li>\u2705 Les requ\u00eates HIT ne d\u00e9clenchent PAS le d\u00e9marrage des containers</li> <li>\u2705 Les containers peuvent rester arr\u00eat\u00e9s plus longtemps (\u00e9conomie RAM)</li> <li>\u2705 Les requ\u00eates MISS d\u00e9clenchent l'auto-start normalement</li> </ul> <p>Synergie parfaite : Cache r\u00e9duit le nombre de d\u00e9marrages containers, auto-start r\u00e9duit l'utilisation RAM totale.</p>"},{"location":"02-applications/guides/cache-wordpress/#metriques-de-succes","title":"M\u00e9triques de succ\u00e8s","text":""},{"location":"02-applications/guides/cache-wordpress/#phase-de-test-1-semaine","title":"Phase de test (1 semaine)","text":"<ul> <li> X-Cache-Status HIT visible dans headers</li> <li> Temps de r\u00e9ponse moyen &lt; 100ms pour pages en cache</li> <li> Taux de HIT &gt; 70% sur trafic total</li> <li> Aucune plainte utilisateurs (pages p\u00e9rim\u00e9es, erreurs)</li> <li> Taille cache &lt; 500MB (limite non atteinte)</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#production-1-mois","title":"Production (1 mois)","text":"<ul> <li> R\u00e9duction 50% temps de d\u00e9marrage containers (moins sollicit\u00e9s)</li> <li> R\u00e9duction 30% RAM moyenne utilis\u00e9e (containers idle plus souvent)</li> <li> Temps de r\u00e9ponse moyen global &lt; 200ms</li> <li> Z\u00e9ro erreur de cache (stale content acceptable uniquement en erreur)</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Nginx Proxy Cache : https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache</li> <li>WordPress Nginx : https://www.nginx.com/resources/wiki/start/topics/recipes/wordpress/</li> <li>Cache Key Optimization : https://www.nginx.com/blog/nginx-caching-guide/</li> </ul>"},{"location":"02-applications/guides/cache-wordpress/#nginx-helper-plugin-purge-automatique","title":"Nginx Helper Plugin - Purge automatique","text":""},{"location":"02-applications/guides/cache-wordpress/#installation-et-configuration","title":"Installation et configuration","text":"<p>Le plugin Nginx Helper est install\u00e9 sur le site Clemence pour purger automatiquement le cache lors des mises \u00e0 jour de contenu WordPress.</p> <p>Plugin : https://wordpress.org/plugins/nginx-helper/</p> <p>Configuration active : <pre><code>// Options du plugin\nenable_purge: true\ncache_method: enable_fastcgi (compatible proxy_cache)\npurge_method: get_request\n\n// Hooks de purge automatique activ\u00e9s:\n- Purge homepage lors de nouvelle publication/modification/suppression\n- Purge archives lors de nouvelles publications\n- Purge page modifi\u00e9e\n- Purge page lors de nouveaux commentaires/commentaires supprim\u00e9s\n</code></pre></p> <p>Comment \u00e7a fonctionne :</p> <ol> <li>Lorsqu'une page/article WordPress est publi\u00e9/modifi\u00e9, le plugin d\u00e9clenche des hooks WordPress (<code>save_post</code>, <code>publish_post</code>, etc.)</li> <li>Le plugin envoie une requ\u00eate HTTP \u00e0 Nginx pour invalider les entr\u00e9es de cache concern\u00e9es</li> <li>Le cache Nginx supprime les entr\u00e9es, for\u00e7ant la r\u00e9g\u00e9n\u00e9ration au prochain acc\u00e8s</li> </ol> <p>Hooks WordPress utilis\u00e9s : - <code>save_post</code> \u2192 Purge la page/article modifi\u00e9 - <code>publish_post</code> \u2192 Purge homepage + archives - <code>wp_trash_post</code> \u2192 Purge homepage + archives - <code>comment_post</code> \u2192 Purge la page comment\u00e9e - <code>delete_comment</code> \u2192 Purge la page comment\u00e9e</p> <p>Avantage : Les visiteurs voient toujours le contenu \u00e0 jour sans intervention manuelle.</p>"},{"location":"02-applications/guides/cache-wordpress/#historique-des-modifications","title":"Historique des modifications","text":"Date Action Par 2025-10-18 Configuration initiale cache proxy WordPress Claude Code 2025-10-18 Ajout zones de cache globales Claude Code 2025-10-18 Activation cache clemence + solidarlink Claude Code 2025-10-18 Documentation compl\u00e8te cr\u00e9\u00e9e Claude Code 2025-10-20 Installation Nginx Helper sur Clemence Claude Code 2025-10-20 Configuration purge automatique via hooks Claude Code 2025-10-20 V\u00e9rification cache fonctionnel (HIT confirm\u00e9) Claude Code"},{"location":"02-applications/guides/cache-wordpress/#todo","title":"TODO","text":"<ul> <li> Tester cache depuis Windows avec credentials basic auth</li> <li> Nginx Helper install\u00e9 et configur\u00e9 pour purge automatique</li> <li> Monitorer taux HIT/MISS pendant 1 semaine</li> <li> Documenter proc\u00e9dure purge cache dans scripts maintenance</li> <li> Ajouter m\u00e9triques cache au dashboard auto-start (futur)</li> </ul> <p>Version : 1.1 Auteur : Claude Code + Julien Prochaine revue : Apr\u00e8s 1 semaine de production</p>"},{"location":"02-applications/guides/jitsi-transcription/","title":"\ud83c\udfa5 Analyse - Pipeline de Transcription Intelligent Jitsi avec OCR Local","text":"<p>Date de cr\u00e9ation : 2025-01-17 Contexte : ~5h r\u00e9unions/semaine, pas de GPU, OCR local souhait\u00e9, d\u00e9tection intelligente de slides</p>"},{"location":"02-applications/guides/jitsi-transcription/#table-des-matieres","title":"\ud83d\udccb Table des mati\u00e8res","text":"<ol> <li>Objectifs</li> <li>Solutions OCR locales</li> <li>D\u00e9tection changement de slides</li> <li>D\u00e9tection screenshare</li> <li>Architecture finale</li> <li>Performances et co\u00fbts</li> <li>Biblioth\u00e8ques recommand\u00e9es</li> </ol>"},{"location":"02-applications/guides/jitsi-transcription/#objectifs","title":"\ud83c\udfaf Objectifs","text":""},{"location":"02-applications/guides/jitsi-transcription/#problematique-initiale","title":"Probl\u00e9matique initiale","text":"<ul> <li>\u274c Claude Vision API : 1 frame/10sec \u2192 1800 frames/h \u2192 ~110\u20ac/mois pour 20h r\u00e9unions</li> <li>\u274c Beaucoup de frames redondantes (m\u00eame slide affich\u00e9e plusieurs minutes)</li> <li>\u274c OCR sur webcam inutile (seulement screenshare int\u00e9ressant)</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#solution-optimisee","title":"Solution optimis\u00e9e","text":"<ul> <li>\u2705 OCR local (CPU, gratuit)</li> <li>\u2705 D\u00e9tection intelligente des changements de slides (ImageHash)</li> <li>\u2705 OCR uniquement sur screenshare et nouvelles slides</li> <li>\u2705 30-50 OCR au lieu de 1800 par heure \u2192 0\u20ac/mois</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#1-ocr-local-paddleocr-recommande","title":"\ud83d\udd0d 1. OCR Local - PaddleOCR (recommand\u00e9)","text":""},{"location":"02-applications/guides/jitsi-transcription/#comparaison-des-3-principales-options","title":"Comparaison des 3 principales options","text":"Crit\u00e8re PaddleOCR \u2b50 Tesseract EasyOCR Pr\u00e9cision \u2b50\u2b50\u2b50\u2b50\u2b50 Meilleure \u2b50\u2b50\u2b50\u2b50 Bonne \u2b50\u2b50\u2b50\u2b50 Bonne CPU Performance \u2b50\u2b50\u2b50\u2b50 Rapide \u2b50\u2b50\u2b50\u2b50\u2b50 Tr\u00e8s rapide \u2b50\u2b50 Lent sans GPU Langues 80+ 100+ 80+ Slides/Pr\u00e9sentations \u2b50\u2b50\u2b50\u2b50\u2b50 Excellent \u2b50\u2b50\u2b50\u2b50 Tr\u00e8s bon \u2b50\u2b50\u2b50\u2b50 Tr\u00e8s bon Installation <code>pip install</code> <code>apt install</code> <code>pip install</code> D\u00e9pendances Medium L\u00e9g\u00e8res Lourdes (PyTorch)"},{"location":"02-applications/guides/jitsi-transcription/#pourquoi-paddleocr","title":"Pourquoi PaddleOCR ?","text":"<p>\u2705 Meilleure pr\u00e9cision globale : Moins d'erreurs que Tesseract selon benchmarks 2024 \u2705 Bon sur CPU : Acceptable pour ~5h/semaine (~150 slides \u00e0 OCR) \u2705 Architecture modulaire : D\u00e9tection texte + reconnaissance s\u00e9par\u00e9es \u2705 Optimis\u00e9 pour pr\u00e9sentations : Texte dans images complexes (graphiques, sch\u00e9mas) \u2705 Multilingue : Supporte 80+ langues dont fran\u00e7ais/anglais</p> <p>Sources : - OCR comparison: Tesseract vs EasyOCR vs PaddleOCR vs MMOCR - PaddleOCR vs Tesseract: Which is the best open source OCR?</p>"},{"location":"02-applications/guides/jitsi-transcription/#installation","title":"Installation","text":"<pre><code>pip install paddleocr paddlepaddle\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#usage-de-base","title":"Usage de base","text":"<pre><code>from paddleocr import PaddleOCR\n\n# Initialiser (une seule fois)\nocr = PaddleOCR(use_angle_cls=True, lang='fr', use_gpu=False)\n\n# OCR sur une image\nresult = ocr.ocr('screenshot_slide.jpg', cls=True)\n\n# Extraire le texte\ntext_lines = []\nif result and result[0]:\n    for line in result[0]:\n        text = line[1][0]  # [1][0] = texte d\u00e9tect\u00e9\n        confidence = line[1][1]  # [1][1] = score de confiance\n        text_lines.append(text)\n\nfull_text = '\\n'.join(text_lines)\nprint(full_text)\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#exemple-de-resultat","title":"Exemple de r\u00e9sultat","text":"<p>Input : Screenshot PowerPoint avec titre \"Q4 2024 Results\" et bullet points</p> <p>Output : <pre><code>[\n    [[[120, 45], [580, 45], [580, 95], [120, 95]], ('Q4 2024 Results', 0.987)],\n    [[[150, 180], [520, 180], [520, 220], [150, 220]], ('Revenue: +23% YoY', 0.953)],\n    [[[150, 250], [480, 250], [480, 290], [150, 290]], ('Customer growth: 45k', 0.941)]\n]\n</code></pre></p>"},{"location":"02-applications/guides/jitsi-transcription/#configuration-avancee","title":"Configuration avanc\u00e9e","text":"<pre><code># Optimisations pour screenshots de pr\u00e9sentations\nocr = PaddleOCR(\n    use_angle_cls=True,      # Correction rotation\n    lang='fr',               # ou 'en' pour anglais\n    use_gpu=False,           # CPU only\n    show_log=False,          # Pas de logs verbeux\n    det_db_thresh=0.3,       # Seuil d\u00e9tection texte (plus bas = plus sensible)\n    det_db_box_thresh=0.6,   # Seuil bounding boxes\n    rec_batch_num=6          # Batch size (augmenter si beaucoup de RAM)\n)\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#2-detection-changement-de-slides-imagehash-pyscenedetect","title":"\ud83c\udfaf 2. D\u00e9tection changement de slides - ImageHash + PySceneDetect","text":""},{"location":"02-applications/guides/jitsi-transcription/#solution-hybride-recommandee","title":"Solution hybride recommand\u00e9e","text":""},{"location":"02-applications/guides/jitsi-transcription/#a-imagehash-perceptual-hashing-recommande-pour-slides","title":"A. ImageHash - Perceptual Hashing \u2b50 Recommand\u00e9 pour slides","text":"<p>Concept : G\u00e9n\u00e9rer un \"hash perceptuel\" de chaque frame. Deux images similaires auront des hashes similaires.</p> <p>GitHub : https://github.com/JohannesBuchner/imagehash Stars : 3.2k | Derni\u00e8re release : 1er f\u00e9vrier 2025</p>"},{"location":"02-applications/guides/jitsi-transcription/#pourquoi-cest-parfait-pour-les-slides","title":"Pourquoi c'est parfait pour les slides ?","text":"<p>\u2705 Hash perceptuel : 2 images similaires = hashes similaires \u2705 Distance de Hamming : Mesure num\u00e9rique de la diff\u00e9rence (0 = identiques, 64 = tr\u00e8s diff\u00e9rents) \u2705 Insensible aux variations : Compression vid\u00e9o, petits mouvements de curseur ignor\u00e9s \u2705 Ultra rapide : Hash en &lt;1ms par image</p>"},{"location":"02-applications/guides/jitsi-transcription/#algorithmes-disponibles","title":"Algorithmes disponibles","text":"Algorithme Usage Vitesse Pr\u00e9cision <code>average_hash</code> Simple, slides statiques \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 <code>phash</code> (perceptual) \u2b50 Meilleur pour slides \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 <code>dhash</code> (difference) D\u00e9tection bordures \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 <code>whash</code> (wavelet) Tr\u00e8s pr\u00e9cis \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50"},{"location":"02-applications/guides/jitsi-transcription/#installation_1","title":"Installation","text":"<pre><code>pip install ImageHash Pillow\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#code-detection-changement-de-slide","title":"Code : D\u00e9tection changement de slide","text":"<pre><code>import imagehash\nfrom PIL import Image\nfrom pathlib import Path\n\ndef detect_slide_changes(frames: list[str], threshold: int = 5) -&gt; list[int]:\n    \"\"\"\n    D\u00e9tecte les changements de slides en comparant les hashes perceptuels.\n\n    Args:\n        frames: Liste de chemins vers les images (frames extraits)\n        threshold: Seuil de distance Hamming\n            - 0-5  : Images quasi identiques (m\u00eame slide)\n            - 6-10 : Petites variations (curseur, animation)\n            - 10+  : Changement significatif (nouvelle slide)\n\n    Returns:\n        Liste des indices de frames o\u00f9 un changement de slide est d\u00e9tect\u00e9\n\n    Example:\n        &gt;&gt;&gt; frames = [\"frame_0001.jpg\", \"frame_0002.jpg\", ...]\n        &gt;&gt;&gt; changes = detect_slide_changes(frames, threshold=8)\n        &gt;&gt;&gt; print(changes)\n        [45, 123, 289, 456]  # Nouvelles slides aux frames 45, 123, 289, 456\n    \"\"\"\n\n    changes = []\n    prev_hash = None\n\n    for i, frame_path in enumerate(frames):\n        img = Image.open(frame_path)\n\n        # G\u00e9n\u00e9rer hash perceptuel (16x16 = 256 bits)\n        current_hash = imagehash.phash(img, hash_size=16)\n\n        if prev_hash is not None:\n            # Distance de Hamming = nombre de bits diff\u00e9rents\n            distance = current_hash - prev_hash\n\n            if distance &gt; threshold:\n                changes.append(i)\n                print(f\"\ud83d\udcca Changement de slide d\u00e9tect\u00e9 : frame {i} (distance: {distance})\")\n\n        prev_hash = current_hash\n\n    return changes\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#exemple-dutilisation","title":"Exemple d'utilisation","text":"<pre><code># Cas d'usage : 1h de screenshare, 1 frame/sec = 3600 frames\nframes = [f\"frame_{i:04d}.jpg\" for i in range(3600)]\n\n# D\u00e9tection avec seuil 8 (\u00e9quilibre sensibilit\u00e9/bruit)\nslide_changes = detect_slide_changes(frames, threshold=8)\n\n# R\u00e9sultat typique : 30-50 changements de slides d\u00e9tect\u00e9s\nprint(f\"Slides d\u00e9tect\u00e9es : {len(slide_changes)}\")\n# \u2192 Slides d\u00e9tect\u00e9es : 42\n\n# OCR uniquement sur ces 42 frames au lieu de 3600 !\nfor idx in slide_changes:\n    ocr_result = ocr.ocr(frames[idx])\n    # ... traiter r\u00e9sultat\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#performances","title":"Performances","text":"<ul> <li>Hash d'une image 1920\u00d71080 : ~1-2ms</li> <li>Comparaison de 3600 frames : ~5-7 secondes</li> <li>Pour 1h vid\u00e9o (1 frame/sec) : ~7 secondes de traitement</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#reglage-du-seuil","title":"R\u00e9glage du seuil","text":"<pre><code># Tester diff\u00e9rents seuils pour trouver le bon \u00e9quilibre\ntest_frames = frames[:100]  # Tester sur 100 frames\n\nfor threshold in [5, 8, 10, 12, 15]:\n    changes = detect_slide_changes(test_frames, threshold=threshold)\n    print(f\"Seuil {threshold:2d} \u2192 {len(changes)} changements d\u00e9tect\u00e9s\")\n\n# Output typique :\n# Seuil  5 \u2192 23 changements d\u00e9tect\u00e9s (trop sensible, curseur = nouveau slide)\n# Seuil  8 \u2192 12 changements d\u00e9tect\u00e9s (bon \u00e9quilibre)\n# Seuil 10 \u2192 9 changements d\u00e9tect\u00e9s\n# Seuil 12 \u2192 7 changements d\u00e9tect\u00e9s\n# Seuil 15 \u2192 4 changements d\u00e9tect\u00e9s (pas assez sensible, rate des slides)\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#b-pyscenedetect-analyse-de-contenu-video","title":"B. PySceneDetect - Analyse de contenu vid\u00e9o","text":"<p>Utile pour : D\u00e9tection grossi\u00e8re des zones webcam vs screenshare</p> <p>GitHub : https://github.com/Breakthrough/PySceneDetect Stars : 3.8k | PyPI : https://pypi.org/project/scenedetect/</p>"},{"location":"02-applications/guides/jitsi-transcription/#installation_2","title":"Installation","text":"<pre><code>pip install scenedetect[opencv]\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#usage-detecter-les-scenes","title":"Usage : D\u00e9tecter les sc\u00e8nes","text":"<pre><code>from scenedetect import detect, ContentDetector, AdaptiveDetector\n\n# D\u00e9tecter les coupures de sc\u00e8ne (changement webcam \u2194 screenshare)\nscene_list = detect('meeting_recording.mp4', ContentDetector(threshold=30))\n\n# scene_list = [(start_timecode, end_timecode), ...]\n# Exemple :\n# [\n#   (00:00:00, 00:07:30),  # Sc\u00e8ne 1 : Webcam introduction\n#   (00:07:30, 00:35:12),  # Sc\u00e8ne 2 : Screenshare pr\u00e9sentation\n#   (00:35:12, 00:40:00),  # Sc\u00e8ne 3 : Retour webcam discussion\n#   (00:40:00, 01:00:00)   # Sc\u00e8ne 4 : Screenshare d\u00e9mo\n# ]\n\nfor i, (start, end) in enumerate(scene_list):\n    duration = (end - start).get_seconds()\n    print(f\"Sc\u00e8ne {i+1}: {start} \u2192 {end} ({duration:.1f}s)\")\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#extraire-frames-uniquement-dans-zones-screenshare","title":"Extraire frames uniquement dans zones screenshare","text":"<pre><code>from scenedetect import detect, ContentDetector\nimport cv2\n\n# 1. D\u00e9tecter les sc\u00e8nes\nscenes = detect('meeting.mp4', ContentDetector(threshold=27))\n\n# 2. Analyser chaque sc\u00e8ne pour d\u00e9terminer si screenshare\nfor i, (start, end) in enumerate(scenes):\n    # Extraire 1 frame au milieu de la sc\u00e8ne pour analyse\n    mid_frame_num = (start.frame_num + end.frame_num) // 2\n\n    cap = cv2.VideoCapture('meeting.mp4')\n    cap.set(cv2.CAP_PROP_POS_FRAMES, mid_frame_num)\n    ret, frame = cap.read()\n\n    # Tester si c'est screenshare (voir section 3 ci-dessous)\n    is_screen = is_screenshare_frame(frame)\n\n    if is_screen:\n        print(f\"Sc\u00e8ne {i}: {start} \u2192 {end} = SCREENSHARE \u2705\")\n        # Extraire frames de cette sc\u00e8ne pour ImageHash + OCR\n    else:\n        print(f\"Sc\u00e8ne {i}: {start} \u2192 {end} = WEBCAM \u23ed\ufe0f (skip)\")\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#3-detection-screenshare-dans-video-jitsi","title":"\ud83d\udda5\ufe0f 3. D\u00e9tection screenshare dans vid\u00e9o Jitsi","text":""},{"location":"02-applications/guides/jitsi-transcription/#3-approches-identifiees","title":"3 approches identifi\u00e9es","text":""},{"location":"02-applications/guides/jitsi-transcription/#approche-1-metadata-jibri-le-plus-fiable","title":"Approche 1 : Metadata Jibri \u2b50 Le plus fiable","text":"<p>D\u00e9couverte : Jibri g\u00e9n\u00e8re un fichier <code>metadata.json</code> lors de l'enregistrement.</p> <p>Source : Jitsi Community Forum - Jibri metadata.json</p>"},{"location":"02-applications/guides/jitsi-transcription/#localisation","title":"Localisation","text":"<pre><code>/tmp/recordings/&lt;MEETING_ID&gt;/metadata.json\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#structure-json","title":"Structure JSON","text":"<pre><code>{\n  \"meeting_url\": \"https://meet.jit.si/MyRoom\",\n  \"participants\": [\n    {\n      \"id\": \"abc123\",\n      \"name\": \"Julien\",\n      \"jid\": \"julien@meet.jit.si\"\n    },\n    {\n      \"id\": \"def456\",\n      \"name\": \"Cl\u00e9mence\",\n      \"jid\": \"clemence@meet.jit.si\"\n    }\n  ],\n  \"share\": true\n}\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#interpretation","title":"Interpr\u00e9tation","text":"<ul> <li><code>\"share\": true</code> \u2192 Au moins 1 screenshare a eu lieu pendant la r\u00e9union</li> <li><code>\"share\": false</code> \u2192 Pas de screenshare (uniquement webcams)</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#limitation","title":"\u26a0\ufe0f Limitation","text":"<p>Ce flag indique si il y a eu screenshare, mais pas quand (timestamps manquants).</p>"},{"location":"02-applications/guides/jitsi-transcription/#usage","title":"Usage","text":"<pre><code>import json\n\ndef check_has_screenshare(metadata_path: str) -&gt; bool:\n    \"\"\"V\u00e9rifie si la r\u00e9union a eu au moins 1 screenshare\"\"\"\n    with open(metadata_path) as f:\n        metadata = json.load(f)\n\n    return metadata.get(\"share\", False)\n\n# D\u00e9cision rapide avant traitement\nif check_has_screenshare(\"/tmp/recordings/abc123/metadata.json\"):\n    print(\"\u2705 Screenshare d\u00e9tect\u00e9 \u2192 Lancer pipeline OCR\")\nelse:\n    print(\"\u23ed\ufe0f Pas de screenshare \u2192 Skip OCR, transcription audio uniquement\")\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#approche-2-analyse-heuristique-des-frames-custom","title":"Approche 2 : Analyse heuristique des frames (custom)","text":"<p>Principe : Distinguer webcam vs screenshare par analyse d'image OpenCV</p>"},{"location":"02-applications/guides/jitsi-transcription/#caracteristiques-visuelles","title":"Caract\u00e9ristiques visuelles","text":"Webcam Screenshare Formes floues, peau Contours nets, texte Couleurs vari\u00e9es (visages) Couleurs UI (blancs, gris, bleus) Mouvement fluide Changements brusques Peu/pas de texte Beaucoup de texte Visages d\u00e9tectables (Haar Cascade) Pas de visages Basse fr\u00e9quence spatiale Haute fr\u00e9quence spatiale (contours)"},{"location":"02-applications/guides/jitsi-transcription/#code-detection-screenshare-par-heuristiques","title":"Code : D\u00e9tection screenshare par heuristiques","text":"<pre><code>import cv2\nimport numpy as np\nfrom paddleocr import PaddleOCR\n\n# Initialiser OCR (r\u00e9utilis\u00e9 pour chaque frame)\nocr = PaddleOCR(use_angle_cls=False, lang='en', use_gpu=False, show_log=False)\n\ndef is_screenshare_frame(frame: np.ndarray) -&gt; tuple[bool, float]:\n    \"\"\"\n    D\u00e9termine si une frame est un screenshare ou une webcam.\n\n    Args:\n        frame: Image numpy array (BGR)\n\n    Returns:\n        (is_screenshare, confidence_score)\n\n    Example:\n        &gt;&gt;&gt; cap = cv2.VideoCapture('meeting.mp4')\n        &gt;&gt;&gt; ret, frame = cap.read()\n        &gt;&gt;&gt; is_screen, score = is_screenshare_frame(frame)\n        &gt;&gt;&gt; print(f\"Screenshare: {is_screen} (score: {score:.2%})\")\n        Screenshare: True (score: 0.34)\n    \"\"\"\n\n    frame_area = frame.shape[0] * frame.shape[1]\n\n    # ==========================\n    # 1. D\u00e9tection de TEXTE\n    # ==========================\n    # Beaucoup de texte = probablement screenshare\n\n    result = ocr.ocr(frame, cls=False)\n\n    text_area = 0\n    if result and result[0]:\n        for detection in result[0]:\n            bbox = detection[0]\n            # Calculer aire de la bounding box\n            width = bbox[1][0] - bbox[0][0]\n            height = bbox[2][1] - bbox[1][1]\n            text_area += width * height\n\n    text_ratio = text_area / frame_area\n\n    # ==========================\n    # 2. D\u00e9tection de CONTOURS\n    # ==========================\n    # Slides = beaucoup de contours nets (bordures, s\u00e9parateurs)\n\n    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)\n    edges = cv2.Canny(gray, 50, 150)\n    edge_ratio = np.count_nonzero(edges) / frame_area\n\n    # ==========================\n    # 3. Analyse COULEUR\n    # ==========================\n    # UI = beaucoup de blanc/gris (backgrounds PowerPoint, Google Docs)\n\n    hsv = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)\n\n    # Masque blanc (Saturation faible, Value \u00e9lev\u00e9e)\n    white_mask = cv2.inRange(hsv, (0, 0, 200), (180, 30, 255))\n    white_ratio = np.count_nonzero(white_mask) / frame_area\n\n    # ==========================\n    # 4. SCORE COMPOSITE\n    # ==========================\n\n    score = (\n        text_ratio * 0.5 +      # 50% poids texte (crit\u00e8re principal)\n        edge_ratio * 0.3 +      # 30% poids contours\n        white_ratio * 0.2       # 20% poids blanc\n    )\n\n    # Seuil : ajuster selon tests\n    # - Webcam typique : score 0.05-0.10\n    # - Screenshare typique : score 0.20-0.50\n    is_screenshare = score &gt; 0.15\n\n    return is_screenshare, score\n\n\n# ==========================\n# UTILISATION\n# ==========================\n\ncap = cv2.VideoCapture('meeting.mp4')\nfps = cap.get(cv2.CAP_PROP_FPS)\ntotal_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))\n\n# Tester toutes les 30 frames (1 fois par seconde si 30fps)\nframe_num = 0\nscreenshare_periods = []\ncurrent_period_start = None\n\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    if frame_num % 30 == 0:  # Tester chaque seconde\n        is_screen, score = is_screenshare_frame(frame)\n\n        timestamp = frame_num / fps\n\n        if is_screen:\n            if current_period_start is None:\n                current_period_start = timestamp\n                print(f\"\ud83d\udda5\ufe0f Screenshare START \u00e0 {timestamp:.1f}s (score: {score:.2%})\")\n        else:\n            if current_period_start is not None:\n                screenshare_periods.append((current_period_start, timestamp))\n                print(f\"\ud83d\udcf7 Screenshare END \u00e0 {timestamp:.1f}s\")\n                current_period_start = None\n\n    frame_num += 1\n\ncap.release()\n\n# R\u00e9sultat : Liste de p\u00e9riodes screenshare\nprint(f\"\\n\ud83d\udcca P\u00e9riodes de screenshare d\u00e9tect\u00e9es :\")\nfor start, end in screenshare_periods:\n    duration = end - start\n    print(f\"  {start:.1f}s \u2192 {end:.1f}s (dur\u00e9e: {duration:.1f}s)\")\n\n# Exemple output :\n# \ud83d\udcca P\u00e9riodes de screenshare d\u00e9tect\u00e9es :\n#   450.0s \u2192 2100.0s (dur\u00e9e: 1650.0s = 27.5min)\n#   2850.0s \u2192 3300.0s (dur\u00e9e: 450.0s = 7.5min)\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#optimisations-possibles","title":"Optimisations possibles","text":"<pre><code># Cache OCR pour \u00e9viter r\u00e9initialisation\n_ocr_instance = None\n\ndef get_ocr():\n    global _ocr_instance\n    if _ocr_instance is None:\n        _ocr_instance = PaddleOCR(use_angle_cls=False, lang='en', use_gpu=False, show_log=False)\n    return _ocr_instance\n\n# Utiliser dans is_screenshare_frame()\nocr = get_ocr()\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#ajustement-des-seuils","title":"Ajustement des seuils","text":"<pre><code># Tester sur \u00e9chantillon connu\ntest_frames = {\n    \"webcam_julien.jpg\": False,\n    \"slide_intro.jpg\": True,\n    \"webcam_clemence.jpg\": False,\n    \"slide_results.jpg\": True,\n    \"split_screen.jpg\": True  # Split screen webcam + slides = screenshare\n}\n\nfor filename, expected in test_frames.items():\n    frame = cv2.imread(filename)\n    is_screen, score = is_screenshare_frame(frame)\n\n    status = \"\u2705\" if is_screen == expected else \"\u274c\"\n    print(f\"{status} {filename}: {is_screen} (score: {score:.3f}, attendu: {expected})\")\n\n# Ajuster le seuil 0.15 si trop de faux positifs/n\u00e9gatifs\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#approche-3-pyscenedetect-pour-zones-temporelles","title":"Approche 3 : PySceneDetect pour zones temporelles","text":"<p>Principe : D\u00e9tecter les changements majeurs de sc\u00e8ne (transitions webcam \u2194 screenshare)</p> <pre><code>from scenedetect import detect, ContentDetector\n\n# D\u00e9tecter les changements de sc\u00e8ne\nscenes = detect('meeting.mp4', ContentDetector(threshold=27))\n\n# Analyser seulement 1 frame par sc\u00e8ne (optimisation)\nfor i, (start, end) in enumerate(scenes):\n    # Extraire 1 frame au milieu de la sc\u00e8ne\n    mid_frame_num = (start.frame_num + end.frame_num) // 2\n\n    cap = cv2.VideoCapture('meeting.mp4')\n    cap.set(cv2.CAP_PROP_POS_FRAMES, mid_frame_num)\n    ret, frame = cap.read()\n    cap.release()\n\n    # Tester avec approche 2\n    is_screen, score = is_screenshare_frame(frame)\n\n    if is_screen:\n        print(f\"\u2705 Sc\u00e8ne {i} ({start} \u2192 {end}) = SCREENSHARE \u2192 OCR \u00e0 faire\")\n        # Extraire frames dans cette p\u00e9riode pour ImageHash + OCR\n    else:\n        print(f\"\u23ed\ufe0f Sc\u00e8ne {i} ({start} \u2192 {end}) = WEBCAM \u2192 Skip\")\n</code></pre> <p>Avantage : Teste seulement 1 frame par sc\u00e8ne au lieu de toutes les frames \u2192 tr\u00e8s rapide</p>"},{"location":"02-applications/guides/jitsi-transcription/#architecture-finale-recommandee","title":"\ud83c\udfd7\ufe0f Architecture finale recommand\u00e9e","text":""},{"location":"02-applications/guides/jitsi-transcription/#pipeline-complet","title":"Pipeline complet","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Vid\u00e9o Jibri                    \u2502\n\u2502  meeting.mp4                    \u2502\n\u2502  + metadata.json                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 1 : V\u00e9rification rapide              \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500              \u2502\n\u2502  Lire metadata.json                         \u2502\n\u2502  Si share=false \u2192 Skip OCR \u23ed\ufe0f              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 2 : D\u00e9tection zones screenshare     \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502\n\u2502  PySceneDetect \u2192 Sc\u00e8nes                     \u2502\n\u2502  Pour chaque sc\u00e8ne :                        \u2502\n\u2502    - Tester 1 frame mid-scene               \u2502\n\u2502    - is_screenshare_frame() \u2192 bool          \u2502\n\u2502  \u2192 P\u00e9riodes screenshare identifi\u00e9es         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 3 : Extraction frames screenshare   \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502  ffmpeg extract 1 frame/sec                 \u2502\n\u2502  SEULEMENT dans p\u00e9riodes screenshare        \u2502\n\u2502  Exemple : 30min screenshare = 1800 frames  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 4 : D\u00e9tection changements slides    \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502\n\u2502  ImageHash (phash) sur 1800 frames          \u2502\n\u2502  Distance Hamming &gt; 8 = nouvelle slide      \u2502\n\u2502  \u2192 ~30-50 frames de slides uniques          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 5 : OCR local PaddleOCR             \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500     \u2502\n\u2502  OCR sur 30-50 slides uniques               \u2502\n\u2502  Extraction texte + structure               \u2502\n\u2502  Temps : ~15 secondes (CPU)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u00c9TAPE 6 : Fusion avec transcription       \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502\n\u2502  Transcription audio (faster-whisper)       \u2502\n\u2502  + Diarization (pyannote)                   \u2502\n\u2502  + Texte OCR avec timestamps                \u2502\n\u2502  \u2192 Transcription enrichie compl\u00e8te          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#workflow-visuel","title":"Workflow visuel","text":"<pre><code>Vid\u00e9o 1h (3600 frames @ 1fps)\n         \u2502\n         \u251c\u2500\u2192 metadata.json: share=true \u2705\n         \u2502\n         \u25bc\n   PySceneDetect\n         \u2502\n         \u251c\u2500\u2192 Sc\u00e8ne 1 (0-450s) : Webcam \u23ed\ufe0f SKIP\n         \u251c\u2500\u2192 Sc\u00e8ne 2 (450-2100s) : Screenshare \u2705 \u2192 1650 frames\n         \u251c\u2500\u2192 Sc\u00e8ne 3 (2100-2850s) : Webcam \u23ed\ufe0f SKIP\n         \u2514\u2500\u2192 Sc\u00e8ne 4 (2850-3300s) : Screenshare \u2705 \u2192 450 frames\n         \u2502\n         \u25bc\n   Extract frames (2100 frames total)\n         \u2502\n         \u25bc\n   ImageHash perceptual diff\n         \u2502\n         \u251c\u2500\u2192 Frame 450 : Hash A\n         \u251c\u2500\u2192 Frame 451 : Hash A (distance=2) \u2192 SKIP\n         \u251c\u2500\u2192 Frame 452 : Hash A (distance=1) \u2192 SKIP\n         \u251c\u2500\u2192 ...\n         \u251c\u2500\u2192 Frame 498 : Hash B (distance=12) \u2192 \u2705 NOUVELLE SLIDE\n         \u251c\u2500\u2192 Frame 499 : Hash B (distance=3) \u2192 SKIP\n         \u2514\u2500\u2192 ...\n         \u2502\n         \u25bc\n   30-50 slides uniques identifi\u00e9es\n         \u2502\n         \u25bc\n   PaddleOCR (30-50 fois)\n         \u2502\n         \u25bc\n   Texte structur\u00e9 par slide\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#performances-et-couts","title":"\ud83d\udcca Performances et co\u00fbts","text":""},{"location":"02-applications/guides/jitsi-transcription/#estimation-pour-1h-de-reunion-avec-30min-screenshare","title":"Estimation pour 1h de r\u00e9union avec 30min screenshare","text":"\u00c9tape Temps CPU Frames trait\u00e9es Co\u00fbt 1. Metadata check &lt;1sec - Gratuit 2. PySceneDetect ~2min 3600 frames (analyse) Gratuit 3. Extract frames ~1min 1800 frames (30min screenshare) Gratuit 4. ImageHash ~3-5sec 1800 frames Gratuit \u2192 Slides uniques - ~30-50 frames - 5. PaddleOCR ~15-20sec 30-50 slides Gratuit TOTAL ~3-4 min 30-50 OCR (vs 1800 !) 0\u20ac"},{"location":"02-applications/guides/jitsi-transcription/#comparaison-claude-vision-api","title":"Comparaison Claude Vision API","text":"Approche Frames OCR Temps Co\u00fbt/heure Co\u00fbt/mois (20h) Claude Vision API 1800 (1 frame/10sec) ~30sec 5,40\u20ac ~110\u20ac Solution locale optimis\u00e9e 30-50 (slides uniques) ~4min 0\u20ac 0\u20ac <p>\u00c9conomie : 110\u20ac/mois \u2192 100% d'\u00e9conomie !</p>"},{"location":"02-applications/guides/jitsi-transcription/#temps-de-traitement-detaille-cpu","title":"Temps de traitement d\u00e9taill\u00e9 (CPU)","text":"<p>Configuration test : Intel i5-8250U (4 cores @ 1.6GHz), 16GB RAM</p> Op\u00e9ration 1 frame 100 frames 1800 frames ImageHash (phash) 1ms 100ms 1.8s PaddleOCR 350ms 35s 10.5min is_screenshare_frame() 400ms 40s 12min PySceneDetect - - 2-3min (vid\u00e9o compl\u00e8te) <p>Optimisation parall\u00e8le possible : - ImageHash : Traitement batch (100 frames en parall\u00e8le) - PaddleOCR : <code>rec_batch_num=6</code> pour OCR multiple simultan\u00e9</p>"},{"location":"02-applications/guides/jitsi-transcription/#bibliotheques-recommandees","title":"\ud83d\udce6 Biblioth\u00e8ques recommand\u00e9es","text":""},{"location":"02-applications/guides/jitsi-transcription/#installation-complete","title":"Installation compl\u00e8te","text":"<pre><code># OCR\npip install paddleocr==2.7.3\npip install paddlepaddle==2.6.0  # CPU version\n\n# D\u00e9tection changement slides\npip install ImageHash==4.3.1\npip install Pillow==10.2.0\n\n# D\u00e9tection sc\u00e8nes\npip install scenedetect[opencv]==0.6.3\n\n# Traitement vid\u00e9o\npip install opencv-python==4.9.0.80\n\n# Utilitaires\npip install numpy\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#requirementstxt","title":"requirements.txt","text":"<pre><code>paddleocr==2.7.3\npaddlepaddle==2.6.0\nImageHash==4.3.1\nPillow==10.2.0\nscenedetect[opencv]==0.6.3\nopencv-python==4.9.0.80\nnumpy&gt;=1.24.0\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#versions-gpu-optionnel-si-gpu-disponible-plus-tard","title":"Versions GPU (optionnel, si GPU disponible plus tard)","text":"<pre><code># Remplacer paddlepaddle CPU par GPU\npip uninstall paddlepaddle\npip install paddlepaddle-gpu  # N\u00e9cessite CUDA\n</code></pre>"},{"location":"02-applications/guides/jitsi-transcription/#ressources-et-references","title":"\ud83d\udd17 Ressources et r\u00e9f\u00e9rences","text":""},{"location":"02-applications/guides/jitsi-transcription/#benchmarks-et-comparaisons-ocr","title":"Benchmarks et comparaisons OCR","text":"<ul> <li>OCR comparison: Tesseract vs EasyOCR vs PaddleOCR vs MMOCR (Medium)</li> <li>PaddleOCR vs Tesseract: Which is the best open source OCR?</li> <li>8 Top Open-Source OCR Models Compared (Modal Blog)</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#bibliotheques-github","title":"Biblioth\u00e8ques GitHub","text":"<ul> <li>PaddleOCR - 44k stars</li> <li>ImageHash - 3.2k stars</li> <li>PySceneDetect - 3.8k stars</li> <li>Jibri (Jitsi Recording) - 500+ stars</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#documentation","title":"Documentation","text":"<ul> <li>PaddleOCR Documentation</li> <li>PySceneDetect Documentation</li> <li>Jitsi Community Forum - Jibri metadata</li> </ul>"},{"location":"02-applications/guides/jitsi-transcription/#prochaines-etapes","title":"\ud83c\udfaf Prochaines \u00e9tapes","text":"<ol> <li>\u2705 Valider architecture avec Julien</li> <li>\u23f3 Coder prototype (<code>transcription_local_ocr.py</code>)</li> <li>\u23f3 Tester sur vid\u00e9o r\u00e9elle (ajuster seuils ImageHash + is_screenshare)</li> <li>\u23f3 Int\u00e9grer au pipeline complet (Jibri \u2192 Transcription \u2192 R\u00e9sum\u00e9)</li> <li>\u23f3 D\u00e9ployer sur VPS (Docker Compose)</li> </ol> <p>Version : 1.0 Auteur : Claude Code + Julien Prochaine r\u00e9vision : Apr\u00e8s tests prototype</p>"},{"location":"02-applications/guides/live-status-page/","title":"Live Services Status - Documentation","text":""},{"location":"02-applications/guides/live-status-page/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Le syst\u00e8me Live Services Status g\u00e9n\u00e8re automatiquement une page de documentation listant en temps r\u00e9el l'\u00e9tat de tous les services Docker d\u00e9ploy\u00e9s sur srv759970.</p>"},{"location":"02-applications/guides/live-status-page/#acces-rapide","title":"Acc\u00e8s Rapide","text":"<ul> <li>\ud83d\udcc4 Page Live: Services Status</li> <li>\ud83c\udfaf Dashy Portal: https://dashy.srv759970.hstgr.cloud</li> <li>\ud83d\udcca Grafana: https://monitoring.srv759970.hstgr.cloud</li> </ul>"},{"location":"02-applications/guides/live-status-page/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":""},{"location":"02-applications/guides/live-status-page/#statistiques-en-temps-reel","title":"\ud83d\udcca Statistiques en Temps R\u00e9el","text":"<ul> <li>Total containers - Nombre total de conteneurs Docker</li> <li>Containers actifs - Services en cours d'ex\u00e9cution</li> <li>Containers arr\u00eat\u00e9s - Services d\u00e9sactiv\u00e9s</li> <li>Horodatage - Derni\u00e8re mise \u00e0 jour</li> </ul>"},{"location":"02-applications/guides/live-status-page/#liste-complete-des-services","title":"\ud83d\udce6 Liste Compl\u00e8te des Services","text":"<p>Pour chaque service Docker: - \u2705 Nom du container - \u2705 Status (\ud83d\udfe2 running, \ud83d\udd34 stopped, \ud83d\udfe1 restarting) - \u2705 Uptime - Temps depuis le d\u00e9marrage - \u2705 Ports - Ports expos\u00e9s et mappings</p>"},{"location":"02-applications/guides/live-status-page/#ressources-systeme","title":"\ud83d\udcbb Ressources Syst\u00e8me","text":"<ul> <li>RAM - Utilisation et pourcentage</li> <li>Disque - Espace utilis\u00e9 et pourcentage</li> <li>Top Consommateurs - 10 containers utilisant le plus de RAM</li> </ul>"},{"location":"02-applications/guides/live-status-page/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         Cron Job (toutes les 5 minutes)             \u2502\n\u2502                                                     \u2502\n\u2502   */5 * * * * generate-services-status-simple.sh   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n                  \u2502 Collecte donn\u00e9es\n                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Docker Engine API                      \u2502\n\u2502                                                     \u2502\n\u2502  \u2022 docker ps -a (tous les containers)              \u2502\n\u2502  \u2022 docker stats (ressources)                       \u2502\n\u2502  \u2022 docker inspect (health checks)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n                  \u2502 G\u00e9n\u00e9ration\n                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         docs/SERVICES_STATUS.md                     \u2502\n\u2502                                                     \u2502\n\u2502  \u2022 Markdown format\u00e9                                \u2502\n\u2502  \u2022 Tableaux de donn\u00e9es                             \u2502\n\u2502  \u2022 Badges de statut                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n                  \u2502 Publication\n                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            MkDocs Material                          \u2502\n\u2502                                                     \u2502\n\u2502  https://docs.srv759970.hstgr.cloud/               \u2502\n\u2502  SERVICES_STATUS/                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#configuration","title":"Configuration","text":""},{"location":"02-applications/guides/live-status-page/#script-de-generation","title":"Script de G\u00e9n\u00e9ration","text":"<p>Emplacement: <code>/root/hostinger/scripts/generate-services-status-simple.sh</code></p> <p>Permissions: <pre><code>-rwxr-xr-x 1 root root 4.5K Oct 23 18:50 generate-services-status-simple.sh\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#cron-job","title":"Cron Job","text":"<p>Configuration actuelle: <pre><code>*/5 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1\n</code></pre></p> <p>V\u00e9rifier le cron: <pre><code>crontab -l | grep services-status\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#fichier-de-sortie","title":"Fichier de Sortie","text":"<p>Emplacement: <code>/root/hostinger/docs/SERVICES_STATUS.md</code></p> <p>Format: Markdown compatible MkDocs Material</p>"},{"location":"02-applications/guides/live-status-page/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/guides/live-status-page/#mise-a-jour-manuelle","title":"Mise \u00e0 Jour Manuelle","text":"<p>M\u00e9thode 1 - Alias: <pre><code>update-services-status\n</code></pre></p> <p>M\u00e9thode 2 - Commande compl\u00e8te: <pre><code>cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#visualisation","title":"Visualisation","text":"<p>1. Via MkDocs (recommand\u00e9): - Acc\u00e9der \u00e0 https://docs.srv759970.hstgr.cloud/SERVICES_STATUS/ - Navigation: \"\ud83d\ude80 Services Status (Live)\"</p> <p>2. Via fichier brut: <pre><code>cat /root/hostinger/docs/SERVICES_STATUS.md\n</code></pre></p> <p>3. Via less (pour scroll): <pre><code>less /root/hostinger/docs/SERVICES_STATUS.md\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#consultation-des-logs","title":"Consultation des Logs","text":"<p>Logs en temps r\u00e9el: <pre><code>tail -f /var/log/services-status.log\n</code></pre></p> <p>Derni\u00e8res ex\u00e9cutions: <pre><code>tail -50 /var/log/services-status.log\n</code></pre></p> <p>Rechercher les erreurs: <pre><code>grep -i error /var/log/services-status.log\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#personnalisation","title":"Personnalisation","text":""},{"location":"02-applications/guides/live-status-page/#modifier-lintervalle-de-mise-a-jour","title":"Modifier l'Intervalle de Mise \u00e0 Jour","text":"<p>\u00c9diter le cron: <pre><code>crontab -e\n</code></pre></p> <p>Exemples d'intervalles:</p> <pre><code># Toutes les minutes (tr\u00e8s fr\u00e9quent)\n*/1 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1\n\n# Toutes les 10 minutes (recommand\u00e9 pour r\u00e9duire la charge)\n*/10 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1\n\n# Toutes les 30 minutes (l\u00e9ger)\n*/30 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1\n\n# Toutes les heures\n0 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#ajouter-des-categories-personnalisees","title":"Ajouter des Cat\u00e9gories Personnalis\u00e9es","text":"<p>\u00c9diter le script pour mapper des containers \u00e0 des cat\u00e9gories:</p> <pre><code>vim /root/hostinger/scripts/generate-services-status-simple.sh\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#filtrer-certains-containers","title":"Filtrer Certains Containers","text":"<p>Pour exclure certains containers de la liste:</p> <pre><code># Dans le script, modifier la ligne docker ps\ndocker ps -a --format '{{.Names}}|{{.Status}}|{{.Ports}}' | grep -v \"unwanted-container\" | sort\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#monitoring-alertes","title":"Monitoring &amp; Alertes","text":""},{"location":"02-applications/guides/live-status-page/#verifier-que-le-script-fonctionne","title":"V\u00e9rifier que le Script Fonctionne","text":"<p>Test 1 - Derni\u00e8re modification: <pre><code>stat /root/hostinger/docs/SERVICES_STATUS.md | grep Modify\n</code></pre></p> <p>Test 2 - Ex\u00e9cution manuelle: <pre><code>cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh\n# Doit afficher: \u2705 Services status page generated\n</code></pre></p> <p>Test 3 - V\u00e9rifier le cron: <pre><code>grep CRON /var/log/syslog | grep services-status | tail -5\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#alertes-sur-echecs","title":"Alertes sur \u00c9checs","text":"<p>Option 1 - Email sur erreur:</p> <p>Modifier le cron pour envoyer un email en cas d'erreur:</p> <pre><code>MAILTO=your-email@example.com\n*/5 * * * * cd /root/hostinger &amp;&amp; ./scripts/generate-services-status-simple.sh &gt;&gt; /var/log/services-status.log 2&gt;&amp;1 || echo \"Services status generation failed\"\n</code></pre> <p>Option 2 - Webhook Discord/Slack:</p> <p>Ajouter \u00e0 la fin du script:</p> <pre><code># En cas d'erreur\nif [ $? -ne 0 ]; then\n    curl -X POST https://your-webhook-url \\\n        -H \"Content-Type: application/json\" \\\n        -d '{\"content\":\"\u274c Services status generation failed!\"}'\nfi\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#integrations","title":"Int\u00e9grations","text":""},{"location":"02-applications/guides/live-status-page/#grafana-dashboard","title":"Grafana Dashboard","text":"<p>Cr\u00e9er un dashboard Grafana affichant les m\u00e9triques:</p> <ol> <li>Panel \"Total Containers\" - Nombre total de containers</li> <li>Panel \"Services Status\" - R\u00e9partition actifs/arr\u00eat\u00e9s</li> <li>Panel \"RAM Usage\" - Top consommateurs</li> <li>Panel \"Generation Time\" - Temps d'ex\u00e9cution du script</li> </ol>"},{"location":"02-applications/guides/live-status-page/#api-rest","title":"API REST","text":"<p>Exposer les donn\u00e9es via une API:</p> <pre><code># Convertir markdown en JSON\ncat docs/SERVICES_STATUS.md | \\\n  python3 -c \"import json; import sys; print(json.dumps({'status': 'ok'}))\" \\\n  &gt; /var/www/html/services-status.json\n</code></pre> <p>Accessible via: <code>http://srv759970.hstgr.cloud/services-status.json</code></p>"},{"location":"02-applications/guides/live-status-page/#dashy-widget","title":"Dashy Widget","text":"<p>Int\u00e9grer dans Dashy pour affichage visuel:</p> <pre><code># /opt/dashy/conf.yml\nwidgets:\n  - type: iframe\n    options:\n      url: https://docs.srv759970.hstgr.cloud/SERVICES_STATUS/\n      height: 600\n</code></pre>"},{"location":"02-applications/guides/live-status-page/#depannage","title":"D\u00e9pannage","text":""},{"location":"02-applications/guides/live-status-page/#le-script-ne-sexecute-pas","title":"Le Script ne S'ex\u00e9cute pas","text":"<p>1. V\u00e9rifier les permissions: <pre><code>ls -l /root/hostinger/scripts/generate-services-status-simple.sh\nchmod +x /root/hostinger/scripts/generate-services-status-simple.sh\n</code></pre></p> <p>2. V\u00e9rifier le cron: <pre><code># Service cron actif?\nsystemctl status cron\n\n# Red\u00e9marrer si n\u00e9cessaire\nsystemctl restart cron\n</code></pre></p> <p>3. V\u00e9rifier les logs: <pre><code>tail -100 /var/log/services-status.log\njournalctl -u cron -f\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#le-fichier-nest-pas-genere","title":"Le Fichier n'est pas G\u00e9n\u00e9r\u00e9","text":"<p>1. V\u00e9rifier le r\u00e9pertoire: <pre><code>ls -la /root/hostinger/docs/\nmkdir -p /root/hostinger/docs\n</code></pre></p> <p>2. Tester Docker: <pre><code>docker ps\n# Doit lister les containers\n</code></pre></p> <p>3. Ex\u00e9cuter avec debug: <pre><code>cd /root/hostinger\nbash -x ./scripts/generate-services-status-simple.sh\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#les-donnees-ne-sont-pas-a-jour","title":"Les Donn\u00e9es ne Sont pas \u00e0 Jour","text":"<p>1. V\u00e9rifier l'horodatage: <pre><code>head -10 /root/hostinger/docs/SERVICES_STATUS.md | grep \"Derni\u00e8re mise \u00e0 jour\"\n</code></pre></p> <p>2. Forcer une mise \u00e0 jour: <pre><code>update-services-status\n</code></pre></p> <p>3. V\u00e9rifier le cache MkDocs: <pre><code># Rebuild MkDocs si d\u00e9ploy\u00e9\ncd /path/to/mkdocs &amp;&amp; mkdocs build --clean\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#performance","title":"Performance","text":""},{"location":"02-applications/guides/live-status-page/#temps-dexecution","title":"Temps d'Ex\u00e9cution","text":"<p>Mesure: <pre><code>time ./scripts/generate-services-status-simple.sh\n</code></pre></p> <p>Temps moyen: ~2-3 secondes pour 64 containers</p>"},{"location":"02-applications/guides/live-status-page/#optimisations","title":"Optimisations","text":"<p>1. R\u00e9duire la fr\u00e9quence: - Passer de 5 minutes \u00e0 10 minutes</p> <p>2. Cache Docker: <pre><code># Utiliser le cache Docker stats\ndocker stats --no-stream --format \"table {{.Name}}\\t{{.MemUsage}}\" &gt; /tmp/docker-stats.cache\n</code></pre></p> <p>3. G\u00e9n\u00e9ration asynchrone: <pre><code># G\u00e9n\u00e9rer en arri\u00e8re-plan\nnohup ./scripts/generate-services-status-simple.sh &amp;\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/live-status-page/#permissions","title":"Permissions","text":"<p>Script: <pre><code>chmod 700 /root/hostinger/scripts/generate-services-status-simple.sh\nchown root:root /root/hostinger/scripts/generate-services-status-simple.sh\n</code></pre></p> <p>Fichier de sortie: <pre><code>chmod 644 /root/hostinger/docs/SERVICES_STATUS.md\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#logs","title":"Logs","text":"<p>Rotation des logs: <pre><code># /etc/logrotate.d/services-status\n/var/log/services-status.log {\n    daily\n    rotate 7\n    compress\n    missingok\n    notifempty\n}\n</code></pre></p>"},{"location":"02-applications/guides/live-status-page/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Dashy Portal - Dashboard visuel</li> <li>Monitoring Stack - Grafana + Prometheus</li> <li>Dozzle - Logs Docker temps r\u00e9el</li> <li>Portainer - Gestion Docker GUI</li> </ul>"},{"location":"02-applications/guides/live-status-page/#ressources","title":"Ressources","text":"<ul> <li>Script: <code>/root/hostinger/scripts/generate-services-status-simple.sh</code></li> <li>Documentation: <code>/root/hostinger/scripts/README.md</code></li> <li>Logs: <code>/var/log/services-status.log</code></li> <li>Sortie: <code>/root/hostinger/docs/SERVICES_STATUS.md</code></li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 Status: \u2705 Production Maintenance: Automatique via cron</p>"},{"location":"02-applications/guides/n8n-setup/","title":"Guide n8n - Automatisation et SMS vers Whisper","text":""},{"location":"02-applications/guides/n8n-setup/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>n8n est une plateforme d'automatisation open-source qui permet de cr\u00e9er des workflows sans code. Ce guide explique comment connecter les SMS \u00e0 l'API Whisper pour la transcription audio.</p>"},{"location":"02-applications/guides/n8n-setup/#installation","title":"\ud83d\udccb Installation","text":""},{"location":"02-applications/guides/n8n-setup/#n8n-deploye-via-docker","title":"n8n d\u00e9ploy\u00e9 via Docker","text":"<p>URL : https://n8n.srv759970.hstgr.cloud Port interne : 5678 Container : <code>n8n</code></p> <p>Authentification : - Basic Auth : <code>julien</code> / <code>DevAccess2025</code> - n8n : Cr\u00e9er un compte lors de la premi\u00e8re connexion</p>"},{"location":"02-applications/guides/n8n-setup/#acces-a-n8n","title":"\ud83d\ude80 Acc\u00e8s \u00e0 n8n","text":"<ol> <li>Ouvrir https://n8n.srv759970.hstgr.cloud</li> <li>Entrer Basic Auth : <code>julien</code> / <code>DevAccess2025</code></li> <li>Cr\u00e9er un compte n8n (email + mot de passe)</li> </ol>"},{"location":"02-applications/guides/n8n-setup/#connecter-sms-a-whisper-api","title":"\ud83d\udcf1 Connecter SMS \u00e0 Whisper API","text":""},{"location":"02-applications/guides/n8n-setup/#workflow-sms-audio-whisper-transcription","title":"Workflow : SMS Audio \u2192 Whisper Transcription","text":"<p>Objectif : Recevoir un SMS contenant un lien audio \u2192 T\u00e9l\u00e9charger l'audio \u2192 Envoyer \u00e0 Whisper \u2192 Retourner la transcription</p>"},{"location":"02-applications/guides/n8n-setup/#etape-1-creer-un-nouveau-workflow","title":"\u00c9tape 1 : Cr\u00e9er un nouveau workflow","text":"<ol> <li>Dans n8n, cliquer + New Workflow</li> <li>Nommer : <code>SMS to Whisper Transcription</code></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-2-ajouter-un-trigger-webhook","title":"\u00c9tape 2 : Ajouter un trigger Webhook","text":"<ol> <li>Ajouter le node Webhook</li> <li>Configuration :</li> <li>HTTP Method : <code>POST</code></li> <li>Path : <code>sms-whisper</code></li> <li>Respond : <code>Last Node</code></li> <li>Copier l'URL du webhook (exemple : <code>https://n8n.srv759970.hstgr.cloud/webhook/sms-whisper</code>)</li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-3-extraire-lurl-audio-du-sms","title":"\u00c9tape 3 : Extraire l'URL audio du SMS","text":"<ol> <li>Ajouter le node Code</li> <li>Code JavaScript : <pre><code>// Extraire l'URL audio depuis le body du webhook\nconst smsBody = $input.item.json.body;\nconst audioUrl = smsBody.MediaUrl0 || smsBody.audio_url || smsBody.url;\n\nreturn {\n  json: {\n    audioUrl: audioUrl,\n    from: $input.item.json.From || $input.item.json.from,\n    timestamp: new Date().toISOString()\n  }\n};\n</code></pre></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-4-telecharger-le-fichier-audio","title":"\u00c9tape 4 : T\u00e9l\u00e9charger le fichier audio","text":"<ol> <li>Ajouter le node HTTP Request</li> <li>Configuration :</li> <li>Method : <code>GET</code></li> <li>URL : <code>{{ $json.audioUrl }}</code></li> <li>Response Format : <code>File</code></li> <li>Binary Property : <code>audio</code></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-5-envoyer-a-whisper-api","title":"\u00c9tape 5 : Envoyer \u00e0 Whisper API","text":"<ol> <li>Ajouter le node HTTP Request</li> <li>Configuration :</li> <li>Method : <code>POST</code></li> <li>URL : <code>https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions</code></li> <li>Authentication : <code>Generic Credential Type</code> \u2192 <code>Basic Auth</code><ul> <li>Username : <code>julien</code></li> <li>Password : <code>DevAccess2025</code></li> </ul> </li> <li>Send Body : <code>Yes</code> \u2192 <code>Form-Data Multipart</code></li> <li>Body Parameters :<ul> <li>Key : <code>file</code> \u2192 Value : <code>{{ $binary.audio }}</code></li> <li>Key : <code>model</code> \u2192 Value : <code>base</code></li> <li>Key : <code>response_format</code> \u2192 Value : <code>json</code></li> </ul> </li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-6-formater-et-retourner-la-reponse","title":"\u00c9tape 6 : Formater et retourner la r\u00e9ponse","text":"<ol> <li>Ajouter le node Code</li> <li>Code JavaScript : <pre><code>const transcription = $input.item.json.text;\nconst from = $('Code').item.json.from;\n\nreturn {\n  json: {\n    status: \"success\",\n    transcription: transcription,\n    from: from,\n    timestamp: new Date().toISOString()\n  }\n};\n</code></pre></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-7-repondre-au-webhook","title":"\u00c9tape 7 : R\u00e9pondre au webhook","text":"<ol> <li>Ajouter le node Respond to Webhook</li> <li>Configuration :</li> <li>Respond With : <code>JSON</code></li> <li>Response Body : <code>{{ $json }}</code></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#etape-8-activer-le-workflow","title":"\u00c9tape 8 : Activer le workflow","text":"<ol> <li>Cliquer sur Save en haut \u00e0 droite</li> <li>Activer le workflow avec le toggle en haut</li> </ol>"},{"location":"02-applications/guides/n8n-setup/#test-du-workflow","title":"\ud83e\uddea Test du workflow","text":""},{"location":"02-applications/guides/n8n-setup/#via-curl","title":"Via cURL","text":"<pre><code>curl -u julien:DevAccess2025 \\\n  -X POST https://n8n.srv759970.hstgr.cloud/webhook/sms-whisper \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"From\": \"+33612345678\",\n    \"audio_url\": \"https://example.com/audio.mp3\"\n  }'\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#via-twilio-si-integration-sms-reelle","title":"Via Twilio (si int\u00e9gration SMS r\u00e9elle)","text":"<ol> <li>Configurer un compte Twilio</li> <li>Dans Twilio Console \u2192 Phone Numbers \u2192 Configure</li> <li>Messaging Configuration :</li> <li>A MESSAGE COMES IN : <code>Webhook</code></li> <li>URL : <code>https://n8n.srv759970.hstgr.cloud/webhook/sms-whisper</code></li> <li>HTTP Method : <code>POST</code></li> </ol>"},{"location":"02-applications/guides/n8n-setup/#exemples-de-workflows-n8n-utiles","title":"\ud83d\udcca Exemples de workflows n8n utiles","text":""},{"location":"02-applications/guides/n8n-setup/#1-email-vers-whisper","title":"1. Email vers Whisper","text":"<ul> <li>Trigger : Email Trigger (IMAP)</li> <li>Action : Extraire pi\u00e8ce jointe audio \u2192 Whisper \u2192 Envoyer transcription par email</li> </ul>"},{"location":"02-applications/guides/n8n-setup/#2-google-drive-audio-whisper","title":"2. Google Drive Audio \u2192 Whisper","text":"<ul> <li>Trigger : Google Drive Trigger (nouveau fichier dans dossier)</li> <li>Action : T\u00e9l\u00e9charger fichier \u2192 Whisper \u2192 Ajouter transcription dans Google Sheets</li> </ul>"},{"location":"02-applications/guides/n8n-setup/#3-slack-audio-whisper","title":"3. Slack Audio \u2192 Whisper","text":"<ul> <li>Trigger : Slack Trigger (message avec fichier)</li> <li>Action : T\u00e9l\u00e9charger audio \u2192 Whisper \u2192 R\u00e9pondre dans le thread</li> </ul>"},{"location":"02-applications/guides/n8n-setup/#configuration-docker-de-n8n","title":"\ud83d\udd27 Configuration Docker de n8n","text":"<pre><code>docker run -d \\\n  --name n8n \\\n  --restart unless-stopped \\\n  -p 5678:5678 \\\n  -e N8N_HOST=n8n.srv759970.hstgr.cloud \\\n  -e N8N_PORT=5678 \\\n  -e N8N_PROTOCOL=https \\\n  -e WEBHOOK_URL=https://n8n.srv759970.hstgr.cloud/ \\\n  -e GENERIC_TIMEZONE=Europe/Paris \\\n  -v /var/www/n8n:/home/node/.n8n \\\n  docker.n8n.io/n8nio/n8n\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#securite","title":"\ud83d\udd12 S\u00e9curit\u00e9","text":"<ul> <li>Basic Auth Nginx : Prot\u00e8ge l'acc\u00e8s \u00e0 n8n (julien/DevAccess2025)</li> <li>Webhook URLs : Utiliser des chemins complexes pour \u00e9viter les acc\u00e8s non autoris\u00e9s</li> <li>Whisper API Auth : Prot\u00e9g\u00e9 par Basic Auth</li> <li>Donn\u00e9es : Stock\u00e9es dans <code>/var/www/n8n</code> sur le serveur</li> </ul>"},{"location":"02-applications/guides/n8n-setup/#commandes-utiles","title":"\ud83d\udee0\ufe0f Commandes utiles","text":""},{"location":"02-applications/guides/n8n-setup/#redemarrer-n8n","title":"Red\u00e9marrer n8n","text":"<pre><code>ssh root@69.62.108.82\ndocker restart n8n\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#voir-les-logs","title":"Voir les logs","text":"<pre><code>docker logs -f n8n\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#mettre-a-jour-n8n","title":"Mettre \u00e0 jour n8n","text":"<pre><code>docker stop n8n\ndocker rm n8n\ndocker pull docker.n8n.io/n8nio/n8n\n# Relancer la commande docker run ci-dessus\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#backup-des-workflows","title":"Backup des workflows","text":"<pre><code>ssh root@69.62.108.82\ntar -czf n8n-backup-$(date +%Y%m%d).tar.gz /var/www/n8n\n</code></pre>"},{"location":"02-applications/guides/n8n-setup/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>n8n Documentation : https://docs.n8n.io/</li> <li>Webhook Node : https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/</li> <li>HTTP Request Node : https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/</li> <li>Whisper API Docs : https://platform.openai.com/docs/api-reference/audio</li> </ul> <p>Cr\u00e9\u00e9 le : 2025-10-16 URL n8n : https://n8n.srv759970.hstgr.cloud</p>"},{"location":"02-applications/guides/ollama-setup/","title":"\ud83e\udd16 Guide Ollama - API ML/AI sur VPS","text":"<p>Guide complet pour Ollama sur VPS Hostinger avec Nginx reverse proxy et SSL</p>"},{"location":"02-applications/guides/ollama-setup/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<p>Ollama : Framework pour ex\u00e9cuter des LLMs (Large Language Models) localement Utilisation : API REST pour g\u00e9n\u00e9rer du texte, chat, embeddings Avantage : Mod\u00e8les locaux, pas de d\u00e9pendance cloud, gratuit D\u00e9ploiement : Service systemd + Nginx reverse proxy avec HTTPS</p>"},{"location":"02-applications/guides/ollama-setup/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<pre><code>Client (HTTPS)\n    \u2193\nNginx (443) - ollama.srv759970.hstgr.cloud\n    \u2193 reverse proxy\nOllama Service (localhost:11434)\n    \u2193\nMod\u00e8les LLMs locaux\n</code></pre> <p>Configuration actuelle : - Service : <code>ollama.service</code> (systemd) - Port local : 11434 (127.0.0.1 uniquement) - URL publique : https://ollama.srv759970.hstgr.cloud - SSL : Let's Encrypt - Mod\u00e8les install\u00e9s : 4 (qwen2.5:14b, qwen2.5vl:7b, mistral:7b, llama3.2:1b)</p>"},{"location":"02-applications/guides/ollama-setup/#etat-actuel-du-service","title":"\u2705 \u00c9tat actuel du service","text":""},{"location":"02-applications/guides/ollama-setup/#verifier-le-service","title":"V\u00e9rifier le service","text":"<pre><code># Statut du service\nssh root@69.62.108.82 \"systemctl status ollama\"\n\n# V\u00e9rifier si Ollama \u00e9coute\nssh root@69.62.108.82 \"netstat -tulpn | grep 11434\"\n# R\u00e9sultat attendu : tcp 0 0 127.0.0.1:11434 0.0.0.0:* LISTEN\n\n# Tester localement\nssh root@69.62.108.82 \"curl -s http://localhost:11434/api/tags | jq '.models | length'\"\n# R\u00e9sultat attendu : nombre de mod\u00e8les (ex: 4)\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#modeles-disponibles","title":"Mod\u00e8les disponibles","text":"<pre><code># Lister les mod\u00e8les install\u00e9s\nssh root@69.62.108.82 \"curl -s http://localhost:11434/api/tags | jq -r '.models[] | .name'\"\n</code></pre> <p>Mod\u00e8les actuels : - <code>qwen2.5:14b</code> - Mod\u00e8le chinois multilingue (14B param\u00e8tres) - <code>qwen2.5vl:7b</code> - Vision + Language (7B param\u00e8tres) - <code>mistral:7b</code> - Mod\u00e8le fran\u00e7ais/anglais performant - <code>llama3.2:1b</code> - Mod\u00e8le l\u00e9ger et rapide (1B param\u00e8tres)</p>"},{"location":"02-applications/guides/ollama-setup/#configuration-nginx-avec-ssl","title":"\ud83d\udd27 Configuration Nginx avec SSL","text":""},{"location":"02-applications/guides/ollama-setup/#configuration-actuelle","title":"Configuration actuelle","text":"<p>Fichier : <code>/etc/nginx/sites-available/ollama-https</code></p> <pre><code># HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name ollama.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n\n# HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name ollama.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/ollama.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/ollama.srv759970.hstgr.cloud/privkey.pem;\n\n    access_log /var/log/nginx/ollama-access.log;\n    error_log /var/log/nginx/ollama-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:11434;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts augment\u00e9s pour g\u00e9n\u00e9ration de texte\n        proxy_read_timeout 600s;\n        proxy_connect_timeout 75s;\n\n        # D\u00e9sactiver buffering pour streaming\n        proxy_buffering off;\n        proxy_cache off;\n\n        # CORS headers\n        add_header Access-Control-Allow-Origin * always;\n        add_header Access-Control-Allow-Methods \"GET, POST, OPTIONS, DELETE, PUT\" always;\n        add_header Access-Control-Allow-Headers \"Content-Type, Authorization\" always;\n    }\n\n    # Security headers\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n}\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#points-cles-de-la-configuration","title":"Points cl\u00e9s de la configuration","text":"<ol> <li>Timeouts augment\u00e9s : <code>proxy_read_timeout 600s</code> pour permettre la g\u00e9n\u00e9ration de longues r\u00e9ponses</li> <li>Buffering d\u00e9sactiv\u00e9 : <code>proxy_buffering off</code> pour le streaming de tokens</li> <li>CORS activ\u00e9 : Permet les appels depuis n'importe quel domaine</li> <li>HTTP/2 : <code>http2</code> pour meilleures performances</li> <li>Security headers : Protection XSS, clickjacking, etc.</li> </ol>"},{"location":"02-applications/guides/ollama-setup/#deploiement-initial-si-besoin","title":"\ud83d\ude80 D\u00e9ploiement initial (si besoin)","text":""},{"location":"02-applications/guides/ollama-setup/#etape-1-installer-ollama","title":"\u00c9tape 1 : Installer Ollama","text":"<pre><code># Installation\nssh root@69.62.108.82 \"curl -fsSL https://ollama.com/install.sh | sh\"\n\n# V\u00e9rifier l'installation\nssh root@69.62.108.82 \"ollama --version\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#etape-2-configurer-le-service-systemd","title":"\u00c9tape 2 : Configurer le service systemd","text":"<pre><code># V\u00e9rifier la config du service\nssh root@69.62.108.82 \"systemctl cat ollama.service\"\n</code></pre> <p>Config standard : <code>/etc/systemd/system/ollama.service</code></p> <pre><code>[Unit]\nDescription=Ollama Service\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/ollama serve\nUser=root\nRestart=always\nRestartSec=3\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#etape-3-demarrer-le-service","title":"\u00c9tape 3 : D\u00e9marrer le service","text":"<pre><code># D\u00e9marrer et activer au boot\nssh root@69.62.108.82 \"systemctl enable --now ollama\"\n\n# V\u00e9rifier\nssh root@69.62.108.82 \"systemctl status ollama\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#etape-4-installer-des-modeles","title":"\u00c9tape 4 : Installer des mod\u00e8les","text":"<pre><code># Installer un mod\u00e8le (exemple : llama3.2:1b)\nssh root@69.62.108.82 \"ollama pull llama3.2:1b\"\n\n# Lister les mod\u00e8les\nssh root@69.62.108.82 \"ollama list\"\n</code></pre> <p>Mod\u00e8les recommand\u00e9s : - <code>llama3.2:1b</code> - L\u00e9ger et rapide (1.3GB) - <code>mistral:7b</code> - Bon compromis qualit\u00e9/taille (4.1GB) - <code>qwen2.5:14b</code> - Tr\u00e8s performant mais lourd (9GB)</p>"},{"location":"02-applications/guides/ollama-setup/#etape-5-configurer-ssl-avec-certbot","title":"\u00c9tape 5 : Configurer SSL avec Certbot","text":"<pre><code># 1. Arr\u00eater Nginx\nssh root@69.62.108.82 \"systemctl stop nginx\"\n\n# 2. Obtenir le certificat SSL\nssh root@69.62.108.82 \"certbot certonly --standalone -d ollama.srv759970.hstgr.cloud --non-interactive --agree-tos --email contact@srv759970.hstgr.cloud\"\n\n# 3. Cr\u00e9er la config Nginx (voir section ci-dessus)\n# 4. Activer et red\u00e9marrer\nssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/ollama-https /etc/nginx/sites-enabled/\"\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl start nginx\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#tester-lapi","title":"\ud83e\uddea Tester l'API","text":""},{"location":"02-applications/guides/ollama-setup/#endpoints-disponibles","title":"Endpoints disponibles","text":""},{"location":"02-applications/guides/ollama-setup/#1-lister-les-modeles","title":"1. Lister les mod\u00e8les","text":"<pre><code>curl https://ollama.srv759970.hstgr.cloud/api/tags\n</code></pre> <p>R\u00e9ponse : <pre><code>{\n  \"models\": [\n    {\n      \"name\": \"llama3.2:1b\",\n      \"modified_at\": \"2025-10-10T11:28:35Z\",\n      \"size\": 1300000000\n    }\n  ]\n}\n</code></pre></p>"},{"location":"02-applications/guides/ollama-setup/#2-generer-du-texte","title":"2. G\u00e9n\u00e9rer du texte","text":"<pre><code>curl -X POST https://ollama.srv759970.hstgr.cloud/api/generate \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"model\": \"llama3.2:1b\",\n    \"prompt\": \"Pourquoi le ciel est bleu?\",\n    \"stream\": false\n  }'\n</code></pre> <p>R\u00e9ponse : <pre><code>{\n  \"model\": \"llama3.2:1b\",\n  \"response\": \"Le ciel appara\u00eet bleu car...\",\n  \"done\": true\n}\n</code></pre></p>"},{"location":"02-applications/guides/ollama-setup/#3-chat-conversation","title":"3. Chat (conversation)","text":"<pre><code>curl -X POST https://ollama.srv759970.hstgr.cloud/api/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"model\": \"mistral:7b\",\n    \"messages\": [\n      {\"role\": \"user\", \"content\": \"Bonjour, qui es-tu?\"}\n    ],\n    \"stream\": false\n  }'\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#4-embeddings-vecteurs","title":"4. Embeddings (vecteurs)","text":"<pre><code>curl -X POST https://ollama.srv759970.hstgr.cloud/api/embeddings \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"model\": \"llama3.2:1b\",\n    \"prompt\": \"Hello world\"\n  }'\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#mode-streaming","title":"Mode streaming","text":"<p>Pour recevoir les tokens au fur et \u00e0 mesure :</p> <pre><code>curl -X POST https://ollama.srv759970.hstgr.cloud/api/generate \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"model\": \"llama3.2:1b\",\n    \"prompt\": \"\u00c9cris une histoire courte\",\n    \"stream\": true\n  }'\n</code></pre> <p>R\u00e9sultat : Flux de JSON (un par ligne)</p>"},{"location":"02-applications/guides/ollama-setup/#gestion-des-modeles","title":"\ud83d\udd27 Gestion des mod\u00e8les","text":""},{"location":"02-applications/guides/ollama-setup/#installer-un-nouveau-modele","title":"Installer un nouveau mod\u00e8le","text":"<pre><code># Depuis le VPS\nssh root@69.62.108.82 \"ollama pull [model-name]\"\n\n# Exemples\nssh root@69.62.108.82 \"ollama pull llama3.2:1b\"\nssh root@69.62.108.82 \"ollama pull mistral:7b\"\nssh root@69.62.108.82 \"ollama pull qwen2.5:14b\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#supprimer-un-modele","title":"Supprimer un mod\u00e8le","text":"<pre><code>ssh root@69.62.108.82 \"ollama rm [model-name]\"\n\n# Exemple\nssh root@69.62.108.82 \"ollama rm llama3.2:1b\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#voir-lespace-disque-utilise","title":"Voir l'espace disque utilis\u00e9","text":"<pre><code># Taille totale des mod\u00e8les\nssh root@69.62.108.82 \"du -sh ~/.ollama/models/\"\n\n# D\u00e9tail par mod\u00e8le\nssh root@69.62.108.82 \"ollama list\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"02-applications/guides/ollama-setup/#probleme-1-service-ne-demarre-pas","title":"Probl\u00e8me 1 : Service ne d\u00e9marre pas","text":"<pre><code># Voir les logs\nssh root@69.62.108.82 \"journalctl -u ollama -n 50 --no-pager\"\n\n# Red\u00e9marrer le service\nssh root@69.62.108.82 \"systemctl restart ollama\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#probleme-2-nginx-retourne-502-bad-gateway","title":"Probl\u00e8me 2 : Nginx retourne 502 Bad Gateway","text":"<p>Cause : Ollama n'est pas d\u00e9marr\u00e9 ou n'\u00e9coute pas sur 11434</p> <p>Solution : <pre><code># V\u00e9rifier le service\nssh root@69.62.108.82 \"systemctl status ollama\"\n\n# V\u00e9rifier le port\nssh root@69.62.108.82 \"netstat -tulpn | grep 11434\"\n\n# Red\u00e9marrer si n\u00e9cessaire\nssh root@69.62.108.82 \"systemctl restart ollama\"\n</code></pre></p>"},{"location":"02-applications/guides/ollama-setup/#probleme-3-timeout-sur-generation","title":"Probl\u00e8me 3 : Timeout sur g\u00e9n\u00e9ration","text":"<p>Cause : Timeout Nginx trop court</p> <p>Solution : Augmenter <code>proxy_read_timeout</code> dans la config Nginx</p> <pre><code>proxy_read_timeout 600s;  # 10 minutes\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#probleme-4-modele-ne-charge-pas-out-of-memory","title":"Probl\u00e8me 4 : Mod\u00e8le ne charge pas (out of memory)","text":"<p>Sympt\u00f4mes : Erreur \"failed to load model\"</p> <p>Solution : Utiliser un mod\u00e8le plus petit ou augmenter la RAM du VPS</p> <pre><code># V\u00e9rifier la RAM disponible\nssh root@69.62.108.82 \"free -h\"\n\n# Utiliser un mod\u00e8le plus l\u00e9ger\nssh root@69.62.108.82 \"ollama pull llama3.2:1b\"  # Au lieu de qwen2.5:14b\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#monitoring-et-logs","title":"\ud83d\udcca Monitoring et logs","text":""},{"location":"02-applications/guides/ollama-setup/#logs-du-service","title":"Logs du service","text":"<pre><code># Logs en temps r\u00e9el\nssh root@69.62.108.82 \"journalctl -u ollama -f\"\n\n# Derni\u00e8res 100 lignes\nssh root@69.62.108.82 \"journalctl -u ollama -n 100 --no-pager\"\n\n# Logs depuis une date\nssh root@69.62.108.82 \"journalctl -u ollama --since '2025-10-15 10:00:00'\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#logs-nginx","title":"Logs Nginx","text":"<pre><code># Access logs\nssh root@69.62.108.82 \"tail -f /var/log/nginx/ollama-access.log\"\n\n# Error logs\nssh root@69.62.108.82 \"tail -f /var/log/nginx/ollama-error.log\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#statistiques-dutilisation","title":"Statistiques d'utilisation","text":"<pre><code># Voir l'utilisation CPU/RAM\nssh root@69.62.108.82 \"top -b -n 1 | grep ollama\"\n\n# Voir les processus Ollama\nssh root@69.62.108.82 \"ps aux | grep ollama\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/ollama-setup/#considerations-importantes","title":"Consid\u00e9rations importantes","text":"<ol> <li>Pas d'authentification native : Ollama n'a pas d'auth built-in</li> <li>CORS ouvert : Config actuelle permet tous les origins</li> <li>Rate limiting : Pas de limite de requ\u00eates</li> </ol>"},{"location":"02-applications/guides/ollama-setup/#ajouter-une-authentification-optionnel","title":"Ajouter une authentification (optionnel)","text":""},{"location":"02-applications/guides/ollama-setup/#option-1-basic-auth-nginx","title":"Option 1 : Basic Auth Nginx","text":"<pre><code>location / {\n    auth_basic \"Ollama API\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n\n    proxy_pass http://127.0.0.1:11434;\n    # ... reste de la config\n}\n</code></pre> <pre><code># Cr\u00e9er le fichier de mots de passe\nssh root@69.62.108.82 \"apt install -y apache2-utils\"\nssh root@69.62.108.82 \"htpasswd -c /etc/nginx/.htpasswd admin\"\n</code></pre>"},{"location":"02-applications/guides/ollama-setup/#option-2-api-key-via-header","title":"Option 2 : API Key via header","text":"<pre><code>location / {\n    if ($http_x_api_key != \"votre-secret-key\") {\n        return 403;\n    }\n\n    proxy_pass http://127.0.0.1:11434;\n    # ... reste de la config\n}\n</code></pre> <p>Utilisation : <pre><code>curl -H \"X-API-Key: votre-secret-key\" https://ollama.srv759970.hstgr.cloud/api/tags\n</code></pre></p>"},{"location":"02-applications/guides/ollama-setup/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Ollama Documentation : https://github.com/ollama/ollama</li> <li>API Reference : https://github.com/ollama/ollama/blob/main/docs/api.md</li> <li>Mod\u00e8les disponibles : https://ollama.com/library</li> <li>Guide Nginx : Nginx Infrastructure</li> </ul>"},{"location":"02-applications/guides/ollama-setup/#checklist-deploiement-ollama","title":"\ud83d\udcdd Checklist d\u00e9ploiement Ollama","text":"<ul> <li> Ollama install\u00e9 (<code>curl -fsSL https://ollama.com/install.sh | sh</code>)</li> <li> Service systemd actif (<code>systemctl enable --now ollama</code>)</li> <li> Au moins un mod\u00e8le install\u00e9 (<code>ollama pull llama3.2:1b</code>)</li> <li> Service \u00e9coute sur 11434 (<code>netstat -tulpn | grep 11434</code>)</li> <li> Certificat SSL obtenu (Certbot standalone)</li> <li> Config Nginx cr\u00e9\u00e9e avec timeouts augment\u00e9s</li> <li> Config Nginx test\u00e9e (<code>nginx -t</code>)</li> <li> Site activ\u00e9 (symlink dans <code>sites-enabled/</code>)</li> <li> Nginx recharg\u00e9 (<code>systemctl reload nginx</code>)</li> <li> API accessible via HTTPS</li> <li> Test g\u00e9n\u00e9ration de texte r\u00e9ussi</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version : 1.0 Status : \u2705 Op\u00e9rationnel sur srv759970.hstgr.cloud URL publique : https://ollama.srv759970.hstgr.cloud Mod\u00e8les install\u00e9s : 4 (qwen2.5:14b, qwen2.5vl:7b, mistral:7b, llama3.2:1b)</p>"},{"location":"02-applications/guides/rustdesk-deployment/","title":"Guide RustDesk - Bureau \u00e0 distance auto-h\u00e9berg\u00e9","text":"<p>Derni\u00e8re mise \u00e0 jour : 20 octobre 2025 Serveur : srv759970.hstgr.cloud (69.62.108.82) Status : \u2705 Install\u00e9 et fonctionnel</p>"},{"location":"02-applications/guides/rustdesk-deployment/#quest-ce-que-rustdesk","title":"\ud83c\udfaf Qu'est-ce que RustDesk ?","text":"<p>RustDesk est une alternative open-source \u00e0 TeamViewer/AnyDesk permettant : - \u2705 Bureau \u00e0 distance s\u00e9curis\u00e9 - \u2705 Auto-h\u00e9bergement complet (aucune d\u00e9pendance cloud) - \u2705 Multiplateforme (Windows, Mac, Linux, Android, iOS) - \u2705 Gratuit et sans limitation - \u2705 Chiffrement de bout en bout</p>"},{"location":"02-applications/guides/rustdesk-deployment/#installation-serveur","title":"\ud83d\udce6 Installation serveur","text":""},{"location":"02-applications/guides/rustdesk-deployment/#architecture-deployee","title":"Architecture d\u00e9ploy\u00e9e","text":"<pre><code>/opt/rustdesk/\n\u251c\u2500\u2500 docker-compose.yml          # Configuration Docker\n\u2514\u2500\u2500 data/                       # Donn\u00e9es persistantes\n    \u251c\u2500\u2500 id_ed25519              # Cl\u00e9 priv\u00e9e serveur\n    \u2514\u2500\u2500 id_ed25519.pub          # Cl\u00e9 publique serveur\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#composants-installes","title":"Composants install\u00e9s","text":"Service Conteneur Port R\u00f4le RAM HBBS hbbs 21115-21116 (TCP/UDP) Signal server (enregistrement ID, NAT) ~2 MB HBBR hbbr 21117, 21119 (TCP) Relay server (connexions peer-to-peer) ~1 MB Web nginx 80 (HTTP) Page d'information - <p>Total RAM : ~3 MB (ultra l\u00e9ger, laiss\u00e9 actif 24/7)</p>"},{"location":"02-applications/guides/rustdesk-deployment/#ports-ouverts-dans-le-firewall","title":"Ports ouverts dans le firewall","text":"<pre><code># TCP\n21115 - NAT type test\n21116 - ID registration &amp; heartbeat\n21117 - Relay server\n21118 - WebSocket support\n21119 - WebSocket support\n\n# UDP\n21116 - ID registration &amp; heartbeat\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#configuration-client","title":"\ud83d\udd11 Configuration client","text":""},{"location":"02-applications/guides/rustdesk-deployment/#informations-de-connexion","title":"Informations de connexion","text":"<p>Serveur ID : <code>rustdesk.srv759970.hstgr.cloud</code> Port ID : <code>21116</code> (ou laisser vide pour port par d\u00e9faut) Serveur Relay : <code>rustdesk.srv759970.hstgr.cloud</code> Port Relay : <code>21117</code> (ou laisser vide pour port par d\u00e9faut) Cl\u00e9 publique : <code>Rrvoi88SE7SuwOBgzUD9vqWqPl6gpDWDXNjifrTee+c=</code></p>"},{"location":"02-applications/guides/rustdesk-deployment/#etapes-de-configuration-client","title":"\u00c9tapes de configuration client","text":""},{"location":"02-applications/guides/rustdesk-deployment/#1-telecharger-rustdesk","title":"1. T\u00e9l\u00e9charger RustDesk","text":"<p>Windows/Mac/Linux : https://rustdesk.com/fr/ Android : Google Play Store iOS : Apple App Store</p>"},{"location":"02-applications/guides/rustdesk-deployment/#2-configurer-le-client","title":"2. Configurer le client","text":"<ol> <li>Lancer RustDesk</li> <li>Cliquer sur les 3 points (menu) \u00e0 c\u00f4t\u00e9 de \"Pr\u00eat\"</li> <li>S\u00e9lectionner \"Serveur ID/Relay\"</li> <li>Remplir les champs :</li> </ol> <pre><code>Serveur ID : rustdesk.srv759970.hstgr.cloud\nPort ID : (laisser vide ou 21116)\nServeur Relay : rustdesk.srv759970.hstgr.cloud\nPort Relay : (laisser vide ou 21117)\nCl\u00e9 : Rrvoi88SE7SuwOBgzUD9vqWqPl6gpDWDXNjifrTee+c=\n</code></pre> <ol> <li>Cliquer sur \"Appliquer\"</li> <li>Red\u00e9marrer RustDesk</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#3-verifier-la-connexion","title":"3. V\u00e9rifier la connexion","text":"<p>Le client doit afficher : - \u2705 \"Pr\u00eat\" avec un ID unique (ex: 123456789) - \u2705 Point vert \u00e0 c\u00f4t\u00e9 de l'ID (connect\u00e9 au serveur)</p>"},{"location":"02-applications/guides/rustdesk-deployment/#utilisation","title":"\ud83d\ude80 Utilisation","text":""},{"location":"02-applications/guides/rustdesk-deployment/#controler-un-ordinateur-a-distance","title":"Contr\u00f4ler un ordinateur \u00e0 distance","text":"<ol> <li>Sur l'ordinateur distant :</li> <li>Noter l'ID RustDesk affich\u00e9 (ex: 987654321)</li> <li> <p>Noter le mot de passe temporaire (ou configurer un mot de passe fixe)</p> </li> <li> <p>Sur votre ordinateur :</p> </li> <li>Entrer l'ID distant dans le champ \"Remote ID\"</li> <li>Cliquer sur \"Connect\"</li> <li>Entrer le mot de passe</li> <li>Le bureau distant s'affiche</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#permettre-a-quelquun-de-se-connecter-a-votre-pc","title":"Permettre \u00e0 quelqu'un de se connecter \u00e0 votre PC","text":"<ol> <li>Partager votre ID RustDesk (9 chiffres)</li> <li>Partager le mot de passe temporaire affich\u00e9 sous l'ID</li> <li>L'autre personne entre votre ID et se connecte</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#gestion-du-serveur","title":"\ud83d\udd27 Gestion du serveur","text":""},{"location":"02-applications/guides/rustdesk-deployment/#commandes-docker","title":"Commandes Docker","text":"<pre><code># Voir les conteneurs\nssh automation@69.62.108.82 \"sudo docker ps | grep rustdesk\"\n\n# Voir les logs HBBS (signal server)\nssh automation@69.62.108.82 \"sudo docker logs hbbs -f\"\n\n# Voir les logs HBBR (relay server)\nssh automation@69.62.108.82 \"sudo docker logs hbbr -f\"\n\n# Red\u00e9marrer les services\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose restart\"\n\n# Arr\u00eater les services\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose stop\"\n\n# D\u00e9marrer les services\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose start\"\n\n# Rebuild complet\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose down &amp;&amp; sudo docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#recuperer-la-cle-publique","title":"R\u00e9cup\u00e9rer la cl\u00e9 publique","text":"<pre><code># Afficher la cl\u00e9 publique serveur\nssh automation@69.62.108.82 \"sudo cat /opt/rustdesk/data/id_ed25519.pub\"\n</code></pre> <p>R\u00e9sultat : <code>Rrvoi88SE7SuwOBgzUD9vqWqPl6gpDWDXNjifrTee+c=</code></p>"},{"location":"02-applications/guides/rustdesk-deployment/#verifier-le-statut","title":"V\u00e9rifier le statut","text":"<pre><code># Tester les ports\nssh automation@69.62.108.82 \"sudo netstat -tulpn | grep -E '(21115|21116|21117|21118|21119)'\"\n\n# V\u00e9rifier le firewall\nssh automation@69.62.108.82 \"sudo ufw status | grep 211\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#securite","title":"\ud83d\udee1\ufe0f S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/rustdesk-deployment/#recommandations","title":"Recommandations","text":"<ol> <li>Mot de passe fort : Configurer un mot de passe permanent dans RustDesk (ne pas utiliser le mot de passe temporaire)</li> <li>Cl\u00e9 publique : Ne jamais partager la cl\u00e9 priv\u00e9e (<code>id_ed25519</code>), seulement la cl\u00e9 publique</li> <li>Firewall : Les ports sont ouverts uniquement pour RustDesk (21115-21119)</li> <li>Chiffrement : Toutes les connexions sont chiffr\u00e9es de bout en bout</li> <li>Logs : Les connexions sont logg\u00e9es dans Docker logs</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#audit-des-connexions","title":"Audit des connexions","text":"<pre><code># Voir les connexions r\u00e9centes\nssh automation@69.62.108.82 \"sudo docker logs hbbs --tail 100 | grep -i 'peer'\"\n\n# Voir les erreurs\nssh automation@69.62.108.82 \"sudo docker logs hbbs --tail 100 | grep -i 'error'\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#mise-a-jour","title":"\ud83d\udd04 Mise \u00e0 jour","text":""},{"location":"02-applications/guides/rustdesk-deployment/#mettre-a-jour-les-images-docker","title":"Mettre \u00e0 jour les images Docker","text":"<pre><code># 1. Pull les nouvelles images\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose pull\"\n\n# 2. Recr\u00e9er les conteneurs\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose up -d\"\n\n# 3. Nettoyer les anciennes images\nssh automation@69.62.108.82 \"sudo docker image prune -f\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#pourquoi-rustdesk-nutilise-pas-lauto-stop","title":"Pourquoi RustDesk n'utilise PAS l'auto-stop ?","text":"<p>D\u00e9cision technique : RustDesk reste actif 24/7 (pas d'auto-stop comme les autres services)</p> <p>Raisons : 1. Ultra l\u00e9ger : ~3 MB de RAM total (n\u00e9gligeable) 2. Disponibilit\u00e9 critique : Bureau \u00e0 distance = besoin urgent, pas de temps d'attente 3. Incompatibilit\u00e9 technique : Utilise des ports TCP/UDP directs (pas de proxy HTTP possible) 4. Nature du protocole : Les clients se connectent directement aux ports 21116/21117</p> <p>Comparaison : - WordPress : 200-300 MB \u2192 Auto-stop activ\u00e9 - Strapi : 400 MB \u2192 Auto-stop activ\u00e9 - RustDesk : 3 MB \u2192 Toujours actif (restart: unless-stopped)</p>"},{"location":"02-applications/guides/rustdesk-deployment/#troubleshooting","title":"\ud83c\udd98 Troubleshooting","text":""},{"location":"02-applications/guides/rustdesk-deployment/#le-client-affiche-non-connecte","title":"Le client affiche \"Non connect\u00e9\"","text":"<p>Cause : Le client ne peut pas joindre le serveur HBBS</p> <p>Solutions : <pre><code># 1. V\u00e9rifier que les conteneurs tournent\nssh automation@69.62.108.82 \"sudo docker ps | grep rustdesk\"\n\n# 2. V\u00e9rifier les logs\nssh automation@69.62.108.82 \"sudo docker logs hbbs --tail 50\"\n\n# 3. Tester la connectivit\u00e9 depuis le client\nping rustdesk.srv759970.hstgr.cloud\ntelnet rustdesk.srv759970.hstgr.cloud 21116\n</code></pre></p>"},{"location":"02-applications/guides/rustdesk-deployment/#impossible-de-se-connecter-a-un-peer","title":"Impossible de se connecter \u00e0 un peer","text":"<p>Cause : Le serveur relay (HBBR) ne fonctionne pas ou les ports sont bloqu\u00e9s</p> <p>Solutions : <pre><code># 1. V\u00e9rifier HBBR\nssh automation@69.62.108.82 \"sudo docker logs hbbr --tail 50\"\n\n# 2. V\u00e9rifier les ports relay\nssh automation@69.62.108.82 \"sudo netstat -tulpn | grep 21117\"\n\n# 3. Tester depuis le client\ntelnet rustdesk.srv759970.hstgr.cloud 21117\n</code></pre></p>"},{"location":"02-applications/guides/rustdesk-deployment/#erreur-invalid-key","title":"Erreur \"Invalid key\"","text":"<p>Cause : La cl\u00e9 publique configur\u00e9e dans le client ne correspond pas \u00e0 celle du serveur</p> <p>Solution : <pre><code># R\u00e9cup\u00e9rer la bonne cl\u00e9 publique\nssh automation@69.62.108.82 \"sudo cat /opt/rustdesk/data/id_ed25519.pub\"\n\n# La copier dans le client RustDesk (param\u00e8tres Serveur ID/Relay)\n</code></pre></p>"},{"location":"02-applications/guides/rustdesk-deployment/#conteneurs-ne-demarrent-pas","title":"Conteneurs ne d\u00e9marrent pas","text":"<pre><code># Voir les erreurs\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose logs\"\n\n# Rebuild from scratch\nssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose down -v &amp;&amp; sudo docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"02-applications/guides/rustdesk-deployment/#metriques-importantes","title":"M\u00e9triques importantes","text":"<pre><code># Nombre de clients connect\u00e9s\nssh automation@69.62.108.82 \"sudo docker logs hbbs --tail 1000 | grep -c 'peer online'\"\n\n# Utilisation m\u00e9moire\nssh automation@69.62.108.82 \"sudo docker stats --no-stream | grep rustdesk\"\n\n# Utilisation disque\nssh automation@69.62.108.82 \"sudo du -sh /opt/rustdesk/data\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#acces-web","title":"\ud83c\udf10 Acc\u00e8s web","text":"<p>URL : https://rustdesk.srv759970.hstgr.cloud SSL : Certificat Let's Encrypt (expire le 18 janvier 2026) Protection : Basic Auth (credentials Nginx)</p> <p>La page affiche : - Statut du serveur - Ports de connexion - Cl\u00e9 publique - Instructions de configuration</p>"},{"location":"02-applications/guides/rustdesk-deployment/#renouvellement-automatique-ssl","title":"Renouvellement automatique SSL","text":"<p>Le certificat SSL est automatiquement renouvel\u00e9 par Certbot tous les 90 jours.</p> <p>V\u00e9rifier le renouvellement : <pre><code>ssh automation@69.62.108.82 \"sudo certbot certificates | grep -A 6 rustdesk\"\n</code></pre></p> <p>Forcer un renouvellement (si besoin) : <pre><code>ssh automation@69.62.108.82 \"sudo certbot renew --cert-name rustdesk.srv759970.hstgr.cloud\"\n</code></pre></p>"},{"location":"02-applications/guides/rustdesk-deployment/#configuration-avancee","title":"\ud83d\udcdd Configuration avanc\u00e9e","text":""},{"location":"02-applications/guides/rustdesk-deployment/#changer-le-port-de-connexion","title":"Changer le port de connexion","text":"<p>\u00c9diter <code>/opt/rustdesk/docker-compose.yml</code> :</p> <pre><code>services:\n  hbbs:\n    ports:\n      - \"21115:21115\"      # Changer 21115 par le port souhait\u00e9\n      - \"21116:21116\"      # Changer 21116 par le port souhait\u00e9\n      - \"21116:21116/udp\"  # Changer 21116 par le port souhait\u00e9\n</code></pre> <p>Puis red\u00e9marrer : <pre><code>ssh automation@69.62.108.82 \"cd /opt/rustdesk &amp;&amp; sudo docker-compose down &amp;&amp; sudo docker-compose up -d\"\n</code></pre></p>"},{"location":"02-applications/guides/rustdesk-deployment/#activer-les-logs-detailles","title":"Activer les logs d\u00e9taill\u00e9s","text":"<pre><code>services:\n  hbbs:\n    command: hbbs -r rustdesk.srv759970.hstgr.cloud:21117 -v\n  hbbr:\n    command: hbbr -v\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#configuration-du-relay-personnalise","title":"Configuration du relay personnalis\u00e9","text":"<p>Le relay est configur\u00e9 dans le command HBBS : <pre><code>command: hbbs -r rustdesk.srv759970.hstgr.cloud:21117\n</code></pre></p> <p>Cela indique aux clients o\u00f9 trouver le serveur relay.</p>"},{"location":"02-applications/guides/rustdesk-deployment/#liens-utiles","title":"\ud83d\udd17 Liens utiles","text":"<ul> <li>Site officiel : https://rustdesk.com/fr/</li> <li>Documentation : https://rustdesk.com/docs/</li> <li>GitHub : https://github.com/rustdesk/rustdesk-server</li> <li>Docker Hub : https://hub.docker.com/r/rustdesk/rustdesk-server</li> </ul>"},{"location":"02-applications/guides/rustdesk-deployment/#support","title":"\ud83d\udcde Support","text":""},{"location":"02-applications/guides/rustdesk-deployment/#logs-du-serveur","title":"Logs du serveur","text":"<pre><code># Logs HBBS (signal)\nssh automation@69.62.108.82 \"sudo docker logs hbbs -f\"\n\n# Logs HBBR (relay)\nssh automation@69.62.108.82 \"sudo docker logs hbbr -f\"\n\n# Logs Nginx (page web)\nssh automation@69.62.108.82 \"sudo tail -f /var/log/nginx/access.log | grep rustdesk\"\n</code></pre>"},{"location":"02-applications/guides/rustdesk-deployment/#contacts","title":"Contacts","text":"<p>Serveur : srv759970.hstgr.cloud (69.62.108.82) Acc\u00e8s SSH : <code>ssh automation@69.62.108.82</code> Panel Hostinger : https://hpanel.hostinger.com/</p>"},{"location":"02-applications/guides/rustdesk-deployment/#checklist-deploiement","title":"\ud83d\udccb Checklist d\u00e9ploiement","text":"<ul> <li> Serveur RustDesk install\u00e9 (hbbs + hbbr)</li> <li> Ports firewall ouverts (21115-21119)</li> <li> Conteneurs Docker d\u00e9marr\u00e9s</li> <li> Cl\u00e9 publique g\u00e9n\u00e9r\u00e9e</li> <li> Configuration Nginx cr\u00e9\u00e9e</li> <li> Page web d'information accessible</li> <li> Client Windows configur\u00e9 et test\u00e9</li> <li> Client Mac configur\u00e9 et test\u00e9</li> <li> Client Linux configur\u00e9 et test\u00e9</li> <li> Connexion peer-to-peer test\u00e9e</li> <li> Logs v\u00e9rifi\u00e9s (pas d'erreur)</li> </ul>"},{"location":"02-applications/guides/rustdesk-deployment/#exemples-dutilisation","title":"\ud83c\udf93 Exemples d'utilisation","text":""},{"location":"02-applications/guides/rustdesk-deployment/#cas-1-support-technique-a-distance","title":"Cas 1 : Support technique \u00e0 distance","text":"<ol> <li>L'utilisateur lance RustDesk et communique son ID (ex: 123456789)</li> <li>Le technicien entre cet ID dans son RustDesk</li> <li>L'utilisateur partage le mot de passe temporaire</li> <li>Le technicien prend le contr\u00f4le du PC</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#cas-2-acces-a-son-pc-de-bureau-depuis-chez-soi","title":"Cas 2 : Acc\u00e8s \u00e0 son PC de bureau depuis chez soi","text":"<ol> <li>Configurer RustDesk sur le PC de bureau avec un mot de passe permanent</li> <li>Noter l'ID RustDesk</li> <li>Installer RustDesk sur le PC personnel avec la m\u00eame config serveur</li> <li>Se connecter \u00e0 tout moment avec l'ID et le mot de passe</li> </ol>"},{"location":"02-applications/guides/rustdesk-deployment/#cas-3-acces-mobile-au-pc","title":"Cas 3 : Acc\u00e8s mobile au PC","text":"<ol> <li>Installer RustDesk sur smartphone (Android/iOS)</li> <li>Configurer le serveur avec les m\u00eames param\u00e8tres</li> <li>Entrer l'ID du PC</li> <li>Contr\u00f4ler le PC depuis le t\u00e9l\u00e9phone</li> </ol> <p>Version : 1.0 Auteur : Claude Code + Julien Status : Production Prochaine revue : Apr\u00e8s tests utilisateurs</p>"},{"location":"02-applications/guides/strapi-setup/","title":"\ud83d\udd27 Guide Strapi - D\u00e9ploiement sur VPS avec Docker","text":"<p>Guide complet pour d\u00e9ployer Strapi CMS sur VPS Hostinger - Solutions aux probl\u00e8mes courants</p>"},{"location":"02-applications/guides/strapi-setup/#avertissement-important","title":"\u26a0\ufe0f AVERTISSEMENT IMPORTANT","text":"<p>Ce guide vous fera gagner 3+ heures de debugging en \u00e9vitant les pi\u00e8ges suivants : 1. \u274c Bug Vite 6 avec <code>server.allowedHosts</code> en mode <code>develop</code> 2. \u274c Strapi n\u00e9cessite Node.js &lt;=22 (pas 23+) 3. \u274c Rebuild admin requis apr\u00e8s modification <code>vite.config.ts</code> 4. \u274c Mode production OBLIGATOIRE avec reverse proxy</p>"},{"location":"02-applications/guides/strapi-setup/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<p>Strapi : Headless CMS open-source (Node.js) Version support\u00e9e : Strapi 5.x D\u00e9ploiement : Docker avec Node.js 22 + SQLite Admin panel : Interface web sur <code>/admin</code></p>"},{"location":"02-applications/guides/strapi-setup/#architecture-de-deploiement","title":"\ud83c\udfd7\ufe0f Architecture de d\u00e9ploiement","text":"<pre><code>VPS Hostinger (69.62.108.82)\n\u2502\n\u251c\u2500\u2500 Nginx (port 80)\n\u2502   \u2514\u2500\u2500 Reverse proxy vers localhost:1337\n\u2502       \u2514\u2500\u2500 admin.mon-site.srv759970.hstgr.cloud\n\u2502\n\u2514\u2500\u2500 Docker Container (cristina-strapi)\n    \u251c\u2500\u2500 Node.js 22-slim\n    \u251c\u2500\u2500 Strapi 5.27.0\n    \u251c\u2500\u2500 SQLite database\n    \u251c\u2500\u2500 Mode: PRODUCTION (important !)\n    \u2514\u2500\u2500 Port: 1337\n</code></pre> <p>Pourquoi Docker ? : - Node.js 22 isol\u00e9 (syst\u00e8me peut avoir Node 23) - D\u00e9pendances g\u00e9r\u00e9es - Facile \u00e0 rebuild/red\u00e9marrer</p>"},{"location":"02-applications/guides/strapi-setup/#deploiement-initial","title":"\ud83d\ude80 D\u00e9ploiement initial","text":""},{"location":"02-applications/guides/strapi-setup/#etape-1-creer-le-projet-strapi-localement-avec-node-22","title":"\u00c9tape 1 : Cr\u00e9er le projet Strapi localement (avec Node 22)","text":"<p>\u26a0\ufe0f Pr\u00e9requis : Node.js 22 (pas 23 !)</p> <pre><code># V\u00e9rifier version Node\nnode -v\n# Doit afficher : v22.x.x\n\n# Si version 23+, installer Node 22 via NVM\n# Ou utiliser Docker directement sur le VPS\n</code></pre> <p>Option A : Cr\u00e9er localement (si Node 22 disponible)</p> <pre><code>cd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\"\n\n# Cr\u00e9er projet Strapi\npnpm create strapi-app@latest mon-backoffice --quickstart --typescript --skip-cloud\n\n# Structure cr\u00e9\u00e9e :\n# mon-backoffice/\n# \u251c\u2500\u2500 src/\n# \u251c\u2500\u2500 config/\n# \u251c\u2500\u2500 public/\n# \u2514\u2500\u2500 package.json\n</code></pre> <p>Option B : Cr\u00e9er directement sur VPS avec Docker (recommand\u00e9 si pas Node 22)</p> <pre><code># Cr\u00e9er avec conteneur temporaire Node 22\nssh root@69.62.108.82 \"docker run --rm -v /opt/mon-backend:/opt -w /opt node:22-slim sh -c 'npx create-strapi-app@latest backend --quickstart --typescript --skip-cloud'\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#etape-2-creer-la-structure-docker","title":"\u00c9tape 2 : Cr\u00e9er la structure Docker","text":"<p>Sur le VPS :</p> <pre><code>ssh root@69.62.108.82 \"mkdir -p /opt/mon-backend\"\n</code></pre> <p>Cr\u00e9er <code>Dockerfile</code> :</p> <pre><code>ssh root@69.62.108.82 \"cat &gt; /opt/mon-backend/Dockerfile\" &lt;&lt;'EOF'\nFROM node:22-slim\n\nWORKDIR /app\n\n# Copier le projet Strapi\nCOPY backend/ /app/\n\n# Installer les d\u00e9pendances\nRUN npm install\n\n# Build l'admin panel (IMPORTANT !)\nRUN npm run build\n\n# Exposer le port\nEXPOSE 1337\n\n# \u26a0\ufe0f IMPORTANT : Utiliser 'start' (production), PAS 'develop'\nCMD [\"npm\", \"run\", \"start\"]\nEOF\n</code></pre> <p>Cr\u00e9er <code>docker-compose.yml</code> :</p> <pre><code>ssh root@69.62.108.82 \"cat &gt; /opt/mon-backend/docker-compose.yml\" &lt;&lt;'EOF'\nversion: '3.8'\n\nservices:\n  strapi:\n    build: .\n    container_name: mon-strapi\n    ports:\n      - \"1337:1337\"\n    volumes:\n      # Donn\u00e9es persistantes (SQLite + uploads)\n      - ./data:/app/.tmp\n      - ./uploads:/app/public/uploads\n    restart: unless-stopped\n    environment:\n      # \u26a0\ufe0f IMPORTANT : Production mode obligatoire avec reverse proxy !\n      - NODE_ENV=production\n      - TZ=Europe/Paris\n      - STRAPI_ADMIN_BACKEND_URL=http://admin.mon-site.srv759970.hstgr.cloud\n      - HOST=0.0.0.0\n      - PORT=1337\nEOF\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#etape-3-critique-creer-viteconfigts","title":"\u00c9tape 3 : CRITIQUE - Cr\u00e9er <code>vite.config.ts</code>","text":"<p>\u26a0\ufe0f SANS CE FICHIER, VOUS AUREZ \"host not allowed\" ERROR !</p> <pre><code>ssh root@69.62.108.82 \"mkdir -p /opt/mon-backend/backend/src/admin\"\n\nssh root@69.62.108.82 \"cat &gt; /opt/mon-backend/backend/src/admin/vite.config.ts\" &lt;&lt;'EOF'\nimport { mergeConfig, type UserConfig } from 'vite';\n\nexport default (config: UserConfig) =&gt; {\n  return mergeConfig(config, {\n    server: {\n      // \u2705 SOLUTION : allowedHosts: true\n      // \u274c NE MARCHE PAS : Liste sp\u00e9cifique en mode develop\n      allowedHosts: true,\n    },\n  });\n};\nEOF\n</code></pre> <p>Pourquoi <code>allowedHosts: true</code> ? : - Bug Vite 6.0.11+ : liste d'hosts ne fonctionne qu'en production - <code>true</code> = accepte tous les hosts (OK pour reverse proxy) - Alternative : Passer en mode production (recommand\u00e9)</p>"},{"location":"02-applications/guides/strapi-setup/#etape-4-transferer-le-code-strapi","title":"\u00c9tape 4 : Transf\u00e9rer le code Strapi","text":"<pre><code># Depuis le dossier local\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\"\n\n# Transf\u00e9rer le code Strapi (backend/)\nscp -r mon-backoffice/* root@69.62.108.82:/opt/mon-backend/backend/\n\n# \u26a0\ufe0f NE PAS transf\u00e9rer node_modules/ (trop gros, inutile)\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#etape-5-build-et-lancer-docker","title":"\u00c9tape 5 : Build et lancer Docker","text":"<pre><code># Build l'image Docker\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose build\"\n\n# Lancer le conteneur\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose up -d\"\n\n# Attendre 15s que Strapi d\u00e9marre\nsleep 15\n\n# V\u00e9rifier les logs\nssh root@69.62.108.82 \"docker logs mon-strapi --tail=30\"\n</code></pre> <p>Logs attendus : <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Strapi started successfully                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nCreate your first administrator \ud83d\udcbb by going to:\nhttp://localhost:1337/admin\n</code></pre></p>"},{"location":"02-applications/guides/strapi-setup/#etape-6-configurer-nginx-reverse-proxy","title":"\u00c9tape 6 : Configurer Nginx (reverse proxy)","text":"<pre><code>ssh root@69.62.108.82 \"cat &gt; /etc/nginx/sites-available/mon-admin\" &lt;&lt;'EOF'\nserver {\n    listen 80;\n    server_name admin.mon-site.srv759970.hstgr.cloud;\n\n    # Logs\n    access_log /var/log/nginx/mon-admin-access.log;\n    error_log /var/log/nginx/mon-admin-error.log;\n\n    location / {\n        # Reverse proxy vers Strapi Docker\n        proxy_pass http://localhost:1337;\n\n        proxy_http_version 1.1;\n\n        # Headers essentiels\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support (admin panel en temps r\u00e9el)\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        # Timeout long (admin panel peut avoir des requ\u00eates longues)\n        proxy_read_timeout 86400;\n    }\n}\nEOF\n</code></pre> <p>Activer le site :</p> <pre><code># Cr\u00e9er symlink\nssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/mon-admin /etc/nginx/sites-enabled/\"\n\n# Tester config\nssh root@69.62.108.82 \"nginx -t\"\n\n# Recharger Nginx\nssh root@69.62.108.82 \"systemctl reload nginx\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#etape-7-verifier-le-deploiement","title":"\u00c9tape 7 : V\u00e9rifier le d\u00e9ploiement","text":"<pre><code># Test via Nginx proxy\nssh root@69.62.108.82 \"curl -s -o /dev/null -w 'Admin HTTP: %{http_code}\\n' -H 'Host: admin.mon-site.srv759970.hstgr.cloud' http://localhost/admin\"\n\n# Attendu : HTTP 200\n</code></pre> <p>Ouvrir dans navigateur : http://admin.mon-site.srv759970.hstgr.cloud/admin</p> <p>Si HTTP 200 : \u2705 Cr\u00e9er le compte administrateur !</p>"},{"location":"02-applications/guides/strapi-setup/#problemes-courants-solutions-detaillees","title":"\u26a0\ufe0f PROBL\u00c8MES COURANTS - SOLUTIONS D\u00c9TAILL\u00c9ES","text":""},{"location":"02-applications/guides/strapi-setup/#probleme-1-blocked-request-this-host-is-not-allowed","title":"Probl\u00e8me 1 : \"Blocked request. This host is not allowed\"","text":"<p>Sympt\u00f4me : <pre><code>Blocked request. This host (\"admin.mon-site.srv759970.hstgr.cloud\") is not allowed.\nTo allow this host, add \"admin.mon-site.srv759970.hstgr.cloud\" to `server.allowedHosts` in vite.config.js.\n</code></pre></p> <p>Cause : Bug Vite 6.0.11+ avec Strapi 5.12+</p> <p>Solutions (par ordre de priorit\u00e9) :</p>"},{"location":"02-applications/guides/strapi-setup/#solution-1-mode-production-recommandee","title":"\u2705 Solution 1 : Mode production (RECOMMAND\u00c9E)","text":"<pre><code># Modifier docker-compose.yml\nssh root@69.62.108.82 \"cat &gt; /opt/mon-backend/docker-compose.yml\" &lt;&lt;'EOF'\nversion: '3.8'\nservices:\n  strapi:\n    build: .\n    environment:\n      - NODE_ENV=production  # \u2190 IMPORTANT !\n      # ... autres variables\nEOF\n\n# Rebuild et red\u00e9marrer\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose down &amp;&amp; docker-compose build --no-cache &amp;&amp; docker-compose up -d\"\n</code></pre> <p>Avantages : - Admin panel optimis\u00e9 - Plus rapide - Plus stable - <code>allowedHosts</code> fonctionne correctement</p>"},{"location":"02-applications/guides/strapi-setup/#solution-2-allowedhosts-true-si-vraiment-en-develop","title":"\u2705 Solution 2 : <code>allowedHosts: true</code> (si vraiment en develop)","text":"<pre><code># Cr\u00e9er vite.config.ts\nssh root@69.62.108.82 \"cat &gt; /opt/mon-backend/backend/src/admin/vite.config.ts\" &lt;&lt;'EOF'\nimport { mergeConfig, type UserConfig } from 'vite';\n\nexport default (config: UserConfig) =&gt; {\n  return mergeConfig(config, {\n    server: {\n      allowedHosts: true,  // Accepte tous les hosts\n    },\n  });\n};\nEOF\n\n# \u26a0\ufe0f REBUILD ADMIN REQUIS !\nssh root@69.62.108.82 \"docker exec mon-strapi npm run build\"\nssh root@69.62.108.82 \"docker restart mon-strapi\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#solution-qui-ne-marche-pas","title":"\u274c Solution qui NE MARCHE PAS","text":"<pre><code>// \u274c CETTE CONFIG NE FONCTIONNE PAS EN MODE DEVELOP !\nserver: {\n  allowedHosts: [\n    'admin.mon-site.srv759970.hstgr.cloud',\n    'localhost',\n  ],\n}\n</code></pre> <p>Pourquoi \u00e7a ne marche pas : Bug Vite 6 en mode develop, la liste est ignor\u00e9e.</p>"},{"location":"02-applications/guides/strapi-setup/#probleme-2-erreur-nodejs-version-incompatible","title":"Probl\u00e8me 2 : Erreur \"Node.js version incompatible\"","text":"<p>Sympt\u00f4me : <pre><code>error Strapi requires Node.js &gt;=18.0.0 &lt;=22.x.x\n</code></pre></p> <p>Cause : Syst\u00e8me a Node.js 23+</p> <p>Solution : Utiliser Docker avec Node 22</p> <pre><code># Dockerfile\nFROM node:22-slim  # \u2190 Version sp\u00e9cifique\n</code></pre> <p>Alternative locale : Installer Node 22 via NVM (pas d'admin requis)</p>"},{"location":"02-applications/guides/strapi-setup/#probleme-3-rebuild-admin-panel-ne-prend-pas-effet","title":"Probl\u00e8me 3 : Rebuild admin panel ne prend pas effet","text":"<p>Sympt\u00f4me : - Modification <code>vite.config.ts</code> ignor\u00e9e - Config anciennes toujours actives</p> <p>Cause : Cache du build pr\u00e9c\u00e9dent</p> <p>Solution :</p> <pre><code># 1. Build complet avec --no-cache\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose build --no-cache\"\n\n# 2. Red\u00e9marrer proprement\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose down &amp;&amp; docker-compose up -d\"\n\n# 3. V\u00e9rifier logs\nssh root@69.62.108.82 \"docker logs mon-strapi --tail=50\"\n</code></pre> <p>Alternative : Build inside container</p> <pre><code>ssh root@69.62.108.82 \"docker exec mon-strapi npm run build\"\nssh root@69.62.108.82 \"docker restart mon-strapi\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#probleme-4-sqlite-database-locked","title":"Probl\u00e8me 4 : SQLite database locked","text":"<p>Sympt\u00f4me : <pre><code>Error: SQLITE_BUSY: database is locked\n</code></pre></p> <p>Cause : Plusieurs instances Strapi acc\u00e8dent \u00e0 la m\u00eame DB</p> <p>Solution :</p> <pre><code># Arr\u00eater TOUS les conteneurs Strapi\nssh root@69.62.108.82 \"docker ps | grep strapi\"\nssh root@69.62.108.82 \"docker stop [tous-les-conteneurs-strapi]\"\n\n# Supprimer fichiers lock\nssh root@69.62.108.82 \"rm -f /opt/mon-backend/data/.tmp/data.db-*\"\n\n# Red\u00e9marrer\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#probleme-5-port-1337-deja-utilise","title":"Probl\u00e8me 5 : Port 1337 d\u00e9j\u00e0 utilis\u00e9","text":"<p>Sympt\u00f4me : <pre><code>Error starting userland proxy: listen tcp4 0.0.0.0:1337: bind: address already in use\n</code></pre></p> <p>Cause : Autre Strapi ou service sur port 1337</p> <p>Solution :</p> <pre><code># Trouver qui utilise le port\nssh root@69.62.108.82 \"lsof -i :1337\"\nssh root@69.62.108.82 \"docker ps | grep 1337\"\n\n# Option 1 : Arr\u00eater l'autre service\nssh root@69.62.108.82 \"docker stop [autre-conteneur]\"\n\n# Option 2 : Changer le port dans docker-compose.yml\n# ports:\n#   - \"1338:1337\"  # Port externe diff\u00e9rent\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#probleme-6-admin-panel-lent-ne-charge-pas","title":"Probl\u00e8me 6 : Admin panel lent / ne charge pas","text":"<p>Sympt\u00f4mes : - Page blanche - Console : <code>Uncaught Error</code> - Tr\u00e8s lent</p> <p>Causes possibles :</p>"},{"location":"02-applications/guides/strapi-setup/#cause-1-mode-develop-en-production","title":"Cause 1 : Mode develop en production","text":"<p>Solution : Passer en mode production</p> <pre><code>environment:\n  - NODE_ENV=production  # Pas 'development' !\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#cause-2-admin-pas-rebuild","title":"Cause 2 : Admin pas rebuild","text":"<p>Solution :</p> <pre><code>ssh root@69.62.108.82 \"docker exec mon-strapi npm run build\"\nssh root@69.62.108.82 \"docker restart mon-strapi\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#cause-3-memoire-insuffisante","title":"Cause 3 : M\u00e9moire insuffisante","text":"<p>Solution : Augmenter limite m\u00e9moire Docker</p> <pre><code>services:\n  strapi:\n    deploy:\n      resources:\n        limits:\n          memory: 1G\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#workflow-de-mise-a-jour","title":"\ud83d\udd04 Workflow de mise \u00e0 jour","text":""},{"location":"02-applications/guides/strapi-setup/#mise-a-jour-du-code-strapi","title":"Mise \u00e0 jour du code Strapi","text":"<pre><code># 1. Modifier code localement\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\[PROJET]\\mon-backoffice\"\n\n# 2. Transf\u00e9rer modifications\nscp -r src/ root@69.62.108.82:/opt/mon-backend/backend/\nscp -r config/ root@69.62.108.82:/opt/mon-backend/backend/\n\n# 3. Rebuild Docker\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose build --no-cache\"\n\n# 4. Red\u00e9marrer\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose down &amp;&amp; docker-compose up -d\"\n\n# 5. V\u00e9rifier\nssh root@69.62.108.82 \"docker logs mon-strapi --tail=30\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#mise-a-jour-strapi-version","title":"Mise \u00e0 jour Strapi version","text":"<pre><code># 1. Localement, mettre \u00e0 jour package.json\ncd mon-backoffice\nnpm install @strapi/strapi@latest\n\n# 2. Transf\u00e9rer package.json et package-lock.json\nscp package.json package-lock.json root@69.62.108.82:/opt/mon-backend/backend/\n\n# 3. Rebuild complet\nssh root@69.62.108.82 \"cd /opt/mon-backend &amp;&amp; docker-compose build --no-cache &amp;&amp; docker-compose down &amp;&amp; docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#configuration-optimale","title":"\ud83d\udcca Configuration optimale","text":""},{"location":"02-applications/guides/strapi-setup/#docker-composeyml-complet","title":"docker-compose.yml complet","text":"<pre><code>version: '3.8'\n\nservices:\n  strapi:\n    build: .\n    container_name: mon-strapi\n    ports:\n      - \"1337:1337\"\n    volumes:\n      # Donn\u00e9es persistantes\n      - ./data:/app/.tmp\n      - ./uploads:/app/public/uploads\n    restart: unless-stopped\n    environment:\n      # \u26a0\ufe0f Production obligatoire avec reverse proxy\n      - NODE_ENV=production\n      - TZ=Europe/Paris\n\n      # URL admin (pour g\u00e9n\u00e9ration liens)\n      - STRAPI_ADMIN_BACKEND_URL=http://admin.mon-site.srv759970.hstgr.cloud\n\n      # Network\n      - HOST=0.0.0.0\n      - PORT=1337\n\n      # Database (SQLite par d\u00e9faut)\n      # - DATABASE_CLIENT=sqlite\n      # - DATABASE_FILENAME=.tmp/data.db\n\n    # Limites ressources (optionnel)\n    deploy:\n      resources:\n        limits:\n          memory: 1G\n          cpus: '1.0'\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#viteconfigts-optimal","title":"vite.config.ts optimal","text":"<pre><code>// src/admin/vite.config.ts\nimport { mergeConfig, type UserConfig } from 'vite';\n\nexport default (config: UserConfig) =&gt; {\n  return mergeConfig(config, {\n    server: {\n      // En production, allowedHosts n'est pas n\u00e9cessaire\n      // Mais on le met au cas o\u00f9\n      allowedHosts: true,\n    },\n  });\n};\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#commandes-de-diagnostic","title":"\ud83d\udd0d Commandes de diagnostic","text":""},{"location":"02-applications/guides/strapi-setup/#verifier-status-strapi","title":"V\u00e9rifier status Strapi","text":"<pre><code># Container en cours\nssh root@69.62.108.82 \"docker ps | grep strapi\"\n\n# Logs r\u00e9cents\nssh root@69.62.108.82 \"docker logs mon-strapi --tail=50\"\n\n# Logs en temps r\u00e9el\nssh root@69.62.108.82 \"docker logs -f mon-strapi\"\n\n# Entrer dans le container\nssh root@69.62.108.82 \"docker exec -it mon-strapi sh\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#tester-acces","title":"Tester acc\u00e8s","text":"<pre><code># Direct (sans Nginx)\nssh root@69.62.108.82 \"curl -I http://localhost:1337/admin\"\n\n# Via Nginx proxy\nssh root@69.62.108.82 \"curl -I -H 'Host: admin.mon-site.srv759970.hstgr.cloud' http://localhost/admin\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#verifier-fichiers","title":"V\u00e9rifier fichiers","text":"<pre><code># Structure Strapi\nssh root@69.62.108.82 \"ls -la /opt/mon-backend/backend/\"\n\n# vite.config.ts existe ?\nssh root@69.62.108.82 \"cat /opt/mon-backend/backend/src/admin/vite.config.ts\"\n\n# Database SQLite\nssh root@69.62.108.82 \"ls -lh /opt/mon-backend/data/\"\n</code></pre>"},{"location":"02-applications/guides/strapi-setup/#checklist-de-deploiement","title":"\u2705 Checklist de d\u00e9ploiement","text":"<ul> <li> Node.js 22 utilis\u00e9 (Docker <code>node:22-slim</code>)</li> <li> Strapi cr\u00e9\u00e9 avec <code>--quickstart --typescript</code></li> <li> <code>vite.config.ts</code> cr\u00e9\u00e9 dans <code>src/admin/</code></li> <li> <code>allowedHosts: true</code> dans vite.config.ts</li> <li> <code>NODE_ENV=production</code> dans docker-compose.yml</li> <li> <code>STRAPI_ADMIN_BACKEND_URL</code> configur\u00e9</li> <li> Dockerfile avec <code>npm run build</code></li> <li> docker-compose.yml avec volumes persistants</li> <li> Code transf\u00e9r\u00e9 sur VPS (<code>/opt/mon-backend/backend/</code>)</li> <li> Docker build r\u00e9ussi</li> <li> Container d\u00e9marr\u00e9 (<code>docker ps</code> affiche le container)</li> <li> Logs propres (pas de \"host not allowed\")</li> <li> Nginx configur\u00e9 avec reverse proxy</li> <li> Nginx recharg\u00e9 (<code>systemctl reload nginx</code>)</li> <li> Admin accessible via navigateur (HTTP 200)</li> <li> Compte admin cr\u00e9\u00e9</li> </ul>"},{"location":"02-applications/guides/strapi-setup/#cas-reel-site-cristina","title":"\ud83c\udfaf Cas r\u00e9el : Site Cristina","text":"<p>D\u00e9ploiement : Octobre 2025 URL Admin : http://admin.cristina.srv759970.hstgr.cloud/admin Container : <code>cristina-strapi</code> Port : 1337</p> <p>Probl\u00e8mes rencontr\u00e9s : 1. \u274c \"host not allowed\" \u2192 Solution : Mode production + <code>allowedHosts: true</code> 2. \u274c Node 23 incompatible \u2192 Solution : Docker <code>node:22-slim</code> 3. \u274c Rebuild admin ignor\u00e9 \u2192 Solution : <code>docker-compose build --no-cache</code></p> <p>Temps de debug : 3+ heures Avec ce guide : 15 minutes</p>"},{"location":"02-applications/guides/strapi-setup/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Strapi 5 Documentation</li> <li>Strapi Deployment Guide</li> <li>Strapi GitHub Issue #23433 (allowedHosts bug)</li> <li>Guide Nginx</li> <li>Guide Docker VPS</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version : 1.0 Strapi d\u00e9ploy\u00e9s : 1 (Cristina Admin) Heures \u00e9conomis\u00e9es : 3+ par d\u00e9ploiement</p>"},{"location":"02-applications/guides/tika-deployment/","title":"\ud83d\udd0d Guide Apache Tika Server - Document Parsing API","text":""},{"location":"02-applications/guides/tika-deployment/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<p>Apache Tika est un serveur de parsing de documents qui extrait du texte et des m\u00e9tadonn\u00e9es depuis plus de 1000+ formats de fichiers (PDF, Office, HTML, images avec OCR, etc.).</p> <p>Version d\u00e9ploy\u00e9e : Apache Tika 3.2.3 (latest-full avec Tesseract OCR) Type : Docker container Port : 9998 API : REST (HTTP)</p>"},{"location":"02-applications/guides/tika-deployment/#informations-du-deploiement","title":"\ud83d\udcca Informations du d\u00e9ploiement","text":"Propri\u00e9t\u00e9 Valeur Serveur srv759970.hstgr.cloud (69.62.108.82) Chemin <code>/opt/tika-server/</code> Container <code>tika-server</code> Image Docker <code>apache/tika:latest-full</code> Port interne 9998 Port externe 9998 Auto-restart Oui (<code>unless-stopped</code>) Healthcheck Activ\u00e9 (30s interval)"},{"location":"02-applications/guides/tika-deployment/#acces-et-utilisation","title":"\ud83d\ude80 Acc\u00e8s et utilisation","text":""},{"location":"02-applications/guides/tika-deployment/#url-dacces","title":"URL d'acc\u00e8s","text":"<p>Production (HTTPS) : <pre><code>https://tika.srv759970.hstgr.cloud\n</code></pre></p> <p>Local (sur le serveur) : <pre><code>http://localhost:9998\n</code></pre></p> <p>Direct (non recommand\u00e9) : <pre><code>http://69.62.108.82:9998\n</code></pre></p> <p>Recommandation : Utilisez toujours l'URL HTTPS pour un acc\u00e8s s\u00e9curis\u00e9 depuis l'ext\u00e9rieur.</p>"},{"location":"02-applications/guides/tika-deployment/#utilisation-de-lapi","title":"\ud83d\udd27 Utilisation de l'API","text":""},{"location":"02-applications/guides/tika-deployment/#1-verifier-que-le-serveur-fonctionne","title":"1. V\u00e9rifier que le serveur fonctionne","text":"<pre><code>curl -X GET https://tika.srv759970.hstgr.cloud/tika\n</code></pre> <p>R\u00e9ponse attendue : <pre><code>This is Tika Server (Apache Tika 3.2.3). Please PUT\n</code></pre></p>"},{"location":"02-applications/guides/tika-deployment/#2-obtenir-la-version","title":"2. Obtenir la version","text":"<pre><code>curl -X GET https://tika.srv759970.hstgr.cloud/version\n</code></pre> <p>R\u00e9ponse : <pre><code>Apache Tika 3.2.3\n</code></pre></p>"},{"location":"02-applications/guides/tika-deployment/#3-parser-un-document-extraire-le-texte","title":"3. Parser un document (extraire le texte)","text":"<pre><code>curl -X PUT --data-binary @document.pdf \\\n  https://tika.srv759970.hstgr.cloud/tika \\\n  --header \"Accept: text/plain\"\n</code></pre> <p>Formats support\u00e9s : - PDF - Microsoft Office (Word, Excel, PowerPoint) - OpenOffice/LibreOffice - HTML, XML - Images (avec OCR Tesseract) : PNG, JPG, TIFF - Archives : ZIP, TAR, GZIP - Et 1000+ autres formats</p>"},{"location":"02-applications/guides/tika-deployment/#4-extraire-les-metadonnees","title":"4. Extraire les m\u00e9tadonn\u00e9es","text":"<pre><code>curl -X PUT --data-binary @document.pdf \\\n  https://tika.srv759970.hstgr.cloud/meta \\\n  --header \"Accept: application/json\"\n</code></pre> <p>Retourne : M\u00e9tadonn\u00e9es JSON (auteur, date cr\u00e9ation, titre, format, etc.)</p>"},{"location":"02-applications/guides/tika-deployment/#5-detecter-le-type-mime-dun-fichier","title":"5. D\u00e9tecter le type MIME d'un fichier","text":"<pre><code>curl -X PUT --data-binary @unknown-file \\\n  https://tika.srv759970.hstgr.cloud/detect/stream\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#endpoints-principaux","title":"\ud83d\udcda Endpoints principaux","text":"Endpoint M\u00e9thode Description <code>/tika</code> GET Informations serveur <code>/tika</code> PUT Extraire texte d'un document <code>/meta</code> PUT Extraire m\u00e9tadonn\u00e9es JSON <code>/detect/stream</code> PUT D\u00e9tecter type MIME <code>/version</code> GET Version Apache Tika <code>/tika/form</code> POST Upload multipart form <code>/rmeta</code> PUT M\u00e9tadonn\u00e9es r\u00e9cursives (archives) <p>Documentation compl\u00e8te : https://cwiki.apache.org/confluence/display/TIKA/TikaServer</p>"},{"location":"02-applications/guides/tika-deployment/#gestion-du-container","title":"\ud83d\udc33 Gestion du container","text":""},{"location":"02-applications/guides/tika-deployment/#voir-les-logs","title":"Voir les logs","text":"<pre><code>ssh root@69.62.108.82 \"docker logs tika-server --tail=50 -f\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#redemarrer-le-serveur","title":"Red\u00e9marrer le serveur","text":"<pre><code>ssh root@69.62.108.82 \"cd /opt/tika-server &amp;&amp; docker-compose restart\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#arreter-le-serveur","title":"Arr\u00eater le serveur","text":"<pre><code>ssh root@69.62.108.82 \"cd /opt/tika-server &amp;&amp; docker-compose down\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#demarrer-le-serveur","title":"D\u00e9marrer le serveur","text":"<pre><code>ssh root@69.62.108.82 \"cd /opt/tika-server &amp;&amp; docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#mettre-a-jour-vers-la-derniere-version","title":"Mettre \u00e0 jour vers la derni\u00e8re version","text":"<pre><code>ssh root@69.62.108.82 \"cd /opt/tika-server &amp;&amp; docker-compose pull &amp;&amp; docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#verifier-letat-du-container","title":"V\u00e9rifier l'\u00e9tat du container","text":"<pre><code>ssh root@69.62.108.82 \"docker ps | grep tika\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#verifier-le-healthcheck","title":"V\u00e9rifier le healthcheck","text":"<pre><code>ssh root@69.62.108.82 \"docker inspect tika-server | grep -A 10 Health\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#configuration-nginx-optionnel-acces-https-public","title":"\ud83c\udf10 Configuration Nginx (optionnel - acc\u00e8s HTTPS public)","text":"<p>Pour exposer Tika via HTTPS avec un sous-domaine :</p>"},{"location":"02-applications/guides/tika-deployment/#creer-la-configuration-nginx","title":"Cr\u00e9er la configuration Nginx","text":"<pre><code>ssh root@69.62.108.82 \"cat &gt; /etc/nginx/sites-available/tika\" &lt;&lt;'EOF'\nserver {\n    listen 80;\n    server_name tika.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:9998;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Augmenter timeout pour gros documents\n        proxy_read_timeout 300s;\n        proxy_connect_timeout 75s;\n\n        # Augmenter taille max upload\n        client_max_body_size 100M;\n    }\n}\nEOF\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#activer-le-site","title":"Activer le site","text":"<pre><code>ssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/tika /etc/nginx/sites-enabled/\"\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#obtenir-un-certificat-ssl-lets-encrypt","title":"Obtenir un certificat SSL (Let's Encrypt)","text":"<pre><code>ssh root@69.62.108.82 \"certbot --nginx -d tika.srv759970.hstgr.cloud\"\n</code></pre> <p>URL finale : <code>https://tika.srv759970.hstgr.cloud</code></p> <p>\u2705 Statut : Configur\u00e9 et op\u00e9rationnel</p>"},{"location":"02-applications/guides/tika-deployment/#exemples-dutilisation","title":"\ud83d\udca1 Exemples d'utilisation","text":""},{"location":"02-applications/guides/tika-deployment/#exemple-python","title":"Exemple Python","text":"<pre><code>import requests\n\n# Parser un PDF\nwith open('document.pdf', 'rb') as f:\n    response = requests.put(\n        'https://tika.srv759970.hstgr.cloud/tika',\n        data=f,\n        headers={'Accept': 'text/plain'}\n    )\n    text = response.text\n    print(text)\n\n# Extraire m\u00e9tadonn\u00e9es\nwith open('document.pdf', 'rb') as f:\n    response = requests.put(\n        'https://tika.srv759970.hstgr.cloud/meta',\n        data=f,\n        headers={'Accept': 'application/json'}\n    )\n    metadata = response.json()\n    print(metadata)\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#exemple-javascript-nodejs","title":"Exemple JavaScript (Node.js)","text":"<pre><code>const fs = require('fs');\nconst axios = require('axios');\n\n// Parser un document\nconst fileBuffer = fs.readFileSync('document.pdf');\n\naxios.put('https://tika.srv759970.hstgr.cloud/tika', fileBuffer, {\n    headers: {\n        'Accept': 'text/plain'\n    }\n})\n.then(response =&gt; {\n    console.log(response.data);\n})\n.catch(error =&gt; {\n    console.error('Error:', error);\n});\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#exemple-curl-batch-de-fichiers","title":"Exemple cURL (batch de fichiers)","text":"<pre><code># Parser tous les PDFs d'un dossier\nfor file in *.pdf; do\n    echo \"Processing: $file\"\n    curl -X PUT --data-binary @\"$file\" \\\n        https://tika.srv759970.hstgr.cloud/tika \\\n        --header \"Accept: text/plain\" \\\n        &gt; \"${file%.pdf}.txt\"\ndone\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#limites-et-recommandations","title":"\u26a0\ufe0f Limites et recommandations","text":""},{"location":"02-applications/guides/tika-deployment/#limites-actuelles","title":"Limites actuelles","text":"<ul> <li>Taille max documents : Limit\u00e9e par RAM disponible (~2GB recommand\u00e9 par document)</li> <li>Timeout : 2 minutes par d\u00e9faut (configurable)</li> <li>Concurrent requests : Limit\u00e9 par CPU/RAM serveur</li> </ul>"},{"location":"02-applications/guides/tika-deployment/#bonnes-pratiques","title":"Bonnes pratiques","text":"<ol> <li>Documents volumineux : Traiter par batch ou augmenter timeout</li> <li>S\u00e9curit\u00e9 : Ne pas exposer directement sur Internet sans authentification</li> <li>Performance : Pour volumes \u00e9lev\u00e9s, consid\u00e9rer un cluster Tika</li> <li>OCR : Ralentit le traitement, d\u00e9sactiver si pas n\u00e9cessaire</li> </ol>"},{"location":"02-applications/guides/tika-deployment/#optimisation-pour-production","title":"Optimisation pour production","text":"<pre><code># docker-compose.yml avec configuration optimis\u00e9e\nversion: '3.8'\nservices:\n  tika:\n    image: apache/tika:latest-full\n    container_name: tika-server\n    ports:\n      - \"9998:9998\"\n    restart: unless-stopped\n    environment:\n      - TZ=Europe/Paris\n      - TIKA_CONFIG=/tika-config.xml  # Config personnalis\u00e9e\n    volumes:\n      - ./tika-config.xml:/tika-config.xml:ro\n    deploy:\n      resources:\n        limits:\n          memory: 4G\n          cpus: '2.0'\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#troubleshooting","title":"\ud83d\udd0d Troubleshooting","text":""},{"location":"02-applications/guides/tika-deployment/#le-serveur-ne-demarre-pas","title":"Le serveur ne d\u00e9marre pas","text":"<pre><code># V\u00e9rifier les logs\nssh root@69.62.108.82 \"docker logs tika-server\"\n\n# V\u00e9rifier que le port n'est pas utilis\u00e9\nssh root@69.62.108.82 \"netstat -tlnp | grep 9998\"\n\n# Rebuild from scratch\nssh root@69.62.108.82 \"cd /opt/tika-server &amp;&amp; docker-compose down &amp;&amp; docker-compose pull &amp;&amp; docker-compose up -d\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#erreur-out-of-memory","title":"Erreur \"Out of Memory\"","text":"<pre><code># Augmenter la RAM allou\u00e9e au container\n# Modifier docker-compose.yml :\ndeploy:\n  resources:\n    limits:\n      memory: 4G\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#timeout-sur-gros-documents","title":"Timeout sur gros documents","text":"<pre><code># Augmenter le timeout dans la requ\u00eate\ncurl -X PUT --data-binary @large.pdf \\\n    --max-time 600 \\\n    http://69.62.108.82:9998/tika\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#probleme-ocr-images","title":"Probl\u00e8me OCR (images)","text":"<pre><code># V\u00e9rifier que Tesseract est bien inclus (version full)\nssh root@69.62.108.82 \"docker exec tika-server tesseract --version\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#monitoring-et-maintenance","title":"\ud83d\udcca Monitoring et maintenance","text":""},{"location":"02-applications/guides/tika-deployment/#verifier-lutilisation-des-ressources","title":"V\u00e9rifier l'utilisation des ressources","text":"<pre><code>ssh root@69.62.108.82 \"docker stats tika-server --no-stream\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#logs-de-parsing","title":"Logs de parsing","text":"<pre><code>ssh root@69.62.108.82 \"docker logs tika-server --since 1h\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#espace-disque","title":"Espace disque","text":"<pre><code>ssh root@69.62.108.82 \"docker system df\"\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#ressources-utiles","title":"\ud83d\udd17 Ressources utiles","text":"<ul> <li>Documentation officielle : https://tika.apache.org/</li> <li>API REST docs : https://cwiki.apache.org/confluence/display/TIKA/TikaServer</li> <li>Docker Hub : https://hub.docker.com/r/apache/tika</li> <li>GitHub : https://github.com/apache/tika</li> <li>Formats support\u00e9s : https://tika.apache.org/2.6.0/formats.html</li> </ul>"},{"location":"02-applications/guides/tika-deployment/#configuration-actuelle-docker-composeyml","title":"\ud83d\udcdd Configuration actuelle (docker-compose.yml)","text":"<pre><code>version: '3.8'\n\nservices:\n  tika:\n    image: apache/tika:latest-full\n    container_name: tika-server\n    ports:\n      - \"9998:9998\"\n    restart: unless-stopped\n    environment:\n      - TZ=Europe/Paris\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:9998/tika\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n</code></pre>"},{"location":"02-applications/guides/tika-deployment/#checklist-de-deploiement","title":"\u2705 Checklist de d\u00e9ploiement","text":"<ul> <li> Container Docker cr\u00e9\u00e9 et d\u00e9marr\u00e9</li> <li> API accessible sur port 9998</li> <li> Healthcheck configur\u00e9 et op\u00e9rationnel</li> <li> Tests de parsing r\u00e9ussis</li> <li> Logs v\u00e9rifi\u00e9s (pas d'erreur)</li> <li> Nginx reverse proxy configur\u00e9</li> <li> Certificat SSL install\u00e9 (Let's Encrypt)</li> <li> HTTPS fonctionnel sur https://tika.srv759970.hstgr.cloud</li> <li> (Optionnel) Authentification ajout\u00e9e</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version Apache Tika : 3.2.3 Status : \u2705 En production Contact serveur : root@69.62.108.82</p>"},{"location":"02-applications/guides/videorag-docker/","title":"\ud83d\udc33 Guide VideoRAG Docker - Installation et Configuration","text":"<p>VideoRAG Dockeris\u00e9: Chat with Your Videos - Version conteneuris\u00e9e</p> <p>Date d'installation: 20 Octobre 2025 Serveur: srv759970.hstgr.cloud (69.62.108.82) URL: https://videorag.srv759970.hstgr.cloud</p>"},{"location":"02-applications/guides/videorag-docker/#architecture-docker","title":"\ud83d\udccb Architecture Docker","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         Nginx (Host)                \u2502\n\u2502  https://videorag.srv759970...      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Docker Container: videorag      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  VideoRAG Backend API     \u2502   \u2502\n\u2502   \u2502  Python 3.11 + Flask      \u2502   \u2502\n\u2502   \u2502  Port: 5000               \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  Models (~8GB)            \u2502   \u2502\n\u2502   \u2502  - MiniCPM-V (4GB)       \u2502   \u2502\n\u2502   \u2502  - Whisper (1.5GB)       \u2502   \u2502\n\u2502   \u2502  - ImageBind (2.4GB)     \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#installation-complete","title":"\u2705 Installation Compl\u00e8te","text":""},{"location":"02-applications/guides/videorag-docker/#composants","title":"Composants","text":"<ol> <li>Dockerfile - Image Python 3.11 avec toutes les d\u00e9pendances</li> <li>docker-compose.yml - Orchestration du service</li> <li>Nginx - Reverse proxy HTTPS</li> <li>Volumes Docker:</li> <li><code>videorag-data</code> - Donn\u00e9es persistantes (vid\u00e9os upload\u00e9es)</li> <li><code>videorag-cache</code> - Cache des mod\u00e8les</li> <li>Mod\u00e8les - Mont\u00e9s en read-only depuis l'h\u00f4te</li> </ol>"},{"location":"02-applications/guides/videorag-docker/#gestion-du-container","title":"\ud83d\ude80 Gestion du Container","text":""},{"location":"02-applications/guides/videorag-docker/#demarrer-videorag","title":"D\u00e9marrer VideoRAG","text":"<pre><code>cd /opt/videorag\ndocker compose up -d\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#voir-les-logs","title":"Voir les logs","text":"<pre><code># Logs en temps r\u00e9el\ndocker compose logs -f\n\n# Derni\u00e8res 100 lignes\ndocker compose logs --tail=100\n\n# Logs du container uniquement\ndocker logs videorag -f\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#arreter-redemarrer","title":"Arr\u00eater / Red\u00e9marrer","text":"<pre><code># Arr\u00eater\ndocker compose stop\n\n# Red\u00e9marrer\ndocker compose restart\n\n# Arr\u00eater et supprimer\ndocker compose down\n\n# Arr\u00eater et supprimer avec volumes\ndocker compose down -v\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#status","title":"Status","text":"<pre><code># Status des containers\ndocker compose ps\n\n# D\u00e9tails du container\ndocker inspect videorag\n\n# Ressources utilis\u00e9es\ndocker stats videorag\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#configuration","title":"\ud83d\udd27 Configuration","text":""},{"location":"02-applications/guides/videorag-docker/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Fichier: <code>/opt/videorag/.env</code></p> <pre><code>OPENAI_API_KEY=sk-proj-...\nFLASK_ENV=production\nPORT=5000\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#modifier-la-cle-openai","title":"Modifier la cl\u00e9 OpenAI","text":"<pre><code># Option 1: \u00c9diter .env\nnano /opt/videorag/.env\n\n# Option 2: \u00c9diter docker-compose.yml\nnano /opt/videorag/docker-compose.yml\n\n# Puis red\u00e9marrer\ncd /opt/videorag\ndocker compose restart\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#structure-des-fichiers","title":"\ud83d\udcc1 Structure des Fichiers","text":"<pre><code>/opt/videorag/\n\u251c\u2500\u2500 Dockerfile                    # Image Docker\n\u251c\u2500\u2500 docker-compose.yml           # Orchestration\n\u251c\u2500\u2500 .env                         # Variables d'environnement\n\u251c\u2500\u2500 web/\n\u2502   \u2514\u2500\u2500 index.html              # Frontend web\n\u251c\u2500\u2500 VideoRAG-algorithm/          # Code VideoRAG (mont\u00e9)\n\u2502   \u251c\u2500\u2500 MiniCPM-V-2_6-int4/     # Mod\u00e8le (read-only)\n\u2502   \u251c\u2500\u2500 faster-distil-whisper/   # Mod\u00e8le (read-only)\n\u2502   \u2514\u2500\u2500 .checkpoints/            # ImageBind (read-only)\n\u2514\u2500\u2500 Vimo-desktop/\n    \u2514\u2500\u2500 python_backend/          # Backend API (mont\u00e9)\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#volumes-docker","title":"Volumes Docker","text":"<pre><code># Lister les volumes\ndocker volume ls | grep videorag\n\n# Inspecter un volume\ndocker volume inspect videorag_videorag-data\n\n# Sauvegarder les donn\u00e9es\ndocker run --rm -v videorag_videorag-data:/data -v $(pwd):/backup \\\n  alpine tar czf /backup/videorag-backup.tar.gz /data\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#mise-a-jour","title":"\ud83d\udd04 Mise \u00e0 Jour","text":""},{"location":"02-applications/guides/videorag-docker/#mettre-a-jour-le-code","title":"Mettre \u00e0 jour le code","text":"<pre><code>cd /opt/videorag\ngit pull\n\n# Rebuild et red\u00e9marrer\ndocker compose build\ndocker compose up -d\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#mettre-a-jour-les-dependances-python","title":"Mettre \u00e0 jour les d\u00e9pendances Python","text":"<p>Modifier <code>Dockerfile</code>, puis:</p> <pre><code>cd /opt/videorag\ndocker compose build --no-cache\ndocker compose up -d\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"02-applications/guides/videorag-docker/#container-ne-demarre-pas","title":"Container ne d\u00e9marre pas","text":"<pre><code># Voir les logs d'erreur\ndocker compose logs videorag\n\n# V\u00e9rifier la config\ndocker compose config\n\n# Rebuild sans cache\ndocker compose build --no-cache\ndocker compose up -d\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#api-ne-repond-pas","title":"API ne r\u00e9pond pas","text":"<pre><code># V\u00e9rifier que le container tourne\ndocker compose ps\n\n# Logs en temps r\u00e9el\ndocker logs videorag -f\n\n# Tester depuis l'h\u00f4te\ncurl http://localhost:5000/health\n\n# Entrer dans le container\ndocker exec -it videorag bash\ncurl http://localhost:5000/health\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#problemes-de-modeles","title":"Probl\u00e8mes de mod\u00e8les","text":"<pre><code># V\u00e9rifier que les mod\u00e8les sont bien mont\u00e9s\ndocker exec -it videorag ls -la /app/VideoRAG-algorithm/\n\n# V\u00e9rifier les permissions\nls -la /opt/videorag/VideoRAG-algorithm/\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#probleme-despace-disque","title":"Probl\u00e8me d'espace disque","text":"<pre><code># Voir l'espace utilis\u00e9 par Docker\ndocker system df\n\n# Nettoyer les images inutilis\u00e9es\ndocker system prune -a\n\n# Nettoyer tout (ATTENTION!)\ndocker system prune -a --volumes\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"02-applications/guides/videorag-docker/#ressources","title":"Ressources","text":"<pre><code># CPU et RAM en temps r\u00e9el\ndocker stats videorag\n\n# Voir les processus dans le container\ndocker top videorag\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#logs-nginx","title":"Logs Nginx","text":"<pre><code># Access logs\ntail -f /var/log/nginx/videorag-access.log\n\n# Error logs\ntail -f /var/log/nginx/videorag-error.log\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#health-check","title":"Health Check","text":"<p>Le container a un health check automatique:</p> <pre><code># Status du health check\ndocker inspect videorag | grep -A 10 Health\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/videorag-docker/#bonnes-pratiques","title":"Bonnes Pratiques","text":"<ol> <li>.env prot\u00e9g\u00e9: <code>chmod 600 /opt/videorag/.env</code></li> <li>Cl\u00e9 OpenAI: Ne jamais commit dans git</li> <li>Mod\u00e8les en read-only: Mont\u00e9s avec <code>:ro</code></li> <li>Restart policy: <code>unless-stopped</code> pour red\u00e9marrage auto</li> <li>HTTPS: Configur\u00e9 avec Let's Encrypt</li> </ol>"},{"location":"02-applications/guides/videorag-docker/#network-isolation","title":"Network Isolation","text":"<p>Le container utilise un r\u00e9seau bridge d\u00e9di\u00e9:</p> <pre><code># Voir le r\u00e9seau\ndocker network inspect videorag_videorag-network\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#performance","title":"\ud83d\ude80 Performance","text":""},{"location":"02-applications/guides/videorag-docker/#optimisations","title":"Optimisations","text":"<ol> <li>Multi-stage build possible pour r\u00e9duire taille image</li> <li>Cache layers Docker pour builds plus rapides</li> <li>Volumes pour donn\u00e9es persistantes</li> <li>Health check pour monitoring automatique</li> </ol>"},{"location":"02-applications/guides/videorag-docker/#limites-de-ressources","title":"Limites de ressources","text":"<p>Ajouter dans <code>docker-compose.yml</code>:</p> <pre><code>services:\n  videorag:\n    deploy:\n      resources:\n        limits:\n          cpus: '4.0'\n          memory: 8G\n        reservations:\n          memory: 4G\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#commandes-utiles","title":"\ud83d\udcda Commandes Utiles","text":"<pre><code># Build\ndocker compose build\ndocker compose build --no-cache\n\n# Start/Stop\ndocker compose up -d\ndocker compose down\n\n# Logs\ndocker compose logs -f\ndocker logs videorag -f\n\n# Status\ndocker compose ps\ndocker stats videorag\n\n# Shell dans le container\ndocker exec -it videorag bash\ndocker exec -it videorag python\n\n# Restart\ndocker compose restart\n\n# Pull latest\ncd /opt/videorag &amp;&amp; git pull\ndocker compose build &amp;&amp; docker compose up -d\n</code></pre>"},{"location":"02-applications/guides/videorag-docker/#checklist","title":"\u2705 Checklist","text":"<ul> <li> Docker et docker-compose install\u00e9s</li> <li> Repository clon\u00e9 dans <code>/opt/videorag</code></li> <li> Mod\u00e8les t\u00e9l\u00e9charg\u00e9s</li> <li> <code>.env</code> configur\u00e9 avec cl\u00e9 OpenAI</li> <li> Nginx configur\u00e9</li> <li> HTTPS activ\u00e9</li> <li> Container built</li> <li> Container running (<code>docker compose ps</code>)</li> <li> API r\u00e9pond (<code>curl localhost:5000/health</code>)</li> <li> Interface web accessible (https://videorag...)</li> <li> Logs corrects (<code>docker compose logs</code>)</li> </ul>"},{"location":"02-applications/guides/videorag-docker/#liens","title":"\ud83d\udd17 Liens","text":"<ul> <li>Interface Web: https://videorag.srv759970.hstgr.cloud</li> <li>API Health: https://videorag.srv759970.hstgr.cloud/api/health</li> <li>GitHub VideoRAG: https://github.com/HKUDS/VideoRAG</li> <li>Docker Hub: (si publi\u00e9)</li> </ul> <p>Installation: 20 Octobre 2025 Type: Docker Compose Version: 1.0</p>"},{"location":"02-applications/guides/videorag-systemd/","title":"\ud83c\udfac Guide VideoRAG - Installation et Configuration","text":"<p>VideoRAG: Chat with Your Videos - Syst\u00e8me d'analyse vid\u00e9o par IA avec interface web</p> <p>Date d'installation: 20 Octobre 2025 Serveur: srv759970.hstgr.cloud (69.62.108.82) URL: https://videorag.srv759970.hstgr.cloud \u2705 HTTPS ACTIV\u00c9</p>"},{"location":"02-applications/guides/videorag-systemd/#installation-complete","title":"\ud83d\udccb Installation Compl\u00e8te","text":"<p>VideoRAG a \u00e9t\u00e9 install\u00e9 avec succ\u00e8s sur votre VPS avec tous les composants n\u00e9cessaires.</p>"},{"location":"02-applications/guides/videorag-systemd/#ce-qui-a-ete-installe","title":"\u2705 Ce qui a \u00e9t\u00e9 install\u00e9:","text":"<ol> <li>Python 3.11 via Miniconda (<code>/opt/miniconda/envs/vimo</code>)</li> <li>VideoRAG Backend API (Flask sur port 5000)</li> <li>Mod\u00e8les IA (~8GB total):</li> <li>MiniCPM-V-2_6-int4 (4GB)</li> <li>Whisper large-v3 (1.5GB)</li> <li>ImageBind huge (2.4GB)</li> <li>Interface Web simple en <code>/opt/videorag-web</code></li> <li>Service systemd <code>videorag.service</code></li> <li>Configuration Nginx avec reverse proxy</li> <li>Certificat SSL Let's Encrypt (HTTPS configur\u00e9)</li> </ol>"},{"location":"02-applications/guides/videorag-systemd/#demarrage-rapide","title":"\ud83d\ude80 D\u00e9marrage Rapide","text":""},{"location":"02-applications/guides/videorag-systemd/#etape-1-configurer-votre-cle-openai","title":"\u00c9tape 1: Configurer votre cl\u00e9 OpenAI","text":"<pre><code>ssh root@69.62.108.82\n/opt/videorag/set_openai_key.sh sk-proj-VOTRE_CLE_OPENAI\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#etape-2-demarrer-le-service","title":"\u00c9tape 2: D\u00e9marrer le service","text":"<pre><code>systemctl enable videorag\nsystemctl start videorag\nsystemctl status videorag\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#etape-3-acceder","title":"\u00c9tape 3: Acc\u00e9der","text":"<ul> <li>Interface Web: http://videorag.srv759970.hstgr.cloud</li> <li>API Directe: http://69.62.108.82:5000/health</li> </ul>"},{"location":"02-applications/guides/videorag-systemd/#emplacements","title":"\ud83d\udcc1 Emplacements","text":"Composant Chemin Repository principal <code>/opt/videorag/</code> Backend API <code>/opt/videorag/Vimo-desktop/python_backend/</code> Mod\u00e8les <code>/opt/videorag/VideoRAG-algorithm/</code> Frontend Web <code>/opt/videorag-web/</code> Service <code>/etc/systemd/system/videorag.service</code> Config Nginx <code>/etc/nginx/sites-available/videorag</code> Documentation <code>/opt/videorag/README_INSTALL.md</code>"},{"location":"02-applications/guides/videorag-systemd/#gestion-du-service","title":"\ud83d\udd27 Gestion du Service","text":"<pre><code># D\u00e9marrer/Arr\u00eater/Red\u00e9marrer\nsystemctl start videorag\nsystemctl stop videorag\nsystemctl restart videorag\n\n# Status\nsystemctl status videorag\n\n# Logs en temps r\u00e9el\njournalctl -u videorag -f\n\n# Derni\u00e8res 100 lignes de logs\njournalctl -u videorag -n 100\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#api-endpoints","title":"\ud83d\udce1 API Endpoints","text":""},{"location":"02-applications/guides/videorag-systemd/#base-url","title":"Base URL","text":"<ul> <li>Via Nginx: <code>http://videorag.srv759970.hstgr.cloud/api/</code></li> <li>Direct: <code>http://localhost:5000/</code></li> </ul>"},{"location":"02-applications/guides/videorag-systemd/#endpoints","title":"Endpoints","text":"<ol> <li>GET /health - V\u00e9rifier si l'API fonctionne</li> <li>POST /upload - Upload une vid\u00e9o</li> <li>POST /query - Poser une question sur les vid\u00e9os</li> <li>GET /videos - Lister les vid\u00e9os upload\u00e9es</li> </ol>"},{"location":"02-applications/guides/videorag-systemd/#exemples","title":"Exemples","text":"<pre><code># Health check\ncurl http://localhost:5000/health\n\n# Upload\ncurl -X POST -F \"video=@video.mp4\" http://localhost:5000/upload\n\n# Query\ncurl -X POST -H \"Content-Type: application/json\" \\\n  -d '{\"query\":\"What happens in the video?\"}' \\\n  http://localhost:5000/query\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/videorag-systemd/#changer-la-cle-openai","title":"Changer la cl\u00e9 OpenAI","text":"<pre><code># Option 1: Script\n/opt/videorag/set_openai_key.sh sk-proj-NOUVELLE_CLE\n\n# Option 2: Manuel\nnano /etc/systemd/system/videorag.service\nsystemctl daemon-reload\nsystemctl restart videorag\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#limite-dupload-actuellement-5gb","title":"Limite d'upload (actuellement 5GB)","text":"<pre><code>nano /etc/nginx/sites-available/videorag\n# Modifier: client_max_body_size 5000M;\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#ajouter-https","title":"Ajouter HTTPS","text":"<pre><code>certbot --nginx -d videorag.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"02-applications/guides/videorag-systemd/#service-ne-demarre-pas","title":"Service ne d\u00e9marre pas","text":"<pre><code>journalctl -u videorag -n 50\nlsof -i :5000\nsystemctl status videorag\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#api-ne-repond-pas","title":"API ne r\u00e9pond pas","text":"<pre><code>curl http://localhost:5000/health\nsystemctl status videorag\nnginx -t\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#modeles-introuvables","title":"Mod\u00e8les introuvables","text":"<pre><code>ls -lh /opt/videorag/VideoRAG-algorithm/MiniCPM-V-2_6-int4/\nls -lh /opt/videorag/VideoRAG-algorithm/faster-distil-whisper-large-v3/\nls -lh /opt/videorag/VideoRAG-algorithm/.checkpoints/\n</code></pre>"},{"location":"02-applications/guides/videorag-systemd/#documentation","title":"\ud83d\udcda Documentation","text":"<ul> <li>Documentation compl\u00e8te: <code>/opt/videorag/README_INSTALL.md</code></li> <li>GitHub VideoRAG: https://github.com/HKUDS/VideoRAG</li> <li>Paper: https://arxiv.org/abs/2502.01549</li> <li>Guides locaux: <code>docs/guides/</code></li> </ul>"},{"location":"02-applications/guides/videorag-systemd/#checklist","title":"\u2705 Checklist","text":"<ul> <li> Cl\u00e9 OpenAI configur\u00e9e</li> <li> Service d\u00e9marr\u00e9</li> <li> Interface web accessible</li> <li> API r\u00e9pond (/health)</li> <li> Test upload vid\u00e9o</li> <li> Test query vid\u00e9o</li> <li> HTTPS configur\u00e9 (optionnel)</li> <li> Basic Auth ajout\u00e9 (optionnel)</li> </ul> <p>Installation: 20 Octobre 2025 Par: Claude Code</p>"},{"location":"02-applications/guides/whisper-deployment/","title":"Guide Whisper Services","text":"<p>Documentation pour les deux services de transcription audio d\u00e9ploy\u00e9s sur srv759970.</p>"},{"location":"02-applications/guides/whisper-deployment/#vue-densemble","title":"Vue d'ensemble","text":"<p>Deux services Whisper sont configur\u00e9s pour r\u00e9pondre \u00e0 des besoins diff\u00e9rents :</p> Service URL Caract\u00e9ristiques Port Utilisation faster-whisper whisper.srv759970.hstgr.cloud Rapide, compatible OpenAI API 8001 Transcription simple, haute performance WhisperX whisperx.srv759970.hstgr.cloud Diarisation speakers, timestamps pr\u00e9cis 8002 Transcription avec identification locuteurs"},{"location":"02-applications/guides/whisper-deployment/#faster-whisper","title":"faster-whisper","text":""},{"location":"02-applications/guides/whisper-deployment/#architecture","title":"Architecture","text":"<pre><code>/opt/whisper-faster/\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 (cache HuggingFace)\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#configuration","title":"Configuration","text":"<p>Image Docker : <code>fedirz/faster-whisper-server:latest-cpu</code> Mod\u00e8le : <code>Systran/faster-whisper-small</code> Device : CPU (int8 quantization)</p>"},{"location":"02-applications/guides/whisper-deployment/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  faster-whisper:\n    image: fedirz/faster-whisper-server:latest-cpu\n    container_name: faster-whisper\n    restart: 'no'  # Auto-start system\n    ports:\n      - '8001:8000'\n    volumes:\n      - /root/.cache/huggingface:/root/.cache/huggingface\n    environment:\n      - WHISPER__MODEL=Systran/faster-whisper-small\n      - WHISPER__INFERENCE_DEVICE=cpu\n      - UVICORN_HOST=0.0.0.0\n      - UVICORN_PORT=8000\n      - TZ=Europe/Paris\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#endpoints-principaux","title":"Endpoints principaux","text":"<p>POST /v1/audio/transcriptions (OpenAI-compatible) <pre><code>curl -X POST https://whisper.srv759970.hstgr.cloud/v1/audio/transcriptions \\\n  -H \"Authorization: Bearer $API_KEY\" \\\n  -F \"file=@audio.mp3\" \\\n  -F \"model=Systran/faster-whisper-small\" \\\n  -F \"language=fr\"\n</code></pre></p> <p>Swagger : https://whisper.srv759970.hstgr.cloud/docs</p>"},{"location":"02-applications/guides/whisper-deployment/#performance","title":"Performance","text":"<ul> <li>Vitesse : 10-15x temps r\u00e9el sur CPU</li> <li>RAM : ~400MB</li> <li>Formats : mp3, wav, m4a, flac, ogg</li> <li>Langues : 99 langues support\u00e9es</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#whisperx","title":"WhisperX","text":""},{"location":"02-applications/guides/whisper-deployment/#architecture_1","title":"Architecture","text":"<pre><code>/opt/whisperx/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 server.py\n\u2514\u2500\u2500 .env (HF_TOKEN)\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#configuration_1","title":"Configuration","text":"<p>Image : Custom build (Python 3.11 + whisperx + FastAPI) Mod\u00e8le : base (modifiable via API) Diarization : pyannote-audio (n\u00e9cessite HuggingFace token)</p>"},{"location":"02-applications/guides/whisper-deployment/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM python:3.11-slim\n\nWORKDIR /app\n\n# System dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    ffmpeg \\\n    git \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Python packages\nRUN pip install --no-cache-dir \\\n    whisperx \\\n    fastapi \\\n    uvicorn[standard] \\\n    python-multipart\n\nCOPY server.py /app/server.py\n\nEXPOSE 8002\n\nCMD [\"uvicorn\", \"server:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8002\"]\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#docker-composeyml_1","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  whisperx:\n    build: .\n    container_name: whisperx\n    restart: 'no'\n    ports:\n      - '8002:8002'\n    volumes:\n      - /root/.cache/huggingface:/root/.cache/huggingface\n    environment:\n      - HF_TOKEN=${HF_TOKEN}\n      - TZ=Europe/Paris\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#configuration-huggingface-token","title":"Configuration HuggingFace Token","text":"<p>Pour activer la diarization, cr\u00e9er <code>/opt/whisperx/.env</code> :</p> <pre><code>HF_TOKEN=hf_xxxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre> <p>Obtenir le token : 1. Cr\u00e9er un compte sur https://huggingface.co 2. Aller dans Settings &gt; Access Tokens 3. Cr\u00e9er un nouveau token (read) 4. Accepter les conditions de pyannote/speaker-diarization</p>"},{"location":"02-applications/guides/whisper-deployment/#api-endpoints","title":"API Endpoints","text":"<p>POST /transcribe</p> <pre><code>curl -X POST https://whisperx.srv759970.hstgr.cloud/transcribe \\\n  -F \"file=@audio.mp3\" \\\n  -F \"model=base\" \\\n  -F \"language=fr\" \\\n  -F \"diarize=true\"\n</code></pre> <p>Param\u00e8tres : - <code>file</code> : Fichier audio (required) - <code>model</code> : tiny, base, small, medium, large-v2 (default: base) - <code>language</code> : Code langue ISO 639-1 ou auto-detect (default: None) - <code>diarize</code> : true/false - Active l'identification des speakers (default: false)</p> <p>R\u00e9ponse avec diarization : <pre><code>{\n  \"segments\": [\n    {\n      \"start\": 0.5,\n      \"end\": 3.2,\n      \"text\": \"Bonjour, comment allez-vous ?\",\n      \"speaker\": \"SPEAKER_00\"\n    },\n    {\n      \"start\": 3.5,\n      \"end\": 5.8,\n      \"text\": \"Tr\u00e8s bien, merci !\",\n      \"speaker\": \"SPEAKER_01\"\n    }\n  ],\n  \"language\": \"fr\"\n}\n</code></pre></p> <p>Swagger : https://whisperx.srv759970.hstgr.cloud/docs</p>"},{"location":"02-applications/guides/whisper-deployment/#performance_1","title":"Performance","text":"<ul> <li>Vitesse : 60-70x temps r\u00e9el (WhisperX optimized)</li> <li>RAM : ~500MB (sans diarization), ~800MB (avec)</li> <li>Diarization : Ajoute 2-3s de latence</li> <li>Pr\u00e9cision timestamps : \u00b150ms</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/guides/whisper-deployment/#build-whisperx","title":"Build WhisperX","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/whisperx\n\n# Configurer HF token\nnano .env  # Ajouter HF_TOKEN=...\n\n# Build image\ndocker-compose build\n\n# D\u00e9marrer une fois pour test\ndocker-compose up -d\n\n# V\u00e9rifier logs\ndocker logs -f whisperx\n\n# Arr\u00eater (auto-start prendra le relai)\ndocker-compose stop\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#configuration-nginx","title":"Configuration Nginx","text":"<p>Les deux services partagent la m\u00eame configuration de base :</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name whisper.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/privkey.pem;\n\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://127.0.0.1:8890;  # Auto-start proxy\n        proxy_set_header Host $host;\n        proxy_read_timeout 600;\n        client_max_body_size 500M;\n\n        # CORS for Swagger\n        add_header 'Access-Control-Allow-Origin' 'https://portal.srv759970.hstgr.cloud' always;\n    }\n}\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#auto-start-configuration","title":"Auto-start Configuration","text":"<p>Extrait de <code>/opt/docker-autostart/config.json</code> :</p> <pre><code>{\n  \"services\": {\n    \"whisper.srv759970.hstgr.cloud\": {\n      \"name\": \"Whisper API (faster-whisper)\",\n      \"composeDir\": \"/opt/whisper-faster\",\n      \"proxyPort\": 8001,\n      \"blocking\": true,\n      \"containers\": [\"faster-whisper\"]\n    },\n    \"whisperx.srv759970.hstgr.cloud\": {\n      \"name\": \"WhisperX API (with diarization)\",\n      \"composeDir\": \"/opt/whisperx\",\n      \"proxyPort\": 8002,\n      \"blocking\": true,\n      \"containers\": [\"whisperx\"]\n    }\n  }\n}\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#choix-du-service","title":"Choix du service","text":""},{"location":"02-applications/guides/whisper-deployment/#utiliser-faster-whisper-si","title":"Utiliser faster-whisper si :","text":"<ul> <li>\u2705 Transcription simple sans besoin de speakers</li> <li>\u2705 Performance maximale requise</li> <li>\u2705 Compatibilit\u00e9 OpenAI API n\u00e9cessaire</li> <li>\u2705 Pas de token HuggingFace disponible</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#utiliser-whisperx-si","title":"Utiliser WhisperX si :","text":"<ul> <li>\u2705 Besoin d'identifier les speakers (r\u00e9unions, interviews)</li> <li>\u2705 Timestamps pr\u00e9cis requis (\u00b150ms)</li> <li>\u2705 Audio multi-locuteurs</li> <li>\u2705 Post-traitement avanc\u00e9 souhait\u00e9</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#exemples-dutilisation","title":"Exemples d'utilisation","text":""},{"location":"02-applications/guides/whisper-deployment/#faster-whisper-transcription-simple","title":"faster-whisper : Transcription simple","text":"<pre><code>import openai\n\nclient = openai.OpenAI(\n    base_url=\"https://whisper.srv759970.hstgr.cloud/v1\",\n    api_key=\"dummy\"  # Not used but required\n)\n\nwith open(\"meeting.mp3\", \"rb\") as audio_file:\n    transcript = client.audio.transcriptions.create(\n        model=\"Systran/faster-whisper-small\",\n        file=audio_file,\n        language=\"fr\"\n    )\n\nprint(transcript.text)\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#whisperx-transcription-avec-diarization","title":"WhisperX : Transcription avec diarization","text":"<pre><code>import requests\n\nurl = \"https://whisperx.srv759970.hstgr.cloud/transcribe\"\n\nwith open(\"meeting.mp3\", \"rb\") as f:\n    files = {\"file\": f}\n    data = {\n        \"model\": \"base\",\n        \"language\": \"fr\",\n        \"diarize\": \"true\"\n    }\n\n    response = requests.post(url, files=files, data=data)\n    result = response.json()\n\nfor segment in result[\"segments\"]:\n    print(f\"[{segment['speaker']}] {segment['text']}\")\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#monitoring","title":"Monitoring","text":""},{"location":"02-applications/guides/whisper-deployment/#logs","title":"Logs","text":"<pre><code># faster-whisper\ndocker logs -f faster-whisper\n\n# WhisperX\ndocker logs -f whisperx\n\n# Auto-start system\njournalctl -u docker-autostart -f | grep whisper\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#metriques","title":"M\u00e9triques","text":"<pre><code># RAM usage\ndocker stats faster-whisper whisperx\n\n# Uptime\ndocker ps | grep whisper\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/guides/whisper-deployment/#faster-whisper-ne-demarre-pas","title":"faster-whisper ne d\u00e9marre pas","text":"<pre><code># V\u00e9rifier image\ndocker images | grep faster-whisper\n\n# Pull si manquante\ndocker pull fedirz/faster-whisper-server:latest-cpu\n\n# Restart manual\ncd /opt/whisper-faster\ndocker-compose up -d\ndocker logs -f faster-whisper\n</code></pre>"},{"location":"02-applications/guides/whisper-deployment/#whisperx-erreur-diarization","title":"WhisperX : Erreur diarization","text":"<p>Sympt\u00f4me : <code>401 Unauthorized</code> ou <code>403 Forbidden</code> lors de diarization</p> <p>Cause : HF_TOKEN invalide ou mod\u00e8les pyannote non accept\u00e9s</p> <p>Solution : <pre><code># V\u00e9rifier token\ncat /opt/whisperx/.env\n\n# Accepter les conditions des mod\u00e8les\n# 1. https://huggingface.co/pyannote/speaker-diarization\n# 2. https://huggingface.co/pyannote/segmentation\n# Cliquer \"Agree and access repository\"\n\n# Rebuild\ncd /opt/whisperx\ndocker-compose down\ndocker-compose build --no-cache\ndocker-compose up -d\n</code></pre></p>"},{"location":"02-applications/guides/whisper-deployment/#502-bad-gateway","title":"502 Bad Gateway","text":"<p>Cause : Container pas encore pr\u00eat apr\u00e8s auto-start</p> <p>Solution : Le proxy attend 30s en mode Blocking. Si toujours 502 : <pre><code># Augmenter timeout dans /opt/docker-autostart/server.js\n# Ligne ~120 : const MAX_WAIT_TIME = 60000; // 60s au lieu de 30s\n\nsystemctl restart docker-autostart\n</code></pre></p>"},{"location":"02-applications/guides/whisper-deployment/#audio-upload-fails-413-payload-too-large","title":"Audio upload fails (413 Payload Too Large)","text":"<p>Cause : Fichier &gt; 500MB</p> <p>Solution : Augmenter <code>client_max_body_size</code> dans Nginx <pre><code>nano /etc/nginx/sites-available/whisperx\n# Changer : client_max_body_size 1G;\n\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre></p>"},{"location":"02-applications/guides/whisper-deployment/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/whisper-deployment/#basic-auth","title":"Basic Auth","text":"<p>Tous les acc\u00e8s sont prot\u00e9g\u00e9s par basic auth Nginx : <pre><code># Credentials\ncat /etc/nginx/.htpasswd\n</code></pre></p>"},{"location":"02-applications/guides/whisper-deployment/#ssltls","title":"SSL/TLS","text":"<p>Certificats Let's Encrypt avec renouvellement automatique : <pre><code>certbot renew --dry-run\n</code></pre></p>"},{"location":"02-applications/guides/whisper-deployment/#exposition","title":"Exposition","text":"<ul> <li>Port 8001 (faster-whisper) : localhost only</li> <li>Port 8002 (WhisperX) : localhost only</li> <li>Port 8890 (auto-start proxy) : localhost only</li> <li>Port 443 (Nginx) : public (avec basic auth)</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#limitations","title":"Limitations","text":""},{"location":"02-applications/guides/whisper-deployment/#faster-whisper_1","title":"faster-whisper","text":"<ul> <li>\u274c Pas de diarization</li> <li>\u274c Timestamps moins pr\u00e9cis (~1s)</li> <li>\u2705 Mais plus rapide et l\u00e9ger</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#whisperx_1","title":"WhisperX","text":"<ul> <li>\u274c N\u00e9cessite HuggingFace token pour diarization</li> <li>\u274c Plus lourd en RAM avec diarization</li> <li>\u274c Build custom requis</li> <li>\u2705 Mais identification speakers + timestamps pr\u00e9cis</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#liens-utiles","title":"Liens utiles","text":"<ul> <li>faster-whisper repo : https://github.com/fedirz/faster-whisper-server</li> <li>WhisperX repo : https://github.com/m-bain/whisperX</li> <li>OpenAI Whisper : https://github.com/openai/whisper</li> <li>pyannote-audio : https://github.com/pyannote/pyannote-audio</li> <li>Swagger UI Portal : https://portal.srv759970.hstgr.cloud/api</li> </ul>"},{"location":"02-applications/guides/whisper-deployment/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Faster-Whisper Queue - Documentation compl\u00e8te du syst\u00e8me async avec RQ</li> <li>WhisperX Service - Acc\u00e8s rapide WhisperX</li> <li>Monitoring WhisperX - Stack de monitoring compl\u00e8te</li> <li>Docker Autostart - Configuration auto-start</li> <li>Nginx - Reverse proxy configuration</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/","title":"Guide Monitoring WhisperX avec Grafana + Prometheus + Loki","text":""},{"location":"02-applications/guides/whisperx-monitoring/#vue-densemble","title":"Vue d'ensemble","text":"<p>Stack de monitoring compl\u00e8te pour WhisperX avec m\u00e9triques temps r\u00e9el et logs centralis\u00e9s.</p>"},{"location":"02-applications/guides/whisperx-monitoring/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     Grafana Dashboard                        \u2502\n\u2502              https://monitoring.srv759970.hstgr.cloud        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502   Prometheus Datasource  \u2502   Loki Datasource        \u2502   \u2502\n\u2502  \u2502   (M\u00e9triques RQ)         \u2502   (Logs Docker)          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Prometheus     \u2502            \u2502      Loki        \u2502\n\u2502   :9090          \u2502            \u2502      :3100       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  RQ Exporter     \u2502            \u2502    Promtail      \u2502\n\u2502  :9726           \u2502            \u2502                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Redis Queue     \u2502            \u2502  Docker Logs     \u2502\n\u2502  (WhisperX)      \u2502            \u2502  (whisperx-*)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#composants","title":"Composants","text":""},{"location":"02-applications/guides/whisperx-monitoring/#1-prometheus-metriques","title":"1. Prometheus (M\u00e9triques)","text":"<ul> <li>Port : 9090</li> <li>Fonction : Collecte et stocke les m\u00e9triques time-series</li> <li>R\u00e9tention : 30 jours</li> <li>Scrape interval : 15 secondes</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#2-rq-exporter-exporteur-redis-queue","title":"2. RQ Exporter (Exporteur Redis Queue)","text":"<ul> <li>Port : 9726</li> <li>Image : <code>mdawar/rq-exporter:latest</code></li> <li>Fonction : Exporte les m\u00e9triques RQ vers Prometheus</li> <li>M\u00e9triques expos\u00e9es :</li> <li><code>rq_workers</code> : Nombre de workers actifs</li> <li><code>rq_jobs{status=\"queued|started|finished|failed\"}</code> : Compteurs de jobs par statut</li> <li><code>rq_queue_length</code> : Longueur des queues</li> <li><code>rq_workers_success_total</code> : Total des succ\u00e8s</li> <li><code>rq_workers_failed_total</code> : Total des \u00e9checs</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#3-loki-logs","title":"3. Loki (Logs)","text":"<ul> <li>Port : 3100</li> <li>Fonction : Agr\u00e9gation et stockage de logs</li> <li>R\u00e9tention : 7 jours (168h)</li> <li>Storage : Filesystem local</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#4-promtail-collecteur-de-logs","title":"4. Promtail (Collecteur de logs)","text":"<ul> <li>Fonction : Collecte logs Docker et envoie \u00e0 Loki</li> <li>Cibles :</li> <li><code>whisperx-worker</code> : Logs du worker RQ</li> <li><code>whisperx</code> : Logs de l'API FastAPI</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#5-grafana-visualisation","title":"5. Grafana (Visualisation)","text":"<ul> <li>Port : 3001 (mapp\u00e9 sur 3000 interne)</li> <li>URL : https://monitoring.srv759970.hstgr.cloud</li> <li>Version : 12.2.0</li> <li>Credentials :</li> <li>User : <code>admin</code></li> <li>Password : <code>YourSecurePassword2025!</code></li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#installation","title":"Installation","text":""},{"location":"02-applications/guides/whisperx-monitoring/#structure-des-fichiers","title":"Structure des fichiers","text":"<pre><code>/opt/monitoring/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 prometheus/\n\u2502   \u2514\u2500\u2500 prometheus.yml\n\u251c\u2500\u2500 loki/\n\u2502   \u2514\u2500\u2500 loki-config.yml\n\u251c\u2500\u2500 promtail/\n\u2502   \u2514\u2500\u2500 promtail-config.yml\n\u2514\u2500\u2500 grafana/\n    \u2514\u2500\u2500 provisioning/\n        \u251c\u2500\u2500 datasources/\n        \u2502   \u2514\u2500\u2500 datasources.yml\n        \u2514\u2500\u2500 dashboards/\n            \u2514\u2500\u2500 dashboards.yml\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: prometheus\n    restart: unless-stopped\n    volumes:\n      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml\n      - prometheus-data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--storage.tsdb.retention.time=30d'\n    ports:\n      - '9090:9090'\n    networks:\n      - monitoring\n\n  rq-exporter:\n    image: mdawar/rq-exporter:latest\n    container_name: rq-exporter\n    restart: unless-stopped\n    environment:\n      - RQ_REDIS_HOST=whisperx-redis\n      - RQ_REDIS_PORT=6379\n      - RQ_REDIS_DB=0\n    ports:\n      - '9726:9726'\n    networks:\n      - monitoring\n      - whisperx_default\n\n  loki:\n    image: grafana/loki:latest\n    container_name: loki\n    restart: unless-stopped\n    ports:\n      - '3100:3100'\n    volumes:\n      - ./loki/loki-config.yml:/etc/loki/local-config.yaml\n      - loki-data:/loki\n    command: -config.file=/etc/loki/local-config.yaml\n    networks:\n      - monitoring\n\n  promtail:\n    image: grafana/promtail:latest\n    container_name: promtail\n    restart: unless-stopped\n    volumes:\n      - ./promtail/promtail-config.yml:/etc/promtail/config.yml\n      - /var/lib/docker/containers:/var/lib/docker/containers:ro\n      - /var/run/docker.sock:/var/run/docker.sock\n    command: -config.file=/etc/promtail/config.yml\n    networks:\n      - monitoring\n\n  grafana:\n    image: grafana/grafana:latest\n    container_name: grafana\n    restart: unless-stopped\n    ports:\n      - '3001:3000'\n    environment:\n      - GF_SECURITY_ADMIN_USER=admin\n      - GF_SECURITY_ADMIN_PASSWORD=YourSecurePassword2025!\n      - GF_INSTALL_PLUGINS=redis-datasource\n      - GF_SERVER_ROOT_URL=https://monitoring.srv759970.hstgr.cloud\n    volumes:\n      - grafana-data:/var/lib/grafana\n      - ./grafana/provisioning:/etc/grafana/provisioning\n    networks:\n      - monitoring\n\nvolumes:\n  prometheus-data:\n  grafana-data:\n  loki-data:\n\nnetworks:\n  monitoring:\n    driver: bridge\n  whisperx_default:\n    external: true\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#demarrage","title":"D\u00e9marrage","text":"<pre><code>cd /opt/monitoring\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#verification","title":"V\u00e9rification","text":"<pre><code># Status des conteneurs\ndocker-compose ps\n\n# Health check complet\ndocker ps --filter name='prometheus|loki|promtail|rq-exporter|grafana'\n\n# M\u00e9triques RQ disponibles\ncurl http://localhost:9726/metrics | grep rq_\n\n# Prometheus targets\ncurl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | {job, health}'\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#configuration-nginx","title":"Configuration Nginx","text":""},{"location":"02-applications/guides/whisperx-monitoring/#certificat-ssl","title":"Certificat SSL","text":"<pre><code>certbot certonly --nginx \\\n  -d monitoring.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#etcnginxsites-availablemonitoring","title":"/etc/nginx/sites-available/monitoring","text":"<pre><code># HTTPS - Grafana Monitoring\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name monitoring.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/monitoring.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/monitoring.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        include snippets/basic-auth.conf;\n\n        proxy_pass http://127.0.0.1:3001;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_read_timeout 300;\n    }\n}\n\n# HTTP -&gt; HTTPS\nserver {\n    listen 80;\n    server_name monitoring.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Activation :</p> <pre><code>ln -sf /etc/nginx/sites-available/monitoring /etc/nginx/sites-enabled/\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#utilisation-de-grafana","title":"Utilisation de Grafana","text":""},{"location":"02-applications/guides/whisperx-monitoring/#connexion","title":"Connexion","text":"<ol> <li>Acc\u00e9der \u00e0 https://monitoring.srv759970.hstgr.cloud</li> <li>Entrer les credentials basic auth (serveur)</li> <li>Login Grafana : <code>admin</code> / <code>YourSecurePassword2025!</code></li> </ol>"},{"location":"02-applications/guides/whisperx-monitoring/#datasources-pre-configurees","title":"Datasources pr\u00e9-configur\u00e9es","text":"<p>Les datasources sont automatiquement provisionn\u00e9es au d\u00e9marrage :</p> <ol> <li>Prometheus (d\u00e9faut)</li> <li>URL : <code>http://prometheus:9090</code></li> <li> <p>M\u00e9triques RQ disponibles</p> </li> <li> <p>Loki</p> </li> <li>URL : <code>http://loki:3100</code></li> <li>Logs des conteneurs WhisperX</li> </ol>"},{"location":"02-applications/guides/whisperx-monitoring/#importer-le-dashboard-rq","title":"Importer le dashboard RQ","text":"<ol> <li>Menu \u2192 Dashboards \u2192 Import</li> <li>Entrer l'ID : 12196</li> <li>S\u00e9lectionner datasource Prometheus</li> <li>Import</li> </ol> <p>Le dashboard affiche : - Nombre de workers actifs/idle - Jobs par statut (queued, started, finished, failed) - Longueur des queues - Taux de succ\u00e8s/\u00e9chec - Temps d'ex\u00e9cution moyen</p>"},{"location":"02-applications/guides/whisperx-monitoring/#creer-un-panel-de-logs","title":"Cr\u00e9er un panel de logs","text":"<ol> <li>Create \u2192 Dashboard \u2192 Add visualization</li> <li>Datasource : Loki</li> <li>Query :    <pre><code>{container=\"whisperx-worker\"}\n</code></pre></li> <li>Options :</li> <li>Show time : Oui</li> <li>Wrap lines : Oui</li> <li>Prettify JSON : Oui</li> </ol>"},{"location":"02-applications/guides/whisperx-monitoring/#requetes-utiles","title":"Requ\u00eates utiles","text":""},{"location":"02-applications/guides/whisperx-monitoring/#prometheus-metriques","title":"Prometheus (M\u00e9triques)","text":"<pre><code># Nombre total de jobs termin\u00e9s\nrq_jobs{queue=\"transcription\",status=\"finished\"}\n\n# Nombre de jobs en cours\nrq_jobs{queue=\"transcription\",status=\"started\"}\n\n# Taux d'\u00e9chec (%)\n(rq_jobs{status=\"failed\"} / (rq_jobs{status=\"finished\"} + rq_jobs{status=\"failed\"})) * 100\n\n# Workers actifs\nrq_workers{queue=\"transcription\"}\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#loki-logs","title":"Loki (Logs)","text":"<pre><code># Logs du worker WhisperX\n{container=\"whisperx-worker\"}\n\n# Logs avec erreur\n{container=\"whisperx-worker\"} |= \"ERROR\"\n\n# Logs de transcription\n{container=\"whisperx-worker\"} |= \"Transcribing\"\n\n# Logs de l'API\n{container=\"whisperx\"} | json\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#monitoring-des-jobs-whisperx","title":"Monitoring des jobs WhisperX","text":""},{"location":"02-applications/guides/whisperx-monitoring/#via-rq-dashboard-original","title":"Via RQ Dashboard (original)","text":"<p>URL : https://whisperx-dashboard.srv759970.hstgr.cloud</p> <p>Affiche : - Queues actives - Jobs en temps r\u00e9el - Workers</p>"},{"location":"02-applications/guides/whisperx-monitoring/#via-grafana-nouveau","title":"Via Grafana (nouveau)","text":"<p>URL : https://monitoring.srv759970.hstgr.cloud</p> <p>Avantages : - Historique des m\u00e9triques (graphiques) - Logs centralis\u00e9s en temps r\u00e9el - Alertes configurables - Dashboards personnalisables - Corr\u00e9lation m\u00e9triques + logs</p>"},{"location":"02-applications/guides/whisperx-monitoring/#exemples-de-panels","title":"Exemples de panels","text":"<p>Panel 1 : Jobs par statut (Time series) <pre><code>rq_jobs{queue=\"transcription\"}\n</code></pre></p> <p>Panel 2 : Logs worker (Logs) <pre><code>{container=\"whisperx-worker\"} |~ \"Job|Transcription|Loading\"\n</code></pre></p> <p>Panel 3 : Taux de succ\u00e8s (Stat) <pre><code>rq_jobs{queue=\"transcription\",status=\"finished\"}\n</code></pre></p>"},{"location":"02-applications/guides/whisperx-monitoring/#alertes","title":"Alertes","text":""},{"location":"02-applications/guides/whisperx-monitoring/#exemple-job-failed","title":"Exemple : Job failed","text":"<p>Dans Grafana \u2192 Alerting \u2192 Alert rules :</p> <pre><code>- alert: WhisperXJobsFailed\n  expr: rate(rq_jobs{status=\"failed\"}[5m]) &gt; 0.1\n  for: 5m\n  labels:\n    severity: warning\n  annotations:\n    summary: \"Taux \u00e9lev\u00e9 d'\u00e9checs jobs WhisperX\"\n    description: \"{{ $value }} jobs/min \u00e9chouent\"\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/guides/whisperx-monitoring/#logs","title":"Logs","text":"<pre><code># Logs Grafana\ndocker logs -f grafana\n\n# Logs Prometheus\ndocker logs -f prometheus\n\n# Logs Loki\ndocker logs -f loki\n\n# Logs Promtail\ndocker logs -f promtail\n\n# Logs RQ Exporter\ndocker logs -f rq-exporter\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#backup","title":"Backup","text":"<pre><code># Backup volumes Grafana\ndocker run --rm -v monitoring_grafana-data:/data -v $(pwd):/backup alpine tar czf /backup/grafana-backup.tar.gz -C /data .\n\n# Backup volumes Prometheus\ndocker run --rm -v monitoring_prometheus-data:/data -v $(pwd):/backup alpine tar czf /backup/prometheus-backup.tar.gz -C /data .\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#restart","title":"Restart","text":"<pre><code>cd /opt/monitoring\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#update","title":"Update","text":"<pre><code>cd /opt/monitoring\ndocker-compose pull\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/guides/whisperx-monitoring/#grafana-naffiche-pas-les-metriques","title":"Grafana n'affiche pas les m\u00e9triques","text":"<ol> <li> <p>V\u00e9rifier Prometheus targets :    <pre><code>curl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.health != \"up\")'\n</code></pre></p> </li> <li> <p>V\u00e9rifier RQ exporter :    <pre><code>curl http://localhost:9726/metrics | head -20\n</code></pre></p> </li> <li> <p>V\u00e9rifier r\u00e9seau Docker :    <pre><code>docker network inspect monitoring_monitoring\ndocker network inspect whisperx_default\n</code></pre></p> </li> </ol>"},{"location":"02-applications/guides/whisperx-monitoring/#loki-ne-recoit-pas-les-logs","title":"Loki ne re\u00e7oit pas les logs","text":"<ol> <li> <p>V\u00e9rifier Promtail :    <pre><code>docker logs promtail | grep ERROR\n</code></pre></p> </li> <li> <p>V\u00e9rifier permissions Docker socket :    <pre><code>ls -la /var/run/docker.sock\n</code></pre></p> </li> <li> <p>Tester manuellement :    <pre><code>curl -X POST http://localhost:3100/loki/api/v1/push \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"streams\":[{\"stream\":{\"job\":\"test\"},\"values\":[[\"'$(date +%s)000000000'\",\"test message\"]]}]}'\n</code></pre></p> </li> </ol>"},{"location":"02-applications/guides/whisperx-monitoring/#certificat-ssl-expire","title":"Certificat SSL expir\u00e9","text":"<pre><code># V\u00e9rifier expiration\ncertbot certificates | grep monitoring\n\n# Renouveler manuellement\ncertbot renew --cert-name monitoring.srv759970.hstgr.cloud\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/guides/whisperx-monitoring/#urls-de-reference","title":"URLs de r\u00e9f\u00e9rence","text":"<ul> <li>Grafana : https://monitoring.srv759970.hstgr.cloud</li> <li>Prometheus : http://srv759970.hstgr.cloud:9090</li> <li>RQ Exporter : http://srv759970.hstgr.cloud:9726/metrics</li> <li>Loki : http://srv759970.hstgr.cloud:3100</li> <li>RQ Dashboard (legacy) : https://whisperx-dashboard.srv759970.hstgr.cloud</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#dashboard-rq-officiel","title":"Dashboard RQ officiel","text":"<p>ID Grafana Labs : 12196</p> <p>Lien direct : https://grafana.com/grafana/dashboards/12196-rq-dashboard/</p>"},{"location":"02-applications/guides/whisperx-monitoring/#ressources","title":"Ressources","text":"<ul> <li>Prometheus</li> <li>Grafana</li> <li>Loki</li> <li>RQ Exporter</li> <li>Promtail</li> </ul>"},{"location":"02-applications/guides/whisperx-monitoring/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Faster-Whisper Queue - Service \u00e0 monitorer</li> <li>WhisperX Service - Service WhisperX</li> <li>Guide Whisper Services - D\u00e9ploiement des services</li> <li>Nginx - Configuration reverse proxy</li> <li>Docker - Gestion des conteneurs</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/","title":"WordPress - D\u00e9ploiement Docker","text":""},{"location":"02-applications/guides/wordpress-docker/#vue-densemble","title":"Vue d'ensemble","text":"<p>Guide de d\u00e9ploiement de sites WordPress avec Docker sur srv759970.hstgr.cloud.</p>"},{"location":"02-applications/guides/wordpress-docker/#sites-wordpress-deployes","title":"Sites WordPress D\u00e9ploy\u00e9s","text":""},{"location":"02-applications/guides/wordpress-docker/#clemence-site","title":"Cl\u00e9mence Site","text":"<ul> <li>URL: https://clemence.srv759970.hstgr.cloud</li> <li>Type: Site vitrine projets engag\u00e9s</li> <li>Stack: WordPress + MySQL + Nginx</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#solidarlink","title":"SolidarLink","text":"<ul> <li>URL: https://solidarlink.srv759970.hstgr.cloud</li> <li>Type: Plateforme de mise en relation solidaire</li> <li>Stack: WordPress + MySQL + Nginx</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#architecture-docker","title":"Architecture Docker","text":"<pre><code>/opt/wordpress-clemence/\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 nginx/\n    \u2514\u2500\u2500 default.conf\n\n/opt/wordpress-solidarlink/\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 nginx/\n    \u2514\u2500\u2500 default.conf\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#configuration-docker-compose","title":"Configuration Docker Compose","text":""},{"location":"02-applications/guides/wordpress-docker/#structure-basique","title":"Structure Basique","text":"<pre><code>version: '3.8'\n\nservices:\n  mysql:\n    image: mysql:8.0\n    container_name: mysql-clemence\n    restart: unless-stopped\n    environment:\n      - MYSQL_ROOT_PASSWORD=&lt;root_password&gt;\n      - MYSQL_DATABASE=clemence_db\n      - MYSQL_USER=clemence_user\n      - MYSQL_PASSWORD=&lt;user_password&gt;\n    volumes:\n      - mysql-data:/var/lib/mysql\n    networks:\n      - wordpress-net\n\n  wordpress:\n    image: wordpress:latest\n    container_name: wordpress-clemence\n    restart: unless-stopped\n    depends_on:\n      - mysql\n    environment:\n      - WORDPRESS_DB_HOST=mysql-clemence:3306\n      - WORDPRESS_DB_NAME=clemence_db\n      - WORDPRESS_DB_USER=clemence_user\n      - WORDPRESS_DB_PASSWORD=&lt;user_password&gt;\n    volumes:\n      - wordpress-data:/var/www/html\n    ports:\n      - \"8080:80\"\n    networks:\n      - wordpress-net\n\nvolumes:\n  mysql-data:\n  wordpress-data:\n\nnetworks:\n  wordpress-net:\n    driver: bridge\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/guides/wordpress-docker/#1-creer-la-structure","title":"1. Cr\u00e9er la Structure","text":"<pre><code>mkdir -p /opt/wordpress-clemence\ncd /opt/wordpress-clemence\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#2-creer-docker-composeyml","title":"2. Cr\u00e9er docker-compose.yml","text":"<pre><code>nano docker-compose.yml\n# Coller la configuration ci-dessus\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#3-demarrer-les-services","title":"3. D\u00e9marrer les Services","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#4-verifier-les-logs","title":"4. V\u00e9rifier les Logs","text":"<pre><code>docker-compose logs -f\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#configuration-nginx","title":"Configuration Nginx","text":""},{"location":"02-applications/guides/wordpress-docker/#certificat-ssl","title":"Certificat SSL","text":"<pre><code>certbot certonly --nginx \\\n  -d clemence.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#configuration-nginx_1","title":"Configuration Nginx","text":"<p>/etc/nginx/sites-available/clemence</p> <pre><code>server {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name clemence.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/clemence.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/clemence.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/clemence-access.log;\n    error_log /var/log/nginx/clemence-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:8080;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WordPress specific\n        proxy_set_header X-Forwarded-Host $host;\n        proxy_redirect off;\n    }\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name clemence.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#activation","title":"Activation","text":"<pre><code>ln -sf /etc/nginx/sites-available/clemence /etc/nginx/sites-enabled/\nnginx -t\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#configuration-wordpress","title":"Configuration WordPress","text":""},{"location":"02-applications/guides/wordpress-docker/#1-acces-initial","title":"1. Acc\u00e8s Initial","text":"<p>Naviguer vers https://clemence.srv759970.hstgr.cloud</p>"},{"location":"02-applications/guides/wordpress-docker/#2-installation-wordpress","title":"2. Installation WordPress","text":"<ul> <li>Langue: Fran\u00e7ais</li> <li>Titre du site</li> <li>Nom d'utilisateur admin</li> <li>Mot de passe</li> <li>Email</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#3-configuration-https","title":"3. Configuration HTTPS","text":"<p>Dans wp-config.php (via docker exec):</p> <pre><code>define('FORCE_SSL_ADMIN', true);\nif (isset($_SERVER['HTTP_X_FORWARDED_PROTO']) &amp;&amp; $_SERVER['HTTP_X_FORWARDED_PROTO'] === 'https') {\n    $_SERVER['HTTPS'] = 'on';\n}\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#plugins-recommandes","title":"Plugins Recommand\u00e9s","text":""},{"location":"02-applications/guides/wordpress-docker/#securite","title":"S\u00e9curit\u00e9","text":"<ul> <li>Wordfence Security</li> <li>iThemes Security</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#performance","title":"Performance","text":"<ul> <li>WP Super Cache</li> <li>Autoptimize</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#seo","title":"SEO","text":"<ul> <li>Yoast SEO</li> <li>Rank Math</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#backup","title":"Backup","text":"<ul> <li>UpdraftPlus</li> <li>BackWPup</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/guides/wordpress-docker/#backup_1","title":"Backup","text":"<pre><code># Backup volumes\ndocker run --rm \\\n  -v wordpress-clemence_wordpress-data:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/wordpress-$(date +%Y%m%d).tar.gz -C /data .\n\ndocker run --rm \\\n  -v wordpress-clemence_mysql-data:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/mysql-$(date +%Y%m%d).tar.gz -C /data .\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#mise-a-jour-wordpress","title":"Mise \u00e0 Jour WordPress","text":"<p>Via l'interface admin ou:</p> <pre><code>docker exec wordpress-clemence wp core update --allow-root\ndocker exec wordpress-clemence wp plugin update --all --allow-root\ndocker exec wordpress-clemence wp theme update --all --allow-root\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#logs","title":"Logs","text":"<pre><code># WordPress\ndocker logs wordpress-clemence -f\n\n# MySQL\ndocker logs mysql-clemence -f\n\n# Nginx\ntail -f /var/log/nginx/clemence-access.log\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/guides/wordpress-docker/#erreur-de-connexion-base-de-donnees","title":"Erreur de connexion base de donn\u00e9es","text":"<pre><code># V\u00e9rifier que MySQL est d\u00e9marr\u00e9\ndocker ps | grep mysql\n\n# Voir les logs MySQL\ndocker logs mysql-clemence --tail 50\n\n# Tester la connexion\ndocker exec -it mysql-clemence mysql -u clemence_user -p\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#permissions-fichiers","title":"Permissions fichiers","text":"<pre><code># R\u00e9parer les permissions\ndocker exec wordpress-clemence chown -R www-data:www-data /var/www/html\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#white-screen-of-death","title":"White Screen of Death","text":"<pre><code># Activer le debug dans wp-config.php\ndocker exec -it wordpress-clemence bash\nnano /var/www/html/wp-config.php\n\n# Ajouter:\ndefine('WP_DEBUG', true);\ndefine('WP_DEBUG_LOG', true);\ndefine('WP_DEBUG_DISPLAY', false);\n\n# Voir les logs\ntail -f /var/www/html/wp-content/debug.log\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#performance_1","title":"Performance","text":""},{"location":"02-applications/guides/wordpress-docker/#cache","title":"Cache","text":"<p>Installer WP Super Cache et activer.</p>"},{"location":"02-applications/guides/wordpress-docker/#cdn","title":"CDN","text":"<p>Configurer Cloudflare pour servir les assets statiques.</p>"},{"location":"02-applications/guides/wordpress-docker/#optimisation-images","title":"Optimisation Images","text":"<ul> <li>Installer Imagify ou Smush</li> <li>Compression automatique</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#database-optimization","title":"Database Optimization","text":"<pre><code>docker exec -it mysql-clemence mysql -u root -p\n\nOPTIMIZE TABLE wp_posts;\nOPTIMIZE TABLE wp_postmeta;\n</code></pre>"},{"location":"02-applications/guides/wordpress-docker/#securite_1","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/wordpress-docker/#sslhttps","title":"SSL/HTTPS","text":"<ul> <li>Certificats Let's Encrypt</li> <li>Force HTTPS dans WordPress</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#firewall","title":"Firewall","text":"<ul> <li>Basic Auth pour wp-admin (Nginx)</li> <li>Wordfence pour protection applicative</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#mises-a-jour","title":"Mises \u00e0 Jour","text":"<ul> <li>WordPress core</li> <li>Plugins</li> <li>Th\u00e8mes</li> <li>PHP (via image Docker)</li> </ul>"},{"location":"02-applications/guides/wordpress-docker/#backup-automatique","title":"Backup Automatique","text":"<p>Configurer UpdraftPlus avec stockage sur Dropbox/Google Drive.</p>"},{"location":"02-applications/guides/wordpress-docker/#ressources","title":"Ressources","text":"<ul> <li>WordPress Docker</li> <li>WordPress Codex</li> <li>WP-CLI</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/","title":"Guide d'installation WordPress Multisite sur VPS Hostinger","text":"<p>Ce guide vous accompagne dans l'installation et la configuration de WordPress en mode multisite sur votre VPS Hostinger.</p>"},{"location":"02-applications/guides/wordpress-multisite/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>VPS Hostinger avec acc\u00e8s SSH</li> <li>Nginx install\u00e9 et configur\u00e9</li> <li>PHP 8.1+ install\u00e9 avec les extensions n\u00e9cessaires</li> <li>MySQL/MariaDB install\u00e9</li> <li>Nom de domaine configur\u00e9 avec DNS pointant vers votre VPS</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#1-installation-des-dependances-php-pour-wordpress","title":"1. Installation des d\u00e9pendances PHP pour WordPress","text":"<pre><code># Se connecter en SSH\nssh root@votre-ip-vps\n\n# Installer PHP et les extensions requises\napt update\napt install -y php8.2-fpm php8.2-mysql php8.2-curl php8.2-gd php8.2-mbstring \\\n  php8.2-xml php8.2-xmlrpc php8.2-soap php8.2-intl php8.2-zip php8.2-imagick\n\n# V\u00e9rifier l'installation\nphp -v\nphp -m | grep -E 'mysql|curl|gd|mbstring|xml'\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#2-configuration-de-la-base-de-donnees","title":"2. Configuration de la base de donn\u00e9es","text":""},{"location":"02-applications/guides/wordpress-multisite/#creer-la-base-de-donnees-et-lutilisateur","title":"Cr\u00e9er la base de donn\u00e9es et l'utilisateur","text":"<pre><code># Se connecter \u00e0 MySQL\nmysql -u root -p\n\n# Dans MySQL, cr\u00e9er la base et l'utilisateur\nCREATE DATABASE wordpress_multisite CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\nCREATE USER 'wp_user'@'localhost' IDENTIFIED BY 'VotreMotDePasseSecurise';\nGRANT ALL PRIVILEGES ON wordpress_multisite.* TO 'wp_user'@'localhost';\nFLUSH PRIVILEGES;\nEXIT;\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#optimisations-mysql-pour-wordpress","title":"Optimisations MySQL pour WordPress","text":"<pre><code># \u00c9diter la configuration MySQL\nnano /etc/mysql/mysql.conf.d/mysqld.cnf\n\n# Ajouter ces param\u00e8tres dans la section [mysqld]\n[mysqld]\nmax_allowed_packet = 256M\ninnodb_buffer_pool_size = 512M\ninnodb_log_file_size = 128M\nquery_cache_type = 1\nquery_cache_size = 64M\nquery_cache_limit = 2M\n\n# Red\u00e9marrer MySQL\nsystemctl restart mysql\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#3-telechargement-et-installation-de-wordpress","title":"3. T\u00e9l\u00e9chargement et installation de WordPress","text":"<pre><code># Cr\u00e9er le r\u00e9pertoire pour WordPress\nmkdir -p /var/www/wordpress\ncd /var/www/wordpress\n\n# T\u00e9l\u00e9charger WordPress\nwget https://wordpress.org/latest.tar.gz\ntar -xzvf latest.tar.gz\nmv wordpress/* .\nrm -rf wordpress latest.tar.gz\n\n# Configurer les permissions\nchown -R www-data:www-data /var/www/wordpress\nfind /var/www/wordpress -type d -exec chmod 755 {} \\;\nfind /var/www/wordpress -type f -exec chmod 644 {} \\;\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#4-configuration-de-wp-configphp","title":"4. Configuration de wp-config.php","text":"<pre><code># Copier le fichier de configuration exemple\ncp wp-config-sample.php wp-config.php\n\n# \u00c9diter wp-config.php\nnano wp-config.php\n</code></pre> <p>Configurer les param\u00e8tres de base de donn\u00e9es :</p> <pre><code>&lt;?php\n// ** R\u00e9glages MySQL ** //\ndefine('DB_NAME', 'wordpress_multisite');\ndefine('DB_USER', 'wp_user');\ndefine('DB_PASSWORD', 'VotreMotDePasseSecurise');\ndefine('DB_HOST', 'localhost');\ndefine('DB_CHARSET', 'utf8mb4');\ndefine('DB_COLLATE', '');\n\n// Cl\u00e9s de s\u00e9curit\u00e9 - \u00c0 g\u00e9n\u00e9rer sur https://api.wordpress.org/secret-key/1.1/salt/\ndefine('AUTH_KEY',         'votre-cl\u00e9-unique');\ndefine('SECURE_AUTH_KEY',  'votre-cl\u00e9-unique');\ndefine('LOGGED_IN_KEY',    'votre-cl\u00e9-unique');\ndefine('NONCE_KEY',        'votre-cl\u00e9-unique');\ndefine('AUTH_SALT',        'votre-cl\u00e9-unique');\ndefine('SECURE_AUTH_SALT', 'votre-cl\u00e9-unique');\ndefine('LOGGED_IN_SALT',   'votre-cl\u00e9-unique');\ndefine('NONCE_SALT',       'votre-cl\u00e9-unique');\n\n// Pr\u00e9fixe de tables\n$table_prefix = 'wp_';\n\n// Mode debug (d\u00e9sactiver en production)\ndefine('WP_DEBUG', false);\n\n// Optimisations\ndefine('WP_MEMORY_LIMIT', '256M');\ndefine('WP_MAX_MEMORY_LIMIT', '512M');\ndefine('AUTOSAVE_INTERVAL', 300);\ndefine('WP_POST_REVISIONS', 5);\ndefine('EMPTY_TRASH_DAYS', 30);\n\n/* C'est tout, ne touchez pas \u00e0 ce qui suit ! Bonne publication. */\nif ( !defined('ABSPATH') )\n    define('ABSPATH', dirname(__FILE__) . '/');\nrequire_once(ABSPATH . 'wp-settings.php');\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#5-configuration-nginx-pour-wordpress","title":"5. Configuration Nginx pour WordPress","text":"<p>Cr\u00e9er un fichier de configuration Nginx :</p> <pre><code>nano /etc/nginx/sites-available/wordpress\n</code></pre> <p>Configuration Nginx optimis\u00e9e pour WordPress :</p> <pre><code>server {\n    listen 80;\n    listen [::]:80;\n    server_name votre-domaine.com www.votre-domaine.com;\n\n    root /var/www/wordpress;\n    index index.php index.html index.htm;\n\n    # Logs\n    access_log /var/log/nginx/wordpress-access.log;\n    error_log /var/log/nginx/wordpress-error.log;\n\n    # S\u00e9curit\u00e9 - Cacher les fichiers sensibles\n    location ~ /\\. {\n        deny all;\n    }\n\n    location ~ /wp-config.php {\n        deny all;\n    }\n\n    # Limits des uploads\n    client_max_body_size 100M;\n\n    # WordPress Multisite - fichiers upload\u00e9s\n    location ~ ^/files/(.*)$ {\n        try_files /wp-content/blogs.dir/$blogid/$uri /wp-includes/ms-files.php?file=$1 ;\n        access_log off;\n        log_not_found off;\n        expires max;\n    }\n\n    # WordPress\n    location / {\n        try_files $uri $uri/ /index.php?$args;\n    }\n\n    # PHP-FPM\n    location ~ \\.php$ {\n        include snippets/fastcgi-php.conf;\n        fastcgi_pass unix:/run/php/php8.2-fpm.sock;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n\n        # Optimisations PHP\n        fastcgi_buffer_size 128k;\n        fastcgi_buffers 256 16k;\n        fastcgi_busy_buffers_size 256k;\n        fastcgi_temp_file_write_size 256k;\n        fastcgi_read_timeout 300;\n    }\n\n    # Cache pour les fichiers statiques\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {\n        expires 365d;\n        add_header Cache-Control \"public, immutable\";\n        access_log off;\n    }\n\n    # S\u00e9curit\u00e9 suppl\u00e9mentaire\n    location = /xmlrpc.php {\n        deny all;\n    }\n}\n</code></pre> <p>Activer le site et red\u00e9marrer Nginx :</p> <pre><code># Cr\u00e9er le lien symbolique\nln -s /etc/nginx/sites-available/wordpress /etc/nginx/sites-enabled/\n\n# Tester la configuration\nnginx -t\n\n# Red\u00e9marrer Nginx\nsystemctl restart nginx\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#6-installation-initiale-de-wordpress","title":"6. Installation initiale de WordPress","text":"<ol> <li>Acc\u00e9der \u00e0 votre domaine dans un navigateur : <code>http://votre-domaine.com</code></li> <li>Suivre l'assistant d'installation WordPress</li> <li>Renseigner :</li> <li>Titre du site</li> <li>Nom d'utilisateur admin</li> <li>Mot de passe fort</li> <li>Email admin</li> </ol>"},{"location":"02-applications/guides/wordpress-multisite/#7-activation-du-mode-multisite","title":"7. Activation du mode Multisite","text":""},{"location":"02-applications/guides/wordpress-multisite/#etape-1-modifier-wp-configphp","title":"\u00c9tape 1 : Modifier wp-config.php","text":"<pre><code>nano /var/www/wordpress/wp-config.php\n</code></pre> <p>Ajouter AVANT la ligne <code>/* C'est tout, ne touchez pas \u00e0 ce qui suit ! */</code> :</p> <pre><code>/* Activation du multisite */\ndefine('WP_ALLOW_MULTISITE', true);\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#etape-2-configurer-le-reseau-multisite","title":"\u00c9tape 2 : Configurer le r\u00e9seau multisite","text":"<ol> <li>Se connecter au tableau de bord WordPress</li> <li>Aller dans Outils &gt; Configuration du r\u00e9seau</li> <li>Choisir le type de multisite :</li> <li>Sous-domaines : site1.domaine.com, site2.domaine.com</li> <li>Sous-r\u00e9pertoires : domaine.com/site1, domaine.com/site2</li> </ol>"},{"location":"02-applications/guides/wordpress-multisite/#etape-3-finaliser-la-configuration","title":"\u00c9tape 3 : Finaliser la configuration","text":"<p>WordPress vous donnera du code \u00e0 ajouter dans <code>wp-config.php</code> et <code>.htaccess</code> (que nous allons adapter pour Nginx).</p> <p>Exemple de code pour wp-config.php (\u00e0 ajouter APR\u00c8S <code>WP_ALLOW_MULTISITE</code>) :</p> <pre><code>define('MULTISITE', true);\ndefine('SUBDOMAIN_INSTALL', false); // true pour sous-domaines, false pour sous-r\u00e9pertoires\ndefine('DOMAIN_CURRENT_SITE', 'votre-domaine.com');\ndefine('PATH_CURRENT_SITE', '/');\ndefine('SITE_ID_CURRENT_SITE', 1);\ndefine('BLOG_ID_CURRENT_SITE', 1);\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#etape-4-configuration-nginx-pour-multisite","title":"\u00c9tape 4 : Configuration Nginx pour Multisite","text":""},{"location":"02-applications/guides/wordpress-multisite/#pour-installation-en-sous-repertoires","title":"Pour installation en sous-r\u00e9pertoires :","text":"<pre><code># Dans le bloc server, remplacer la directive location /\nlocation / {\n    try_files $uri $uri/ /index.php?$args;\n}\n\n# Ajouter le support multisite\nif (!-e $request_filename) {\n    rewrite /wp-admin$ $scheme://$host$uri/ permanent;\n    rewrite ^(/[^/]+)?(/wp-.*) $2 last;\n    rewrite ^(/[^/]+)?(/.*\\.php) $2 last;\n}\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#pour-installation-en-sous-domaines","title":"Pour installation en sous-domaines :","text":"<p>Modifier la directive <code>server_name</code> :</p> <pre><code>server_name votre-domaine.com *.votre-domaine.com;\n</code></pre> <p>Et configurer les wildcards DNS :</p> <pre><code># Dans votre panneau DNS, ajouter un enregistrement A wildcard :\n*.votre-domaine.com    A    votre-ip-vps\n</code></pre> <p>Red\u00e9marrer Nginx :</p> <pre><code>nginx -t\nsystemctl restart nginx\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#8-configuration-ssl-avec-lets-encrypt-recommande","title":"8. Configuration SSL avec Let's Encrypt (Recommand\u00e9)","text":"<pre><code># Installer Certbot\napt install -y certbot python3-certbot-nginx\n\n# Obtenir un certificat SSL\ncertbot --nginx -d votre-domaine.com -d www.votre-domaine.com\n\n# Pour multisite avec sous-domaines, utiliser wildcard\ncertbot certonly --manual --preferred-challenges=dns \\\n  -d votre-domaine.com -d *.votre-domaine.com\n\n# Renouvellement automatique (d\u00e9j\u00e0 configur\u00e9 par d\u00e9faut)\ncertbot renew --dry-run\n</code></pre> <p>Apr\u00e8s SSL, mettre \u00e0 jour wp-config.php :</p> <pre><code>// Forcer HTTPS\ndefine('FORCE_SSL_ADMIN', true);\nif (strpos($_SERVER['HTTP_X_FORWARDED_PROTO'], 'https') !== false)\n    $_SERVER['HTTPS']='on';\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#9-optimisations-php-fpm-pour-wordpress","title":"9. Optimisations PHP-FPM pour WordPress","text":"<pre><code># \u00c9diter la configuration PHP-FPM\nnano /etc/php/8.2/fpm/pool.d/www.conf\n\n# Modifier ces param\u00e8tres\npm = dynamic\npm.max_children = 50\npm.start_servers = 10\npm.min_spare_servers = 5\npm.max_spare_servers = 20\npm.max_requests = 500\n\n# \u00c9diter php.ini\nnano /etc/php/8.2/fpm/php.ini\n\n# Optimisations\nmemory_limit = 256M\nupload_max_filesize = 100M\npost_max_size = 100M\nmax_execution_time = 300\nmax_input_time = 300\n\n# Red\u00e9marrer PHP-FPM\nsystemctl restart php8.2-fpm\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#10-gestion-des-sites-du-reseau","title":"10. Gestion des sites du r\u00e9seau","text":""},{"location":"02-applications/guides/wordpress-multisite/#ajouter-un-nouveau-site","title":"Ajouter un nouveau site","text":"<ol> <li>Aller dans Mes sites &gt; Administration du r\u00e9seau &gt; Sites</li> <li>Cliquer sur Ajouter</li> <li>Renseigner :</li> <li>Adresse du site (sous-domaine ou sous-r\u00e9pertoire)</li> <li>Titre du site</li> <li>Email de l'admin</li> <li>Le site est cr\u00e9\u00e9 instantan\u00e9ment</li> </ol>"},{"location":"02-applications/guides/wordpress-multisite/#gestion-des-utilisateurs","title":"Gestion des utilisateurs","text":"<ul> <li>Super Admin : Acc\u00e8s \u00e0 tous les sites et param\u00e8tres r\u00e9seau</li> <li>Administrateur de site : Gestion d'un seul site</li> <li>Les utilisateurs peuvent \u00eatre ajout\u00e9s \u00e0 plusieurs sites avec diff\u00e9rents r\u00f4les</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#plugins-et-themes","title":"Plugins et th\u00e8mes","text":"<ul> <li>Les plugins peuvent \u00eatre activ\u00e9s pour le r\u00e9seau (disponibles pour tous les sites)</li> <li>Ou activ\u00e9s individuellement par site</li> <li>Les th\u00e8mes doivent \u00eatre activ\u00e9s pour le r\u00e9seau avant d'\u00eatre utilisables</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#11-sauvegarde-et-maintenance","title":"11. Sauvegarde et maintenance","text":""},{"location":"02-applications/guides/wordpress-multisite/#script-de-sauvegarde-automatique","title":"Script de sauvegarde automatique","text":"<pre><code>nano /root/backup-wordpress.sh\n</code></pre> <pre><code>#!/bin/bash\n\n# Configuration\nBACKUP_DIR=\"/root/backups/wordpress\"\nDATE=$(date +%Y%m%d_%H%M%S)\nWP_DIR=\"/var/www/wordpress\"\nDB_NAME=\"wordpress_multisite\"\nDB_USER=\"wp_user\"\nDB_PASS=\"VotreMotDePasseSecurise\"\n\n# Cr\u00e9er le r\u00e9pertoire de sauvegarde\nmkdir -p $BACKUP_DIR\n\n# Sauvegarder les fichiers\ntar -czf $BACKUP_DIR/wp-files-$DATE.tar.gz $WP_DIR\n\n# Sauvegarder la base de donn\u00e9es\nmysqldump -u $DB_USER -p$DB_PASS $DB_NAME | gzip &gt; $BACKUP_DIR/wp-db-$DATE.sql.gz\n\n# Supprimer les sauvegardes de plus de 30 jours\nfind $BACKUP_DIR -name \"wp-*\" -mtime +30 -delete\n\necho \"Sauvegarde termin\u00e9e : $DATE\"\n</code></pre> <pre><code># Rendre le script ex\u00e9cutable\nchmod +x /root/backup-wordpress.sh\n\n# Ajouter au cron pour ex\u00e9cution quotidienne \u00e0 2h\ncrontab -e\n# Ajouter cette ligne :\n0 2 * * * /root/backup-wordpress.sh &gt;&gt; /var/log/wordpress-backup.log 2&gt;&amp;1\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#12-plugins-recommandes-pour-multisite","title":"12. Plugins recommand\u00e9s pour multisite","text":"<ul> <li>WP Super Cache ou W3 Total Cache : Cache et performance</li> <li>Wordfence Security : S\u00e9curit\u00e9 et firewall</li> <li>UpdraftPlus : Sauvegardes automatiques</li> <li>Multisite Enhancements : Am\u00e9liore l'interface multisite</li> <li>WP Multisite Feed : Agr\u00e9gateur de contenu entre sites</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#13-securite","title":"13. S\u00e9curit\u00e9","text":""},{"location":"02-applications/guides/wordpress-multisite/#proteger-wp-loginphp-contre-les-attaques-brute-force","title":"Prot\u00e9ger wp-login.php contre les attaques brute-force","text":"<pre><code>nano /etc/nginx/sites-available/wordpress\n</code></pre> <p>Ajouter dans le bloc server :</p> <pre><code># Limiter les tentatives de connexion\nlocation = /wp-login.php {\n    limit_req zone=one burst=5 nodelay;\n    include snippets/fastcgi-php.conf;\n    fastcgi_pass unix:/run/php/php8.2-fpm.sock;\n}\n</code></pre> <p>Dans la section http de <code>/etc/nginx/nginx.conf</code> :</p> <pre><code>http {\n    # Rate limiting\n    limit_req_zone $binary_remote_addr zone=one:10m rate=5r/m;\n\n    # ...\n}\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#desactiver-lediteur-de-fichiers-wordpress","title":"D\u00e9sactiver l'\u00e9diteur de fichiers WordPress","text":"<p>Dans wp-config.php :</p> <pre><code>define('DISALLOW_FILE_EDIT', true);\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#14-monitoring-et-performance","title":"14. Monitoring et performance","text":""},{"location":"02-applications/guides/wordpress-multisite/#installer-des-outils-de-monitoring","title":"Installer des outils de monitoring","text":"<pre><code># Installer htop pour monitoring CPU/RAM\napt install -y htop\n\n# Installer mytop pour monitoring MySQL\napt install -y mytop\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#activer-les-logs-lents-mysql","title":"Activer les logs lents MySQL","text":"<pre><code>nano /etc/mysql/mysql.conf.d/mysqld.cnf\n</code></pre> <pre><code>[mysqld]\nslow_query_log = 1\nslow_query_log_file = /var/log/mysql/slow-queries.log\nlong_query_time = 2\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#resume-des-commandes-essentielles","title":"R\u00e9sum\u00e9 des commandes essentielles","text":"<pre><code># Red\u00e9marrer les services\nsystemctl restart nginx\nsystemctl restart php8.2-fpm\nsystemctl restart mysql\n\n# V\u00e9rifier les statuts\nsystemctl status nginx\nsystemctl status php8.2-fpm\nsystemctl status mysql\n\n# Logs\ntail -f /var/log/nginx/wordpress-error.log\ntail -f /var/log/php8.2-fpm.log\n\n# Permissions WordPress\nchown -R www-data:www-data /var/www/wordpress\nfind /var/www/wordpress -type d -exec chmod 755 {} \\;\nfind /var/www/wordpress -type f -exec chmod 644 {} \\;\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#depannage","title":"D\u00e9pannage","text":""},{"location":"02-applications/guides/wordpress-multisite/#erreur-error-establishing-database-connection","title":"Erreur \"Error establishing database connection\"","text":"<ul> <li>V\u00e9rifier les credentials dans wp-config.php</li> <li>V\u00e9rifier que MySQL est d\u00e9marr\u00e9 : <code>systemctl status mysql</code></li> <li>Tester la connexion : <code>mysql -u wp_user -p wordpress_multisite</code></li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#erreur-502-bad-gateway","title":"Erreur 502 Bad Gateway","text":"<ul> <li>V\u00e9rifier PHP-FPM : <code>systemctl status php8.2-fpm</code></li> <li>V\u00e9rifier les logs : <code>tail -f /var/log/nginx/error.log</code></li> <li>V\u00e9rifier le socket PHP dans la config Nginx</li> </ul>"},{"location":"02-applications/guides/wordpress-multisite/#problemes-de-permissions","title":"Probl\u00e8mes de permissions","text":"<pre><code>chown -R www-data:www-data /var/www/wordpress\nchmod -R 755 /var/www/wordpress\n</code></pre>"},{"location":"02-applications/guides/wordpress-multisite/#ressources","title":"Ressources","text":"<ul> <li>Documentation officielle WordPress Multisite</li> <li>Nginx et WordPress</li> <li>Codex WordPress</li> </ul> <p>Note : Remplacez toutes les valeurs <code>votre-domaine.com</code>, <code>votre-ip-vps</code>, et <code>VotreMotDePasseSecurise</code> par vos propres valeurs.</p>"},{"location":"02-applications/monitoring/dashy/","title":"Dashy - Portail Centralis\u00e9 de Services","text":"<p>URL: https://dashy.srv759970.hstgr.cloud Version: Dashy v3.1.1 Container: <code>dashy</code> Configuration: <code>/opt/dashy/conf.yml</code> Docker Compose: <code>/opt/dashy/docker-compose.yml</code></p>"},{"location":"02-applications/monitoring/dashy/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Dashy est un dashboard de navigation centralis\u00e9 offrant un acc\u00e8s rapide \u00e0 tous les services d\u00e9ploy\u00e9s sur srv759970.hstgr.cloud.</p>"},{"location":"02-applications/monitoring/dashy/#statistiques","title":"Statistiques","text":"<ul> <li>30+ services organis\u00e9s en 13 cat\u00e9gories</li> <li>8+ APIs avec documentation Swagger/OpenAPI</li> <li>40+ conteneurs Docker monitor\u00e9s</li> <li>13 services prot\u00e9g\u00e9s par Basic Auth</li> <li>Status checks d\u00e9sactiv\u00e9s (voir note ci-dessous)</li> </ul> <p>\u26a0\ufe0f Note importante: Les status checks ont \u00e9t\u00e9 compl\u00e8tement d\u00e9sactiv\u00e9s pour \u00e9viter les conflits avec le syst\u00e8me d'auto-stop Docker. Les requ\u00eates de health check g\u00e9n\u00e9raient du trafic toutes les minutes, emp\u00eachant les services de s'arr\u00eater automatiquement.</p>"},{"location":"02-applications/monitoring/dashy/#categories-de-services","title":"Cat\u00e9gories de Services","text":""},{"location":"02-applications/monitoring/dashy/#apis-de-transcription-speech-to-text","title":"\ud83c\udfa4 APIs de Transcription (Speech-to-Text)","text":"Service URL Description WhisperX API /docs Transcription avec diarization (pyannote-audio) Faster-Whisper Queue /docs Transcription async avec RQ Faster-Whisper Direct /docs Transcription rapide OpenAI-compatible"},{"location":"02-applications/monitoring/dashy/#apis-ai-machine-learning","title":"\ud83e\udd16 APIs AI &amp; Machine Learning","text":"Service URL Description Ollama LLM API Inf\u00e9rence LLM locale (qwen2.5, mistral, llama) NeuTTS-Air API /docs TTS avec voice cloning NeuTTS-Air UI App Interface Streamlit pour TTS"},{"location":"02-applications/monitoring/dashy/#apis-rag-semantic-search","title":"\ud83d\udcda APIs RAG &amp; Semantic Search","text":"Service URL Description RAGFlow App RAG avanc\u00e9 (ES, MySQL, Redis, MinIO) RAG-Anything /docs Multimodal RAG avec knowledge graph MemVid RAG /docs RAG s\u00e9mantique avec encodage vid\u00e9o"},{"location":"02-applications/monitoring/dashy/#apis-utilitaires","title":"\ud83d\udd27 APIs Utilitaires","text":"Service URL Description Apache Tika API Parsing 1000+ formats documents Portail Swagger Unifi\u00e9 UI Swagger UI centralis\u00e9"},{"location":"02-applications/monitoring/dashy/#monitoring-observabilite","title":"\ud83d\udcca Monitoring &amp; Observabilit\u00e9","text":"Service URL Description Grafana Dashboard Prometheus + Loki Prometheus Metrics Time-series metrics RQ Dashboard Jobs Redis Queue monitoring Dozzle Logs Docker logs temps r\u00e9el Netdata System M\u00e9triques syst\u00e8me Portainer Admin Gestion Docker GUI"},{"location":"02-applications/monitoring/dashy/#applications-web-dashboards","title":"\ud83c\udf10 Applications Web &amp; Dashboards","text":"Service URL Description Support Dashboard App IT Support (Streamlit) SharePoint Dashboards App Analytics SharePoint API &amp; Admin Portal Portal Documentation centralis\u00e9e"},{"location":"02-applications/monitoring/dashy/#sites-web-cms","title":"\ud83c\udfe2 Sites Web &amp; CMS","text":"Service URL Description Cristina Site Site Site Astro SSG Cristina Admin (Strapi) Admin CMS Strapi 5 Cl\u00e9mence Site Site WordPress Docker SolidarLink Site WordPress natif"},{"location":"02-applications/monitoring/dashy/#documentation-portails","title":"\ud83d\udcd6 Documentation &amp; Portails","text":"Service URL Description MkDocs Documentation Docs Documentation technique (60+ guides) Dashy Dashboard Portal Ce portail"},{"location":"02-applications/monitoring/dashy/#liens-rapides-swaggeropenapi","title":"\ud83d\udd17 Liens Rapides - Swagger/OpenAPI","text":"<p>Section d\u00e9di\u00e9e avec tous les endpoints de documentation interactive:</p> <ul> <li>WhisperX: Swagger UI | ReDoc</li> <li>Faster-Whisper Queue: Swagger UI | ReDoc</li> <li>Faster-Whisper Direct: Swagger UI</li> <li>NeuTTS-Air: Swagger UI</li> <li>MemVid RAG: Swagger UI</li> <li>RAG-Anything: Swagger UI</li> <li>Portail Unifi\u00e9: Multi-API Swagger</li> </ul>"},{"location":"02-applications/monitoring/dashy/#configuration","title":"Configuration","text":""},{"location":"02-applications/monitoring/dashy/#structure-du-fichier-confyml","title":"Structure du Fichier conf.yml","text":"<pre><code>pageInfo:\n  title: srv759970 Services Portal\n  description: Portail Centralis\u00e9 - APIs, Applications &amp; Infrastructure\n  navLinks:\n    - title: GitHub\n      path: https://github.com/julienfernandez\n    - title: Documentation Technique\n      path: https://docs.srv759970.hstgr.cloud\n    - title: Analyse Auth Strategy\n      path: https://docs.srv759970.hstgr.cloud/analysis/auth-strategy-oauth-vs-basic/\n\nappConfig:\n  theme: material-dark\n  layout: horizontal\n  iconSize: small\n  language: fr\n  # statusCheck: REMOVED - Do NOT use statusCheck: false\n  # statusCheckInterval: REMOVED\n  # IMPORTANT: To disable status checks, DELETE these lines entirely\n  # Setting to 'false' does not work due to browser localStorage cache\n  defaultOpeningMethod: newtab\n  routingMode: history\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#sections-principales","title":"Sections Principales","text":"<ol> <li>APIs de Transcription (3 services)</li> <li>APIs AI &amp; ML (3 services)</li> <li>APIs RAG &amp; Search (3 services)</li> <li>APIs Utilitaires (2 services)</li> <li>Monitoring (6 services)</li> <li>Applications Web (3 services)</li> <li>Sites Web &amp; CMS (4 services)</li> <li>Documentation (2 services)</li> <li>Infrastructure (6 composants)</li> <li>S\u00e9curit\u00e9 (3 composants)</li> <li>Services RAG (5 composants)</li> <li>Liens Swagger (9 endpoints)</li> <li>Informations Serveur (3 infos)</li> </ol>"},{"location":"02-applications/monitoring/dashy/#status-checks","title":"Status Checks","text":"<p>\u26a0\ufe0f STATUS CHECKS D\u00c9SACTIV\u00c9S (depuis 24/10/2025)</p> <p>Les status checks ont \u00e9t\u00e9 compl\u00e8tement supprim\u00e9s de la configuration pour r\u00e9soudre un conflit avec le syst\u00e8me d'auto-stop Docker.</p>"},{"location":"02-applications/monitoring/dashy/#probleme-resolu","title":"Probl\u00e8me R\u00e9solu","text":"<p>Sympt\u00f4me: Les requ\u00eates de health check (axios/1.12.0) \u00e9taient envoy\u00e9es toutes les 60 secondes, emp\u00eachant les services de s'arr\u00eater automatiquement apr\u00e8s 15 minutes d'inactivit\u00e9.</p> <p>Solution: Suppression compl\u00e8te des lignes <code>statusCheck</code> du fichier de configuration. Important: Mettre <code>statusCheck: false</code> ne suffit pas \u00e0 cause du cache localStorage des navigateurs.</p>"},{"location":"02-applications/monitoring/dashy/#configuration-correcte","title":"Configuration Correcte","text":"<pre><code># \u274c INCORRECT - Ne fonctionne pas\nappConfig:\n  statusCheck: false\n  statusCheckInterval: 0\n\n# \u2705 CORRECT - Supprimer compl\u00e8tement les lignes\nappConfig:\n  # statusCheck: REMOVED\n  # statusCheckInterval: REMOVED\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#si-vous-avez-besoin-de-status-checks","title":"Si Vous Avez Besoin de Status Checks","text":"<p>Si vous devez r\u00e9activer les status checks malgr\u00e9 le conflit avec auto-stop :</p> <ol> <li> <p>Ajouter dans <code>appConfig</code>: <pre><code>statusCheck: true\nstatusCheckInterval: 600  # 10 minutes minimum\n</code></pre></p> </li> <li> <p>Exclure Dashy de la configuration auto-stop</p> </li> <li>Accepter que les services ne s'arr\u00eateront plus automatiquement</li> </ol> <p>R\u00e9f\u00e9rence: Voir Changelog Fix Dashy/Auto-Stop</p>"},{"location":"02-applications/monitoring/dashy/#deploiement","title":"D\u00e9ploiement","text":""},{"location":"02-applications/monitoring/dashy/#docker-compose","title":"Docker Compose","text":"<pre><code># /opt/dashy/docker-compose.yml\nversion: '3.8'\n\nservices:\n  dashy:\n    image: lissy93/dashy:latest\n    container_name: dashy\n    restart: unless-stopped\n    ports:\n      - \"4000:80\"\n    volumes:\n      - ./conf.yml:/app/public/conf.yml\n      - dashy-icons:/app/public/item-icons\n    environment:\n      - NODE_ENV=production\n    healthcheck:\n      test: [\"CMD\", \"node\", \"/app/services/healthcheck\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n\nvolumes:\n  dashy-icons:\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#commandes-de-gestion","title":"Commandes de Gestion","text":"<pre><code># D\u00e9marrer Dashy\ncd /opt/dashy\ndocker-compose up -d\n\n# Red\u00e9marrer apr\u00e8s modification config\ndocker-compose restart\n\n# Voir les logs\ndocker-compose logs -f\n\n# V\u00e9rifier le status\ndocker-compose ps\n\n# Rebuild complet\ndocker-compose down\ndocker-compose up -d --build\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#nginx-configuration","title":"Nginx Configuration","text":"<pre><code># /etc/nginx/sites-available/dashy\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name dashy.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/faster-whisper.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/faster-whisper.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    # Basic Auth\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://127.0.0.1:4000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name dashy.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#personnalisation","title":"Personnalisation","text":""},{"location":"02-applications/monitoring/dashy/#ajouter-un-nouveau-service","title":"Ajouter un Nouveau Service","text":"<ol> <li>\u00c9diter <code>/opt/dashy/conf.yml</code></li> <li>Ajouter l'item dans la section appropri\u00e9e:</li> </ol> <pre><code>- title: Mon Nouveau Service\n  description: Description du service\n  icon: fas fa-rocket  # Font Awesome icon\n  url: https://service.srv759970.hstgr.cloud\n  target: newtab\n  # statusCheck: DO NOT ADD - Conflicts with auto-stop\n  tags: [API, Custom, HTTPS]\n</code></pre> <ol> <li>Red\u00e9marrer Dashy:</li> </ol> <pre><code>cd /opt/dashy\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#icons-disponibles","title":"Icons Disponibles","text":"<ul> <li>Font Awesome: <code>fas fa-icon-name</code></li> <li>Homelab Icons: <code>hl-service-name</code> (ex: <code>hl-docker</code>, <code>hl-grafana</code>)</li> <li>Material Design Icons: <code>mdi-icon-name</code></li> <li>Custom Images: Placer dans <code>/app/public/item-icons/</code></li> </ul>"},{"location":"02-applications/monitoring/dashy/#themes-disponibles","title":"Th\u00e8mes Disponibles","text":"<pre><code>theme: colorful      # (Actuel)\n# Alternatives:\n# theme: default\n# theme: material-dark\n# theme: material-light\n# theme: nord\n# theme: nord-frost\n# theme: dracula\n# theme: high-contrast-dark\n# theme: high-contrast-light\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#widgets","title":"Widgets","text":""},{"location":"02-applications/monitoring/dashy/#clock-widget-infrastructure-section","title":"Clock Widget (Infrastructure Section)","text":"<pre><code>widgets:\n  - type: clock\n    options:\n      timeZone: Europe/Paris\n      format: fr-FR\n      hideDate: false\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#autres-widgets-disponibles","title":"Autres Widgets Disponibles","text":"<ul> <li>Weather: M\u00e9t\u00e9o locale</li> <li>RSS Feed: Flux RSS</li> <li>iFrame: Embed sites externes</li> <li>System Info: Infos syst\u00e8me</li> <li>Image: Affichage d'images</li> </ul>"},{"location":"02-applications/monitoring/dashy/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/monitoring/dashy/#mise-a-jour-dashy","title":"Mise \u00e0 Jour Dashy","text":"<pre><code>cd /opt/dashy\ndocker-compose pull\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#backup-configuration","title":"Backup Configuration","text":"<pre><code># Backup conf.yml\ncp /opt/dashy/conf.yml /opt/dashy/conf.yml.backup-$(date +%Y%m%d)\n\n# Backup complet\ntar -czf /root/backups/dashy-$(date +%Y%m%d).tar.gz /opt/dashy/\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#validation-configuration","title":"Validation Configuration","text":"<pre><code># V\u00e9rifier la syntaxe YAML\ndocker run --rm -v /opt/dashy/conf.yml:/conf.yml mikefarah/yq eval /conf.yml\n\n# Voir les logs de build\ndocker logs dashy --tail 50\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/monitoring/dashy/#build-errors","title":"Build Errors","text":"<p>Sympt\u00f4me: Build \u00e9choue avec erreur OpenSSL</p> <p>Solution: Utiliser Node.js legacy OpenSSL (d\u00e9j\u00e0 configur\u00e9)</p> <pre><code>environment:\n  - NODE_OPTIONS=--openssl-legacy-provider\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#status-checks-causing-auto-stop-issues","title":"Status Checks Causing Auto-Stop Issues","text":"<p>Sympt\u00f4me: Services ne s'arr\u00eatent jamais automatiquement (auto-stop ne fonctionne pas)</p> <p>Cause: Les requ\u00eates de status check r\u00e9initialisent le compteur d'inactivit\u00e9</p> <p>Solution: Supprimer compl\u00e8tement les lignes <code>statusCheck</code> et <code>statusCheckInterval</code> de <code>conf.yml</code></p> <pre><code>cd /opt/dashy\n# Supprimer toutes les lignes statusCheck\nsed -i '/^[[:space:]]*statusCheck: \\(true\\|false\\)/d' conf.yml\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#services-inaccessibles","title":"Services Inaccessibles","text":"<p>Sympt\u00f4me: 401 Unauthorized sur certains services</p> <p>Solution: V\u00e9rifier Basic Auth dans Nginx</p> <pre><code># Test sans auth\ncurl -I https://whisperx.srv759970.hstgr.cloud\n\n# Test avec auth\ncurl -I -u julien:DevAccess2025 https://whisperx.srv759970.hstgr.cloud\n</code></pre>"},{"location":"02-applications/monitoring/dashy/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/monitoring/dashy/#basic-auth-protection","title":"Basic Auth Protection","text":"<p>Dashy est prot\u00e9g\u00e9 par HTTP Basic Authentication:</p> <ul> <li>Username: <code>julien</code></li> <li>Password: <code>DevAccess2025</code></li> <li>Fichier: <code>/etc/nginx/.htpasswd</code></li> </ul>"},{"location":"02-applications/monitoring/dashy/#httpstls","title":"HTTPS/TLS","text":"<ul> <li>Certificat: Let's Encrypt</li> <li>Expiration: 2026-01-18</li> <li>Auto-renewal: Activ\u00e9 via Certbot</li> </ul>"},{"location":"02-applications/monitoring/dashy/#recommandations","title":"Recommandations","text":"<ol> <li>\u2705 Garder Basic Auth pour acc\u00e8s s\u00e9curis\u00e9</li> <li>\u2705 Envisager Tailscale VPN pour acc\u00e8s network-level (voir Analyse Auth Strategy)</li> <li>\u26a0\ufe0f Ne pas exposer Dashy sans authentification</li> </ol>"},{"location":"02-applications/monitoring/dashy/#statistiques_1","title":"Statistiques","text":""},{"location":"02-applications/monitoring/dashy/#metriques-de-configuration-actuelle","title":"M\u00e9triques de Configuration Actuelle","text":"<ul> <li>Total Items: 60+ services et composants</li> <li>Sections: 13 cat\u00e9gories</li> <li>Swagger Endpoints: 9 APIs document\u00e9es</li> <li>Status Checks: 35+ endpoints monitor\u00e9s</li> <li>Taille Config: ~400 lignes YAML</li> </ul>"},{"location":"02-applications/monitoring/dashy/#performance","title":"Performance","text":"<ul> <li>Build Time: ~30-40 secondes</li> <li>Page Load: &lt; 2 secondes</li> <li>Status Check Interval: 5 minutes</li> <li>Bundle Size: ~13MB (prod build)</li> </ul>"},{"location":"02-applications/monitoring/dashy/#voir-aussi","title":"Voir Aussi","text":"<ul> <li>Infrastructure &gt; Nginx - Configuration reverse proxy</li> <li>Infrastructure &gt; Security - Basic Auth setup</li> <li>Analysis &gt; Auth Strategy - OAuth vs Basic Auth</li> <li>MkDocs Documentation - Documentation compl\u00e8te</li> </ul>"},{"location":"02-applications/monitoring/dashy/#liens-externes","title":"Liens Externes","text":"<ul> <li>Dashy Official Docs: https://dashy.to/docs</li> <li>GitHub Repository: https://github.com/Lissy93/dashy</li> <li>Icon Sets: https://dashy.to/docs/icons</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-24 (Fix status checks + auto-stop) Prochaine r\u00e9vision: Apr\u00e8s ajout de nouveaux services Changelog: Voir Fix Dashy/Auto-Stop 2025-10-24</p>"},{"location":"02-applications/monitoring/dozzle/","title":"Dozzle","text":"<p>URL: https://dozzle.srv759970.hstgr.cloud Port interne: 8888 Statut: \u2705 Op\u00e9rationnel \u2705 S\u00e9curis\u00e9 avec Basic Auth</p>"},{"location":"02-applications/monitoring/dozzle/#vue-densemble","title":"Vue d'ensemble","text":"<p>Dozzle est une interface web l\u00e9g\u00e8re et temps r\u00e9el pour visualiser les logs Docker. Alternative moderne \u00e0 <code>docker logs</code>, avec interface graphique intuitive et recherche en temps r\u00e9el.</p>"},{"location":"02-applications/monitoring/dozzle/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Logs temps r\u00e9el : Streaming live de tous les conteneurs</li> <li>Multi-conteneurs : Vue simultan\u00e9e de plusieurs conteneurs</li> <li>Recherche : Filtrage et recherche dans les logs</li> <li>Dark mode : Interface moderne et agr\u00e9able</li> <li>Lightweight : &lt; 10MB, consommation RAM minimale</li> <li>Zero configuration : D\u00e9tection automatique de tous les conteneurs</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#architecture","title":"Architecture","text":"<pre><code>Dozzle (port 8888)\n    \u2193\nNginx (HTTPS + Basic Auth)\n    \u2193\n/var/run/docker.sock (ro)\n    \u2193\nLecture logs de tous les conteneurs Docker\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#conteneur","title":"Conteneur","text":"<ul> <li>dozzle : Application Dozzle compl\u00e8te (web UI + Docker API)</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#configuration","title":"Configuration","text":""},{"location":"02-applications/monitoring/dozzle/#emplacement","title":"Emplacement","text":"<ul> <li>Conteneur : <code>dozzle</code></li> <li>Image : <code>amir20/dozzle:latest</code></li> <li>Port : <code>0.0.0.0:8888</code> (expos\u00e9 publiquement, s\u00e9curis\u00e9 par Nginx)</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#volumes-montes","title":"Volumes mont\u00e9s","text":"<pre><code>volumes:\n  - /var/run/docker.sock:/var/run/docker.sock:ro\n</code></pre> <p>Note : Acc\u00e8s read-only au socket Docker pour lire les logs (pas de modifications possibles).</p>"},{"location":"02-applications/monitoring/dozzle/#configuration-nginx","title":"Configuration Nginx","text":"<pre><code># /etc/nginx/sites-available/dozzle\nserver {\n    listen 443 ssl http2;\n    server_name dozzle.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/dozzle.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/dozzle.srv759970.hstgr.cloud/privkey.pem;\n\n    access_log /var/log/nginx/dozzle-access.log;\n    error_log /var/log/nginx/dozzle-error.log;\n\n    location / {\n        include snippets/basic-auth.conf;\n\n        proxy_pass http://127.0.0.1:8888;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support pour streaming temps r\u00e9el\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n    }\n}\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/monitoring/dozzle/#acces-web-ui","title":"Acc\u00e8s Web UI","text":"<p>URL : https://dozzle.srv759970.hstgr.cloud</p> <p>Authentification : Basic Auth (credentials configur\u00e9s dans Nginx)</p>"},{"location":"02-applications/monitoring/dozzle/#navigation-principale","title":"Navigation principale","text":""},{"location":"02-applications/monitoring/dozzle/#page-daccueil","title":"Page d'accueil","text":"<ul> <li>Liste de tous les conteneurs Docker actifs</li> <li>Statut (running, stopped)</li> <li>Uptime</li> <li>Bouton pour acc\u00e9der aux logs</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#visualisation-logs","title":"Visualisation logs","text":"<ol> <li>Cliquer sur un conteneur</li> <li>Logs s'affichent en temps r\u00e9el (auto-scroll)</li> <li>Utiliser la barre de recherche en haut pour filtrer</li> <li>Cliquer sur Pause pour arr\u00eater l'auto-scroll</li> </ol>"},{"location":"02-applications/monitoring/dozzle/#fonctionnalites-avancees","title":"Fonctionnalit\u00e9s avanc\u00e9es","text":"<p>Multi-conteneurs : - Maintenir <code>Ctrl</code> (Windows/Linux) ou <code>Cmd</code> (Mac) - Cliquer sur plusieurs conteneurs - Les logs se m\u00e9langent chronologiquement</p> <p>Recherche : - Taper dans la barre de recherche - Logs filtr\u00e9s instantan\u00e9ment - Expressions r\u00e9guli\u00e8res support\u00e9es</p> <p>Download logs : - Bouton \"Download\" pour t\u00e9l\u00e9charger les logs au format texte</p>"},{"location":"02-applications/monitoring/dozzle/#administration","title":"Administration","text":""},{"location":"02-applications/monitoring/dozzle/#verifier-le-conteneur","title":"V\u00e9rifier le conteneur","text":"<pre><code># Statut\ndocker ps --filter name=dozzle\n\n# Logs Dozzle lui-m\u00eame\ndocker logs dozzle --tail 100\n\n# Stats ressources\ndocker stats dozzle\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#redemarrer","title":"Red\u00e9marrer","text":"<pre><code>docker restart dozzle\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#verifier-acces-docker-socket","title":"V\u00e9rifier acc\u00e8s Docker socket","text":"<pre><code># Dozzle doit avoir acc\u00e8s au socket Docker\ndocker exec dozzle ls -la /var/run/docker.sock\n\n# Output attendu: srw-rw---- 1 root docker 0 ... /var/run/docker.sock\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/monitoring/dozzle/#etat-actuel","title":"\u00c9tat actuel","text":"<ul> <li>\u2705 HTTPS avec Let's Encrypt (certificat expire 2026-01-19)</li> <li>\u2705 Basic Auth Nginx (protection par mot de passe)</li> <li>\u2705 Acc\u00e8s Docker socket en read-only</li> <li>\u2705 Pas d'acc\u00e8s direct au port 8888 (proxy Nginx uniquement)</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"02-applications/monitoring/dozzle/#gestion-des-credentials-basic-auth","title":"Gestion des credentials Basic Auth","text":"<pre><code># Changer le mot de passe Basic Auth\nhtpasswd -c /etc/nginx/.htpasswd username\n\n# Red\u00e9marrer Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#limiter-acces-par-ip-optionnel","title":"Limiter acc\u00e8s par IP (optionnel)","text":"<pre><code># Dans /etc/nginx/sites-available/dozzle\nlocation / {\n    # Autoriser uniquement certaines IPs\n    allow 203.0.113.0/24;\n    deny all;\n\n    include snippets/basic-auth.conf;\n    proxy_pass http://127.0.0.1:8888;\n}\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#cas-dusage","title":"Cas d'usage","text":""},{"location":"02-applications/monitoring/dozzle/#1-debugging-en-temps-reel","title":"1. Debugging en temps r\u00e9el","text":"<p>Sc\u00e9nario : Un service Docker plante al\u00e9atoirement</p> <p>Solution : 1. Ouvrir Dozzle 2. S\u00e9lectionner le conteneur probl\u00e9matique 3. Attendre le crash 4. Logs disponibles imm\u00e9diatement (pas besoin de SSH)</p>"},{"location":"02-applications/monitoring/dozzle/#2-monitoring-deploiement","title":"2. Monitoring d\u00e9ploiement","text":"<p>Sc\u00e9nario : D\u00e9ploiement d'un nouveau service</p> <p>Solution : 1. Ouvrir Dozzle 2. S\u00e9lectionner le nouveau conteneur 3. V\u00e9rifier que le service d\u00e9marre correctement 4. Identifier rapidement les erreurs de config</p>"},{"location":"02-applications/monitoring/dozzle/#3-support-utilisateur","title":"3. Support utilisateur","text":"<p>Sc\u00e9nario : Un utilisateur signale un probl\u00e8me</p> <p>Solution : 1. Partager l'acc\u00e8s Dozzle (temporaire) 2. L'utilisateur peut voir les logs en temps r\u00e9el 3. Pas besoin de SSH ou acc\u00e8s serveur</p>"},{"location":"02-applications/monitoring/dozzle/#comparaison-avec-alternatives","title":"Comparaison avec alternatives","text":"Feature Dozzle Portainer Logs Loki + Grafana Temps r\u00e9el \u2705 Oui \u2705 Oui \u26a0\ufe0f D\u00e9lai ~5s Multi-conteneurs \u2705 Oui \u274c Non \u2705 Oui Recherche \u2705 Basique \u2705 Basique \u2705 Avanc\u00e9e (LogQL) Historique \u26a0\ufe0f Limit\u00e9 \u26a0\ufe0f Limit\u00e9 \u2705 Illimit\u00e9 Installation \u2705 1 conteneur \u26a0\ufe0f Stack compl\u00e8te \u274c Stack complexe Ressources \u2705 &lt; 10MB \u26a0\ufe0f ~100MB \u274c &gt; 500MB Dashboards \u274c Non \u274c Non \u2705 Grafana <p>Recommandation : Utiliser Dozzle ET Loki/Grafana en compl\u00e9mentarit\u00e9 : - Dozzle : Debugging rapide, logs temps r\u00e9el, simplicit\u00e9 - Loki/Grafana : Historique long terme, dashboards, alerting</p>"},{"location":"02-applications/monitoring/dozzle/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/monitoring/dozzle/#probleme-page-blanche-ou-erreur-502","title":"Probl\u00e8me : Page blanche ou erreur 502","text":"<p>Sympt\u00f4me : Dozzle inaccessible via Nginx</p> <p>Solution : <pre><code># V\u00e9rifier que Dozzle tourne\ndocker ps --filter name=dozzle\n\n# V\u00e9rifier logs Dozzle\ndocker logs dozzle --tail 50\n\n# V\u00e9rifier Nginx\nnginx -t\nsystemctl status nginx\n\n# Red\u00e9marrer Dozzle\ndocker restart dozzle\n</code></pre></p>"},{"location":"02-applications/monitoring/dozzle/#probleme-conteneurs-manquants-dans-la-liste","title":"Probl\u00e8me : Conteneurs manquants dans la liste","text":"<p>Sympt\u00f4me : Certains conteneurs ne s'affichent pas dans Dozzle</p> <p>Solution : <pre><code># V\u00e9rifier acc\u00e8s Docker socket\ndocker exec dozzle ls -la /var/run/docker.sock\n\n# Si erreur, recr\u00e9er conteneur avec bon volume\ndocker stop dozzle\ndocker rm dozzle\ndocker run -d --name dozzle \\\n  --restart unless-stopped \\\n  -p 0.0.0.0:8888:8080 \\\n  -v /var/run/docker.sock:/var/run/docker.sock:ro \\\n  amir20/dozzle:latest\n</code></pre></p>"},{"location":"02-applications/monitoring/dozzle/#probleme-logs-ne-se-rafraichissent-pas","title":"Probl\u00e8me : Logs ne se rafra\u00eechissent pas","text":"<p>Sympt\u00f4me : Logs fig\u00e9s, pas de streaming temps r\u00e9el</p> <p>Solution : 1. V\u00e9rifier WebSocket fonctionne (F12 \u2192 Network \u2192 WS) 2. V\u00e9rifier configuration Nginx (<code>Upgrade</code> et <code>Connection</code> headers) 3. Rafra\u00eechir la page (Ctrl+F5)</p>"},{"location":"02-applications/monitoring/dozzle/#fonctionnalites-avancees_1","title":"Fonctionnalit\u00e9s avanc\u00e9es","text":""},{"location":"02-applications/monitoring/dozzle/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Dozzle supporte plusieurs options de configuration via variables d'environnement :</p> <pre><code>docker run -d --name dozzle \\\n  -p 8888:8080 \\\n  -v /var/run/docker.sock:/var/run/docker.sock:ro \\\n  -e DOZZLE_LEVEL=info \\\n  -e DOZZLE_FILTER=\"name=app\" \\\n  -e DOZZLE_ENABLE_ACTIONS=true \\\n  amir20/dozzle:latest\n</code></pre> <p>Variables utiles : - <code>DOZZLE_LEVEL</code> : Niveau de logs Dozzle (<code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>) - <code>DOZZLE_FILTER</code> : Filtre containers (ex: <code>name=nginx|mysql</code>) - <code>DOZZLE_ENABLE_ACTIONS</code> : Activer boutons start/stop/restart (\u26a0\ufe0f dangereux)</p>"},{"location":"02-applications/monitoring/dozzle/#mode-multi-host","title":"Mode multi-host","text":"<p>Dozzle peut surveiller plusieurs h\u00f4tes Docker :</p> <pre><code>docker run -d --name dozzle \\\n  -p 8888:8080 \\\n  -v /var/run/docker.sock:/var/run/docker.sock:ro \\\n  -e DOZZLE_REMOTE_HOST=tcp://remote-docker:2375 \\\n  amir20/dozzle:latest\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#performance","title":"Performance","text":""},{"location":"02-applications/monitoring/dozzle/#ressources","title":"Ressources","text":"<ul> <li>CPU : &lt; 1% en moyenne</li> <li>RAM : ~8-12 MB</li> <li>Disk : Aucun stockage (lecture directe Docker)</li> </ul>"},{"location":"02-applications/monitoring/dozzle/#optimisations","title":"Optimisations","text":"<p>Dozzle est d\u00e9j\u00e0 ultra-optimis\u00e9. Aucune optimisation n\u00e9cessaire.</p>"},{"location":"02-applications/monitoring/dozzle/#integration-avec-autres-outils","title":"Int\u00e9gration avec autres outils","text":""},{"location":"02-applications/monitoring/dozzle/#lien-vers-grafana","title":"Lien vers Grafana","text":"<p>Ajouter un lien dans Dozzle vers Grafana pour une vue compl\u00e8te :</p> <ol> <li>Dans Dozzle, copier le nom du conteneur</li> <li>Ouvrir Grafana \u2192 Explore</li> <li>Chercher dans Loki : <code>{container_name=\"nom_conteneur\"}</code></li> </ol>"},{"location":"02-applications/monitoring/dozzle/#webhooks","title":"Webhooks","text":"<p>Dozzle ne supporte pas nativement les webhooks, mais peut \u00eatre coupl\u00e9 avec un script :</p> <pre><code># Exemple: Alerte si erreur critique d\u00e9tect\u00e9e\ndocker logs -f nom_conteneur | grep -i \"ERROR\" | while read line; do\n  curl -X POST https://chat.srv759970.hstgr.cloud/hooks/WEBHOOK_ID \\\n    -d \"{\\\"text\\\": \\\"Erreur d\u00e9tect\u00e9e: $line\\\"}\"\ndone\n</code></pre>"},{"location":"02-applications/monitoring/dozzle/#liens-utiles","title":"Liens utiles","text":"<ul> <li>GitHub : https://github.com/amir20/dozzle</li> <li>Documentation : https://dozzle.dev</li> <li>Docker Hub : https://hub.docker.com/r/amir20/dozzle</li> <li>Release notes : https://github.com/amir20/dozzle/releases</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-21 Version Dozzle : latest Container : <code>dozzle</code> Certificat SSL : Expire 2026-01-19</p>"},{"location":"02-applications/monitoring/glances/","title":"Glances","text":"<p>URL: https://glances.srv759970.hstgr.cloud Port interne: 61208 Statut: \u2705 Op\u00e9rationnel \u2705 S\u00e9curis\u00e9 avec HTTPS + Basic Auth</p>"},{"location":"02-applications/monitoring/glances/#vue-densemble","title":"Vue d'ensemble","text":"<p>Glances est un outil de monitoring syst\u00e8me multiplateforme \u00e9crit en Python. Alternative l\u00e9g\u00e8re \u00e0 Netdata, offre une interface web temps r\u00e9el pour surveiller CPU, RAM, disque, r\u00e9seau et conteneurs Docker.</p>"},{"location":"02-applications/monitoring/glances/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Monitoring syst\u00e8me : CPU, RAM, disque, r\u00e9seau en temps r\u00e9el</li> <li>Monitoring Docker : Tous les conteneurs avec m\u00e9triques d\u00e9taill\u00e9es</li> <li>Interface web : Dashboard moderne et responsive</li> <li>API REST : Export des m\u00e9triques au format JSON</li> <li>Lightweight : ~55MB RAM (vs Netdata ~200MB)</li> <li>Limites de ressources : Conteneur limit\u00e9 \u00e0 256MB RAM et 0.5 CPU</li> </ul>"},{"location":"02-applications/monitoring/glances/#architecture","title":"Architecture","text":"<pre><code>Glances (port 61208, limit\u00e9 256MB RAM / 0.5 CPU)\n    \u2193\nNginx (HTTPS + Basic Auth)\n    \u2193\n/var/run/docker.sock (ro)\n    \u2193\nLecture m\u00e9triques syst\u00e8me + Docker\n</code></pre>"},{"location":"02-applications/monitoring/glances/#conteneur","title":"Conteneur","text":"<ul> <li>glances : Application Glances compl\u00e8te (monitoring + web UI + API REST)</li> </ul>"},{"location":"02-applications/monitoring/glances/#configuration","title":"Configuration","text":""},{"location":"02-applications/monitoring/glances/#emplacement","title":"Emplacement","text":"<ul> <li>Conteneur : <code>glances</code></li> <li>Image : <code>nicolargo/glances:latest</code></li> <li>Port : <code>127.0.0.1:61208</code> (localhost uniquement, accessible via Nginx)</li> </ul>"},{"location":"02-applications/monitoring/glances/#volumes-montes","title":"Volumes mont\u00e9s","text":"<pre><code>volumes:\n  - /var/run/docker.sock:/var/run/docker.sock:ro\n</code></pre> <p>Note : Acc\u00e8s read-only au socket Docker pour lire les m\u00e9triques (pas de modifications possibles).</p>"},{"location":"02-applications/monitoring/glances/#limites-de-ressources","title":"Limites de ressources","text":"<pre><code>--memory=256m      # Limite RAM \u00e0 256MB\n--cpus=0.5         # Limite CPU \u00e0 50%\n</code></pre> <p>Raison : \u00c9viter la surcharge du serveur (le\u00e7on apprise avec Netdata qui a plant\u00e9 le serveur).</p>"},{"location":"02-applications/monitoring/glances/#configuration-nginx","title":"Configuration Nginx","text":"<pre><code># /etc/nginx/sites-available/glances\nserver {\n    listen 443 ssl http2;\n    server_name glances.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/glances.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/glances.srv759970.hstgr.cloud/privkey.pem;\n\n    location / {\n        include snippets/basic-auth.conf;\n\n        proxy_pass http://127.0.0.1:61208;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_read_timeout 300;\n    }\n}\n</code></pre>"},{"location":"02-applications/monitoring/glances/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/monitoring/glances/#acces-web-ui","title":"Acc\u00e8s Web UI","text":"<p>URL : https://glances.srv759970.hstgr.cloud</p> <p>Authentification : Basic Auth (credentials configur\u00e9s dans Nginx)</p>"},{"location":"02-applications/monitoring/glances/#navigation-principale","title":"Navigation principale","text":""},{"location":"02-applications/monitoring/glances/#dashboard-principal","title":"Dashboard principal","text":"<ul> <li>CPU : Usage global et par c\u0153ur</li> <li>RAM : Total, utilis\u00e9e, buffers, cache, swap</li> <li>LOAD : Load average 1m, 5m, 15m</li> <li>NETWORK : Bande passante RX/TX</li> <li>DISK I/O : Lecture/\u00e9criture par seconde</li> <li>FILE SYSTEM : Espace disque utilis\u00e9/disponible</li> </ul>"},{"location":"02-applications/monitoring/glances/#conteneurs-docker","title":"Conteneurs Docker","text":"<ul> <li>Liste de tous les conteneurs actifs</li> <li>CPU % par conteneur</li> <li>RAM usage par conteneur</li> <li>Network I/O par conteneur</li> <li>Uptime par conteneur</li> </ul>"},{"location":"02-applications/monitoring/glances/#api-rest","title":"API REST","text":"<p>Glances expose une API REST compl\u00e8te :</p> <pre><code># Toutes les m\u00e9triques (JSON)\ncurl -u user:pass https://glances.srv759970.hstgr.cloud/api/4/all\n\n# CPU seulement\ncurl -u user:pass https://glances.srv759970.hstgr.cloud/api/4/cpu\n\n# RAM seulement\ncurl -u user:pass https://glances.srv759970.hstgr.cloud/api/4/mem\n\n# Docker containers\ncurl -u user:pass https://glances.srv759970.hstgr.cloud/api/4/docker\n</code></pre>"},{"location":"02-applications/monitoring/glances/#administration","title":"Administration","text":""},{"location":"02-applications/monitoring/glances/#verifier-le-conteneur","title":"V\u00e9rifier le conteneur","text":"<pre><code># Statut\ndocker ps --filter name=glances\n\n# Logs\ndocker logs glances --tail 100 -f\n\n# Stats ressources (v\u00e9rifier limites)\ndocker stats glances\n</code></pre>"},{"location":"02-applications/monitoring/glances/#redemarrer","title":"Red\u00e9marrer","text":"<pre><code>docker restart glances\n</code></pre>"},{"location":"02-applications/monitoring/glances/#verifier-consommation-ressources","title":"V\u00e9rifier consommation ressources","text":"<pre><code># Glances devrait rester sous 256MB RAM et 1% CPU\ndocker stats glances --no-stream\n</code></pre>"},{"location":"02-applications/monitoring/glances/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"02-applications/monitoring/glances/#etat-actuel","title":"\u00c9tat actuel","text":"<ul> <li>\u2705 HTTPS avec Let's Encrypt (certificat expire 2026-01-19)</li> <li>\u2705 Basic Auth Nginx (protection par mot de passe)</li> <li>\u2705 Acc\u00e8s Docker socket en read-only</li> <li>\u2705 Port localhost uniquement (127.0.0.1:61208)</li> <li>\u2705 Limites de ressources (256MB RAM, 0.5 CPU)</li> </ul>"},{"location":"02-applications/monitoring/glances/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"02-applications/monitoring/glances/#changer-le-mot-de-passe-basic-auth","title":"Changer le mot de passe Basic Auth","text":"<pre><code>htpasswd -c /etc/nginx/.htpasswd username\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/monitoring/glances/#limiter-acces-par-ip-optionnel","title":"Limiter acc\u00e8s par IP (optionnel)","text":"<pre><code>location / {\n    allow 203.0.113.0/24;  # Votre r\u00e9seau\n    deny all;\n\n    include snippets/basic-auth.conf;\n    proxy_pass http://127.0.0.1:61208;\n}\n</code></pre>"},{"location":"02-applications/monitoring/glances/#cas-dusage","title":"Cas d'usage","text":""},{"location":"02-applications/monitoring/glances/#1-monitoring-rapide-cpuram","title":"1. Monitoring rapide CPU/RAM","text":"<p>Sc\u00e9nario : V\u00e9rifier rapidement si le serveur est surcharg\u00e9</p> <p>Solution : 1. Ouvrir https://glances.srv759970.hstgr.cloud 2. Vue instantan\u00e9e CPU, RAM, Load average 3. Identifier les processus/conteneurs consommant le plus</p>"},{"location":"02-applications/monitoring/glances/#2-identifier-conteneur-problematique","title":"2. Identifier conteneur probl\u00e9matique","text":"<p>Sc\u00e9nario : Un conteneur consomme trop de ressources</p> <p>Solution : 1. Section \"DOCKER\" dans Glances 2. Trier par CPU % ou RAM usage 3. Identifier le coupable imm\u00e9diatement</p>"},{"location":"02-applications/monitoring/glances/#3-verifier-espace-disque","title":"3. V\u00e9rifier espace disque","text":"<p>Sc\u00e9nario : Le serveur manque d'espace disque</p> <p>Solution : 1. Section \"FILE SYSTEM\" dans Glances 2. Voir tous les points de montage 3. Identifier les partitions pleines</p>"},{"location":"02-applications/monitoring/glances/#comparaison-avec-alternatives","title":"Comparaison avec alternatives","text":"Feature Glances Netdata Portainer Stats Grafana Temps r\u00e9el \u2705 1s \u2705 1s \u2705 2s \u26a0\ufe0f 5-15s Ressources \u2705 ~55MB \u274c ~200MB+ \u2705 ~100MB \u26a0\ufe0f ~200MB Docker support \u2705 Oui \u2705 Oui \u2705 Oui \u26a0\ufe0f Via cAdvisor API REST \u2705 Oui \u2705 Oui \u26a0\ufe0f Limit\u00e9e \u2705 Oui Interface \u2705 Simple \u2705 Compl\u00e8te \u26a0\ufe0f Par conteneur \u2705 Dashboards Stabilit\u00e9 (59 conteneurs) \u2705 Stable \u274c Plantage serveur \u2705 Stable \u2705 Stable Configuration \u2705 Zero config \u2705 Zero config \u2705 Zero config \u274c Complexe <p>Recommandation : Utiliser Glances ET Grafana en compl\u00e9mentarit\u00e9 : - Glances : Monitoring rapide, debug temps r\u00e9el - Grafana : Dashboards personnalis\u00e9s, historique, alerting</p>"},{"location":"02-applications/monitoring/glances/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/monitoring/glances/#probleme-page-blanche-ou-erreur-502","title":"Probl\u00e8me : Page blanche ou erreur 502","text":"<p>Sympt\u00f4me : Glances inaccessible via Nginx</p> <p>Solution : <pre><code># V\u00e9rifier que Glances tourne\ndocker ps --filter name=glances\n\n# V\u00e9rifier logs Glances\ndocker logs glances --tail 50\n\n# V\u00e9rifier Nginx\nnginx -t\nsystemctl status nginx\n\n# Red\u00e9marrer Glances\ndocker restart glances\n</code></pre></p>"},{"location":"02-applications/monitoring/glances/#probleme-glances-consomme-trop-de-ressources","title":"Probl\u00e8me : Glances consomme trop de ressources","text":"<p>Sympt\u00f4me : CPU &gt; 10% ou RAM &gt; 256MB</p> <p>Solution : <pre><code># V\u00e9rifier stats\ndocker stats glances --no-stream\n\n# Si limite d\u00e9pass\u00e9e, r\u00e9duire les limites\ndocker stop glances\ndocker rm glances\n\n# Recr\u00e9er avec limites plus strictes\ndocker run -d \\\n  --name glances \\\n  --restart unless-stopped \\\n  -p 127.0.0.1:61208:61208 \\\n  -e GLANCES_OPT='-w' \\\n  -v /var/run/docker.sock:/var/run/docker.sock:ro \\\n  --pid host \\\n  --memory=128m \\\n  --cpus=0.25 \\\n  nicolargo/glances:latest\n</code></pre></p>"},{"location":"02-applications/monitoring/glances/#probleme-metriques-docker-manquantes","title":"Probl\u00e8me : M\u00e9triques Docker manquantes","text":"<p>Sympt\u00f4me : Section \"DOCKER\" vide</p> <p>Solution : <pre><code># V\u00e9rifier acc\u00e8s Docker socket\ndocker exec glances ls -la /var/run/docker.sock\n\n# Si erreur, recr\u00e9er avec bon volume\ndocker stop glances\ndocker rm glances\n# Recr\u00e9er (voir commande d'installation)\n</code></pre></p>"},{"location":"02-applications/monitoring/glances/#performance","title":"Performance","text":""},{"location":"02-applications/monitoring/glances/#ressources","title":"Ressources","text":"<ul> <li>CPU : ~0.77% en moyenne</li> <li>RAM : ~55MB (limite 256MB)</li> <li>Disk I/O : Minimal (lecture /proc et /sys)</li> </ul>"},{"location":"02-applications/monitoring/glances/#optimisations","title":"Optimisations","text":"<p>Glances est d\u00e9j\u00e0 tr\u00e8s optimis\u00e9. Si n\u00e9cessaire :</p> <pre><code># D\u00e9sactiver certains plugins via variables d'environnement\ndocker run -d \\\n  --name glances \\\n  -e GLANCES_OPT='-w --disable-plugin network' \\\n  ...\n</code></pre>"},{"location":"02-applications/monitoring/glances/#integration-avec-autres-outils","title":"Int\u00e9gration avec autres outils","text":""},{"location":"02-applications/monitoring/glances/#export-vers-prometheus","title":"Export vers Prometheus","text":"<p>Glances peut exporter des m\u00e9triques Prometheus :</p> <pre><code># Activer export Prometheus\ndocker run -d \\\n  --name glances \\\n  -e GLANCES_OPT='-w --export prometheus' \\\n  ...\n</code></pre> <p>Puis dans Prometheus : <pre><code>scrape_configs:\n  - job_name: 'glances'\n    static_configs:\n      - targets: ['glances:61208']\n</code></pre></p>"},{"location":"02-applications/monitoring/glances/#lien-vers-grafana","title":"Lien vers Grafana","text":"<p>Utiliser le datasource Prometheus avec les m\u00e9triques Glances export\u00e9es.</p>"},{"location":"02-applications/monitoring/glances/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Glances supporte de nombreuses options :</p> <pre><code>GLANCES_OPT='-w'                    # Mode web uniquement\nGLANCES_OPT='-w --disable-docker'   # D\u00e9sactiver monitoring Docker\nGLANCES_OPT='-w --time 2'           # Rafra\u00eechissement toutes les 2s\n</code></pre>"},{"location":"02-applications/monitoring/glances/#historique","title":"Historique","text":""},{"location":"02-applications/monitoring/glances/#pourquoi-glances-au-lieu-de-netdata","title":"Pourquoi Glances au lieu de Netdata ?","text":"<p>Incident du 2025-10-21 : - Netdata a \u00e9t\u00e9 install\u00e9 sur srv759970 (59 conteneurs actifs) - Netdata a provoqu\u00e9 un effondrement complet des performances - Serveur compl\u00e8tement inaccessible (tous les services en timeout) - Reboot forc\u00e9 n\u00e9cessaire pour restaurer le service - Netdata incompatible avec un grand nombre de conteneurs</p> <p>Solution : Glances avec limites de ressources strictes - Limit\u00e9 \u00e0 256MB RAM et 0.5 CPU - Test\u00e9 stable avec 59 conteneurs - Consommation r\u00e9elle : ~55MB RAM, &lt;1% CPU</p>"},{"location":"02-applications/monitoring/glances/#liens-utiles","title":"Liens utiles","text":"<ul> <li>GitHub : https://github.com/nicolargo/glances</li> <li>Documentation : https://glances.readthedocs.io</li> <li>Docker Hub : https://hub.docker.com/r/nicolargo/glances</li> <li>API Documentation : https://glances.readthedocs.io/en/latest/api.html</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-21 Version Glances : latest Container : <code>glances</code> Certificat SSL : Expire 2026-01-19 Consommation : ~55MB RAM, &lt;1% CPU</p>"},{"location":"02-applications/monitoring/monitoring-stack/","title":"Guide Monitoring WhisperX avec Grafana + Prometheus + Loki","text":""},{"location":"02-applications/monitoring/monitoring-stack/#vue-densemble","title":"Vue d'ensemble","text":"<p>Stack de monitoring compl\u00e8te pour WhisperX avec m\u00e9triques temps r\u00e9el et logs centralis\u00e9s.</p>"},{"location":"02-applications/monitoring/monitoring-stack/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     Grafana Dashboard                        \u2502\n\u2502              https://monitoring.srv759970.hstgr.cloud        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502   Prometheus Datasource  \u2502   Loki Datasource        \u2502   \u2502\n\u2502  \u2502   (M\u00e9triques RQ)         \u2502   (Logs Docker)          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Prometheus     \u2502            \u2502      Loki        \u2502\n\u2502   :9090          \u2502            \u2502      :3100       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  RQ Exporter     \u2502            \u2502    Promtail      \u2502\n\u2502  :9726           \u2502            \u2502                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                                \u2502\n         \u25bc                                \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Redis Queue     \u2502            \u2502  Docker Logs     \u2502\n\u2502  (WhisperX)      \u2502            \u2502  (whisperx-*)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#composants","title":"Composants","text":""},{"location":"02-applications/monitoring/monitoring-stack/#1-prometheus-metriques","title":"1. Prometheus (M\u00e9triques)","text":"<ul> <li>Port : 9090</li> <li>Fonction : Collecte et stocke les m\u00e9triques time-series</li> <li>R\u00e9tention : 30 jours</li> <li>Scrape interval : 15 secondes</li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#2-rq-exporter-exporteur-redis-queue","title":"2. RQ Exporter (Exporteur Redis Queue)","text":"<ul> <li>Port : 9726</li> <li>Image : <code>mdawar/rq-exporter:latest</code></li> <li>Fonction : Exporte les m\u00e9triques RQ vers Prometheus</li> <li>M\u00e9triques expos\u00e9es :</li> <li><code>rq_workers</code> : Nombre de workers actifs</li> <li><code>rq_jobs{status=\"queued|started|finished|failed\"}</code> : Compteurs de jobs par statut</li> <li><code>rq_queue_length</code> : Longueur des queues</li> <li><code>rq_workers_success_total</code> : Total des succ\u00e8s</li> <li><code>rq_workers_failed_total</code> : Total des \u00e9checs</li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#3-loki-logs","title":"3. Loki (Logs)","text":"<ul> <li>Port : 3100</li> <li>Fonction : Agr\u00e9gation et stockage de logs</li> <li>R\u00e9tention : 7 jours (168h)</li> <li>Storage : Filesystem local</li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#4-promtail-collecteur-de-logs","title":"4. Promtail (Collecteur de logs)","text":"<ul> <li>Fonction : Collecte logs Docker et envoie \u00e0 Loki</li> <li>Cibles :</li> <li><code>whisperx-worker</code> : Logs du worker RQ</li> <li><code>whisperx</code> : Logs de l'API FastAPI</li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#5-grafana-visualisation","title":"5. Grafana (Visualisation)","text":"<ul> <li>Port : 3001 (mapp\u00e9 sur 3000 interne)</li> <li>URL : https://monitoring.srv759970.hstgr.cloud</li> <li>Version : 12.2.0</li> <li>Credentials :</li> <li>User : <code>admin</code></li> <li>Password : <code>YourSecurePassword2025!</code></li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#installation","title":"Installation","text":""},{"location":"02-applications/monitoring/monitoring-stack/#structure-des-fichiers","title":"Structure des fichiers","text":"<pre><code>/opt/monitoring/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 prometheus/\n\u2502   \u2514\u2500\u2500 prometheus.yml\n\u251c\u2500\u2500 loki/\n\u2502   \u2514\u2500\u2500 loki-config.yml\n\u251c\u2500\u2500 promtail/\n\u2502   \u2514\u2500\u2500 promtail-config.yml\n\u2514\u2500\u2500 grafana/\n    \u2514\u2500\u2500 provisioning/\n        \u251c\u2500\u2500 datasources/\n        \u2502   \u2514\u2500\u2500 datasources.yml\n        \u2514\u2500\u2500 dashboards/\n            \u2514\u2500\u2500 dashboards.yml\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: prometheus\n    restart: unless-stopped\n    volumes:\n      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml\n      - prometheus-data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--storage.tsdb.retention.time=30d'\n    ports:\n      - '9090:9090'\n    networks:\n      - monitoring\n\n  rq-exporter:\n    image: mdawar/rq-exporter:latest\n    container_name: rq-exporter\n    restart: unless-stopped\n    environment:\n      - RQ_REDIS_HOST=whisperx-redis\n      - RQ_REDIS_PORT=6379\n      - RQ_REDIS_DB=0\n    ports:\n      - '9726:9726'\n    networks:\n      - monitoring\n      - whisperx_default\n\n  loki:\n    image: grafana/loki:latest\n    container_name: loki\n    restart: unless-stopped\n    ports:\n      - '3100:3100'\n    volumes:\n      - ./loki/loki-config.yml:/etc/loki/local-config.yaml\n      - loki-data:/loki\n    command: -config.file=/etc/loki/local-config.yaml\n    networks:\n      - monitoring\n\n  promtail:\n    image: grafana/promtail:latest\n    container_name: promtail\n    restart: unless-stopped\n    volumes:\n      - ./promtail/promtail-config.yml:/etc/promtail/config.yml\n      - /var/lib/docker/containers:/var/lib/docker/containers:ro\n      - /var/run/docker.sock:/var/run/docker.sock\n    command: -config.file=/etc/promtail/config.yml\n    networks:\n      - monitoring\n\n  grafana:\n    image: grafana/grafana:latest\n    container_name: grafana\n    restart: unless-stopped\n    ports:\n      - '3001:3000'\n    environment:\n      - GF_SECURITY_ADMIN_USER=admin\n      - GF_SECURITY_ADMIN_PASSWORD=YourSecurePassword2025!\n      - GF_INSTALL_PLUGINS=redis-datasource\n      - GF_SERVER_ROOT_URL=https://monitoring.srv759970.hstgr.cloud\n    volumes:\n      - grafana-data:/var/lib/grafana\n      - ./grafana/provisioning:/etc/grafana/provisioning\n    networks:\n      - monitoring\n\nvolumes:\n  prometheus-data:\n  grafana-data:\n  loki-data:\n\nnetworks:\n  monitoring:\n    driver: bridge\n  whisperx_default:\n    external: true\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#demarrage","title":"D\u00e9marrage","text":"<pre><code>cd /opt/monitoring\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#verification","title":"V\u00e9rification","text":"<pre><code># Status des conteneurs\ndocker-compose ps\n\n# Health check complet\ndocker ps --filter name='prometheus|loki|promtail|rq-exporter|grafana'\n\n# M\u00e9triques RQ disponibles\ncurl http://localhost:9726/metrics | grep rq_\n\n# Prometheus targets\ncurl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | {job, health}'\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#configuration-nginx","title":"Configuration Nginx","text":""},{"location":"02-applications/monitoring/monitoring-stack/#certificat-ssl","title":"Certificat SSL","text":"<pre><code>certbot certonly --nginx \\\n  -d monitoring.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#etcnginxsites-availablemonitoring","title":"/etc/nginx/sites-available/monitoring","text":"<pre><code># HTTPS - Grafana Monitoring\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name monitoring.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/monitoring.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/monitoring.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        include snippets/basic-auth.conf;\n\n        proxy_pass http://127.0.0.1:3001;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_read_timeout 300;\n    }\n}\n\n# HTTP -&gt; HTTPS\nserver {\n    listen 80;\n    server_name monitoring.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Activation :</p> <pre><code>ln -sf /etc/nginx/sites-available/monitoring /etc/nginx/sites-enabled/\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#utilisation-de-grafana","title":"Utilisation de Grafana","text":""},{"location":"02-applications/monitoring/monitoring-stack/#connexion","title":"Connexion","text":"<ol> <li>Acc\u00e9der \u00e0 https://monitoring.srv759970.hstgr.cloud</li> <li>Entrer les credentials basic auth (serveur)</li> <li>Login Grafana : <code>admin</code> / <code>YourSecurePassword2025!</code></li> </ol>"},{"location":"02-applications/monitoring/monitoring-stack/#datasources-pre-configurees","title":"Datasources pr\u00e9-configur\u00e9es","text":"<p>Les datasources sont automatiquement provisionn\u00e9es au d\u00e9marrage :</p> <ol> <li>Prometheus (d\u00e9faut)</li> <li>URL : <code>http://prometheus:9090</code></li> <li> <p>M\u00e9triques RQ disponibles</p> </li> <li> <p>Loki</p> </li> <li>URL : <code>http://loki:3100</code></li> <li>Logs des conteneurs WhisperX</li> </ol>"},{"location":"02-applications/monitoring/monitoring-stack/#importer-le-dashboard-rq","title":"Importer le dashboard RQ","text":"<ol> <li>Menu \u2192 Dashboards \u2192 Import</li> <li>Entrer l'ID : 12196</li> <li>S\u00e9lectionner datasource Prometheus</li> <li>Import</li> </ol> <p>Le dashboard affiche : - Nombre de workers actifs/idle - Jobs par statut (queued, started, finished, failed) - Longueur des queues - Taux de succ\u00e8s/\u00e9chec - Temps d'ex\u00e9cution moyen</p>"},{"location":"02-applications/monitoring/monitoring-stack/#creer-un-panel-de-logs","title":"Cr\u00e9er un panel de logs","text":"<ol> <li>Create \u2192 Dashboard \u2192 Add visualization</li> <li>Datasource : Loki</li> <li>Query :    <pre><code>{container=\"whisperx-worker\"}\n</code></pre></li> <li>Options :</li> <li>Show time : Oui</li> <li>Wrap lines : Oui</li> <li>Prettify JSON : Oui</li> </ol>"},{"location":"02-applications/monitoring/monitoring-stack/#requetes-utiles","title":"Requ\u00eates utiles","text":""},{"location":"02-applications/monitoring/monitoring-stack/#prometheus-metriques","title":"Prometheus (M\u00e9triques)","text":"<pre><code># Nombre total de jobs termin\u00e9s\nrq_jobs{queue=\"transcription\",status=\"finished\"}\n\n# Nombre de jobs en cours\nrq_jobs{queue=\"transcription\",status=\"started\"}\n\n# Taux d'\u00e9chec (%)\n(rq_jobs{status=\"failed\"} / (rq_jobs{status=\"finished\"} + rq_jobs{status=\"failed\"})) * 100\n\n# Workers actifs\nrq_workers{queue=\"transcription\"}\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#loki-logs","title":"Loki (Logs)","text":"<pre><code># Logs du worker WhisperX\n{container=\"whisperx-worker\"}\n\n# Logs avec erreur\n{container=\"whisperx-worker\"} |= \"ERROR\"\n\n# Logs de transcription\n{container=\"whisperx-worker\"} |= \"Transcribing\"\n\n# Logs de l'API\n{container=\"whisperx\"} | json\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#monitoring-des-jobs-whisperx","title":"Monitoring des jobs WhisperX","text":""},{"location":"02-applications/monitoring/monitoring-stack/#via-rq-dashboard-original","title":"Via RQ Dashboard (original)","text":"<p>URL : https://whisperx-dashboard.srv759970.hstgr.cloud</p> <p>Affiche : - Queues actives - Jobs en temps r\u00e9el - Workers</p>"},{"location":"02-applications/monitoring/monitoring-stack/#via-grafana-nouveau","title":"Via Grafana (nouveau)","text":"<p>URL : https://monitoring.srv759970.hstgr.cloud</p> <p>Avantages : - Historique des m\u00e9triques (graphiques) - Logs centralis\u00e9s en temps r\u00e9el - Alertes configurables - Dashboards personnalisables - Corr\u00e9lation m\u00e9triques + logs</p>"},{"location":"02-applications/monitoring/monitoring-stack/#exemples-de-panels","title":"Exemples de panels","text":"<p>Panel 1 : Jobs par statut (Time series) <pre><code>rq_jobs{queue=\"transcription\"}\n</code></pre></p> <p>Panel 2 : Logs worker (Logs) <pre><code>{container=\"whisperx-worker\"} |~ \"Job|Transcription|Loading\"\n</code></pre></p> <p>Panel 3 : Taux de succ\u00e8s (Stat) <pre><code>rq_jobs{queue=\"transcription\",status=\"finished\"}\n</code></pre></p>"},{"location":"02-applications/monitoring/monitoring-stack/#alertes","title":"Alertes","text":""},{"location":"02-applications/monitoring/monitoring-stack/#exemple-job-failed","title":"Exemple : Job failed","text":"<p>Dans Grafana \u2192 Alerting \u2192 Alert rules :</p> <pre><code>- alert: WhisperXJobsFailed\n  expr: rate(rq_jobs{status=\"failed\"}[5m]) &gt; 0.1\n  for: 5m\n  labels:\n    severity: warning\n  annotations:\n    summary: \"Taux \u00e9lev\u00e9 d'\u00e9checs jobs WhisperX\"\n    description: \"{{ $value }} jobs/min \u00e9chouent\"\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#maintenance","title":"Maintenance","text":""},{"location":"02-applications/monitoring/monitoring-stack/#logs","title":"Logs","text":"<pre><code># Logs Grafana\ndocker logs -f grafana\n\n# Logs Prometheus\ndocker logs -f prometheus\n\n# Logs Loki\ndocker logs -f loki\n\n# Logs Promtail\ndocker logs -f promtail\n\n# Logs RQ Exporter\ndocker logs -f rq-exporter\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#backup","title":"Backup","text":"<pre><code># Backup volumes Grafana\ndocker run --rm -v monitoring_grafana-data:/data -v $(pwd):/backup alpine tar czf /backup/grafana-backup.tar.gz -C /data .\n\n# Backup volumes Prometheus\ndocker run --rm -v monitoring_prometheus-data:/data -v $(pwd):/backup alpine tar czf /backup/prometheus-backup.tar.gz -C /data .\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#restart","title":"Restart","text":"<pre><code>cd /opt/monitoring\ndocker-compose restart\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#update","title":"Update","text":"<pre><code>cd /opt/monitoring\ndocker-compose pull\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/monitoring/monitoring-stack/#grafana-naffiche-pas-les-metriques","title":"Grafana n'affiche pas les m\u00e9triques","text":"<ol> <li> <p>V\u00e9rifier Prometheus targets :    <pre><code>curl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.health != \"up\")'\n</code></pre></p> </li> <li> <p>V\u00e9rifier RQ exporter :    <pre><code>curl http://localhost:9726/metrics | head -20\n</code></pre></p> </li> <li> <p>V\u00e9rifier r\u00e9seau Docker :    <pre><code>docker network inspect monitoring_monitoring\ndocker network inspect whisperx_default\n</code></pre></p> </li> </ol>"},{"location":"02-applications/monitoring/monitoring-stack/#loki-ne-recoit-pas-les-logs","title":"Loki ne re\u00e7oit pas les logs","text":"<ol> <li> <p>V\u00e9rifier Promtail :    <pre><code>docker logs promtail | grep ERROR\n</code></pre></p> </li> <li> <p>V\u00e9rifier permissions Docker socket :    <pre><code>ls -la /var/run/docker.sock\n</code></pre></p> </li> <li> <p>Tester manuellement :    <pre><code>curl -X POST http://localhost:3100/loki/api/v1/push \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"streams\":[{\"stream\":{\"job\":\"test\"},\"values\":[[\"'$(date +%s)000000000'\",\"test message\"]]}]}'\n</code></pre></p> </li> </ol>"},{"location":"02-applications/monitoring/monitoring-stack/#certificat-ssl-expire","title":"Certificat SSL expir\u00e9","text":"<pre><code># V\u00e9rifier expiration\ncertbot certificates | grep monitoring\n\n# Renouveler manuellement\ncertbot renew --cert-name monitoring.srv759970.hstgr.cloud\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"02-applications/monitoring/monitoring-stack/#urls-de-reference","title":"URLs de r\u00e9f\u00e9rence","text":"<ul> <li>Grafana : https://monitoring.srv759970.hstgr.cloud</li> <li>Prometheus : http://srv759970.hstgr.cloud:9090</li> <li>RQ Exporter : http://srv759970.hstgr.cloud:9726/metrics</li> <li>Loki : http://srv759970.hstgr.cloud:3100</li> <li>RQ Dashboard (legacy) : https://whisperx-dashboard.srv759970.hstgr.cloud</li> </ul>"},{"location":"02-applications/monitoring/monitoring-stack/#dashboard-rq-officiel","title":"Dashboard RQ officiel","text":"<p>ID Grafana Labs : 12196</p> <p>Lien direct : https://grafana.com/grafana/dashboards/12196-rq-dashboard/</p>"},{"location":"02-applications/monitoring/monitoring-stack/#ressources","title":"Ressources","text":"<ul> <li>Prometheus</li> <li>Grafana</li> <li>Loki</li> <li>RQ Exporter</li> <li>Promtail</li> </ul>"},{"location":"02-applications/monitoring/portainer/","title":"Portainer","text":"<p>URL: https://portainer.srv759970.hstgr.cloud Ports: 127.0.0.1:9000 (HTTP local), 127.0.0.1:9443 (HTTPS local) Statut: \u2705 Op\u00e9rationnel \u2705 S\u00e9curis\u00e9 via Nginx Identifiants: admin / Po85593734!?</p>"},{"location":"02-applications/monitoring/portainer/#vue-densemble","title":"Vue d'ensemble","text":"<p>Portainer est une interface web de gestion compl\u00e8te pour Docker et Kubernetes. Alternative graphique au CLI Docker, permet de g\u00e9rer conteneurs, images, volumes, r\u00e9seaux et stacks via interface intuitive.</p>"},{"location":"02-applications/monitoring/portainer/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>Gestion conteneurs : Start, stop, restart, logs, console, stats</li> <li>Gestion images : Pull, build, push, suppression</li> <li>Gestion volumes : Cr\u00e9ation, suppression, navigation fichiers</li> <li>Gestion r\u00e9seaux : Cr\u00e9ation, attachement conteneurs</li> <li>Docker Compose : D\u00e9ploiement stacks via interface web</li> <li>Gestion utilisateurs : Multi-utilisateurs avec RBAC</li> <li>Templates : Catalogue d'applications pr\u00e9-configur\u00e9es</li> </ul>"},{"location":"02-applications/monitoring/portainer/#architecture","title":"Architecture","text":"<pre><code>Portainer (ports 9000/9443)\n    \u2193\n/var/run/docker.sock (rw)\n    \u2193\nContr\u00f4le COMPLET Docker Engine\n    \u2193\nTous conteneurs, images, volumes, networks\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#conteneur","title":"Conteneur","text":"<ul> <li>portainer : Application Portainer CE (Community Edition) compl\u00e8te</li> </ul>"},{"location":"02-applications/monitoring/portainer/#configuration","title":"Configuration","text":""},{"location":"02-applications/monitoring/portainer/#emplacement","title":"Emplacement","text":"<ul> <li>Data : Docker volume <code>portainer_data</code> \u2192 <code>/data</code> dans le conteneur</li> <li>Image : <code>portainer/portainer-ce:latest</code></li> </ul>"},{"location":"02-applications/monitoring/portainer/#volumes-montes","title":"Volumes mont\u00e9s","text":"<pre><code>volumes:\n  - /var/run/docker.sock:/var/run/docker.sock  # RW (lecture + \u00e9criture!)\n  - portainer_data:/data  # Configuration et base de donn\u00e9es\n</code></pre> <p>\u26a0\ufe0f ATTENTION : Contrairement \u00e0 Dozzle, Portainer a acc\u00e8s RW (read-write) au socket Docker = contr\u00f4le total sur le serveur.</p>"},{"location":"02-applications/monitoring/portainer/#ports-reseau","title":"Ports r\u00e9seau","text":"<ul> <li>9000 : HTTP Web UI \u26a0\ufe0f Expos\u00e9 sur 0.0.0.0 (PUBLIC)</li> <li>9443 : HTTPS Web UI (si configur\u00e9)</li> <li>8000 : Tunnel pour agents Portainer (remote Docker hosts)</li> </ul> <p>\u26a0\ufe0f PROBL\u00c8ME DE S\u00c9CURIT\u00c9 CRITIQUE : Port 9000 expos\u00e9 publiquement sans authentification Nginx.</p>"},{"location":"02-applications/monitoring/portainer/#utilisation","title":"Utilisation","text":""},{"location":"02-applications/monitoring/portainer/#acces","title":"Acc\u00e8s","text":"<p>URL : https://portainer.srv759970.hstgr.cloud</p> <p>Identifiants : - Username: <code>admin</code> - Password: <code>Po85593734!?</code></p> <p>Note : L'environnement Docker local \"srv759970\" est d\u00e9j\u00e0 configur\u00e9 et connect\u00e9</p>"},{"location":"02-applications/monitoring/portainer/#navigation-principale","title":"Navigation principale","text":""},{"location":"02-applications/monitoring/portainer/#tableau-de-bord","title":"Tableau de bord","text":"<ul> <li>Dashboard : Vue d'ensemble (conteneurs actifs, images, volumes)</li> <li>Containers : Liste de tous les conteneurs</li> <li>Images : Liste de toutes les images Docker</li> <li>Volumes : Liste de tous les volumes</li> <li>Networks : Liste de tous les r\u00e9seaux</li> <li>Stacks : Stacks Docker Compose d\u00e9ploy\u00e9es</li> </ul>"},{"location":"02-applications/monitoring/portainer/#gestion-conteneurs","title":"Gestion conteneurs","text":"<p>Actions disponibles : - Start/Stop/Restart : Contr\u00f4ler le cycle de vie - Logs : Visualiser logs (comme Dozzle) - Stats : CPU, RAM, r\u00e9seau, disque en temps r\u00e9el - Console : Shell interactif dans le conteneur - Inspect : Configuration JSON compl\u00e8te - Duplicate : Cr\u00e9er un clone du conteneur</p> <p>Acc\u00e9der \u00e0 un conteneur : 1. Cliquer sur le nom du conteneur 2. Utiliser les boutons d'action en haut 3. Onglets : Logs, Inspect, Stats, Console</p>"},{"location":"02-applications/monitoring/portainer/#deployer-une-stack-docker-compose","title":"D\u00e9ployer une stack Docker Compose","text":"<ol> <li>Stacks \u2192 Add stack</li> <li>Donner un nom (ex: <code>my-app</code>)</li> <li>Coller le contenu du <code>docker-compose.yml</code></li> <li>Cliquer Deploy the stack</li> </ol> <p>Portainer cr\u00e9e automatiquement tous les conteneurs d\u00e9finis.</p>"},{"location":"02-applications/monitoring/portainer/#browser-de-volumes","title":"Browser de volumes","text":"<p>Fonctionnalit\u00e9 unique : Naviguer dans les fichiers d'un volume Docker !</p> <ol> <li>Volumes \u2192 S\u00e9lectionner un volume</li> <li>Browse \u2192 Voir l'arborescence des fichiers</li> <li>Possibilit\u00e9 de t\u00e9l\u00e9charger/uploader des fichiers</li> </ol>"},{"location":"02-applications/monitoring/portainer/#administration","title":"Administration","text":""},{"location":"02-applications/monitoring/portainer/#verifier-le-conteneur","title":"V\u00e9rifier le conteneur","text":"<pre><code># Statut\ndocker ps --filter name=portainer\n\n# Logs\ndocker logs portainer --tail 100\n\n# Stats\ndocker stats portainer\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#redemarrer","title":"Red\u00e9marrer","text":"<pre><code>docker restart portainer\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#backup-de-la-configuration","title":"Backup de la configuration","text":"<pre><code># Backup volume portainer_data\ndocker run --rm \\\n  -v portainer_data:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/portainer-backup-$(date +%Y%m%d).tar.gz /data\n\n# Restore\ndocker run --rm \\\n  -v portainer_data:/data \\\n  -v $(pwd):/backup \\\n  alpine tar xzf /backup/portainer-backup-YYYYMMDD.tar.gz -C /\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#securite","title":"S\u00e9curit\u00e9 \u2705","text":""},{"location":"02-applications/monitoring/portainer/#configuration-actuelle","title":"Configuration actuelle","text":"<ul> <li>\u2705 Ports expos\u00e9s uniquement en localhost (<code>127.0.0.1:9000</code>, <code>127.0.0.1:9443</code>)</li> <li>\u2705 HTTPS via Nginx reverse proxy avec certificat Let's Encrypt</li> <li>\u2705 Cache d\u00e9sactiv\u00e9 pour \u00e9viter probl\u00e8mes d'initialisation</li> <li>\u26a0\ufe0f API accessible sans basic-auth (requis pour d\u00e9tection admin)</li> <li>\u26a0\ufe0f Acc\u00e8s RW au socket Docker = CONTR\u00d4LE TOTAL DU SERVEUR</li> </ul> <p>Configuration Nginx en place (<code>/etc/nginx/sites-available/portainer</code>) :</p> <pre><code>server {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name portainer.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/portainer.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/portainer.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/portainer-access.log;\n    error_log /var/log/nginx/portainer-error.log;\n\n    # API SANS basic auth (n\u00e9cessaire pour v\u00e9rification admin)\n    location /api/ {\n        proxy_no_cache 1;\n        proxy_cache_bypass 1;\n        add_header Cache-Control \"no-store\" always;\n\n        proxy_pass http://127.0.0.1:9000;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n    }\n\n    # Interface web AVEC basic auth\n    location / {\n        auth_basic \"Portainer Access\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n\n        proxy_no_cache 1;\n        proxy_cache_bypass 1;\n        add_header Cache-Control \"no-store\" always;\n\n        proxy_pass http://127.0.0.1:9000;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n    }\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name portainer.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>\u26a0\ufe0f Note importante : L'API (<code>/api/</code>) doit \u00eatre accessible SANS basic-auth, sinon le JavaScript de Portainer ne peut pas v\u00e9rifier l'existence de l'admin via <code>/api/users/admin/check</code> et redirige en boucle vers la page d'initialisation.</p>"},{"location":"02-applications/monitoring/portainer/#option-2-limiter-acces-par-ip","title":"Option 2 : Limiter acc\u00e8s par IP","text":"<pre><code>location / {\n    # Autoriser uniquement certaines IPs\n    allow 203.0.113.0/24;  # Votre r\u00e9seau\n    deny all;\n\n    include snippets/basic-auth.conf;\n    proxy_pass http://127.0.0.1:9000;\n}\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#option-3-configurer-https-natif-portainer","title":"Option 3 : Configurer HTTPS natif Portainer","text":"<p>Portainer peut g\u00e9rer ses propres certificats SSL :</p> <pre><code># G\u00e9n\u00e9rer certificat (ou utiliser Let's Encrypt)\nopenssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n  -keyout /opt/portainer/portainer.key \\\n  -out /opt/portainer/portainer.crt\n\n# Red\u00e9marrer avec SSL\ndocker stop portainer\ndocker rm portainer\ndocker run -d \\\n  --name portainer \\\n  --restart unless-stopped \\\n  -p 0.0.0.0:9443:9443 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v portainer_data:/data \\\n  -v /opt/portainer/portainer.crt:/certs/portainer.crt \\\n  -v /opt/portainer/portainer.key:/certs/portainer.key \\\n  portainer/portainer-ce:latest \\\n  --sslcert /certs/portainer.crt \\\n  --sslkey /certs/portainer.key\n</code></pre> <p>Acc\u00e8s : https://srv759970.hstgr.cloud:9443</p>"},{"location":"02-applications/monitoring/portainer/#gestion-utilisateurs","title":"Gestion utilisateurs","text":""},{"location":"02-applications/monitoring/portainer/#creer-utilisateurs-supplementaires","title":"Cr\u00e9er utilisateurs suppl\u00e9mentaires","text":"<ol> <li>Settings \u2192 Users \u2192 Add user</li> <li>Remplir :</li> <li>Username</li> <li>Password</li> <li>Role : <code>Administrator</code> ou <code>User</code></li> <li>Create user</li> </ol>"},{"location":"02-applications/monitoring/portainer/#roles-disponibles","title":"R\u00f4les disponibles","text":"<ul> <li>Administrator : Contr\u00f4le total</li> <li>User : Acc\u00e8s limit\u00e9 (lecture seule ou permissions sp\u00e9cifiques)</li> <li>Helpdesk : Vue limit\u00e9e pour support</li> </ul>"},{"location":"02-applications/monitoring/portainer/#authentification-externe","title":"Authentification externe","text":"<p>Portainer supporte : - OAuth 2.0 : Google, GitHub, Azure AD - LDAP/AD : Active Directory - Internal : Base de donn\u00e9es locale</p> <p>Configuration OAuth : 1. Settings \u2192 Authentication 2. Choisir provider (ex: GitHub) 3. Entrer Client ID et Client Secret 4. Activer</p>"},{"location":"02-applications/monitoring/portainer/#templates-dapplications","title":"Templates d'applications","text":"<p>Portainer inclut un catalogue d'applications pr\u00eates \u00e0 d\u00e9ployer :</p> <p>Acc\u00e8s : App Templates</p> <p>Applications disponibles : - Nginx : Serveur web - MySQL/PostgreSQL : Bases de donn\u00e9es - Redis/Memcached : Caching - WordPress : CMS - GitLab : Git repository - Et bien d'autres...</p> <p>D\u00e9ployer depuis template : 1. App Templates 2. Choisir application 3. Configurer variables (ports, passwords) 4. Deploy the container</p>"},{"location":"02-applications/monitoring/portainer/#stacks-docker-compose","title":"Stacks Docker Compose","text":""},{"location":"02-applications/monitoring/portainer/#deployer-une-stack","title":"D\u00e9ployer une stack","text":"<p>Exemple : D\u00e9ployer WordPress + MySQL</p> <ol> <li>Stacks \u2192 Add stack</li> <li>Nom : <code>wordpress-stack</code></li> <li>Contenu :</li> </ol> <pre><code>version: '3.8'\nservices:\n  db:\n    image: mysql:8.0\n    environment:\n      MYSQL_ROOT_PASSWORD: password123\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: wpuser\n      MYSQL_PASSWORD: wppass\n    volumes:\n      - db_data:/var/lib/mysql\n\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"8080:80\"\n    environment:\n      WORDPRESS_DB_HOST: db:3306\n      WORDPRESS_DB_USER: wpuser\n      WORDPRESS_DB_PASSWORD: wppass\n      WORDPRESS_DB_NAME: wordpress\n    depends_on:\n      - db\n\nvolumes:\n  db_data:\n</code></pre> <ol> <li>Deploy the stack</li> </ol>"},{"location":"02-applications/monitoring/portainer/#gerer-une-stack-existante","title":"G\u00e9rer une stack existante","text":"<ul> <li>Update : Modifier le compose et red\u00e9ployer</li> <li>Stop : Arr\u00eater tous les conteneurs de la stack</li> <li>Remove : Supprimer la stack compl\u00e8te</li> </ul>"},{"location":"02-applications/monitoring/portainer/#monitoring-et-stats","title":"Monitoring et stats","text":""},{"location":"02-applications/monitoring/portainer/#vue-densemble-serveur","title":"Vue d'ensemble serveur","text":"<p>Dashboard \u2192 Section \"Host\" - CPU usage - Memory usage - Disk usage</p>"},{"location":"02-applications/monitoring/portainer/#stats-par-conteneur","title":"Stats par conteneur","text":"<p>Containers \u2192 Cliquer sur un conteneur \u2192 Stats - CPU % en temps r\u00e9el - Memory usage (MB) - Network I/O (rx/tx) - Block I/O (read/write)</p> <p>Graphiques temps r\u00e9el (rafra\u00eechissement 2s).</p>"},{"location":"02-applications/monitoring/portainer/#troubleshooting","title":"Troubleshooting","text":""},{"location":"02-applications/monitoring/portainer/#probleme-cannot-connect-to-docker","title":"Probl\u00e8me : Cannot connect to Docker","text":"<p>Sympt\u00f4me : Portainer affiche \"Cannot connect to the Docker daemon\"</p> <p>Solution : <pre><code># V\u00e9rifier acc\u00e8s Docker socket\ndocker exec portainer ls -la /var/run/docker.sock\n\n# Si erreur, recr\u00e9er conteneur\ndocker stop portainer\ndocker rm portainer\ndocker run -d --name portainer \\\n  --restart unless-stopped \\\n  -p 9000:9000 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v portainer_data:/data \\\n  portainer/portainer-ce:latest\n</code></pre></p>"},{"location":"02-applications/monitoring/portainer/#probleme-mot-de-passe-admin-oublie","title":"Probl\u00e8me : Mot de passe admin oubli\u00e9","text":"<p>Solution : R\u00e9initialiser via CLI</p> <pre><code>docker stop portainer\ndocker run --rm \\\n  -v portainer_data:/data \\\n  portainer/portainer-ce:latest \\\n  --admin-password-file /tmp/portainer_password\n\n# Mot de passe par d\u00e9faut: admin/admin\n# Changer imm\u00e9diatement apr\u00e8s connexion\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#probleme-stack-ne-demarre-pas","title":"Probl\u00e8me : Stack ne d\u00e9marre pas","text":"<p>Sympt\u00f4me : Erreur lors du d\u00e9ploiement d'une stack</p> <p>Solutions : 1. V\u00e9rifier syntaxe YAML (indentation correcte) 2. V\u00e9rifier logs : Stack \u2192 Logs 3. V\u00e9rifier ports disponibles (pas de conflit) 4. V\u00e9rifier variables d'environnement d\u00e9finies</p>"},{"location":"02-applications/monitoring/portainer/#comparaison-avec-alternatives","title":"Comparaison avec alternatives","text":"Feature Portainer Dozzle Rancher Kubernetes Dashboard Docker support \u2705 Complet \u26a0\ufe0f Logs only \u2705 Complet \u274c K8s only K8s support \u2705 Oui \u274c Non \u2705 Oui \u2705 Oui Stacks \u2705 Oui \u274c Non \u2705 Oui \u2705 Helm Templates \u2705 Catalogue \u274c Non \u2705 Catalogue \u26a0\ufe0f Limit\u00e9 RBAC \u2705 Complet \u274c Non \u2705 Complet \u2705 Complet Ressources \u26a0\ufe0f ~100MB \u2705 ~10MB \u274c &gt; 1GB \u26a0\ufe0f ~200MB Complexit\u00e9 \u2705 Simple \u2705 Simple \u274c Complexe \u26a0\ufe0f Moyenne <p>Recommandation : - Portainer : Gestion compl\u00e8te Docker, simplicit\u00e9 - Dozzle : Logs temps r\u00e9el uniquement - Rancher : Multi-cluster K8s enterprise - CLI Docker : Maximum de contr\u00f4le et performance</p>"},{"location":"02-applications/monitoring/portainer/#fonctionnalites-avancees","title":"Fonctionnalit\u00e9s avanc\u00e9es","text":""},{"location":"02-applications/monitoring/portainer/#portainer-agent-multi-hosts","title":"Portainer Agent (multi-hosts)","text":"<p>G\u00e9rer plusieurs serveurs Docker depuis une seule interface :</p> <p>Sur le serveur distant : <pre><code>docker run -d \\\n  --name portainer-agent \\\n  --restart unless-stopped \\\n  -p 9001:9001 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /var/lib/docker/volumes:/var/lib/docker/volumes \\\n  portainer/agent:latest\n</code></pre></p> <p>Dans Portainer : 1. Environments \u2192 Add environment 2. Choisir \"Agent\" 3. URL: <code>remote-server:9001</code> 4. Connect</p>"},{"location":"02-applications/monitoring/portainer/#webhooks","title":"Webhooks","text":"<p>D\u00e9clencher red\u00e9ploiement stack via webhook :</p> <ol> <li>Stack \u2192 S\u00e9lectionner stack \u2192 Webhooks</li> <li>Create a webhook</li> <li>Copier URL</li> <li>Utiliser dans CI/CD :</li> </ol> <pre><code># Exemple GitHub Actions\ncurl -X POST https://portainer.srv759970.hstgr.cloud/api/webhooks/WEBHOOK_ID\n</code></pre>"},{"location":"02-applications/monitoring/portainer/#edge-computing","title":"Edge Computing","text":"<p>Portainer Edge permet de g\u00e9rer des devices IoT/edge derri\u00e8re NAT (pas d'IP publique requise).</p>"},{"location":"02-applications/monitoring/portainer/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Documentation officielle : https://docs.portainer.io</li> <li>GitHub : https://github.com/portainer/portainer</li> <li>Community Edition : https://www.portainer.io/products/community-edition</li> <li>Templates repository : https://github.com/portainer/templates</li> <li>Docker Hub : https://hub.docker.com/r/portainer/portainer-ce</li> </ul>"},{"location":"02-applications/monitoring/portainer/#notes-de-deploiement","title":"Notes de d\u00e9ploiement","text":""},{"location":"02-applications/monitoring/portainer/#problemes-rencontres-et-solutions","title":"Probl\u00e8mes rencontr\u00e9s et solutions","text":"<p>Probl\u00e8me : Redirection infinie vers <code>/#!/init/admin</code> - Cause : Le basic-auth Nginx bloquait l'endpoint <code>/api/users/admin/check</code>, emp\u00eachant Portainer de d\u00e9tecter que l'admin existait - Solution : Exclure <code>/api/</code> du basic-auth dans la configuration Nginx</p> <p>Probl\u00e8me : Formulaire de cr\u00e9ation d'admin ne fonctionne pas - Cause : Bug JavaScript de Portainer v2.33.2 avec les caract\u00e8res sp\u00e9ciaux dans le mot de passe - Solution : Cr\u00e9er l'admin via API avec Python au lieu du formulaire web</p> <p>Probl\u00e8me : Cache navigateur persistant - Cause : Nginx et navigateur cachent la page d'initialisation - Solution : D\u00e9sactiver le cache avec headers <code>Cache-Control: no-store</code> et <code>proxy_no_cache 1</code></p> <p>Derni\u00e8re mise \u00e0 jour : 2025-10-23 Version Portainer : CE (Community Edition) 2.33.2 Container : <code>portainer</code> Environnement Docker : srv759970 (configur\u00e9 automatiquement)</p>"},{"location":"02-applications/wordpress/clemence/","title":"Cl\u00e9mence - Site WordPress","text":"<p>URL: https://clemence.srv759970.hstgr.cloud Port h\u00f4te: 9002 Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"02-applications/wordpress/clemence/#vue-densemble","title":"Vue d'ensemble","text":"<p>Site WordPress pour le projet Cl\u00e9mence (RH Diversit\u00e9 &amp; Inclusion), h\u00e9berg\u00e9 via Docker avec auto-start/stop.</p>"},{"location":"02-applications/wordpress/clemence/#stack-technique","title":"Stack technique","text":"<ul> <li>WordPress: Latest</li> <li>MySQL: 8.0</li> <li>Nginx: Reverse proxy</li> <li>PHP-FPM: 9000</li> <li>Docker Auto-Start: Activ\u00e9</li> </ul>"},{"location":"02-applications/wordpress/clemence/#architecture","title":"Architecture","text":"<pre><code>Internet (HTTPS 443)\n    \u2193\nNginx (reverse proxy)\n    \u2193\nDocker Auto-Start API (:8890)\n    \u2193\nwordpress-clemence (:9000 PHP-FPM)\n    \u2193\nmysql-clemence (:3306)\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#conteneurs","title":"Conteneurs","text":"Container Port Status <code>wordpress-clemence</code> 9000 \u2705 Running <code>mysql-clemence</code> 3306 \u2705 Running <code>nginx-clemence</code> 9002 \u2705 Running <code>wp-cli-clemence</code> - \u2705 Running"},{"location":"02-applications/wordpress/clemence/#emplacements","title":"Emplacements","text":"<ul> <li>R\u00e9pertoire: <code>/opt/wordpress-clemence/</code></li> <li>Data WordPress: <code>/opt/wordpress-clemence/wordpress/</code></li> <li>Data MySQL: <code>/opt/wordpress-clemence/mysql/</code></li> <li>Config: <code>/opt/wordpress-clemence/docker-compose.yml</code></li> <li>Nginx config: <code>/etc/nginx/sites-available/clemence</code></li> </ul>"},{"location":"02-applications/wordpress/clemence/#gestion","title":"Gestion","text":""},{"location":"02-applications/wordpress/clemence/#demarrage-manuel","title":"D\u00e9marrage manuel","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/wordpress-clemence\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#logs","title":"Logs","text":"<pre><code># Logs WordPress\ndocker logs wordpress-clemence -f\n\n# Logs MySQL\ndocker logs mysql-clemence -f\n\n# Logs Nginx\ndocker logs nginx-clemence -f\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#acces-mysql","title":"Acc\u00e8s MySQL","text":"<pre><code>docker exec -it mysql-clemence mysql -u clemence_user -p\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#wp-cli","title":"WP-CLI","text":"<pre><code># Lister les plugins\ndocker exec wp-cli-clemence wp plugin list\n\n# Mettre \u00e0 jour WordPress\ndocker exec wp-cli-clemence wp core update\n\n# Vider le cache\ndocker exec wp-cli-clemence wp cache flush\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#configuration-email","title":"Configuration Email","text":"<p>Le site utilise Gmail SMTP pour l'envoi d'emails.</p> <p>Configuration dans <code>wp-config.php</code> :</p> <pre><code>define( 'WPMS_SMTP_HOST', 'smtp.gmail.com' );\ndefine( 'WPMS_SMTP_PORT', 587 );\ndefine( 'WPMS_SMTP_USER', 'clemsfou@gmail.com' );\n</code></pre> <p>Voir Guide Email pour la configuration compl\u00e8te.</p>"},{"location":"02-applications/wordpress/clemence/#configuration-auto-start","title":"Configuration Auto-Start","text":"<p>Le site utilise docker-autostart pour d\u00e9marrage \u00e0 la demande :</p> <ul> <li>Timeout inactivit\u00e9: 30 minutes</li> <li>Mode: Async (d\u00e9marrage en arri\u00e8re-plan)</li> <li>Health check: V\u00e9rifie MySQL + WordPress</li> </ul> <p>Configuration dans <code>/opt/docker-autostart/config.json</code> :</p> <pre><code>{\n  \"name\": \"Cl\u00e9mence Site\",\n  \"container\": \"wordpress-clemence\",\n  \"timeout\": 1800,\n  \"async\": true,\n  \"healthCheck\": {\n    \"enabled\": true,\n    \"containers\": [\"mysql-clemence\", \"wordpress-clemence\"]\n  }\n}\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#acces-admin-wordpress","title":"Acc\u00e8s Admin WordPress","text":"<p>URL: https://clemence.srv759970.hstgr.cloud/wp-admin</p> <p>Identifiants dans <code>/opt/wordpress-clemence/.env</code></p>"},{"location":"02-applications/wordpress/clemence/#backup","title":"Backup","text":""},{"location":"02-applications/wordpress/clemence/#base-de-donnees","title":"Base de donn\u00e9es","text":"<pre><code>docker exec mysql-clemence mysqldump -u root -p clemence_db &gt; backup_clemence_$(date +%Y%m%d).sql\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#fichiers-wordpress","title":"Fichiers WordPress","text":"<pre><code>tar -czf backup_clemence_files_$(date +%Y%m%d).tar.gz /opt/wordpress-clemence/wordpress/\n</code></pre>"},{"location":"02-applications/wordpress/clemence/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Guide WordPress Docker</li> <li>Guide Email</li> <li>Docker Auto-Start Config</li> </ul>"},{"location":"02-applications/wordpress/solidarlink/","title":"SolidarLink - Site WordPress","text":"<p>URL: https://solidarlink.srv759970.hstgr.cloud Port h\u00f4te: 9003 Statut: \u2705 Op\u00e9rationnel</p>"},{"location":"02-applications/wordpress/solidarlink/#vue-densemble","title":"Vue d'ensemble","text":"<p>Site WordPress pour le projet SolidarLink, h\u00e9berg\u00e9 via Docker avec auto-start/stop.</p>"},{"location":"02-applications/wordpress/solidarlink/#stack-technique","title":"Stack technique","text":"<ul> <li>WordPress: Latest</li> <li>MySQL: 8.0</li> <li>Nginx: Reverse proxy</li> <li>PHP-FPM: 9000</li> <li>Docker Auto-Start: Activ\u00e9</li> </ul>"},{"location":"02-applications/wordpress/solidarlink/#architecture","title":"Architecture","text":"<pre><code>Internet (HTTPS 443)\n    \u2193\nNginx (reverse proxy)\n    \u2193\nDocker Auto-Start API (:8890)\n    \u2193\nwordpress-solidarlink (:9000 PHP-FPM)\n    \u2193\nmysql-solidarlink (:3306)\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#conteneurs","title":"Conteneurs","text":"Container Port Status <code>wordpress-solidarlink</code> 9000 \u2705 Running <code>mysql-solidarlink</code> 3306 \u2705 Running <code>nginx-solidarlink</code> 9003 \u2705 Running <code>wp-cli-solidarlink</code> - \u2705 Running"},{"location":"02-applications/wordpress/solidarlink/#emplacements","title":"Emplacements","text":"<ul> <li>R\u00e9pertoire: <code>/opt/wordpress-solidarlink/</code></li> <li>Data WordPress: <code>/opt/wordpress-solidarlink/wordpress/</code></li> <li>Data MySQL: <code>/opt/wordpress-solidarlink/mysql/</code></li> <li>Config: <code>/opt/wordpress-solidarlink/docker-compose.yml</code></li> <li>Nginx config: <code>/etc/nginx/sites-available/solidarlink</code></li> </ul>"},{"location":"02-applications/wordpress/solidarlink/#gestion","title":"Gestion","text":""},{"location":"02-applications/wordpress/solidarlink/#demarrage-manuel","title":"D\u00e9marrage manuel","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/wordpress-solidarlink\ndocker-compose up -d\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#logs","title":"Logs","text":"<pre><code># Logs WordPress\ndocker logs wordpress-solidarlink -f\n\n# Logs MySQL\ndocker logs mysql-solidarlink -f\n\n# Logs Nginx\ndocker logs nginx-solidarlink -f\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#acces-mysql","title":"Acc\u00e8s MySQL","text":"<pre><code>docker exec -it mysql-solidarlink mysql -u solidarlink_user -p\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#wp-cli","title":"WP-CLI","text":"<pre><code># Lister les plugins\ndocker exec wp-cli-solidarlink wp plugin list\n\n# Mettre \u00e0 jour WordPress\ndocker exec wp-cli-solidarlink wp core update\n\n# Vider le cache\ndocker exec wp-cli-solidarlink wp cache flush\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#configuration-auto-start","title":"Configuration Auto-Start","text":"<p>Le site utilise docker-autostart pour d\u00e9marrage \u00e0 la demande :</p> <ul> <li>Timeout inactivit\u00e9: 30 minutes</li> <li>Mode: Async (d\u00e9marrage en arri\u00e8re-plan)</li> <li>Health check: V\u00e9rifie MySQL + WordPress</li> </ul> <p>Configuration dans <code>/opt/docker-autostart/config.json</code> :</p> <pre><code>{\n  \"name\": \"SolidarLink\",\n  \"container\": \"wordpress-solidarlink\",\n  \"timeout\": 1800,\n  \"async\": true,\n  \"healthCheck\": {\n    \"enabled\": true,\n    \"containers\": [\"mysql-solidarlink\", \"wordpress-solidarlink\"]\n  }\n}\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#acces-admin-wordpress","title":"Acc\u00e8s Admin WordPress","text":"<p>URL: https://solidarlink.srv759970.hstgr.cloud/wp-admin</p> <p>Identifiants dans <code>/opt/wordpress-solidarlink/.env</code></p>"},{"location":"02-applications/wordpress/solidarlink/#backup","title":"Backup","text":""},{"location":"02-applications/wordpress/solidarlink/#base-de-donnees","title":"Base de donn\u00e9es","text":"<pre><code>docker exec mysql-solidarlink mysqldump -u root -p solidarlink_db &gt; backup_solidarlink_$(date +%Y%m%d).sql\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#fichiers-wordpress","title":"Fichiers WordPress","text":"<pre><code>tar -czf backup_solidarlink_files_$(date +%Y%m%d).tar.gz /opt/wordpress-solidarlink/wordpress/\n</code></pre>"},{"location":"02-applications/wordpress/solidarlink/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Guide WordPress Docker</li> <li>Docker Auto-Start Config</li> </ul>"},{"location":"03-operations/backup/","title":"Backup &amp; Restore - srv759970","text":"<p>Guide complet pour sauvegarder et restaurer les configurations et donn\u00e9es du serveur.</p>"},{"location":"03-operations/backup/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Nous utilisons une approche hybride pour backup/restore:</p> <ol> <li>Configurations \u2192 Versionn\u00e9es dans Git (<code>server-configs/</code>)</li> <li>Donn\u00e9es Docker \u2192 Backup automatique serveur (<code>/root/backups/</code>)</li> <li>Bases de donn\u00e9es \u2192 Dumps inclus dans backups serveur</li> </ol>"},{"location":"03-operations/backup/#structure-de-backup","title":"Structure de Backup","text":"<pre><code>Repository Git (Local)\n\u2514\u2500\u2500 server-configs/          # Configurations versionn\u00e9es\n    \u251c\u2500\u2500 docker-compose/      # 8 services\n    \u251c\u2500\u2500 nginx/               # 20+ sites\n    \u251c\u2500\u2500 dashy/               # conf.yml\n    \u251c\u2500\u2500 systemd/             # Services custom\n    \u2514\u2500\u2500 scripts/             # Scripts de backup\n\nServeur (/root/backups/)\n\u2514\u2500\u2500 server-state-YYYYMMDD-HHMMSS.tar.gz    # Backup complet quotidien\n    \u251c\u2500\u2500 configs/             # Configs + .env avec secrets\n    \u251c\u2500\u2500 docker/              # \u00c9tat Docker\n    \u251c\u2500\u2500 volumes/             # Volumes critiques (tar.gz)\n    \u2514\u2500\u2500 databases/           # Dumps SQL\n</code></pre>"},{"location":"03-operations/backup/#synchroniser-configurations-serveur-local","title":"\ud83d\udce5 Synchroniser Configurations (Serveur \u2192 Local)","text":""},{"location":"03-operations/backup/#sync-complet","title":"Sync Complet","text":"<pre><code># Depuis la racine du repo\ncd /path/to/Hostinger\nbash scripts/sync-from-server.sh\n</code></pre> <p>Ce qui est synchronis\u00e9: - \u2705 Docker Compose files (8 services) - \u2705 Nginx configs (20+ sites) - \u2705 Dashy configuration - \u2705 Systemd services - \u2705 \u00c9tat Docker (conteneurs, images, volumes, networks) - \u2705 Certificats SSL (liste) - \u2705 .env templates (SANS secrets) - \u2705 Inventaire serveur</p> <p>Dur\u00e9e: ~2-3 minutes</p>"},{"location":"03-operations/backup/#commit-dans-git","title":"Commit dans Git","text":"<pre><code># Apr\u00e8s sync\ngit add server-configs/\ngit commit -m \"backup: server state $(date +%Y-%m-%d)\"\ngit push\n</code></pre>"},{"location":"03-operations/backup/#deployer-configurations-local-serveur","title":"\ud83d\udce4 D\u00e9ployer Configurations (Local \u2192 Serveur)","text":""},{"location":"03-operations/backup/#dry-run-test","title":"Dry-Run (Test)","text":"<pre><code>bash scripts/sync-to-server.sh --dry-run\n</code></pre> <p>Affiche ce qui serait modifi\u00e9 sans faire de changements.</p>"},{"location":"03-operations/backup/#deploiement-complet","title":"D\u00e9ploiement Complet","text":"<pre><code>bash scripts/sync-to-server.sh\n</code></pre> <p>Actions: - Backup automatique des fichiers existants (<code>*.backup-YYYYMMDD</code>) - Upload des nouvelles configs - Test Nginx (<code>nginx -t</code>) - Prompts pour reload/restart services</p>"},{"location":"03-operations/backup/#deploiement-partiel","title":"D\u00e9ploiement Partiel","text":"<pre><code># Seulement Nginx\nbash scripts/sync-to-server.sh --service nginx\n\n# Seulement Dashy\nbash scripts/sync-to-server.sh --service dashy\n\n# Seulement Docker Compose\nbash scripts/sync-to-server.sh --service docker-compose\n</code></pre>"},{"location":"03-operations/backup/#backup-automatique-serveur","title":"\ud83d\udcbe Backup Automatique Serveur","text":""},{"location":"03-operations/backup/#installation","title":"Installation","text":"<pre><code># D\u00e9ployer le script\nscp server-configs/scripts/backup-server-state.sh root@69.62.108.82:/root/scripts/\nssh root@69.62.108.82 \"chmod +x /root/scripts/backup-server-state.sh\"\n\n# Setup cron\nssh root@69.62.108.82\ncrontab -e\n\n# Ajouter (backup quotidien \u00e0 3h)\n0 3 * * * /root/scripts/backup-server-state.sh &gt;&gt; /var/log/backup-cron.log 2&gt;&amp;1\n</code></pre>"},{"location":"03-operations/backup/#execution-manuelle","title":"Ex\u00e9cution Manuelle","text":"<pre><code>ssh root@69.62.108.82 \"/root/scripts/backup-server-state.sh\"\n</code></pre>"},{"location":"03-operations/backup/#contenu-du-backup","title":"Contenu du Backup","text":"<p>Un backup <code>server-state-*.tar.gz</code> contient:</p> <pre><code>configs/\n\u251c\u2500\u2500 docker-compose.yml (tous les services)\n\u251c\u2500\u2500 nginx-sites/ (tous les sites nginx)\n\u251c\u2500\u2500 nginx-snippets/ (snippets r\u00e9utilisables)\n\u251c\u2500\u2500 dashy-conf.yml\n\u251c\u2500\u2500 .env files (AVEC secrets)\n\u2514\u2500\u2500 systemd/*.service\n\ndocker/\n\u251c\u2500\u2500 containers-running.txt\n\u251c\u2500\u2500 containers-all.txt\n\u251c\u2500\u2500 images.txt\n\u251c\u2500\u2500 volumes.txt\n\u2514\u2500\u2500 networks.txt\n\nvolumes/\n\u251c\u2500\u2500 dashy_icons.tar.gz\n\u251c\u2500\u2500 grafana_data.tar.gz\n\u251c\u2500\u2500 prometheus_data.tar.gz\n\u2514\u2500\u2500 loki_data.tar.gz\n\ndatabases/\n\u2514\u2500\u2500 clemence_db.sql\n\nserver-info.txt\n</code></pre>"},{"location":"03-operations/backup/#gestion-des-backups","title":"Gestion des Backups","text":"<pre><code># Lister les backups\nssh root@69.62.108.82 \"ls -lh /root/backups/\"\n\n# Voir le contenu d'un backup\nssh root@69.62.108.82 \"tar tzf /root/backups/server-state-20250121-030000.tar.gz | head -30\"\n\n# T\u00e9l\u00e9charger un backup en local\nscp root@69.62.108.82:/root/backups/server-state-20250121-030000.tar.gz ./backups/\n\n# Supprimer les anciens backups (&gt;30 jours)\nssh root@69.62.108.82 \"find /root/backups -name 'server-state-*.tar.gz' -mtime +30 -delete\"\n</code></pre> <p>R\u00e9tention: 30 jours (configurable dans le script)</p>"},{"location":"03-operations/backup/#restauration","title":"\ud83d\udd04 Restauration","text":""},{"location":"03-operations/backup/#restaurer-configurations-depuis-git","title":"Restaurer Configurations (depuis Git)","text":""},{"location":"03-operations/backup/#1-checkout-version-voulue","title":"1. Checkout Version Voulue","text":"<pre><code># Voir l'historique\ngit log --oneline server-configs/\n\n# Checkout une version sp\u00e9cifique\ngit checkout &lt;commit-hash&gt; -- server-configs/\n\n# Ou revenir \u00e0 la derni\u00e8re version\ngit checkout HEAD -- server-configs/\n</code></pre>"},{"location":"03-operations/backup/#2-deployer","title":"2. D\u00e9ployer","text":"<pre><code># Test\nbash scripts/sync-to-server.sh --dry-run\n\n# D\u00e9ploiement\nbash scripts/sync-to-server.sh\n</code></pre>"},{"location":"03-operations/backup/#3-redemarrer-services","title":"3. Red\u00e9marrer Services","text":"<pre><code># Exemple: Dashy\nssh root@69.62.108.82 \"cd /opt/dashy &amp;&amp; docker-compose restart\"\n\n# Exemple: Nginx\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n\n# Exemple: Tous les services monitoring\nssh root@69.62.108.82 \"cd /opt/monitoring &amp;&amp; docker-compose restart\"\n</code></pre>"},{"location":"03-operations/backup/#restaurer-depuis-backup-serveur","title":"Restaurer depuis Backup Serveur","text":""},{"location":"03-operations/backup/#1-extraire-le-backup","title":"1. Extraire le Backup","text":"<pre><code>ssh root@69.62.108.82\ncd /tmp\ntar xzf /root/backups/server-state-20250121-030000.tar.gz\ncd server-state-20250121-030000/\n</code></pre>"},{"location":"03-operations/backup/#2-restaurer-configs-specifiques","title":"2. Restaurer Configs Sp\u00e9cifiques","text":"<pre><code># Nginx\ncp -r configs/nginx-sites/* /etc/nginx/sites-available/\nnginx -t &amp;&amp; systemctl reload nginx\n\n# Docker Compose\ncp configs/opt/dashy/docker-compose.yml /opt/dashy/\ncd /opt/dashy &amp;&amp; docker-compose up -d\n\n# Dashy config\ncp configs/dashy-conf.yml /opt/dashy/conf.yml\ncd /opt/dashy &amp;&amp; docker-compose restart\n</code></pre>"},{"location":"03-operations/backup/#3-restaurer-volumes-docker","title":"3. Restaurer Volumes Docker","text":"<pre><code># Exemple: Grafana data\ndocker run --rm \\\n    -v grafana_data:/volume \\\n    -v /tmp/server-state-20250121-030000/volumes:/backup \\\n    alpine sh -c \"cd /volume &amp;&amp; tar xzf /backup/grafana_data.tar.gz --strip 1\"\n\n# Red\u00e9marrer le service\ncd /opt/monitoring &amp;&amp; docker-compose restart grafana\n</code></pre>"},{"location":"03-operations/backup/#4-restaurer-base-de-donnees","title":"4. Restaurer Base de Donn\u00e9es","text":"<pre><code># MySQL (Clemence)\ndocker exec -i mysql-clemence mysql -u clemence_user -pClemenceDB2025 clemence_db \\\n    &lt; databases/clemence_db.sql\n\n# V\u00e9rifier\ndocker exec mysql-clemence mysql -u clemence_user -pClemenceDB2025 -e \"SHOW TABLES;\" clemence_db\n</code></pre>"},{"location":"03-operations/backup/#disaster-recovery","title":"\ud83d\udea8 Disaster Recovery","text":""},{"location":"03-operations/backup/#scenario-serveur-completement-detruit","title":"Sc\u00e9nario: Serveur Compl\u00e8tement D\u00e9truit","text":""},{"location":"03-operations/backup/#etape-1-nouveau-serveur","title":"\u00c9tape 1: Nouveau Serveur","text":"<ol> <li>Provisionner nouveau VPS Ubuntu 24.04</li> <li>Installer Docker, Docker Compose, Nginx, Certbot</li> <li>Configurer SSH avec ta cl\u00e9 publique</li> </ol>"},{"location":"03-operations/backup/#etape-2-restaurer-configurations","title":"\u00c9tape 2: Restaurer Configurations","text":"<pre><code># Clone le repo Git\ngit clone https://github.com/julienfernandez/hostinger.git\ncd hostinger\n\n# D\u00e9ployer TOUTES les configs\nbash scripts/sync-to-server.sh\n</code></pre>"},{"location":"03-operations/backup/#etape-3-restaurer-donnees","title":"\u00c9tape 3: Restaurer Donn\u00e9es","text":"<pre><code># Upload backup le plus r\u00e9cent\nscp local-backups/server-state-latest.tar.gz root@NEW_IP:/tmp/\n\n# Extraire et restaurer\nssh root@NEW_IP\ncd /tmp\ntar xzf server-state-latest.tar.gz\ncd server-state-*/\n\n# Restaurer volumes critiques\n# (voir section \"Restaurer Volumes Docker\" ci-dessus)\n\n# Restaurer databases\n# (voir section \"Restaurer Base de Donn\u00e9es\" ci-dessus)\n</code></pre>"},{"location":"03-operations/backup/#etape-4-certificats-ssl","title":"\u00c9tape 4: Certificats SSL","text":"<pre><code># Reg\u00e9n\u00e9rer tous les certificats\nssh root@NEW_IP\nsystemctl stop nginx\n\ncertbot certonly --standalone \\\n    -d dashy.srv759970.hstgr.cloud \\\n    -d whisperx.srv759970.hstgr.cloud \\\n    -d monitoring.srv759970.hstgr.cloud \\\n    # ... (tous les domaines)\n\nsystemctl start nginx\n</code></pre>"},{"location":"03-operations/backup/#etape-5-demarrer-services","title":"\u00c9tape 5: D\u00e9marrer Services","text":"<pre><code># D\u00e9marrer tous les Docker Compose stacks\nfor service in dashy whisperx faster-whisper-queue monitoring neutts-air memvid mkdocs; do\n    echo \"Starting $service...\"\n    ssh root@NEW_IP \"cd /opt/$service &amp;&amp; docker-compose up -d\"\ndone\n</code></pre>"},{"location":"03-operations/backup/#etape-6-verification","title":"\u00c9tape 6: V\u00e9rification","text":"<pre><code># V\u00e9rifier tous les conteneurs\nssh root@NEW_IP \"docker ps\"\n\n# V\u00e9rifier Nginx\nssh root@NEW_IP \"nginx -t\"\nssh root@NEW_IP \"systemctl status nginx\"\n\n# Tester les URLs\ncurl -I https://dashy.srv759970.hstgr.cloud\ncurl -I https://docs.srv759970.hstgr.cloud\n</code></pre>"},{"location":"03-operations/backup/#calendrier-de-backup-recommande","title":"\ud83d\udcc5 Calendrier de Backup Recommand\u00e9","text":""},{"location":"03-operations/backup/#automatique","title":"Automatique","text":"<ul> <li>Quotidien (3h): Backup complet serveur (<code>/root/backups/</code>)</li> <li>Toutes les 6h: Sync Git (optionnel via cron local)</li> </ul>"},{"location":"03-operations/backup/#manuel","title":"Manuel","text":"<ul> <li>Avant changement majeur: Backup manuel + commit Git</li> <li>Apr\u00e8s d\u00e9ploiement: Sync configs vers Git</li> <li>Mensuel: T\u00e9l\u00e9charger backup serveur en local</li> </ul>"},{"location":"03-operations/backup/#securite-des-backups","title":"\ud83d\udd10 S\u00e9curit\u00e9 des Backups","text":""},{"location":"03-operations/backup/#secrets-dans-les-backups","title":"\u26a0\ufe0f Secrets dans les Backups","text":"<p>Repository Git: - \u274c <code>.env</code> r\u00e9els PAS dans Git - \u2705 <code>.env.template</code> seulement (valeurs masqu\u00e9es)</p> <p>Backups Serveur: - \u2705 Contiennent les <code>.env</code> avec secrets - \u26a0\ufe0f DANGER: <code>/root/backups/</code> sur serveur non chiffr\u00e9 - \u2705 Recommandation: T\u00e9l\u00e9charger en local et chiffrer</p>"},{"location":"03-operations/backup/#chiffrer-un-backup-local","title":"Chiffrer un Backup Local","text":"<pre><code># T\u00e9l\u00e9charger\nscp root@69.62.108.82:/root/backups/server-state-20250121.tar.gz ./\n\n# Chiffrer avec GPG\ngpg --symmetric --cipher-algo AES256 server-state-20250121.tar.gz\n\n# Fichier chiffr\u00e9: server-state-20250121.tar.gz.gpg\n# Supprimer original\nrm server-state-20250121.tar.gz\n</code></pre>"},{"location":"03-operations/backup/#dechiffrer","title":"D\u00e9chiffrer","text":"<pre><code>gpg --decrypt server-state-20250121.tar.gz.gpg &gt; server-state-20250121.tar.gz\n</code></pre>"},{"location":"03-operations/backup/#monitoring-des-backups","title":"\ud83d\udcca Monitoring des Backups","text":""},{"location":"03-operations/backup/#verifier-derniers-backups","title":"V\u00e9rifier Derniers Backups","text":"<pre><code># Sur le serveur\nssh root@69.62.108.82 \"ls -lht /root/backups/ | head -5\"\n\n# V\u00e9rifier le log cron\nssh root@69.62.108.82 \"tail -50 /var/log/backup-cron.log\"\n</code></pre>"},{"location":"03-operations/backup/#tester-un-backup","title":"Tester un Backup","text":"<pre><code># Tester l'int\u00e9grit\u00e9\nssh root@69.62.108.82 \"tar tzf /root/backups/server-state-latest.tar.gz &gt; /dev/null &amp;&amp; echo 'OK' || echo 'CORRUPTED'\"\n\n# Voir la taille\nssh root@69.62.108.82 \"du -h /root/backups/server-state-latest.tar.gz\"\n</code></pre>"},{"location":"03-operations/backup/#troubleshooting","title":"\ud83d\udee0\ufe0f Troubleshooting","text":""},{"location":"03-operations/backup/#sync-failed","title":"Sync Failed","text":"<pre><code># V\u00e9rifier connexion SSH\nssh root@69.62.108.82 \"echo OK\"\n\n# Re-ex\u00e9cuter avec debug\nbash -x scripts/sync-from-server.sh\n</code></pre>"},{"location":"03-operations/backup/#backup-failed","title":"Backup Failed","text":"<pre><code># V\u00e9rifier espace disque\nssh root@69.62.108.82 \"df -h /\"\n\n# V\u00e9rifier permissions\nssh root@69.62.108.82 \"ls -la /root/scripts/backup-server-state.sh\"\n\n# Ex\u00e9cuter manuellement avec verbose\nssh root@69.62.108.82 \"bash -x /root/scripts/backup-server-state.sh\"\n</code></pre>"},{"location":"03-operations/backup/#restore-failed","title":"Restore Failed","text":"<pre><code># V\u00e9rifier le backup\ntar tzf backup.tar.gz | grep -i error\n\n# Extraire partiellement\ntar xzf backup.tar.gz configs/nginx-sites/\n\n# V\u00e9rifier Docker\ndocker ps -a\ndocker logs &lt;container&gt;\n</code></pre>"},{"location":"03-operations/backup/#voir-aussi","title":"\ud83d\udcda Voir Aussi","text":"<ul> <li>server-configs/README.md - Documentation structure</li> <li>INVENTORY.md - Inventaire serveur</li> <li>Docker Infrastructure</li> <li>Nginx Infrastructure</li> <li>Security</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-01-21 Prochaine r\u00e9vision: Apr\u00e8s premier disaster recovery test</p>"},{"location":"03-operations/cloudflare/","title":"Guide Configuration Cloudflare - srv759970.hstgr.cloud","text":""},{"location":"03-operations/cloudflare/#objectifs","title":"\ud83c\udfaf Objectifs","text":"<ul> <li>\u2705 Prot\u00e9ger les sites en dev avec Cloudflare Access (Zero Trust)</li> <li>\u2705 Activer le CDN et cache pour am\u00e9liorer les performances</li> <li>\u2705 Configurer le firewall WAF pour bloquer les menaces</li> <li>\u2705 Garder les APIs accessibles mais s\u00e9curis\u00e9es</li> </ul>"},{"location":"03-operations/cloudflare/#prerequis","title":"\ud83d\udccb Pr\u00e9requis","text":"<ul> <li>Compte Cloudflare (gratuit) : https://dash.cloudflare.com/sign-up</li> <li>Acc\u00e8s aux DNS du domaine <code>srv759970.hstgr.cloud</code> (Hostinger)</li> <li>15-20 minutes</li> </ul>"},{"location":"03-operations/cloudflare/#etape-1-ajouter-le-site-a-cloudflare","title":"\u00c9tape 1 : Ajouter le site \u00e0 Cloudflare","text":""},{"location":"03-operations/cloudflare/#11-creer-un-compte-cloudflare","title":"1.1 Cr\u00e9er un compte Cloudflare","text":"<ol> <li>Aller sur https://dash.cloudflare.com/sign-up</li> <li>S'inscrire avec ton email (julien.fernandez.work@gmail.com)</li> <li>V\u00e9rifier l'email</li> </ol>"},{"location":"03-operations/cloudflare/#12-ajouter-le-domaine","title":"1.2 Ajouter le domaine","text":"<ol> <li>Dans le dashboard Cloudflare, cliquer Add a Site</li> <li>Entrer : <code>srv759970.hstgr.cloud</code></li> <li>S\u00e9lectionner le plan Free ($0/mois)</li> <li>Cliquer Continue</li> </ol>"},{"location":"03-operations/cloudflare/#13-scanner-les-dns-existants","title":"1.3 Scanner les DNS existants","text":"<p>Cloudflare va scanner automatiquement tous les enregistrements DNS actuels.</p> <p>V\u00e9rifier que tous les sous-domaines sont d\u00e9tect\u00e9s : - <code>dashboard.srv759970.hstgr.cloud</code> - <code>wordpress.srv759970.hstgr.cloud</code> - <code>cristina.srv759970.hstgr.cloud</code> - <code>clemence.srv759970.hstgr.cloud</code> - <code>sharepoint.srv759970.hstgr.cloud</code> - <code>whisper.srv759970.hstgr.cloud</code> - <code>tika.srv759970.hstgr.cloud</code> - <code>portal.srv759970.hstgr.cloud</code> - <code>ollama.srv759970.hstgr.cloud</code> - Etc.</p> <p>Si un sous-domaine manque, l'ajouter manuellement : - Type : <code>A</code> - Name : <code>sous-domaine</code> (ex: <code>dashboard</code>) - IPv4 address : <code>69.62.108.82</code> - Proxy status : \ud83d\udfe0 Proxied (cloud orange activ\u00e9)</p> <p>Cliquer Continue</p>"},{"location":"03-operations/cloudflare/#etape-2-changer-les-nameservers-chez-hostinger","title":"\u00c9tape 2 : Changer les nameservers chez Hostinger","text":""},{"location":"03-operations/cloudflare/#21-recuperer-les-nameservers-cloudflare","title":"2.1 R\u00e9cup\u00e9rer les nameservers Cloudflare","text":"<p>Cloudflare affiche 2 nameservers, exemple : <pre><code>aisha.ns.cloudflare.com\nbaker.ns.cloudflare.com\n</code></pre></p> <p>Copier ces 2 nameservers</p>"},{"location":"03-operations/cloudflare/#22-modifier-chez-hostinger","title":"2.2 Modifier chez Hostinger","text":"<ol> <li>Aller sur https://hpanel.hostinger.com/</li> <li>S\u00e9lectionner le VPS <code>srv759970.hstgr.cloud</code></li> <li>Menu DNS / Name Servers</li> <li>Cliquer Change Nameservers</li> <li>S\u00e9lectionner Custom nameservers</li> <li>Entrer les 2 nameservers Cloudflare</li> <li>Cliquer Change Nameservers</li> </ol>"},{"location":"03-operations/cloudflare/#23-verifier-la-propagation","title":"2.3 V\u00e9rifier la propagation","text":"<p>\u23f1\ufe0f D\u00e9lai : 5 minutes \u00e0 24h (g\u00e9n\u00e9ralement 15-30 min)</p> <p>V\u00e9rifier avec : <pre><code>nslookup -type=NS srv759970.hstgr.cloud\n</code></pre></p> <p>R\u00e9sultat attendu : Les nameservers Cloudflare</p> <p>Une fois propag\u00e9, Cloudflare affichera Active avec une coche verte \u2705</p>"},{"location":"03-operations/cloudflare/#etape-3-configuration-ssltls","title":"\u00c9tape 3 : Configuration SSL/TLS","text":""},{"location":"03-operations/cloudflare/#31-mode-ssl","title":"3.1 Mode SSL","text":"<ol> <li>Dans Cloudflare Dashboard \u2192 SSL/TLS</li> <li>S\u00e9lectionner le mode : Full (strict)</li> <li>\u2705 Cloudflare \u2194\ufe0f Serveur : SSL valid\u00e9 (Let's Encrypt)</li> <li> <p>\u2705 Client \u2194\ufe0f Cloudflare : SSL Cloudflare</p> </li> <li> <p>Activer Always Use HTTPS</p> </li> <li>Activer Automatic HTTPS Rewrites</li> </ol>"},{"location":"03-operations/cloudflare/#32-edge-certificates","title":"3.2 Edge Certificates","text":"<p>Dans SSL/TLS \u2192 Edge Certificates : - \u2705 Activer Always Use HTTPS - \u2705 Activer HTTP Strict Transport Security (HSTS) (optionnel, mais recommand\u00e9)   - Max Age: <code>6 months</code>   - Include subdomains: \u2705   - Preload: \u2705 (si tu es s\u00fbr)</p>"},{"location":"03-operations/cloudflare/#etape-4-activer-le-cdn-et-optimisations","title":"\u00c9tape 4 : Activer le CDN et optimisations","text":""},{"location":"03-operations/cloudflare/#41-speed-optimizations","title":"4.1 Speed optimizations","text":"<p>Dans Speed \u2192 Optimization :</p> <p>\u2705 Auto Minify : - JavaScript - CSS - HTML</p> <p>\u2705 Brotli : Activ\u00e9</p> <p>\u2705 Early Hints : Activ\u00e9</p> <p>\u2705 Rocket Loader : \u26a0\ufe0f D\u00e9sactiv\u00e9 (peut casser certains JS)</p>"},{"location":"03-operations/cloudflare/#42-caching","title":"4.2 Caching","text":"<p>Dans Caching \u2192 Configuration :</p> <p>Caching Level : <code>Standard</code></p> <p>Browser Cache TTL : <code>4 hours</code> (ou <code>1 day</code> pour prod)</p> <p>Always Online : \u2705 Activ\u00e9 (cache de secours si serveur down)</p>"},{"location":"03-operations/cloudflare/#etape-5-proteger-les-sites-en-dev-avec-cloudflare-access-zero-trust","title":"\u00c9tape 5 : Prot\u00e9ger les sites en DEV avec Cloudflare Access (Zero Trust)","text":""},{"location":"03-operations/cloudflare/#51-activer-cloudflare-access","title":"5.1 Activer Cloudflare Access","text":"<ol> <li>Dans le menu de gauche \u2192 Zero Trust</li> <li>Si premier usage, cr\u00e9er une \"team\" : <code>julien-dev</code> (ou autre nom)</li> <li>Menu Access \u2192 Applications</li> </ol>"},{"location":"03-operations/cloudflare/#52-creer-une-application-pour-les-sites-dev","title":"5.2 Cr\u00e9er une application pour les sites DEV","text":"<p>Pour chaque site \u00e0 prot\u00e9ger (Cl\u00e9mence, Cristina, WordPress) :</p> <ol> <li>Cliquer Add an application</li> <li>S\u00e9lectionner Self-hosted</li> <li>Configuration :</li> </ol> <p>Application Configuration :    - Application name : <code>Cl\u00e9mence Site (DEV)</code>    - Session Duration : <code>24 hours</code>    - Application domain :      - Subdomain : <code>clemence</code>      - Domain : <code>srv759970.hstgr.cloud</code>    - Accept all available identity providers : \u2705</p> <ol> <li>Cliquer Next</li> </ol> <p>Add policies :    - Policy name : <code>Allow Julien &amp; Team</code>    - Action : <code>Allow</code>    - Include :      - Selector : <code>Emails</code>      - Value : <code>julien.fernandez.work@gmail.com, clemsfou@gmail.com</code></p> <p>Ou utiliser Email domain :      - Value : <code>gmail.com</code> (si tu veux autoriser tous les @gmail.com)</p> <ol> <li>Cliquer Next \u2192 Add application</li> </ol> <p>R\u00e9p\u00e9ter pour : - <code>wordpress.srv759970.hstgr.cloud</code> - <code>cristina.srv759970.hstgr.cloud</code> - <code>admin.cristina.srv759970.hstgr.cloud</code> (Strapi)</p>"},{"location":"03-operations/cloudflare/#53-tester-lacces","title":"5.3 Tester l'acc\u00e8s","text":"<ol> <li>Ouvrir https://clemence.srv759970.hstgr.cloud</li> <li>Cloudflare Access login page appara\u00eet</li> <li>Entrer ton email \u2192 Recevoir un code par email \u2192 Entrer le code</li> <li>Acc\u00e8s au site \u2705</li> </ol>"},{"location":"03-operations/cloudflare/#etape-6-securiser-les-apis-avec-firewall-rules","title":"\u00c9tape 6 : S\u00e9curiser les APIs avec Firewall Rules","text":"<p>Pour les APIs (Whisper, Tika, Ollama) et outils (Portal, Portainer), on ne veut pas bloquer totalement, mais ajouter une protection.</p>"},{"location":"03-operations/cloudflare/#option-a-ip-allowlist-si-ip-fixe","title":"Option A : IP Allowlist (si IP fixe)","text":"<ol> <li>Security \u2192 WAF \u2192 Custom rules</li> <li>Cliquer Create rule</li> <li>Configuration :</li> <li>Rule name : <code>Allow only my IP for APIs</code></li> <li>Field : <code>IP Source Address</code></li> <li>Operator : <code>does not equal</code></li> <li>Value : <code>VOTRE_IP_PUBLIQUE</code> (trouver avec https://ifconfig.me)</li> <li> <p>Then : <code>Block</code></p> </li> <li> <p>Appliquer uniquement \u00e0 certains sous-domaines :</p> </li> <li>Field : <code>Hostname</code></li> <li>Operator : <code>equals</code></li> <li>Value : <code>portal.srv759970.hstgr.cloud</code></li> </ol> <p>R\u00e9p\u00e9ter avec OR pour chaque API.</p>"},{"location":"03-operations/cloudflare/#option-b-secret-header-si-ip-dynamique","title":"Option B : Secret Header (si IP dynamique)","text":"<ol> <li>Security \u2192 WAF \u2192 Custom rules</li> <li>Cliquer Create rule</li> <li>Configuration :</li> <li>Rule name : <code>Require secret header for APIs</code></li> <li>Field : <code>HTTP Header</code></li> <li>Header name : <code>X-Access-Key</code></li> <li>Operator : <code>does not equal</code></li> <li>Value : <code>MonSecretSuper2025!</code></li> <li> <p>Then : <code>Block</code></p> </li> <li> <p>Pour acc\u00e9der \u00e0 l'API, ajouter le header dans les requ\u00eates :    <pre><code>curl -H \"X-Access-Key: MonSecretSuper2025!\" https://whisper.srv759970.hstgr.cloud/docs\n</code></pre></p> </li> </ol>"},{"location":"03-operations/cloudflare/#option-c-laisser-public-avec-rate-limiting","title":"Option C : Laisser public avec Rate Limiting","text":"<ol> <li>Security \u2192 WAF \u2192 Rate limiting rules</li> <li>Cr\u00e9er une r\u00e8gle :</li> <li>If incoming requests match : Hostname = <code>*.srv759970.hstgr.cloud</code></li> <li>Rate : <code>100 requests per 10 seconds</code></li> <li>Then : <code>Block</code> for <code>10 minutes</code></li> </ol> <p>Protection contre le spam/DDoS, mais acc\u00e8s public.</p>"},{"location":"03-operations/cloudflare/#etape-7-configuration-dns-avancee-email","title":"\u00c9tape 7 : Configuration DNS avanc\u00e9e (Email)","text":"<p>Si tu as d\u00e9j\u00e0 configur\u00e9 SPF/DKIM/DMARC (voir TODO_CONFIG_DNS_EMAIL.md), v\u00e9rifier dans Cloudflare :</p> <ol> <li>DNS \u2192 Records</li> <li>V\u00e9rifier que les enregistrements existent :</li> <li>SPF : <code>v=spf1 ip4:69.62.108.82 a mx ~all</code></li> <li>DKIM : <code>mail._domainkey</code> \u2192 (cl\u00e9 publique)</li> <li>DMARC : <code>_dmarc</code> \u2192 politique</li> </ol> <p>\u26a0\ufe0f Important : Les enregistrements email doivent avoir Proxy status = \u2601\ufe0f DNS Only (gris, pas orange)</p>"},{"location":"03-operations/cloudflare/#etape-8-monitoring-et-analytics","title":"\u00c9tape 8 : Monitoring et Analytics","text":""},{"location":"03-operations/cloudflare/#81-activer-analytics","title":"8.1 Activer Analytics","text":"<ol> <li>Analytics &amp; Logs \u2192 Web Analytics</li> <li>Activer Web Analytics</li> <li>Ajouter le tag sur le site (ou laisser auto-inject)</li> </ol>"},{"location":"03-operations/cloudflare/#82-security-events","title":"8.2 Security Events","text":"<ol> <li>Security \u2192 Events</li> <li>Voir toutes les requ\u00eates bloqu\u00e9es/autoris\u00e9es</li> <li>Analyser les menaces</li> </ol>"},{"location":"03-operations/cloudflare/#83-alertes","title":"8.3 Alertes","text":"<ol> <li>Notifications</li> <li>Configurer des alertes :</li> <li>Rate Limiting triggered</li> <li>SSL/TLS certificate expiring</li> <li>Cloudflare Access login failures</li> </ol>"},{"location":"03-operations/cloudflare/#verifications-finales","title":"\u2705 V\u00e9rifications finales","text":""},{"location":"03-operations/cloudflare/#test-1-ssl-fonctionne","title":"Test 1 : SSL fonctionne","text":"<pre><code>curl -I https://clemence.srv759970.hstgr.cloud\n</code></pre> <p>Attendu : <code>HTTP/2 200</code> avec header <code>cf-ray</code> (preuve que Cloudflare est actif)</p>"},{"location":"03-operations/cloudflare/#test-2-cloudflare-access-fonctionne","title":"Test 2 : Cloudflare Access fonctionne","text":"<ol> <li>Ouvrir un navigateur en navigation priv\u00e9e</li> <li>Aller sur https://clemence.srv759970.hstgr.cloud</li> <li>Attendu : Page de login Cloudflare Access</li> </ol>"},{"location":"03-operations/cloudflare/#test-3-cdn-cache-fonctionne","title":"Test 3 : CDN cache fonctionne","text":"<pre><code>curl -I https://cristina.srv759970.hstgr.cloud\n</code></pre> <p>Attendu : Header <code>cf-cache-status: HIT</code> (apr\u00e8s 2\u00e8me requ\u00eate)</p>"},{"location":"03-operations/cloudflare/#test-4-firewall-bloque","title":"Test 4 : Firewall bloque","text":"<p>Si tu as cr\u00e9\u00e9 une r\u00e8gle IP : 1. Utiliser un VPN ou mobile data (autre IP) 2. Acc\u00e9der \u00e0 https://portal.srv759970.hstgr.cloud 3. Attendu : Erreur 1020 ou 1010 (blocked by Cloudflare)</p>"},{"location":"03-operations/cloudflare/#desactiver-temporairement-cloudflare","title":"\ud83d\udd04 D\u00e9sactiver temporairement Cloudflare","text":"<p>Si besoin de contourner Cloudflare (debug) :</p>"},{"location":"03-operations/cloudflare/#option-1-desactiver-le-proxy-par-sous-domaine","title":"Option 1 : D\u00e9sactiver le proxy (par sous-domaine)","text":"<ol> <li>DNS \u2192 Records</li> <li>Cliquer sur le cloud orange \ud83d\udfe0 \u2192 Devient gris \u2601\ufe0f (DNS Only)</li> <li>Le trafic passe direct au serveur</li> </ol>"},{"location":"03-operations/cloudflare/#option-2-mode-development-global","title":"Option 2 : Mode Development (global)","text":"<ol> <li>Caching \u2192 Configuration</li> <li>Activer Development Mode (3 heures)</li> <li>Cache et protection d\u00e9sactiv\u00e9s temporairement</li> </ol>"},{"location":"03-operations/cloudflare/#resume-de-la-configuration","title":"\ud83d\udcca R\u00e9sum\u00e9 de la configuration","text":"Service Protection Acc\u00e8s Cl\u00e9mence Site Cloudflare Access Login email obligatoire WordPress Cloudflare Access Login email obligatoire Cristina Site Cloudflare Access Login email obligatoire Strapi Admin Cloudflare Access Login email obligatoire Portal/APIs Firewall Rules ou Public IP whitelist ou Rate Limit Monitoring Firewall Rules ou Public IP whitelist ou Rate Limit"},{"location":"03-operations/cloudflare/#avantages-obtenus","title":"\ud83d\ude80 Avantages obtenus","text":"<p>\u2705 S\u00e9curit\u00e9 : - Sites dev prot\u00e9g\u00e9s par authentification - WAF bloque attaques automatiques - Rate limiting anti-DDoS</p> <p>\u2705 Performance : - CDN global (cache statique) - Compression Brotli - HTTP/3 et optimisations auto</p> <p>\u2705 Monitoring : - Analytics d\u00e9taill\u00e9s - Logs de s\u00e9curit\u00e9 - Alertes en temps r\u00e9el</p> <p>\u2705 Gratuit : - Plan Free largement suffisant - Pas de limite de bande passante</p>"},{"location":"03-operations/cloudflare/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Cloudflare Dashboard : https://dash.cloudflare.com/</li> <li>Zero Trust Access : https://dash.cloudflare.com/zero-trust</li> <li>Documentation : https://developers.cloudflare.com/</li> </ul> <p>Temps estim\u00e9 : 30 minutes pour tout configurer</p> <p>Prochaine \u00e9tape : Cr\u00e9er un compte Cloudflare et ajouter le domaine !</p>"},{"location":"03-operations/dependency-wake-chain/","title":"Cha\u00eene de R\u00e9veil des D\u00e9pendances - Proposition de Design","text":"<p>Analyse et proposition d'impl\u00e9mentation d'un syst\u00e8me de r\u00e9veil intelligent bas\u00e9 sur les d\u00e9pendances entre services.</p>"},{"location":"03-operations/dependency-wake-chain/#problematique","title":"\ud83c\udfaf Probl\u00e9matique","text":"<p>Situation actuelle : - L'utilisateur acc\u00e8de \u00e0 <code>clemence.srv759970.hstgr.cloud</code> - <code>wordpress-clemence</code> d\u00e9marre - \u274c Mais <code>mysql-clemence</code> reste arr\u00eat\u00e9 - \u274c WordPress crash ou timeout en attendant MySQL</p> <p>Solution attendue : - L'utilisateur acc\u00e8de \u00e0 <code>clemence.srv759970.hstgr.cloud</code> - Le syst\u00e8me d\u00e9tecte les d\u00e9pendances : <code>wordpress-clemence</code> \u2192 <code>mysql-clemence</code> - \u2705 <code>mysql-clemence</code> d\u00e9marre en premier - \u2705 Ensuite <code>wordpress-clemence</code> d\u00e9marre - \u2705 L'utilisateur acc\u00e8de au site fonctionnel</p>"},{"location":"03-operations/dependency-wake-chain/#analyse-des-dependances-actuelles","title":"\ud83d\udcca Analyse des D\u00e9pendances Actuelles","text":""},{"location":"03-operations/dependency-wake-chain/#services-avec-dependances-critiques","title":"Services avec D\u00e9pendances Critiques","text":"<pre><code>graph TB\n    subgraph \"WordPress Clemence\"\n        WP_Clem[wordpress-clemence&lt;br/&gt;Port: 9002]\n        Nginx_Clem[nginx-clemence]\n        MySQL_Clem[mysql-clemence&lt;br/&gt;Port: 3306]\n        WPCli_Clem[wp-cli-clemence]\n    end\n\n    subgraph \"Nextcloud\"\n        NC[nextcloud&lt;br/&gt;Port: 8080]\n        NC_Cron[nextcloud-cron]\n        NC_DB[postgresql-shared&lt;br/&gt;R\u00e9seau: databases-shared]\n        NC_Redis[redis-shared&lt;br/&gt;R\u00e9seau: databases-shared]\n    end\n\n    subgraph \"RAGFlow\"\n        RAG_Server[ragflow-server&lt;br/&gt;Port: 9500]\n        RAG_ES[ragflow-es-01]\n        RAG_MySQL[ragflow-mysql]\n        RAG_Redis[ragflow-redis]\n        RAG_Minio[ragflow-minio]\n    end\n\n    subgraph \"MemVid\"\n        MemVid_API[memvid-api&lt;br/&gt;Port: 8100]\n        MemVid_UI[memvid-ui]\n        Redis_Shared[redis-shared]\n    end\n\n    subgraph \"Telegram Voice Bot\"\n        TG_Bot[telegram-voice-bot]\n        Whisper[faster-whisper-worker]\n        WhisperX[rq-exporter-whisperx]\n        Redis_Shared2[redis-shared]\n    end\n\n    WP_Clem --&gt; MySQL_Clem\n    Nginx_Clem --&gt; WP_Clem\n    WPCli_Clem --&gt; MySQL_Clem\n\n    NC --&gt; NC_DB\n    NC --&gt; NC_Redis\n    NC_Cron --&gt; NC\n\n    RAG_Server --&gt; RAG_ES\n    RAG_Server --&gt; RAG_MySQL\n    RAG_Server --&gt; RAG_Redis\n    RAG_Server --&gt; RAG_Minio\n\n    MemVid_API --&gt; Redis_Shared\n    MemVid_UI --&gt; MemVid_API\n\n    TG_Bot --&gt; Redis_Shared2\n    TG_Bot --&gt; Whisper\n    TG_Bot --&gt; WhisperX\n\n    style MySQL_Clem fill:#ff6b6b\n    style NC_DB fill:#4ecdc4\n    style NC_Redis fill:#ffd93d\n    style RAG_MySQL fill:#ff6b6b\n    style RAG_Redis fill:#ffd93d\n    style RAG_ES fill:#a8e6cf\n    style Redis_Shared fill:#ffd93d</code></pre>"},{"location":"03-operations/dependency-wake-chain/#graphe-de-dependances-detaille","title":"\ud83d\udd17 Graphe de D\u00e9pendances D\u00e9taill\u00e9","text":""},{"location":"03-operations/dependency-wake-chain/#1-wordpress-clemence","title":"1. WordPress Clemence","text":"<p>R\u00e9seau : <code>wordpress-clemence_clemence-network</code></p> <pre><code>wordpress-clemence:\n  depends_on:\n    - mysql-clemence\n  start_order: 2\n  health_check_wait: mysql-clemence\n\nnginx-clemence:\n  depends_on:\n    - wordpress-clemence\n  start_order: 3\n\nmysql-clemence:\n  start_order: 1\n  health_check: \"mysqladmin ping -h localhost\"\n  startup_time: ~5s\n</code></pre> <p>Cha\u00eene de r\u00e9veil : <pre><code>User \u2192 wordpress-clemence \u2192 mysql-clemence (starts first) \u2192 wordpress-clemence (starts) \u2192 nginx-clemence (starts)\n</code></pre></p>"},{"location":"03-operations/dependency-wake-chain/#2-nextcloud","title":"2. Nextcloud","text":"<p>R\u00e9seau : <code>nextcloud</code> + <code>databases-shared</code></p> <pre><code>nextcloud:\n  depends_on:\n    - postgresql-shared  # Cross-network dependency\n    - redis-shared       # Cross-network dependency\n  start_order: 3\n  health_check_wait:\n    - postgresql-shared\n    - redis-shared\n\nnextcloud-cron:\n  depends_on:\n    - nextcloud\n  start_order: 4\n\npostgresql-shared:\n  start_order: 1\n  health_check: \"pg_isready\"\n  startup_time: ~8s\n\nredis-shared:\n  start_order: 1\n  health_check: \"redis-cli ping\"\n  startup_time: ~2s\n</code></pre> <p>Cha\u00eene de r\u00e9veil : <pre><code>User \u2192 nextcloud \u2192 [postgresql-shared, redis-shared] (parallel) \u2192 nextcloud \u2192 nextcloud-cron\n</code></pre></p>"},{"location":"03-operations/dependency-wake-chain/#3-ragflow-cluster","title":"3. RAGFlow Cluster","text":"<p>R\u00e9seau : <code>docker_ragflow</code></p> <pre><code>ragflow-server:\n  depends_on:\n    - ragflow-es-01\n    - ragflow-mysql\n    - ragflow-redis\n    - ragflow-minio\n  start_order: 5\n  health_check_wait: all\n\nragflow-es-01:\n  start_order: 1\n  health_check: \"curl -f http://localhost:9200/_cluster/health\"\n  startup_time: ~30s\n\nragflow-mysql:\n  start_order: 1\n  health_check: \"mysqladmin ping\"\n  startup_time: ~8s\n\nragflow-redis:\n  start_order: 1\n  health_check: \"redis-cli ping\"\n  startup_time: ~3s\n\nragflow-minio:\n  start_order: 1\n  health_check: \"curl -f http://localhost:9000/minio/health/ready\"\n  startup_time: ~5s\n</code></pre> <p>Cha\u00eene de r\u00e9veil : <pre><code>User \u2192 ragflow-server \u2192 [ragflow-es-01, ragflow-mysql, ragflow-redis, ragflow-minio] (parallel)\n                      \u2192 wait all healthy (max 30s for ES)\n                      \u2192 ragflow-server starts\n</code></pre></p>"},{"location":"03-operations/dependency-wake-chain/#4-memvid","title":"4. MemVid","text":"<p>R\u00e9seau : <code>memvid_memvid-network</code> + <code>monitoring_monitoring</code></p> <pre><code>memvid-api:\n  depends_on:\n    - redis-shared  # Cross-network dependency\n  start_order: 2\n  health_check_wait: redis-shared\n\nmemvid-ui:\n  depends_on:\n    - memvid-api\n  start_order: 3\n\nredis-shared:\n  start_order: 1\n  startup_time: ~2s\n</code></pre> <p>Cha\u00eene de r\u00e9veil : <pre><code>User \u2192 memvid-ui \u2192 memvid-api \u2192 redis-shared (cross-network) \u2192 memvid-api \u2192 memvid-ui\n</code></pre></p>"},{"location":"03-operations/dependency-wake-chain/#implementation-proposee","title":"\ud83d\udee0\ufe0f Impl\u00e9mentation Propos\u00e9e","text":""},{"location":"03-operations/dependency-wake-chain/#structure-de-configuration","title":"Structure de Configuration","text":"<p>Nouveau fichier : <code>/opt/docker-autostart/dependencies.json</code></p> <pre><code>{\n  \"services\": {\n    \"clemence\": {\n      \"name\": \"wordpress-clemence\",\n      \"port\": 9002,\n      \"composeDir\": \"/opt/wordpress-clemence\",\n      \"network\": \"wordpress-clemence_clemence-network\",\n      \"dependencies\": [\n        {\n          \"container\": \"mysql-clemence\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec mysql-clemence mysqladmin ping -h localhost -u root -p$MYSQL_ROOT_PASSWORD\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 15\n          }\n        },\n        {\n          \"container\": \"wordpress-clemence\",\n          \"type\": \"required\",\n          \"startOrder\": 2,\n          \"healthCheck\": {\n            \"command\": \"docker exec wordpress-clemence curl -f http://localhost:9000/wp-admin/install.php\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 10\n          }\n        },\n        {\n          \"container\": \"nginx-clemence\",\n          \"type\": \"optional\",\n          \"startOrder\": 3,\n          \"healthCheck\": {\n            \"command\": \"docker exec nginx-clemence curl -f http://localhost:80\",\n            \"interval\": 1000,\n            \"timeout\": 10000,\n            \"retries\": 5\n          }\n        }\n      ]\n    },\n    \"nextcloud\": {\n      \"name\": \"nextcloud\",\n      \"port\": 8080,\n      \"composeDir\": \"/opt/nextcloud\",\n      \"network\": \"nextcloud\",\n      \"crossNetworkDeps\": true,\n      \"dependencies\": [\n        {\n          \"container\": \"postgresql-shared\",\n          \"network\": \"databases-shared\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec postgresql-shared pg_isready -U postgres\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 15\n          }\n        },\n        {\n          \"container\": \"redis-shared\",\n          \"network\": \"databases-shared\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec redis-shared redis-cli ping\",\n            \"interval\": 1000,\n            \"timeout\": 10000,\n            \"retries\": 10\n          }\n        },\n        {\n          \"container\": \"nextcloud\",\n          \"type\": \"required\",\n          \"startOrder\": 2,\n          \"healthCheck\": {\n            \"command\": \"docker exec nextcloud curl -f http://localhost:80/status.php\",\n            \"interval\": 3000,\n            \"timeout\": 60000,\n            \"retries\": 20\n          }\n        },\n        {\n          \"container\": \"nextcloud-cron\",\n          \"type\": \"optional\",\n          \"startOrder\": 3\n        }\n      ]\n    },\n    \"ragflow\": {\n      \"name\": \"ragflow-server\",\n      \"port\": 9500,\n      \"composeDir\": \"/opt/ragflow\",\n      \"network\": \"docker_ragflow\",\n      \"dependencies\": [\n        {\n          \"container\": \"ragflow-mysql\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"parallelGroup\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec ragflow-mysql mysqladmin ping -h localhost\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 15\n          }\n        },\n        {\n          \"container\": \"ragflow-redis\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"parallelGroup\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec ragflow-redis redis-cli ping\",\n            \"interval\": 1000,\n            \"timeout\": 10000,\n            \"retries\": 10\n          }\n        },\n        {\n          \"container\": \"ragflow-minio\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"parallelGroup\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec ragflow-minio curl -f http://localhost:9000/minio/health/ready\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 15\n          }\n        },\n        {\n          \"container\": \"ragflow-es-01\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"parallelGroup\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec ragflow-es-01 curl -f http://localhost:9200/_cluster/health\",\n            \"interval\": 3000,\n            \"timeout\": 60000,\n            \"retries\": 20\n          }\n        },\n        {\n          \"container\": \"ragflow-server\",\n          \"type\": \"required\",\n          \"startOrder\": 2,\n          \"healthCheck\": {\n            \"command\": \"docker exec ragflow-server curl -f http://localhost:9380/health\",\n            \"interval\": 3000,\n            \"timeout\": 90000,\n            \"retries\": 30\n          }\n        }\n      ]\n    },\n    \"memvid\": {\n      \"name\": \"memvid-api\",\n      \"port\": 8100,\n      \"composeDir\": \"/opt/memvid\",\n      \"network\": \"memvid_memvid-network\",\n      \"crossNetworkDeps\": true,\n      \"dependencies\": [\n        {\n          \"container\": \"redis-shared\",\n          \"network\": \"monitoring_monitoring\",\n          \"type\": \"required\",\n          \"startOrder\": 1,\n          \"healthCheck\": {\n            \"command\": \"docker exec redis-shared redis-cli ping\",\n            \"interval\": 1000,\n            \"timeout\": 10000,\n            \"retries\": 10\n          }\n        },\n        {\n          \"container\": \"memvid-api\",\n          \"type\": \"required\",\n          \"startOrder\": 2,\n          \"healthCheck\": {\n            \"command\": \"docker exec memvid-api curl -f http://localhost:8100/health\",\n            \"interval\": 2000,\n            \"timeout\": 30000,\n            \"retries\": 15\n          }\n        },\n        {\n          \"container\": \"memvid-ui\",\n          \"type\": \"optional\",\n          \"startOrder\": 3\n        }\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#algorithme-de-reveil","title":"\ud83d\ude80 Algorithme de R\u00e9veil","text":""},{"location":"03-operations/dependency-wake-chain/#pseudo-code","title":"Pseudo-code","text":"<pre><code>async function wakeServiceWithDependencies(serviceName) {\n  const service = dependencies.services[serviceName];\n\n  // 1. Charger la configuration des d\u00e9pendances\n  const depGraph = loadDependencyGraph(service);\n\n  // 2. Trier les d\u00e9pendances par startOrder\n  const sortedDeps = topologicalSort(depGraph);\n\n  // 3. Grouper par parallelGroup\n  const parallelGroups = groupByParallelGroup(sortedDeps);\n\n  // 4. D\u00e9marrer groupe par groupe\n  for (const group of parallelGroups) {\n    const startPromises = [];\n\n    for (const dep of group) {\n      // V\u00e9rifier si d\u00e9j\u00e0 running\n      if (await isContainerRunning(dep.container)) {\n        console.log(`\u2705 ${dep.container} already running`);\n        continue;\n      }\n\n      // D\u00e9marrer le conteneur\n      console.log(`\ud83d\ude80 Starting ${dep.container}...`);\n      const startPromise = startContainer(dep);\n\n      if (dep.type === 'required') {\n        startPromises.push(startPromise);\n      } else {\n        // Fire and forget pour les optionnels\n        startPromise.catch(err =&gt; console.warn(`\u26a0\ufe0f  Optional ${dep.container} failed:`, err));\n      }\n    }\n\n    // Attendre que tous les conteneurs required du groupe soient ready\n    await Promise.all(startPromises);\n    console.log(`\u2705 Group ${group[0].startOrder} ready`);\n  }\n\n  console.log(`\u2705 Service ${serviceName} and all dependencies are ready`);\n}\n\nasync function startContainer(dep) {\n  // 1. D\u00e9marrer le conteneur\n  await dockerComposeStart(dep.container, dep.composeDir);\n\n  // 2. Attendre le health check si d\u00e9fini\n  if (dep.healthCheck) {\n    await waitForHealthy(dep);\n  } else {\n    // Attendre un d\u00e9lai par d\u00e9faut\n    await sleep(5000);\n  }\n}\n\nasync function waitForHealthy(dep) {\n  const { command, interval, timeout, retries } = dep.healthCheck;\n  const startTime = Date.now();\n\n  for (let i = 0; i &lt; retries; i++) {\n    try {\n      // Ex\u00e9cuter la commande de health check\n      await exec(command);\n      console.log(`\u2705 ${dep.container} is healthy`);\n      return;\n    } catch (err) {\n      const elapsed = Date.now() - startTime;\n\n      if (elapsed &gt;= timeout) {\n        throw new Error(`Timeout waiting for ${dep.container} (${elapsed}ms)`);\n      }\n\n      console.log(`\u23f3 ${dep.container} not ready yet (attempt ${i+1}/${retries})...`);\n      await sleep(interval);\n    }\n  }\n\n  throw new Error(`${dep.container} failed health check after ${retries} attempts`);\n}\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#exemple-de-flux-wordpress-clemence","title":"\ud83d\udcca Exemple de Flux : WordPress Clemence","text":""},{"location":"03-operations/dependency-wake-chain/#etape-par-etape","title":"\u00c9tape par \u00c9tape","text":"<pre><code>sequenceDiagram\n    participant User\n    participant Nginx_Host as Nginx (Host)\n    participant AutoStart\n    participant Docker\n    participant MySQL as mysql-clemence\n    participant WordPress as wordpress-clemence\n    participant Nginx_Container as nginx-clemence\n\n    User-&gt;&gt;Nginx_Host: GET https://clemence.srv759970.hstgr.cloud\n    Nginx_Host-&gt;&gt;AutoStart: Proxy to :3456\n    AutoStart-&gt;&gt;Docker: Check clemence service\n\n    Note over AutoStart: Load dependencies.json\n    Note over AutoStart: Detect: wordpress-clemence needs mysql-clemence\n\n    AutoStart-&gt;&gt;Docker: Is mysql-clemence running?\n    Docker--&gt;&gt;AutoStart: No (stopped)\n\n    AutoStart-&gt;&gt;Docker: docker-compose start mysql-clemence\n    Docker-&gt;&gt;MySQL: Starting...\n\n    loop Health Check (every 2s, max 30s)\n        AutoStart-&gt;&gt;MySQL: mysqladmin ping\n        MySQL--&gt;&gt;AutoStart: Checking...\n    end\n\n    MySQL--&gt;&gt;AutoStart: \u2705 Healthy\n    Note over AutoStart: mysql-clemence ready (5s)\n\n    AutoStart-&gt;&gt;Docker: docker-compose start wordpress-clemence\n    Docker-&gt;&gt;WordPress: Starting...\n\n    loop Health Check (every 2s, max 30s)\n        AutoStart-&gt;&gt;WordPress: curl http://localhost:9000\n        WordPress--&gt;&gt;AutoStart: Checking...\n    end\n\n    WordPress--&gt;&gt;AutoStart: \u2705 Healthy\n    Note over AutoStart: wordpress-clemence ready (10s)\n\n    AutoStart-&gt;&gt;Docker: docker-compose start nginx-clemence\n    Docker-&gt;&gt;Nginx_Container: Starting...\n    Nginx_Container--&gt;&gt;AutoStart: \u2705 Ready (2s)\n\n    Note over AutoStart: All dependencies ready (total: 17s)\n\n    AutoStart-&gt;&gt;Nginx_Host: Proxy to wordpress-clemence:9002\n    Nginx_Host-&gt;&gt;User: HTTP 200 OK</code></pre> <p>Temps total : ~17s (au lieu de timeout ou erreur)</p>"},{"location":"03-operations/dependency-wake-chain/#interface-utilisateur-amelioree","title":"\ud83c\udfa8 Interface Utilisateur Am\u00e9lior\u00e9e","text":""},{"location":"03-operations/dependency-wake-chain/#page-dattente-dynamique-avec-progression","title":"Page d'Attente Dynamique avec Progression","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Starting WordPress Clemence...&lt;/title&gt;\n    &lt;style&gt;\n        .progress-container {\n            width: 80%;\n            margin: 50px auto;\n        }\n        .dependency {\n            margin: 20px 0;\n            padding: 15px;\n            border-radius: 8px;\n            background: #f5f5f5;\n        }\n        .dependency.pending { background: #fff3cd; }\n        .dependency.starting { background: #cfe2ff; }\n        .dependency.ready { background: #d1e7dd; }\n        .dependency.error { background: #f8d7da; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"progress-container\"&gt;\n        &lt;h1&gt;\ud83d\ude80 Starting WordPress Clemence&lt;/h1&gt;\n        &lt;p&gt;D\u00e9marrage des d\u00e9pendances en cours...&lt;/p&gt;\n\n        &lt;div id=\"mysql\" class=\"dependency starting\"&gt;\n            &lt;strong&gt;\ud83d\udce6 mysql-clemence&lt;/strong&gt;\n            &lt;div&gt;Status: Starting... (5s estimated)&lt;/div&gt;\n            &lt;div class=\"progress-bar\"&gt;\n                &lt;div class=\"progress\" style=\"width: 0%\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div id=\"wordpress\" class=\"dependency pending\"&gt;\n            &lt;strong&gt;\ud83d\udce6 wordpress-clemence&lt;/strong&gt;\n            &lt;div&gt;Status: Waiting for mysql-clemence...&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div id=\"nginx\" class=\"dependency pending\"&gt;\n            &lt;strong&gt;\ud83d\udce6 nginx-clemence&lt;/strong&gt;\n            &lt;div&gt;Status: Waiting for wordpress-clemence...&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"total-time\"&gt;\n            &lt;strong&gt;Temps total estim\u00e9:&lt;/strong&gt; ~17 secondes\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;script&gt;\n        // SSE pour recevoir les updates en temps r\u00e9el\n        const eventSource = new EventSource('/api/wake-status/clemence');\n\n        eventSource.addEventListener('dependency-update', (event) =&gt; {\n            const data = JSON.parse(event.data);\n            updateDependency(data.container, data.status, data.progress);\n        });\n\n        function updateDependency(container, status, progress) {\n            const elem = document.getElementById(container);\n            elem.className = `dependency ${status}`;\n            elem.querySelector('.progress').style.width = `${progress}%`;\n\n            if (status === 'ready') {\n                elem.querySelector('div:nth-child(2)').textContent = '\u2705 Ready!';\n            }\n        }\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#temps-de-demarrage-estimes","title":"\ud83d\udcc8 Temps de D\u00e9marrage Estim\u00e9s","text":"Service D\u00e9pendances Temps S\u00e9quentiel Temps Optimis\u00e9 (Parallel) WordPress Clemence mysql-clemence 5s + 10s = 15s 15s (sequential) Nextcloud postgresql + redis 8s + 2s + 15s = 25s 8s + 15s = 23s (postgres start first) RAGFlow ES + MySQL + Redis + Minio 30s + 8s + 3s + 5s + 45s = 91s 30s + 45s = 75s (all deps parallel) MemVid redis-shared 2s + 5s = 7s 7s (sequential) <p>Gains de temps : - WordPress : Pas de gain mais \u00e9vite les erreurs - Nextcloud : -2s (8%) - RAGFlow : -16s (18%) - MemVid : \u00c9vite les erreurs Redis</p>"},{"location":"03-operations/dependency-wake-chain/#migration-et-deploiement","title":"\ud83d\udd27 Migration et D\u00e9ploiement","text":""},{"location":"03-operations/dependency-wake-chain/#etape-1-analyser-les-dependances-existantes","title":"\u00c9tape 1 : Analyser les d\u00e9pendances existantes","text":"<pre><code># Script pour g\u00e9n\u00e9rer dependencies.json automatiquement\npython scripts/utils/generate-dependencies-config.py\n\n# Sortie : /opt/docker-autostart/dependencies.json\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#etape-2-tester-le-nouveau-systeme","title":"\u00c9tape 2 : Tester le nouveau syst\u00e8me","text":"<pre><code># Test en mode dry-run\ncurl -X POST http://localhost:3456/api/wake/clemence?dryRun=true\n\n# Sortie :\n{\n  \"service\": \"clemence\",\n  \"dependencies\": [\n    {\"container\": \"mysql-clemence\", \"order\": 1, \"estimatedTime\": \"5s\"},\n    {\"container\": \"wordpress-clemence\", \"order\": 2, \"estimatedTime\": \"10s\"},\n    {\"container\": \"nginx-clemence\", \"order\": 3, \"estimatedTime\": \"2s\"}\n  ],\n  \"totalEstimatedTime\": \"17s\",\n  \"parallel\": false\n}\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#etape-3-deployer-graduellement","title":"\u00c9tape 3 : D\u00e9ployer graduellement","text":"<pre><code># 1. D\u00e9ployer sur 1 service test (Clemence)\nsystemctl restart docker-autostart\n\n# 2. Tester\ncurl https://clemence.srv759970.hstgr.cloud\n\n# 3. Monitorer les logs\njournalctl -u docker-autostart -f | grep \"dependency\"\n\n# 4. Si OK, d\u00e9ployer sur tous les services\n# \u00c9diter dependencies.json pour ajouter nextcloud, ragflow, etc.\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#gestion-des-erreurs","title":"\ud83d\udea8 Gestion des Erreurs","text":""},{"location":"03-operations/dependency-wake-chain/#scenarios-dechec","title":"Sc\u00e9narios d'\u00c9chec","text":"<p>1. D\u00e9pendance required \u00e9choue <pre><code>if (dep.type === 'required' &amp;&amp; !healthy) {\n  // Arr\u00eater tout et notifier l'utilisateur\n  await stopAllStartedContainers();\n  throw new Error(`Critical dependency ${dep.container} failed`);\n}\n</code></pre></p> <p>2. D\u00e9pendance optional \u00e9choue <pre><code>if (dep.type === 'optional' &amp;&amp; !healthy) {\n  // Logger warning mais continuer\n  console.warn(`Optional ${dep.container} failed, continuing anyway`);\n}\n</code></pre></p> <p>3. Timeout global <pre><code>const globalTimeout = 5 * 60 * 1000; // 5 minutes max\nconst timeoutPromise = new Promise((_, reject) =&gt;\n  setTimeout(() =&gt; reject(new Error('Global timeout')), globalTimeout)\n);\n\nawait Promise.race([\n  wakeServiceWithDependencies(serviceName),\n  timeoutPromise\n]);\n</code></pre></p>"},{"location":"03-operations/dependency-wake-chain/#monitoring-et-metriques","title":"\ud83d\udcca Monitoring et M\u00e9triques","text":""},{"location":"03-operations/dependency-wake-chain/#nouvelles-metriques-a-tracker","title":"Nouvelles M\u00e9triques \u00e0 Tracker","text":"<pre><code>// Prometheus metrics\ndependency_wake_duration_seconds{service=\"clemence\", dependency=\"mysql-clemence\"}\ndependency_wake_success_total{service=\"clemence\"}\ndependency_wake_failure_total{service=\"clemence\", reason=\"health_check_failed\"}\ndependency_wake_parallel_efficiency{service=\"ragflow\"}\n</code></pre>"},{"location":"03-operations/dependency-wake-chain/#dashboard-grafana","title":"Dashboard Grafana","text":"<p>Panels \u00e0 cr\u00e9er : - Temps de r\u00e9veil par service (avg, p95, p99) - Taux de succ\u00e8s des d\u00e9pendances - Top services lents (d\u00e9pendances qui ralentissent) - Efficiency du parall\u00e9lisme (temps gagn\u00e9)</p>"},{"location":"03-operations/dependency-wake-chain/#evolutions-futures","title":"\ud83d\ude80 \u00c9volutions Futures","text":""},{"location":"03-operations/dependency-wake-chain/#phase-1-mvp-janvier-2026","title":"Phase 1 : MVP (Janvier 2026)","text":"<ul> <li>\u2705 D\u00e9pendances simples (same network)</li> <li>\u2705 Health checks basiques</li> <li>\u2705 Gestion erreurs required vs optional</li> <li>\u2705 Logs structur\u00e9s</li> </ul>"},{"location":"03-operations/dependency-wake-chain/#phase-2-optimisations-fevrier-2026","title":"Phase 2 : Optimisations (F\u00e9vrier 2026)","text":"<ul> <li>\u2705 D\u00e9pendances cross-network</li> <li>\u2705 D\u00e9marrage parall\u00e8le (parallelGroup)</li> <li>\u2705 Cache des \u00e9tats (\u00e9viter re-checks)</li> <li>\u2705 Retry logic intelligent</li> </ul>"},{"location":"03-operations/dependency-wake-chain/#phase-3-intelligence-mars-2026","title":"Phase 3 : Intelligence (Mars 2026)","text":"<ul> <li>\u2705 Pr\u00e9diction temps de d\u00e9marrage ML</li> <li>\u2705 Pre-warming proactif des d\u00e9pendances</li> <li>\u2705 Auto-tuning des health checks</li> <li>\u2705 Dependency graph visualization UI</li> </ul>"},{"location":"03-operations/dependency-wake-chain/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Architecture Docker</li> <li>Strat\u00e9gie Auto-Stop</li> <li>Script d'analyse</li> </ul> <p>Date de proposition : 2025-10-27 Auteur : Infrastructure Team Status : \u23f3 En analyse</p>"},{"location":"03-operations/deployment-docker-autostart/","title":"Guide Docker Auto-Start/Stop","text":"<p>Syst\u00e8me automatique de d\u00e9marrage et arr\u00eat des conteneurs Docker peu utilis\u00e9s pour optimiser la RAM.</p>"},{"location":"03-operations/deployment-docker-autostart/#architecture","title":"Architecture","text":"<pre><code>Internet (HTTPS)\n    \u2193\nNginx (port 443) - Basic Auth\n    \u2193\nNode.js Proxy (port 8890) - Auto-start/stop logic\n    \u2193\nDocker Container (port variable)\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#fonctionnement","title":"Fonctionnement","text":"<ol> <li>Requ\u00eate entrante : L'utilisateur acc\u00e8de \u00e0 https://service.srv759970.hstgr.cloud</li> <li>Nginx : V\u00e9rifie basic auth, puis proxifie vers port 8890</li> <li>Node.js Proxy :</li> <li>V\u00e9rifie si conteneurs running avec <code>docker ps</code></li> <li>Si arr\u00eat\u00e9s :<ul> <li>Mode Dynamic \u2192 Affiche page d'attente HTML (auto-refresh 3s)</li> <li>Mode Blocking \u2192 Attend silencieusement (pour APIs)</li> <li>Lance <code>docker-compose start</code></li> </ul> </li> <li>Si running : Proxifie directement vers le conteneur</li> <li>Idle checker (toutes les minutes) :</li> <li>Si aucune requ\u00eate depuis 15 min \u2192 <code>docker-compose stop</code></li> </ol>"},{"location":"03-operations/deployment-docker-autostart/#compatibilite-avec-dashy","title":"Compatibilit\u00e9 avec Dashy","text":""},{"location":"03-operations/deployment-docker-autostart/#conflit-dashy-status-checks","title":"\u26a0\ufe0f Conflit Dashy Status Checks","text":"<p>IMPORTANT : Dashy et docker-autostart peuvent entrer en conflit si les status checks sont activ\u00e9s.</p> <p>Probl\u00e8me : - Les status checks Dashy g\u00e9n\u00e8rent des requ\u00eates HTTP r\u00e9guli\u00e8res (axios/1.12.0) - Ces requ\u00eates r\u00e9initialisent le compteur d'inactivit\u00e9 - R\u00e9sultat : Les services ne s'arr\u00eatent jamais automatiquement</p> <p>Solution :</p> <ol> <li> <p>Supprimer compl\u00e8tement les status checks dans Dashy : <pre><code>cd /opt/dashy\nsed -i '/^[[:space:]]*statusCheck: \\(true\\|false\\)/d' conf.yml\ndocker-compose restart\n</code></pre></p> </li> <li> <p>Exclure Dashy de la configuration auto-stop (le laisser toujours actif)</p> </li> <li> <p>Dans <code>conf.yml</code>, NE PAS mettre <code>statusCheck: false</code>, mais SUPPRIMER la ligne : <pre><code># \u274c INCORRECT - Ne fonctionne pas (cache localStorage navigateur)\nappConfig:\n  statusCheck: false\n\n# \u2705 CORRECT - Supprimer la ligne compl\u00e8tement\nappConfig:\n  # statusCheck: REMOVED\n</code></pre></p> </li> </ol> <p>R\u00e9f\u00e9rence : Fix complet Dashy/Auto-Stop 24/10/2025</p>"},{"location":"03-operations/deployment-docker-autostart/#installation","title":"Installation","text":""},{"location":"03-operations/deployment-docker-autostart/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>\u2705 Node.js install\u00e9</li> <li>\u2705 Docker et Docker Compose</li> <li>\u2705 Nginx avec HTTPS/SSL configur\u00e9</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#fichiers-du-systeme","title":"Fichiers du syst\u00e8me","text":"<pre><code>/opt/docker-autostart/\n\u251c\u2500\u2500 server.js                   # Serveur Express (proxy + auto-start)\n\u251c\u2500\u2500 config.json                 # Configuration des services\n\u251c\u2500\u2500 package.json                # D\u00e9pendances npm\n\u2514\u2500\u2500 themes/                     # Pages d'attente HTML\n    \u251c\u2500\u2500 hacker-terminal.html\n    \u251c\u2500\u2500 ghost.html\n    \u251c\u2500\u2500 matrix.html\n    \u2514\u2500\u2500 shuffle.html\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#configuration-dun-nouveau-service","title":"Configuration d'un nouveau service","text":""},{"location":"03-operations/deployment-docker-autostart/#1-ajouter-dans-configjson","title":"1. Ajouter dans config.json","text":"<pre><code>{\n  \"port\": 8890,\n  \"idleTimeout\": 1800,\n  \"services\": {\n    \"votreservice.srv759970.hstgr.cloud\": {\n      \"name\": \"Nom Affich\u00e9\",\n      \"composeDir\": \"/opt/chemin-vers-service\",\n      \"proxyPort\": 8080,\n      \"theme\": \"hacker-terminal\",\n      \"containers\": [\"nom-conteneur\"]\n    }\n  }\n}\n</code></pre> <p>Param\u00e8tres : - <code>name</code> : Nom affich\u00e9 sur la page d'attente - <code>composeDir</code> : Chemin absolu vers le dossier docker-compose.yml - <code>proxyPort</code> : Port du conteneur \u00e0 proxifier - <code>theme</code> : Page d'attente (hacker-terminal, ghost, matrix, shuffle) - <code>containers</code> : Liste des noms de conteneurs (cf. <code>container_name:</code> dans docker-compose) - <code>blocking</code> : (optionnel) <code>true</code> pour mode API (pas de page d'attente)</p>"},{"location":"03-operations/deployment-docker-autostart/#2-modifier-docker-composeyml","title":"2. Modifier docker-compose.yml","text":"<p>Important : Changer la restart policy :</p> <pre><code>services:\n  votreservice:\n    # ...\n    restart: \"no\"  # \u2190 Obligatoire pour auto-start\n</code></pre> <p>Recr\u00e9er les conteneurs :</p> <pre><code>cd /opt/votreservice\ndocker-compose down\ndocker-compose up -d\ndocker-compose stop\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#3-configurer-nginx","title":"3. Configurer Nginx","text":"<p>Exemple pour un site web (mode Dynamic) :</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name votreservice.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/votreservice.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/votreservice.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    # Basic Auth (optionnel)\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://127.0.0.1:8890;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        proxy_read_timeout 300;\n        client_max_body_size 100M;\n    }\n}\n\nserver {\n    listen 80;\n    server_name votreservice.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Pour une API (mode Blocking), ajouter <code>\"blocking\": true</code> dans config.json.</p>"},{"location":"03-operations/deployment-docker-autostart/#4-redemarrer-le-service","title":"4. Red\u00e9marrer le service","text":"<pre><code>systemctl restart docker-autostart\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#services-configures","title":"Services configur\u00e9s","text":"Service URL Type Mode Th\u00e8me Port SolidarLink solidarlink.srv759970.hstgr.cloud WordPress Dynamic hacker-terminal 9003 Tika API tika.srv759970.hstgr.cloud API Blocking - 9998 Cl\u00e9mence clemence.srv759970.hstgr.cloud WordPress Dynamic ghost 9002 Support Dashboard dashboard.srv759970.hstgr.cloud Streamlit Dynamic matrix 8501 SharePoint Dashboards sharepoint.srv759970.hstgr.cloud Streamlit Dynamic shuffle 8502 Cristina Admin admin.cristina.srv759970.hstgr.cloud Strapi Dynamic ghost 1337 Whisper API (faster-whisper) whisper.srv759970.hstgr.cloud API Blocking - 8001 WhisperX API (diarization) whisperx.srv759970.hstgr.cloud API Blocking - 8002"},{"location":"03-operations/deployment-docker-autostart/#modes-doperation","title":"Modes d'op\u00e9ration","text":""},{"location":"03-operations/deployment-docker-autostart/#mode-dynamic-sites-web","title":"Mode Dynamic (Sites web)","text":"<ul> <li>Affiche une page d'attente pendant le d\u00e9marrage (~15-20s)</li> <li>Auto-refresh toutes les 3 secondes</li> <li>Th\u00e8mes disponibles : hacker-terminal, ghost, matrix, shuffle</li> <li>Utilisation : Sites web, dashboards, admin panels</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#mode-blocking-apis","title":"Mode Blocking (APIs)","text":"<ul> <li>Attend silencieusement que les conteneurs d\u00e9marrent</li> <li>Timeout : 30 secondes</li> <li>Pas de page d'attente (meilleur pour les API clients)</li> <li>Utilisation : APIs REST, services backend</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#commandes-utiles","title":"Commandes utiles","text":""},{"location":"03-operations/deployment-docker-autostart/#service-systemd","title":"Service systemd","text":"<pre><code># Statut\nsystemctl status docker-autostart\n\n# Logs en temps r\u00e9el\njournalctl -u docker-autostart -f\n\n# Red\u00e9marrer\nsystemctl restart docker-autostart\n\n# Arr\u00eater/D\u00e9marrer\nsystemctl stop docker-autostart\nsystemctl start docker-autostart\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#debug","title":"Debug","text":"<pre><code># V\u00e9rifier la config\ncat /opt/docker-autostart/config.json | jq\n\n# Tester manuellement (arr\u00eater systemd avant)\nsystemctl stop docker-autostart\ncd /opt/docker-autostart &amp;&amp; node server.js\n\n# V\u00e9rifier conteneurs arr\u00eat\u00e9s\ndocker ps -a | grep -E \"(support|sharepoint|cristina|tika|solidarlink|clemence|whisper)\"\n\n# Forcer arr\u00eat des conteneurs pour test\ncd /opt/votreservice &amp;&amp; docker-compose stop\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#tester-lauto-start","title":"Tester l'auto-start","text":"<pre><code># 1. Arr\u00eater le conteneur\ncd /opt/support-dashboard &amp;&amp; docker-compose stop\n\n# 2. Acc\u00e9der \u00e0 l'URL\ncurl -I https://dashboard.srv759970.hstgr.cloud\n\n# 3. V\u00e9rifier les logs\njournalctl -u docker-autostart -n 20 --no-pager\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#themes-des-pages-dattente","title":"Th\u00e8mes des pages d'attente","text":""},{"location":"03-operations/deployment-docker-autostart/#hacker-terminal","title":"hacker-terminal","text":"<ul> <li>Fond noir avec gradient vert radial</li> <li>Texte vert phosphorescent style terminal</li> <li>Effet scanlines + CRT monitor</li> <li>Parfait pour : Sites techniques, outils dev</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#ghost","title":"ghost","text":"<ul> <li>Fond sombre avec animation de fant\u00f4mes flottants</li> <li>Couleurs violettes/roses</li> <li>Effet myst\u00e9rieux et \u00e9l\u00e9gant</li> <li>Parfait pour : Sites cr\u00e9atifs, portfolios</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#matrix","title":"matrix","text":"<ul> <li>Effet pluie de caract\u00e8res Matrix</li> <li>Fond noir, caract\u00e8res verts qui tombent</li> <li>Animation constante</li> <li>Parfait pour : APIs, services backend</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#shuffle","title":"shuffle","text":"<ul> <li>Cartes qui se m\u00e9langent avec animation</li> <li>Color\u00e9 et dynamique</li> <li>Effet ludique</li> <li>Parfait pour : Dashboards, outils analytics</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#personnalisation","title":"Personnalisation","text":""},{"location":"03-operations/deployment-docker-autostart/#creer-un-nouveau-theme","title":"Cr\u00e9er un nouveau th\u00e8me","text":"<ol> <li>Cr\u00e9er <code>/opt/docker-autostart/themes/montheme.html</code></li> <li>Utiliser les placeholders :</li> <li><code>{{SERVICE_NAME}}</code> : Remplac\u00e9 par le nom du service</li> <li><code>{{DISPLAY_NAME}}</code> : Alias de SERVICE_NAME</li> <li>Ajouter auto-refresh : <pre><code>&lt;meta http-equiv=\"refresh\" content=\"3\" /&gt;\n</code></pre></li> <li>R\u00e9f\u00e9rencer dans config.json : <pre><code>\"theme\": \"montheme\"\n</code></pre></li> </ol>"},{"location":"03-operations/deployment-docker-autostart/#modifier-le-timeout-dinactivite","title":"Modifier le timeout d'inactivit\u00e9","text":"<p>\u00c9diter <code>/opt/docker-autostart/config.json</code> :</p> <pre><code>{\n  \"idleTimeout\": 3600,  // 60 minutes au lieu de 30\n  // ...\n}\n</code></pre> <p>Puis red\u00e9marrer : <pre><code>systemctl restart docker-autostart\n</code></pre></p>"},{"location":"03-operations/deployment-docker-autostart/#troubleshooting","title":"Troubleshooting","text":""},{"location":"03-operations/deployment-docker-autostart/#probleme-page-dattente-ne-saffiche-pas","title":"Probl\u00e8me : Page d'attente ne s'affiche pas","text":"<p>Diagnostic : <pre><code>journalctl -u docker-autostart -n 50 --no-pager\n</code></pre></p> <p>Solutions : - V\u00e9rifier que Nginx proxifie vers port 8890 - V\u00e9rifier le service tourne : <code>systemctl status docker-autostart</code> - V\u00e9rifier config.json valide : <code>cat /opt/docker-autostart/config.json | jq</code></p>"},{"location":"03-operations/deployment-docker-autostart/#probleme-conteneurs-redemarrent-automatiquement","title":"Probl\u00e8me : Conteneurs red\u00e9marrent automatiquement","text":"<p>Cause : Restart policy incorrecte dans docker-compose.yml</p> <p>Solution : <pre><code>cd /opt/votreservice\ngrep 'restart:' docker-compose.yml  # Doit afficher \"no\"\n# Si ce n'est pas le cas :\nsed -i 's/restart: unless-stopped/restart: \"no\"/g' docker-compose.yml\ndocker-compose down &amp;&amp; docker-compose up -d &amp;&amp; docker-compose stop\n</code></pre></p>"},{"location":"03-operations/deployment-docker-autostart/#probleme-conteneurs-ne-demarrent-pas","title":"Probl\u00e8me : Conteneurs ne d\u00e9marrent pas","text":"<p>V\u00e9rifier : <pre><code># Nom des conteneurs dans config.json\ncat /opt/docker-autostart/config.json | jq '.services[\"votreservice.srv759970.hstgr.cloud\"].containers'\n\n# Nom r\u00e9el des conteneurs\ndocker ps -a --format '{{.Names}}' | grep votreservice\n</code></pre></p> <p>Les noms doivent correspondre exactement (cf. <code>container_name:</code> dans docker-compose.yml).</p>"},{"location":"03-operations/deployment-docker-autostart/#probleme-services-ne-sarretent-jamais-auto-stop-ne-fonctionne-pas","title":"Probl\u00e8me : Services ne s'arr\u00eatent jamais (auto-stop ne fonctionne pas)","text":"<p>Diagnostic : <pre><code># V\u00e9rifier le trafic suspect\ntail -100 /var/log/nginx/votreservice-access.log | grep axios\n</code></pre></p> <p>Causes possibles : 1. Dashy status checks \u2192 Voir section \"Compatibilit\u00e9 avec Dashy\" ci-dessus 2. Monitoring externe \u2192 Ajouter exclusion dans nginx ou auto-stop 3. Timeout trop court \u2192 Augmenter <code>idleTimeout</code> dans config.json 4. Service conflictuel \u2192 V\u00e9rifier si <code>nginx-auto-docker</code> est actif : <pre><code>systemctl status nginx-auto-docker\n# Si actif, le d\u00e9sactiver :\nsystemctl disable --now nginx-auto-docker\n</code></pre></p>"},{"location":"03-operations/deployment-docker-autostart/#probleme-502-bad-gateway-apres-demarrage","title":"Probl\u00e8me : 502 Bad Gateway apr\u00e8s d\u00e9marrage","text":"<p>Cause : Conteneurs pas encore pr\u00eats apr\u00e8s <code>docker-compose start</code></p> <p>Solution : - Ajouter un healthcheck dans docker-compose.yml - Augmenter le d\u00e9lai d'attente dans server.js (waitForReady) - Pour les sites lents, utiliser mode Dynamic au lieu de Blocking</p>"},{"location":"03-operations/deployment-docker-autostart/#optimisation-ram","title":"Optimisation RAM","text":""},{"location":"03-operations/deployment-docker-autostart/#avant-auto-start","title":"Avant auto-start","text":"<pre><code>RAM utilis\u00e9e : 7.1GB / 8GB (89%)\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#apres-auto-start-conteneurs-arretes","title":"Apr\u00e8s auto-start (conteneurs arr\u00eat\u00e9s)","text":"<pre><code>RAM utilis\u00e9e : 2.4GB / 8GB (30%)\n\u00c9conomie : 4.7GB (66%)\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#services-concernes","title":"Services concern\u00e9s","text":"<ul> <li>Support Dashboard : ~300MB</li> <li>SharePoint Dashboards : ~300MB</li> <li>Cristina Admin (Strapi) : ~400MB</li> <li>Tika API : ~800MB</li> <li>SolidarLink (WordPress) : ~200MB</li> <li>Cl\u00e9mence (WordPress) : ~200MB</li> <li>Whisper API (faster-whisper) : ~400MB</li> <li>WhisperX API : ~500MB</li> </ul> <p>Total \u00e9conomis\u00e9 : ~3.1GB de RAM quand tous arr\u00eat\u00e9s</p>"},{"location":"03-operations/deployment-docker-autostart/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"03-operations/deployment-docker-autostart/#basic-auth","title":"Basic Auth","text":"<p>Tous les services sont prot\u00e9g\u00e9s par basic auth Nginx. Les credentials sont dans <code>/etc/nginx/.htpasswd</code>.</p>"},{"location":"03-operations/deployment-docker-autostart/#exposition-des-ports","title":"Exposition des ports","text":"<p>Le proxy Node.js \u00e9coute uniquement sur 127.0.0.1:8890 (localhost), pas accessible depuis l'ext\u00e9rieur.</p>"},{"location":"03-operations/deployment-docker-autostart/#acces-docker-socket","title":"Acc\u00e8s Docker socket","text":"<p>Le service systemd tourne en tant que <code>root</code> pour acc\u00e9der \u00e0 Docker socket (<code>/var/run/docker.sock</code>).</p>"},{"location":"03-operations/deployment-docker-autostart/#maintenance","title":"Maintenance","text":""},{"location":"03-operations/deployment-docker-autostart/#backup-de-la-configuration","title":"Backup de la configuration","text":"<pre><code># Backup config\ncp /opt/docker-autostart/config.json /opt/docker-autostart/config.json.backup\n\n# Versionner dans Git (recommand\u00e9)\ncd /opt/docker-autostart\ngit init\ngit add .\ngit commit -m \"Configuration auto-start\"\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#mise-a-jour-du-serveur-nodejs","title":"Mise \u00e0 jour du serveur Node.js","text":"<pre><code># \u00c9diter server.js\nnano /opt/docker-autostart/server.js\n\n# Test syntaxe\nnode -c /opt/docker-autostart/server.js\n\n# Red\u00e9marrer\nsystemctl restart docker-autostart\n</code></pre>"},{"location":"03-operations/deployment-docker-autostart/#limites-actuelles","title":"Limites actuelles","text":""},{"location":"03-operations/deployment-docker-autostart/#non-supporte","title":"Non support\u00e9","text":"<ul> <li>\u274c Ollama : Service systemd (pas Docker), n\u00e9cessite approche diff\u00e9rente</li> <li>\u274c MySQL shared : Doit rester actif (utilis\u00e9 par plusieurs WordPress)</li> <li>\u274c Portainer/Dozzle/Netdata : Services de monitoring, doivent rester actifs</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#a-venir","title":"\u00c0 venir","text":"<ul> <li> Support Ollama via systemd socket activation</li> <li> Healthchecks personnalisables par service</li> <li> Notifications (email/webhook) au d\u00e9marrage/arr\u00eat</li> <li> Dashboard web pour voir l'\u00e9tat des services</li> <li> M\u00e9triques de d\u00e9marrage/arr\u00eat (logs structur\u00e9s)</li> </ul>"},{"location":"03-operations/deployment-docker-autostart/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Documentation Sablier : https://sablierapp.dev (inspiration pour les th\u00e8mes)</li> <li>Node.js Express : https://expressjs.com</li> <li>Docker Compose : https://docs.docker.com/compose/</li> <li>Systemd : https://www.freedesktop.org/software/systemd/man/systemd.service.html</li> </ul>"},{"location":"03-operations/deployment-systemd/","title":"\ud83d\udd27 Guide des services systemd sur VPS Hostinger","text":"<p>Guide pour d\u00e9ployer et g\u00e9rer des services natifs (non-Docker) sur le VPS.</p>"},{"location":"03-operations/deployment-systemd/#quand-utiliser-systemd-vs-docker","title":"\ud83d\udccb Quand utiliser systemd vs Docker ?","text":""},{"location":"03-operations/deployment-systemd/#utiliser-systemd-quand","title":"Utiliser systemd quand :","text":"<ul> <li>\u2705 Service l\u00e9ger n\u00e9cessitant acc\u00e8s direct au syst\u00e8me</li> <li>\u2705 Performance maximale requise (pas de virtualisation)</li> <li>\u2705 Service syst\u00e8me existant (Ollama, bases de donn\u00e9es, etc.)</li> <li>\u2705 Gestion simplifi\u00e9e sans conteneurisation</li> </ul>"},{"location":"03-operations/deployment-systemd/#utiliser-docker-quand","title":"Utiliser Docker quand :","text":"<ul> <li>\u2705 Isolation compl\u00e8te n\u00e9cessaire</li> <li>\u2705 Portabilit\u00e9 entre environnements</li> <li>\u2705 Application web classique</li> <li>\u27a1\ufe0f Voir <code>GUIDE_DEPLOIEMENT_VPS.md</code></li> </ul>"},{"location":"03-operations/deployment-systemd/#services-systemd-actuellement-deployes","title":"\ud83c\udfaf Services systemd actuellement d\u00e9ploy\u00e9s","text":"Service Port(s) Description Status <code>ollama.service</code> 11434 (local) LLM inference API \u2705 En ligne <code>nginx.service</code> 80, 11435 Reverse proxy \u2705 En ligne"},{"location":"03-operations/deployment-systemd/#exemple-ollama-api","title":"\ud83d\udce6 Exemple : Ollama API","text":""},{"location":"03-operations/deployment-systemd/#architecture","title":"Architecture","text":"<pre><code>Client \u2192 Nginx (0.0.0.0:11435) \u2192 Ollama (127.0.0.1:11434)\n</code></pre>"},{"location":"03-operations/deployment-systemd/#1-installation-du-service","title":"1. Installation du service","text":"<pre><code># Ollama est d\u00e9j\u00e0 install\u00e9, mais voici la proc\u00e9dure g\u00e9n\u00e9rique\nssh root@69.62.108.82 \"curl -fsSL https://ollama.com/install.sh | sh\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#2-configuration-du-service","title":"2. Configuration du service","text":"<p>Le service est g\u00e9r\u00e9 par systemd : <code>/etc/systemd/system/ollama.service</code></p> <pre><code># Voir la configuration\nssh root@69.62.108.82 \"systemctl cat ollama\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#3-gestion-du-service","title":"3. Gestion du service","text":"<pre><code># D\u00e9marrer\nssh root@69.62.108.82 \"systemctl start ollama\"\n\n# Arr\u00eater\nssh root@69.62.108.82 \"systemctl stop ollama\"\n\n# Red\u00e9marrer\nssh root@69.62.108.82 \"systemctl restart ollama\"\n\n# Statut\nssh root@69.62.108.82 \"systemctl status ollama\"\n\n# Activer au d\u00e9marrage\nssh root@69.62.108.82 \"systemctl enable ollama\"\n\n# Logs en temps r\u00e9el\nssh root@69.62.108.82 \"journalctl -u ollama -f\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#4-configuration-nginx-reverse-proxy","title":"4. Configuration Nginx (reverse proxy)","text":"<p>Fichier : <code>/etc/nginx/sites-available/ollama-api</code></p> <pre><code>server {\n    listen 0.0.0.0:11435;\n    server_name _;\n\n    access_log /var/log/nginx/ollama-access.log;\n    error_log /var/log/nginx/ollama-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:11434;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n        proxy_read_timeout 300s;\n        proxy_connect_timeout 75s;\n\n        proxy_buffering off;\n        proxy_cache off;\n\n        # CORS headers\n        add_header Access-Control-Allow-Origin * always;\n        add_header Access-Control-Allow-Methods \"GET, POST, OPTIONS\" always;\n        add_header Access-Control-Allow-Headers \"Content-Type, Authorization\" always;\n    }\n}\n</code></pre> <p>Activation :</p> <pre><code>ssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/ollama-api /etc/nginx/sites-enabled/ollama-api\"\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#5-verification","title":"5. V\u00e9rification","text":"<pre><code># Test local (sur le serveur)\nssh root@69.62.108.82 \"curl http://localhost:11434/api/version\"\n\n# Test public (depuis l'ext\u00e9rieur)\ncurl http://69.62.108.82:11435/api/version\n\n# V\u00e9rifier les ports \u00e9cout\u00e9s\nssh root@69.62.108.82 \"netstat -tlnp | grep -E '11434|11435'\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#6-gestion-des-modeles","title":"6. Gestion des mod\u00e8les","text":"<pre><code># Lister les mod\u00e8les install\u00e9s\nssh root@69.62.108.82 \"ollama list\"\n\n# T\u00e9l\u00e9charger un nouveau mod\u00e8le\nssh root@69.62.108.82 \"ollama pull llama3.2:3b\"\n\n# Supprimer un mod\u00e8le\nssh root@69.62.108.82 \"ollama rm llama3.2:1b\"\n\n# Voir l'espace utilis\u00e9\nssh root@69.62.108.82 \"du -sh /usr/share/ollama/.ollama/models\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#template-generique-deployer-un-service-systemd","title":"\ud83d\udd27 Template g\u00e9n\u00e9rique : D\u00e9ployer un service systemd","text":""},{"location":"03-operations/deployment-systemd/#etape-1-creer-le-fichier-de-service","title":"\u00c9tape 1 : Cr\u00e9er le fichier de service","text":"<pre><code>ssh root@69.62.108.82 \"cat &gt; /etc/systemd/system/mon-service.service\" &lt;&lt; 'EOF'\n[Unit]\nDescription=Mon service personnalis\u00e9\nAfter=network.target\n\n[Service]\nType=simple\nUser=root\nWorkingDirectory=/opt/mon-service\nExecStart=/usr/local/bin/mon-executable\nRestart=on-failure\nRestartSec=5s\n\nEnvironment=\"PORT=8080\"\nEnvironment=\"LOG_LEVEL=info\"\n\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre>"},{"location":"03-operations/deployment-systemd/#etape-2-activer-et-demarrer","title":"\u00c9tape 2 : Activer et d\u00e9marrer","text":"<pre><code># Recharger systemd (apr\u00e8s modification de fichier .service)\nssh root@69.62.108.82 \"systemctl daemon-reload\"\n\n# Activer au d\u00e9marrage\nssh root@69.62.108.82 \"systemctl enable mon-service\"\n\n# D\u00e9marrer\nssh root@69.62.108.82 \"systemctl start mon-service\"\n\n# V\u00e9rifier\nssh root@69.62.108.82 \"systemctl status mon-service\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#etape-3-exposer-via-nginx-si-necessaire","title":"\u00c9tape 3 : Exposer via Nginx (si n\u00e9cessaire)","text":"<pre><code>ssh root@69.62.108.82 'cat &gt; /etc/nginx/sites-available/mon-service &lt;&lt; \"HEREDOC\"\nserver {\n    listen 80;\n    server_name mon-service.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:8080;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\nHEREDOC'\n\n# Activer\nssh root@69.62.108.82 \"ln -s /etc/nginx/sites-available/mon-service /etc/nginx/sites-enabled/\"\nssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#monitoring-et-logs","title":"\ud83d\udcca Monitoring et logs","text":""},{"location":"03-operations/deployment-systemd/#logs-systemd","title":"Logs systemd","text":"<pre><code># Logs d'un service (temps r\u00e9el)\nssh root@69.62.108.82 \"journalctl -u ollama -f\"\n\n# Logs depuis un certain temps\nssh root@69.62.108.82 \"journalctl -u ollama --since '1 hour ago'\"\n\n# Logs avec niveau de d\u00e9tail\nssh root@69.62.108.82 \"journalctl -u ollama -p err\"  # Seulement les erreurs\n</code></pre>"},{"location":"03-operations/deployment-systemd/#logs-nginx-pour-services-proxifies","title":"Logs Nginx (pour services proxifi\u00e9s)","text":"<pre><code># Logs d'acc\u00e8s sp\u00e9cifiques\nssh root@69.62.108.82 \"tail -f /var/log/nginx/ollama-access.log\"\n\n# Logs d'erreur sp\u00e9cifiques\nssh root@69.62.108.82 \"tail -f /var/log/nginx/ollama-error.log\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#ressources-systeme","title":"Ressources syst\u00e8me","text":"<pre><code># Utilisation CPU/RAM d'un service\nssh root@69.62.108.82 \"systemctl status ollama | grep -E 'Memory|CPU'\"\n\n# Processus en cours\nssh root@69.62.108.82 \"ps aux | grep ollama\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#mise-a-jour-dun-service","title":"\ud83d\udd04 Mise \u00e0 jour d'un service","text":""},{"location":"03-operations/deployment-systemd/#exemple-mettre-a-jour-ollama","title":"Exemple : Mettre \u00e0 jour Ollama","text":"<pre><code># 1. Arr\u00eater le service\nssh root@69.62.108.82 \"systemctl stop ollama\"\n\n# 2. Mettre \u00e0 jour (m\u00e9thode d\u00e9pend du service)\nssh root@69.62.108.82 \"curl -fsSL https://ollama.com/install.sh | sh\"\n\n# 3. Red\u00e9marrer\nssh root@69.62.108.82 \"systemctl start ollama\"\n\n# 4. V\u00e9rifier\nssh root@69.62.108.82 \"systemctl status ollama\"\nssh root@69.62.108.82 \"ollama --version\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#securite","title":"\ud83d\udee1\ufe0f S\u00e9curit\u00e9","text":""},{"location":"03-operations/deployment-systemd/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"03-operations/deployment-systemd/#1-ne-pas-exposer-directement-les-services","title":"1. Ne pas exposer directement les services","text":"<p>\u274c Mauvais : Service \u00e9coute sur 0.0.0.0 <pre><code># Service accessible directement depuis Internet\nExecStart=/usr/bin/mon-app --host 0.0.0.0 --port 8080\n</code></pre></p> <p>\u2705 Bon : Service \u00e9coute sur localhost, Nginx fait le proxy <pre><code># Service local uniquement\nExecStart=/usr/bin/mon-app --host 127.0.0.1 --port 8080\n\n# Nginx expose publiquement avec contr\u00f4les\n</code></pre></p>"},{"location":"03-operations/deployment-systemd/#2-limiter-les-permissions","title":"2. Limiter les permissions","text":"<pre><code># Ne pas lancer en root si pas n\u00e9cessaire\n[Service]\nUser=www-data\nGroup=www-data\n</code></pre>"},{"location":"03-operations/deployment-systemd/#3-restreindre-lacces-reseau-optionnel","title":"3. Restreindre l'acc\u00e8s r\u00e9seau (optionnel)","text":"<pre><code># Dans Nginx : limiter par IP\nlocation / {\n    allow 192.168.1.0/24;  # Votre r\u00e9seau\n    deny all;\n\n    proxy_pass http://localhost:8080;\n}\n</code></pre>"},{"location":"03-operations/deployment-systemd/#troubleshooting","title":"\ud83d\udd0d Troubleshooting","text":""},{"location":"03-operations/deployment-systemd/#le-service-ne-demarre-pas","title":"Le service ne d\u00e9marre pas","text":"<pre><code># 1. Voir les logs d\u00e9taill\u00e9s\nssh root@69.62.108.82 \"journalctl -u mon-service -n 50\"\n\n# 2. V\u00e9rifier la syntaxe du fichier .service\nssh root@69.62.108.82 \"systemd-analyze verify /etc/systemd/system/mon-service.service\"\n\n# 3. V\u00e9rifier que l'ex\u00e9cutable existe\nssh root@69.62.108.82 \"ls -la /usr/local/bin/mon-executable\"\n\n# 4. Tester manuellement\nssh root@69.62.108.82 \"/usr/local/bin/mon-executable\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#le-service-redemarre-en-boucle","title":"Le service red\u00e9marre en boucle","text":"<pre><code># Voir pourquoi il crash\nssh root@69.62.108.82 \"journalctl -u mon-service | tail -100\"\n\n# D\u00e9sactiver le restart automatique temporairement\nssh root@69.62.108.82 \"systemctl edit --full mon-service\"\n# Puis commenter la ligne : Restart=on-failure\n</code></pre>"},{"location":"03-operations/deployment-systemd/#port-deja-utilise","title":"Port d\u00e9j\u00e0 utilis\u00e9","text":"<pre><code># Trouver qui utilise le port\nssh root@69.62.108.82 \"lsof -i :8080\"\nssh root@69.62.108.82 \"netstat -tlnp | grep 8080\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#nginx-ne-forward-pas-correctement","title":"Nginx ne forward pas correctement","text":"<pre><code># Test de la config\nssh root@69.62.108.82 \"nginx -t\"\n\n# V\u00e9rifier que le service backend r\u00e9pond\nssh root@69.62.108.82 \"curl http://localhost:8080\"\n\n# Voir les erreurs Nginx\nssh root@69.62.108.82 \"tail -50 /var/log/nginx/error.log\"\n</code></pre>"},{"location":"03-operations/deployment-systemd/#checklist-de-deploiement","title":"\ud83d\udccb Checklist de d\u00e9ploiement","text":"<p>Avant de d\u00e9ployer un nouveau service systemd :</p> <ul> <li> Ex\u00e9cutable test\u00e9 manuellement</li> <li> Fichier <code>.service</code> cr\u00e9\u00e9 dans <code>/etc/systemd/system/</code></li> <li> <code>systemctl daemon-reload</code> ex\u00e9cut\u00e9</li> <li> Service activ\u00e9 avec <code>systemctl enable</code></li> <li> Service d\u00e9marr\u00e9 avec <code>systemctl start</code></li> <li> Logs v\u00e9rifi\u00e9s (pas d'erreur)</li> <li> Service accessible en local (curl localhost:PORT)</li> <li> (Optionnel) Configuration Nginx cr\u00e9\u00e9e</li> <li> (Optionnel) Nginx recharg\u00e9</li> <li> (Optionnel) Service accessible publiquement</li> </ul>"},{"location":"03-operations/deployment-systemd/#comparaison-systemd-vs-docker","title":"\ud83c\udf93 Comparaison systemd vs Docker","text":"Aspect systemd Docker Isolation Faible Forte Performance Native L\u00e9g\u00e8re overhead Portabilit\u00e9 D\u00e9pend de l'OS Ind\u00e9pendant de l'OS Complexit\u00e9 Simple Moyenne Gestion systemctl docker-compose Logs journalctl docker logs Mise \u00e0 jour Manuelle Rebuild image Cas d'usage Services syst\u00e8me Applications web"},{"location":"03-operations/deployment-systemd/#informations","title":"\ud83d\udcde Informations","text":"<p>Serveur : srv759970.hstgr.cloud (69.62.108.82) OS : Ubuntu 24.04.2 LTS Services actifs : ollama, nginx</p> <p>Commandes rapides : <pre><code># Lister tous les services\nssh root@69.62.108.82 \"systemctl list-units --type=service --state=running\"\n\n# Voir les services qui ont failed\nssh root@69.62.108.82 \"systemctl --failed\"\n</code></pre></p> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Services d\u00e9ploy\u00e9s : 1 (Ollama)</p>"},{"location":"03-operations/docker-autostart/","title":"Configuration Docker Auto-Start/Stop","text":""},{"location":"03-operations/docker-autostart/#vue-densemble","title":"Vue d'ensemble","text":"<p>Le syst\u00e8me d'auto-start/stop automatique est un proxy Node.js custom qui g\u00e8re le d\u00e9marrage/arr\u00eat automatique des services Docker en fonction de l'activit\u00e9. Il remplace l'ancien syst\u00e8me Sablier.</p> <p>Emplacement : <code>/opt/docker-autostart/</code> Port : <code>8890</code> Configuration : <code>/opt/docker-autostart/config.json</code> Timeout d'inactivit\u00e9 : <code>900</code> secondes (15 minutes) Services configur\u00e9s : 23 \u00c9tat : \u2705 Fonctionnel (fix 24/10/2025)</p>"},{"location":"03-operations/docker-autostart/#services-configures","title":"Services configur\u00e9s","text":""},{"location":"03-operations/docker-autostart/#tableau-recapitulatif","title":"Tableau r\u00e9capitulatif","text":"Service Nom Compose Dir Port Proxy Mode Th\u00e8me Conteneurs solidarlink.srv759970.hstgr.cloud SolidarLink <code>/opt/wordpress-solidarlink</code> 9003 Dynamic hacker-terminal nginx-solidarlink, wordpress-solidarlink tika.srv759970.hstgr.cloud Tika API <code>/opt/tika-server</code> 9998 Blocking (none) tika-server clemence.srv759970.hstgr.cloud Cl\u00e9mence Site <code>/opt/wordpress-clemence</code> 9002 Dynamic ghost wordpress-clemence, nginx-clemence dashboard.srv759970.hstgr.cloud Support Dashboard <code>/opt/support-dashboard</code> 8501 Dynamic matrix support-dashboard sharepoint.srv759970.hstgr.cloud SharePoint Dashboards <code>/opt/sharepoint-dashboards</code> 8502 Dynamic shuffle sharepoint-dashboards admin.cristina.srv759970.hstgr.cloud Cristina Admin <code>/opt/cristina-backend</code> 1337 Dynamic ghost cristina-strapi whisper.srv759970.hstgr.cloud Whisper API (faster-whisper) <code>/opt/whisper-faster</code> 8001 Blocking (none) faster-whisper whisperx.srv759970.hstgr.cloud WhisperX API (with diarization) <code>/opt/whisperx</code> 8002 Blocking (none) whisperx memvid.srv759970.hstgr.cloud MemVid RAG API <code>/opt/memvid</code> 8506 Blocking (none) memvid-api memvid-ui.srv759970.hstgr.cloud MemVid UI <code>/opt/memvid</code> 8507 Dynamic matrix memvid-ui ragflow.srv759970.hstgr.cloud RAGFlow <code>/opt/ragflow/docker</code> 9500 Blocking cyberpunk ragflow-server, ragflow-mysql, ragflow-es-01, ragflow-redis, ragflow-minio rag-anything.srv759970.hstgr.cloud RAG-Anything <code>/opt/rag-anything</code> 9510 Blocking synthwave rag-anything-api"},{"location":"03-operations/docker-autostart/#details-des-parametres","title":"D\u00e9tails des param\u00e8tres","text":""},{"location":"03-operations/docker-autostart/#1-mode-dynamic-vs-blocking","title":"1. Mode Dynamic vs Blocking","text":""},{"location":"03-operations/docker-autostart/#dynamic-mode-defaut","title":"Dynamic Mode (d\u00e9faut)","text":"<ul> <li>Comportement : Affiche une page d'attente anim\u00e9e pendant le d\u00e9marrage</li> <li>Utilisation : Sites web, dashboards, applications UI</li> <li>Services : SolidarLink, Cl\u00e9mence, Support Dashboard, SharePoint, Cristina, MemVid UI</li> <li>Th\u00e8mes disponibles :</li> <li><code>matrix</code> - Animation Matrix (pluie de caract\u00e8res verts)</li> <li><code>ghost</code> - Fant\u00f4mes flottants avec effets de particules</li> <li><code>hacker-terminal</code> - Terminal de hacking avec commandes simul\u00e9es</li> <li><code>shuffle</code> - Cartes qui se m\u00e9langent et se r\u00e9v\u00e8lent</li> <li><code>cyberpunk</code> - Grille n\u00e9on avec effet glitch</li> <li><code>synthwave</code> - Grille r\u00e9tro ann\u00e9es 80</li> </ul>"},{"location":"03-operations/docker-autostart/#blocking-mode-blocking-true","title":"Blocking Mode (<code>\"blocking\": true</code>)","text":"<ul> <li>Comportement : D\u00e9marre le service AVANT de r\u00e9pondre \u00e0 la requ\u00eate (pas de page d'attente)</li> <li>Utilisation : APIs qui doivent r\u00e9pondre imm\u00e9diatement</li> <li>Services : Tika API, Whisper API, WhisperX API, MemVid API, RAGFlow, RAG-Anything</li> <li>Avantage : Le client re\u00e7oit directement la r\u00e9ponse API (pas d'HTML interm\u00e9diaire)</li> </ul>"},{"location":"03-operations/docker-autostart/#2-parametres-de-configuration","title":"2. Param\u00e8tres de configuration","text":""},{"location":"03-operations/docker-autostart/#port-global","title":"<code>port</code> (global)","text":"<p><pre><code>\"port\": 8890\n</code></pre> Port d'\u00e9coute du proxy auto-start. Nginx redirige vers ce port pour tous les services configur\u00e9s.</p>"},{"location":"03-operations/docker-autostart/#idletimeout-global","title":"<code>idleTimeout</code> (global)","text":"<p><pre><code>\"idleTimeout\": 1800\n</code></pre> Dur\u00e9e d'inactivit\u00e9 (en secondes) avant arr\u00eat automatique du service. Par d\u00e9faut : 30 minutes.</p>"},{"location":"03-operations/docker-autostart/#composedir-par-service","title":"<code>composeDir</code> (par service)","text":"<p>R\u00e9pertoire contenant le <code>docker-compose.yml</code> du service.</p>"},{"location":"03-operations/docker-autostart/#composefile-optionnel","title":"<code>composeFile</code> (optionnel)","text":"<p>Nom du fichier compose si diff\u00e9rent de <code>docker-compose.yml</code>. Exemple : RAGFlow utilise <code>docker-compose-full.yml</code>.</p>"},{"location":"03-operations/docker-autostart/#proxyport-par-service","title":"<code>proxyPort</code> (par service)","text":"<p>Port du service Docker vers lequel le proxy redirige apr\u00e8s d\u00e9marrage.</p>"},{"location":"03-operations/docker-autostart/#containers-par-service","title":"<code>containers</code> (par service)","text":"<p>Liste des conteneurs Docker \u00e0 surveiller pour d\u00e9tecter l'\u00e9tat du service.</p>"},{"location":"03-operations/docker-autostart/#configuration-nginx","title":"Configuration Nginx","text":"<p>Chaque service configur\u00e9 utilise un bloc <code>upstream</code> et <code>proxy_pass</code> dans Nginx :</p> <pre><code>upstream docker-autostart-solidarlink {\n    server 127.0.0.1:8890;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name solidarlink.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://docker-autostart-solidarlink;\n        proxy_set_header Host $host;\n        proxy_set_header X-Autostart-Target \"solidarlink.srv759970.hstgr.cloud\";\n    }\n}\n</code></pre> <p>Le header <code>X-Autostart-Target</code> permet au proxy d'identifier quel service d\u00e9marrer.</p>"},{"location":"03-operations/docker-autostart/#commandes-de-gestion","title":"Commandes de gestion","text":""},{"location":"03-operations/docker-autostart/#verifier-letat-du-proxy","title":"V\u00e9rifier l'\u00e9tat du proxy","text":"<pre><code>systemctl status docker-autostart\n</code></pre>"},{"location":"03-operations/docker-autostart/#redemarrer-le-proxy","title":"Red\u00e9marrer le proxy","text":"<pre><code>systemctl restart docker-autostart\n</code></pre>"},{"location":"03-operations/docker-autostart/#consulter-les-logs","title":"Consulter les logs","text":"<pre><code>journalctl -u docker-autostart -f\n</code></pre>"},{"location":"03-operations/docker-autostart/#modifier-la-configuration","title":"Modifier la configuration","text":"<pre><code>nano /opt/docker-autostart/config.json\nsystemctl restart docker-autostart\n</code></pre>"},{"location":"03-operations/docker-autostart/#tester-un-service","title":"Tester un service","text":"<pre><code>curl -I https://dashboard.srv759970.hstgr.cloud\n# Le service d\u00e9marre automatiquement\n</code></pre>"},{"location":"03-operations/docker-autostart/#synchronisation-dynamique","title":"Synchronisation dynamique","text":"<p>Ce document peut \u00eatre mis \u00e0 jour automatiquement depuis la configuration serveur.</p>"},{"location":"03-operations/docker-autostart/#script-de-mise-a-jour","title":"Script de mise \u00e0 jour","text":"<p>Utiliser le script <code>scripts/sync-autostart-config.sh</code> pour synchroniser :</p> <pre><code>./scripts/sync-autostart-config.sh\n</code></pre> <p>Ce script : 1. R\u00e9cup\u00e8re <code>/opt/docker-autostart/config.json</code> depuis le serveur 2. G\u00e9n\u00e8re automatiquement le tableau r\u00e9capitulatif 3. Met \u00e0 jour cette documentation 4. Commit les changements si n\u00e9cessaire</p>"},{"location":"03-operations/docker-autostart/#architecture-technique","title":"Architecture technique","text":"<pre><code>Internet \u2192 Nginx (443) \u2192 docker-autostart (8890) \u2192 Service Docker (port sp\u00e9cifique)\n                \u2193\n           X-Autostart-Target header\n                \u2193\n        1. Check service status\n        2. Start containers if stopped\n        3. Wait for healthcheck\n        4. Proxy request to service\n</code></pre>"},{"location":"03-operations/docker-autostart/#flux-dynamic-mode","title":"Flux Dynamic Mode","text":"<ol> <li>Requ\u00eate arrive sur Nginx</li> <li>Nginx redirige vers docker-autostart:8890</li> <li>Proxy d\u00e9tecte service arr\u00eat\u00e9</li> <li>Renvoie imm\u00e9diatement page d'attente HTML avec th\u00e8me</li> <li>JavaScript dans la page poll <code>/status</code> toutes les 2 secondes</li> <li>D\u00e9marre les conteneurs Docker en arri\u00e8re-plan</li> <li>Quand healthcheck OK \u2192 JavaScript redirige vers le service</li> </ol>"},{"location":"03-operations/docker-autostart/#flux-blocking-mode","title":"Flux Blocking Mode","text":"<ol> <li>Requ\u00eate arrive sur Nginx</li> <li>Nginx redirige vers docker-autostart:8890</li> <li>Proxy d\u00e9tecte service arr\u00eat\u00e9</li> <li>D\u00e9marre les conteneurs et ATTEND le healthcheck</li> <li>Une fois pr\u00eat \u2192 Proxy la requ\u00eate vers le service</li> <li>Client re\u00e7oit directement la r\u00e9ponse API</li> </ol>"},{"location":"03-operations/docker-autostart/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Guide complet : GUIDE_DOCKER_AUTOSTART.md</li> <li>Code source : <code>/opt/docker-autostart/index.js</code></li> <li>Systemd service : <code>/etc/systemd/system/docker-autostart.service</code></li> <li>Inventory complet : server-configs/INVENTORY.md</li> </ul>"},{"location":"03-operations/docker-autostart/#problemes-resolus","title":"Probl\u00e8mes R\u00e9solus","text":""},{"location":"03-operations/docker-autostart/#fix-auto-stop-avec-dashy-24102025","title":"Fix Auto-Stop avec Dashy (24/10/2025)","text":"<p>Probl\u00e8me : L'auto-stop ne fonctionnait pas car Dashy g\u00e9n\u00e9rait des requ\u00eates <code>axios/1.12.0</code> toutes les minutes, r\u00e9initialisant le compteur d'inactivit\u00e9.</p> <p>Solution : 1. Suppression compl\u00e8te des <code>statusCheck</code> dans Dashy (pas <code>false</code>, SUPPRIM\u00c9) 2. Dashy exclu de la configuration auto-stop (reste toujours actif) 3. D\u00e9sactivation du service conflictuel <code>nginx-auto-docker</code></p> <p>R\u00e9sultat : Auto-stop fonctionnel, v\u00e9rifi\u00e9 avec SolidarLink (arr\u00eat apr\u00e8s 8h d'inactivit\u00e9, red\u00e9marrage en 9s).</p> <p>R\u00e9f\u00e9rence : Changelog complet</p> <p>Derni\u00e8re synchronisation : 2025-10-24 Config serveur : <code>/opt/docker-autostart/config.json</code> Total services : 23 (Dashy exclu de l'auto-stop)</p>"},{"location":"03-operations/docker-autostop/","title":"Strat\u00e9gie Auto-Stop Docker - Optimisation RAM","text":"<p>Guide complet de la strat\u00e9gie d'auto-stop des conteneurs Docker pour optimiser l'utilisation de la RAM sur srv759970.</p>"},{"location":"03-operations/docker-autostop/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>R\u00e9duire la consommation RAM du serveur en arr\u00eatant automatiquement les services peu utilis\u00e9s et en les red\u00e9marrant \u00e0 la demande.</p> <p>Impact r\u00e9el : - Avant : 7.1GB / 8GB utilis\u00e9s (89%) - Apr\u00e8s : 2.4GB / 8GB utilis\u00e9s (30%) - \u00c9conomie : 4.7GB (66%)</p>"},{"location":"03-operations/docker-autostop/#architecture-du-systeme","title":"\ud83c\udfd7\ufe0f Architecture du Syst\u00e8me","text":""},{"location":"03-operations/docker-autostop/#composants","title":"Composants","text":"<pre><code>graph TB\n    User[\ud83d\udc64 Utilisateur]\n    Nginx[\ud83c\udf10 Nginx&lt;br/&gt;Port 443]\n    AutoStart[\ud83e\udd16 docker-autostart&lt;br/&gt;Service Node.js&lt;br/&gt;Port 3456]\n    Config[\ud83d\udccb config.json&lt;br/&gt;Configuration]\n    Docker[\ud83d\udc33 Docker Engine]\n    Container[\ud83d\udce6 Container]\n\n    User --&gt;|1. HTTPS Request| Nginx\n    Nginx --&gt;|2. Proxy to| AutoStart\n    AutoStart --&gt;|3. Check status| Docker\n    AutoStart --&gt;|4. Read config| Config\n    AutoStart --&gt;|5. Start if stopped| Docker\n    Docker --&gt;|6. Container ready| Container\n    Nginx --&gt;|7. Proxy to container| Container\n    Container --&gt;|8. Response| User\n\n    AutoStart -.-&gt;|Idle timeout| Docker\n    Docker -.-&gt;|Stop container| Container\n\n    style AutoStart fill:#95e1d3\n    style Nginx fill:#ff6b6b\n    style Docker fill:#4ecdc4\n    style Container fill:#ffd93d</code></pre>"},{"location":"03-operations/docker-autostop/#configuration","title":"\ud83d\udccb Configuration","text":""},{"location":"03-operations/docker-autostop/#fichier-de-configuration","title":"Fichier de Configuration","text":"<p>Emplacement : <code>/opt/docker-autostart/config.json</code></p> <pre><code>{\n  \"services\": [\n    {\n      \"name\": \"ragflow\",\n      \"port\": 9500,\n      \"timeout\": 180000,\n      \"mode\": \"dynamic\",\n      \"themeName\": \"matrix\",\n      \"composeDir\": \"/opt/ragflow\"\n    },\n    {\n      \"name\": \"xtts\",\n      \"port\": 8020,\n      \"timeout\": 180000,\n      \"mode\": \"blocking\",\n      \"composeDir\": \"/opt/xtts-api-server\"\n    },\n    {\n      \"name\": \"paperless\",\n      \"port\": 8000,\n      \"timeout\": 180000,\n      \"mode\": \"dynamic\",\n      \"themeName\": \"ghost\",\n      \"composeDir\": \"/opt/paperless-ngx\"\n    },\n    {\n      \"name\": \"nextcloud\",\n      \"port\": 8080,\n      \"timeout\": 180000,\n      \"mode\": \"dynamic\",\n      \"themeName\": \"ghost\",\n      \"composeDir\": \"/opt/nextcloud\"\n    },\n    {\n      \"name\": \"memvid\",\n      \"port\": 8100,\n      \"timeout\": 180000,\n      \"mode\": \"blocking\",\n      \"composeDir\": \"/opt/memvid\"\n    },\n    {\n      \"name\": \"jitsi\",\n      \"port\": 8443,\n      \"timeout\": 180000,\n      \"mode\": \"blocking\",\n      \"composeDir\": \"/opt/jitsi-meet\"\n    },\n    {\n      \"name\": \"clemence\",\n      \"port\": 9002,\n      \"timeout\": 180000,\n      \"mode\": \"dynamic\",\n      \"themeName\": \"ghost\",\n      \"composeDir\": \"/opt/wordpress-clemence\"\n    },\n    {\n      \"name\": \"solidarlink\",\n      \"port\": 9001,\n      \"timeout\": 180000,\n      \"mode\": \"dynamic\",\n      \"themeName\": \"hackerTerminal\",\n      \"composeDir\": \"/var/www/solidarlink\"\n    }\n  ]\n}\n</code></pre>"},{"location":"03-operations/docker-autostop/#parametres-expliques","title":"Param\u00e8tres Expliqu\u00e9s","text":"Param\u00e8tre Type Description Exemple <code>name</code> string Identifiant unique du service <code>\"ragflow\"</code> <code>port</code> number Port d'\u00e9coute du service <code>9500</code> <code>timeout</code> number D\u00e9lai d'inactivit\u00e9 en ms avant auto-stop <code>180000</code> (3 min) <code>mode</code> string Mode d'affichage (<code>dynamic</code> ou <code>blocking</code>) <code>\"dynamic\"</code> <code>themeName</code> string Th\u00e8me de la page d'attente (si mode dynamic) <code>\"matrix\"</code> <code>composeDir</code> string Chemin vers le docker-compose.yml <code>\"/opt/ragflow\"</code>"},{"location":"03-operations/docker-autostop/#modes-de-fonctionnement","title":"\ud83c\udfa8 Modes de Fonctionnement","text":""},{"location":"03-operations/docker-autostop/#mode-dynamic","title":"Mode Dynamic","text":"<p>Affiche une page d'attente anim\u00e9e pendant le d\u00e9marrage du conteneur.</p> <p>Caract\u00e9ristiques : - \u2705 Meilleure UX (l'utilisateur voit une progression) - \u2705 Design personnalisable (th\u00e8mes) - \u2705 Estimation du temps de d\u00e9marrage - \u274c N\u00e9cessite JavaScript c\u00f4t\u00e9 client</p> <p>Th\u00e8mes disponibles : - <code>matrix</code> - Effet Matrix (code vert d\u00e9filant) - <code>ghost</code> - Fant\u00f4me anim\u00e9 minimaliste - <code>shuffle</code> - Cartes qui se m\u00e9langent - <code>hackerTerminal</code> - Terminal de hacker r\u00e9tro</p> <p>Cas d'usage : Sites web, dashboards, applications avec UI</p> <p>Services utilisant ce mode : - RAGFlow (theme: matrix) - Paperless (theme: ghost) - Nextcloud (theme: ghost) - WordPress Clemence (theme: ghost) - WordPress SolidarLink (theme: hackerTerminal)</p>"},{"location":"03-operations/docker-autostop/#mode-blocking","title":"Mode Blocking","text":"<p>Attend silencieusement que le conteneur d\u00e9marre avant de r\u00e9pondre.</p> <p>Caract\u00e9ristiques : - \u2705 Compatible avec tous les clients (pas de JS requis) - \u2705 Transparent pour les APIs - \u2705 Timeout configurable - \u274c Pas de feedback visuel pendant l'attente</p> <p>Cas d'usage : APIs REST, webhooks, services backend</p> <p>Services utilisant ce mode : - XTTS-API (API vocale) - MemVid (API de recherche) - Jitsi (WebRTC, incompatible avec page d'attente)</p>"},{"location":"03-operations/docker-autostop/#flux-de-travail","title":"\ud83d\udd04 Flux de Travail","text":""},{"location":"03-operations/docker-autostop/#demarrage-a-la-demande","title":"D\u00e9marrage \u00e0 la Demande","text":"<pre><code>sequenceDiagram\n    participant User\n    participant Nginx\n    participant AutoStart\n    participant Docker\n    participant Container\n\n    User-&gt;&gt;Nginx: HTTPS Request\n    Nginx-&gt;&gt;AutoStart: Proxy to :3456\n    AutoStart-&gt;&gt;Docker: Check container status\n\n    alt Container Stopped\n        AutoStart-&gt;&gt;Docker: docker-compose start\n        AutoStart--&gt;&gt;User: Wait page (dynamic)&lt;br/&gt;or Block (blocking)\n        Docker-&gt;&gt;Container: Starting...\n        Container--&gt;&gt;Docker: Ready\n        Docker--&gt;&gt;AutoStart: Container UP\n        AutoStart-&gt;&gt;Nginx: Proxy to container\n        Nginx-&gt;&gt;User: Response\n    else Container Running\n        AutoStart-&gt;&gt;Nginx: Proxy immediately\n        Nginx-&gt;&gt;User: Response\n    end\n\n    Note over AutoStart: Reset idle timer</code></pre>"},{"location":"03-operations/docker-autostop/#auto-stop-par-inactivite","title":"Auto-Stop par Inactivit\u00e9","text":"<pre><code>sequenceDiagram\n    participant AutoStart\n    participant Timer\n    participant Docker\n    participant Container\n\n    Note over Timer: Derni\u00e8re requ\u00eate&lt;br/&gt;re\u00e7ue il y a 3 min\n\n    Timer-&gt;&gt;AutoStart: Timeout elapsed\n    AutoStart-&gt;&gt;Docker: docker-compose stop\n    Docker-&gt;&gt;Container: Graceful shutdown\n    Container--&gt;&gt;Docker: Stopped\n    Docker--&gt;&gt;AutoStart: Container DOWN\n\n    Note over AutoStart,Container: RAM lib\u00e9r\u00e9e&lt;br/&gt;Container pr\u00eat \u00e0 red\u00e9marrer</code></pre>"},{"location":"03-operations/docker-autostop/#deploiement","title":"\ud83d\ude80 D\u00e9ploiement","text":""},{"location":"03-operations/docker-autostop/#installation-initiale","title":"Installation Initiale","text":"<pre><code># 1. Cloner le repo docker-autostart\ncd /opt\ngit clone https://github.com/your-org/docker-autostart.git\ncd docker-autostart\n\n# 2. Installer les d\u00e9pendances\nnpm install\n\n# 3. Cr\u00e9er le fichier de configuration\ncp config.example.json config.json\nnano config.json  # \u00c9diter selon vos services\n\n# 4. Tester manuellement\nnpm start\n\n# 5. Cr\u00e9er le service systemd\nsudo nano /etc/systemd/system/docker-autostart.service\n</code></pre> <p>Fichier systemd : <pre><code>[Unit]\nDescription=Docker Auto-Start Service\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=simple\nUser=root\nWorkingDirectory=/opt/docker-autostart\nExecStart=/usr/bin/node /opt/docker-autostart/server.js\nRestart=always\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\n</code></pre></p> <pre><code># 6. Activer et d\u00e9marrer\nsudo systemctl daemon-reload\nsudo systemctl enable docker-autostart\nsudo systemctl start docker-autostart\n\n# 7. V\u00e9rifier le statut\nsudo systemctl status docker-autostart\n</code></pre>"},{"location":"03-operations/docker-autostop/#configuration-nginx","title":"Configuration Nginx","text":"<p>Chaque service doit \u00eatre configur\u00e9 pour proxifier vers docker-autostart.</p> <p>Exemple pour RAGFlow : <pre><code># /etc/nginx/sites-available/ragflow\n\nupstream docker_autostart_ragflow {\n    server 127.0.0.1:3456;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name ragflow.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/ragflow.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/ragflow.srv759970.hstgr.cloud/privkey.pem;\n\n    # Proxy vers docker-autostart (qui g\u00e8re le d\u00e9marrage)\n    location / {\n        proxy_pass http://docker_autostart_ragflow;\n        proxy_http_version 1.1;\n\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Headers pour le service auto-start\n        proxy_set_header X-Service-Name ragflow;\n        proxy_set_header X-Target-Port 9500;\n\n        # Timeouts augment\u00e9s pour le d\u00e9marrage\n        proxy_connect_timeout 300s;\n        proxy_send_timeout 300s;\n        proxy_read_timeout 300s;\n    }\n}\n</code></pre></p> <p>Headers critiques : - <code>X-Service-Name</code> : Nom du service dans config.json - <code>X-Target-Port</code> : Port du conteneur cible</p>"},{"location":"03-operations/docker-autostop/#ajout-dun-nouveau-service","title":"Ajout d'un Nouveau Service","text":"<pre><code># 1. \u00c9diter la config\nnano /opt/docker-autostart/config.json\n\n# Ajouter :\n{\n  \"name\": \"mon-service\",\n  \"port\": 8080,\n  \"timeout\": 180000,\n  \"mode\": \"dynamic\",\n  \"themeName\": \"ghost\",\n  \"composeDir\": \"/opt/mon-service\"\n}\n\n# 2. Red\u00e9marrer docker-autostart\nsystemctl restart docker-autostart\n\n# 3. Configurer Nginx\nnano /etc/nginx/sites-available/mon-service\n\n# 4. Activer le site\nln -s /etc/nginx/sites-available/mon-service /etc/nginx/sites-enabled/\nnginx -t\nsystemctl reload nginx\n\n# 5. Tester\ncurl -I https://mon-service.srv759970.hstgr.cloud\n</code></pre>"},{"location":"03-operations/docker-autostop/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"03-operations/docker-autostop/#verifier-letat-des-services","title":"V\u00e9rifier l'\u00c9tat des Services","text":"<pre><code># Script d\u00e9di\u00e9\nbash scripts/deployment/check-autostart-status.sh\n\n# Sortie exemple :\n=== Services Auto-Start - Status &amp; RAM ===\n\nConfiguration actuelle:\n- RAGFlow (6.5GB) : 3 min timeout\n- XTTS-API (2.5GB) : 3 min timeout\n...\n\n=== \u00c9tat Actuel ===\nragflow-server     : \u2705 RUNNING | Up 2 hours | RAM: 4.2GB / 6.5GB\nxtts-api           : \u23f8\ufe0f  STOPPED | Exited (0) 3 hours ago\npaperless-webserver: \ud83d\udfe2 RUNNING | Up 15 minutes | RAM: 890MB / 1.3GB\n</code></pre>"},{"location":"03-operations/docker-autostop/#logs-du-service","title":"Logs du Service","text":"<pre><code># Logs en temps r\u00e9el\njournalctl -u docker-autostart -f\n\n# Derni\u00e8res 100 lignes\njournalctl -u docker-autostart -n 100\n\n# Logs avec timestamps\njournalctl -u docker-autostart --since \"1 hour ago\"\n\n# Filtrer les erreurs\njournalctl -u docker-autostart -p err\n</code></pre>"},{"location":"03-operations/docker-autostop/#metriques","title":"M\u00e9triques","text":"<pre><code># Temps de d\u00e9marrage moyen par service\ngrep \"Container started\" /var/log/docker-autostart.log | \\\n  awk '{print $4, $NF}' | \\\n  sort | uniq -c\n\n# Nombre de starts par service (derni\u00e8res 24h)\njournalctl -u docker-autostart --since \"24 hours ago\" | \\\n  grep \"Starting containers\" | \\\n  awk '{print $NF}' | \\\n  sort | uniq -c\n</code></pre>"},{"location":"03-operations/docker-autostop/#configuration-avancee","title":"\ud83d\udd27 Configuration Avanc\u00e9e","text":""},{"location":"03-operations/docker-autostop/#ajuster-les-timeouts","title":"Ajuster les Timeouts","text":"<p>Les timeouts optimaux d\u00e9pendent de plusieurs facteurs :</p> Service RAM Temps Start Fr\u00e9quence Usage Timeout Recommand\u00e9 Heavy (&gt;5GB) 6.5GB 45-60s Occasionnel 3-5 min Medium (1-3GB) 2.5GB 15-30s Fr\u00e9quent 5-10 min Light (&lt;500MB) 150MB 5-10s Tr\u00e8s fr\u00e9quent 10-15 min <p>Formule empirique : <pre><code>Timeout optimal = (Temps de d\u00e9marrage \u00d7 3) + (Fr\u00e9quence d'usage moyenne)\n</code></pre></p> <p>Exemple RAGFlow : - Temps d\u00e9marrage : 45s - Fr\u00e9quence : 1 usage / 10 min - Timeout : (45 \u00d7 3) + 600 = 735s \u2248 12 min - Configur\u00e9 : 3 min (plus agressif pour \u00e9conomiser RAM)</p>"},{"location":"03-operations/docker-autostop/#priorisation-des-services","title":"Priorisation des Services","text":"<p>Services toujours actifs (pas d'auto-stop) : - redis-shared : Infrastructure critique - postgresql-shared : Base de donn\u00e9es partag\u00e9e - nginx : Reverse proxy (systemd) - portainer : Gestion Docker - dozzle : Logs viewer</p> <p>Services auto-stop agressif (3 min) : - RAGFlow : 6.5GB, usage occasionnel - XTTS-API : 2.5GB, usage API ponctuel - Paperless : 1.3GB, usage administratif</p> <p>Services auto-stop souple (10 min) : - Nextcloud : 130MB, usage fr\u00e9quent - WordPress : 150MB, trafic r\u00e9gulier</p>"},{"location":"03-operations/docker-autostop/#personnalisation-des-themes","title":"Personnalisation des Th\u00e8mes","text":"<p>Ajouter un nouveau th\u00e8me :</p> <pre><code>// /opt/docker-autostart/themes/monTheme.html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Service Starting...&lt;/title&gt;\n    &lt;style&gt;\n        body {\n            background: #0f0f0f;\n            color: #00ff00;\n            font-family: 'Courier New', monospace;\n        }\n        /* Votre CSS personnalis\u00e9 */\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;h1&gt;\ud83d\ude80 Service {{ serviceName }} is starting...&lt;/h1&gt;\n        &lt;p&gt;Please wait ~{{ estimatedTime }}s&lt;/p&gt;\n    &lt;/div&gt;\n    &lt;script&gt;\n        // Votre JavaScript personnalis\u00e9\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Utiliser dans config.json : <pre><code>{\n  \"name\": \"mon-service\",\n  \"themeName\": \"monTheme\",\n  ...\n}\n</code></pre></p>"},{"location":"03-operations/docker-autostop/#troubleshooting","title":"\ud83d\udee0\ufe0f Troubleshooting","text":""},{"location":"03-operations/docker-autostop/#service-ne-demarre-pas","title":"Service ne d\u00e9marre pas","text":"<p>Sympt\u00f4mes : Page d'attente infinie, timeout apr\u00e8s 5 min</p> <p>Diagnostic : <pre><code># 1. V\u00e9rifier les logs docker-autostart\njournalctl -u docker-autostart -n 50\n\n# 2. V\u00e9rifier l'\u00e9tat du conteneur\ndocker ps -a | grep mon-service\n\n# 3. Tenter de d\u00e9marrer manuellement\ncd /opt/mon-service\ndocker-compose up -d\n\n# 4. V\u00e9rifier les logs du conteneur\ndocker logs mon-service-container\n</code></pre></p> <p>Causes fr\u00e9quentes : - Port d\u00e9j\u00e0 utilis\u00e9 - Volume corrompu - R\u00e9seau Docker down - Docker daemon surcharg\u00e9</p>"},{"location":"03-operations/docker-autostop/#container-redemarre-en-boucle","title":"Container red\u00e9marre en boucle","text":"<p>Sympt\u00f4mes : Service d\u00e9marre puis s'arr\u00eate imm\u00e9diatement</p> <p>Diagnostic : <pre><code># Health check du container\ndocker inspect mon-service | jq '.[0].State.Health'\n\n# Logs avec timestamps\ndocker logs mon-service --timestamps --since 1h\n</code></pre></p> <p>Solutions : - V\u00e9rifier health check configuration - Augmenter le <code>timeout</code> dans config.json - D\u00e9sactiver temporairement l'auto-stop pour debugger</p>"},{"location":"03-operations/docker-autostop/#timeout-trop-courtlong","title":"Timeout trop court/long","text":"<p>Ajuster dynamiquement :</p> <pre><code># Script pour modifier un timeout\nbash scripts/deployment/set-autostart-timeout.sh ragflow 10\n\n# V\u00e9rifier la nouvelle config\ncat /opt/docker-autostart/config.json | jq '.services[] | select(.name==\"ragflow\")'\n\n# Red\u00e9marrer pour appliquer\nsystemctl restart docker-autostart\n</code></pre>"},{"location":"03-operations/docker-autostop/#metriques-de-performance","title":"\ud83d\udcc8 M\u00e9triques de Performance","text":""},{"location":"03-operations/docker-autostop/#impact-mesure-octobre-2025","title":"Impact Mesur\u00e9 (Octobre 2025)","text":"M\u00e9trique Avant Auto-Stop Apr\u00e8s Auto-Stop Am\u00e9lioration RAM moyenne 7.1GB (89%) 2.4GB (30%) -66% RAM pic (RAGFlow actif) 7.8GB (97%) 6.2GB (77%) -20% Services actifs 24/7 15 5 -66% Temps r\u00e9ponse (cold start) - 15-45s N/A Temps r\u00e9ponse (warm) &lt;200ms &lt;200ms Identique"},{"location":"03-operations/docker-autostop/#economies-calculees","title":"\u00c9conomies Calcul\u00e9es","text":"<p>RAM \u00e9conomis\u00e9e par service :</p> Service RAM Utilisation \u00c9conomie/jour RAGFlow 6.5GB 5% du temps 6.2GB \u00d7 22.8h = 141GB\u00b7h XTTS 2.5GB 1% du temps 2.5GB \u00d7 23.8h = 59GB\u00b7h Paperless 1.3GB 10% du temps 1.3GB \u00d7 21.6h = 28GB\u00b7h Total 10.3GB ~5% ~228GB\u00b7h/jour"},{"location":"03-operations/docker-autostop/#evolutions-futures","title":"\ud83d\ude80 \u00c9volutions Futures","text":"<ul> <li> Pr\u00e9diction ML : Anticiper les d\u00e9marrages selon patterns d'usage</li> <li> Pre-warming : D\u00e9marrer proactivement avant la requ\u00eate</li> <li> Scaling horizontal : Auto-scale selon charge</li> <li> M\u00e9triques d\u00e9taill\u00e9es : Export vers Prometheus</li> <li> Dashboard temps r\u00e9el : Interface web de monitoring</li> <li> Alerting intelligent : Notifications si \u00e9checs r\u00e9p\u00e9t\u00e9s</li> </ul>"},{"location":"03-operations/docker-autostop/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Script de v\u00e9rification</li> <li>Configuration des timeouts</li> <li>Architecture Docker</li> <li>Emergency Runbook</li> </ul> <p>D\u00e9ploiement initial : 2025-10-21 Derni\u00e8re optimisation : 2025-10-27 Mainteneur : Infrastructure Team</p>"},{"location":"03-operations/emergency-runbook/","title":"\ud83d\udea8 Emergency Runbook - srv759970.hstgr.cloud","text":"<p>Version: 1.0 Derni\u00e8re mise \u00e0 jour: 2025-10-27 Usage: Proc\u00e9dures d'urgence pour incidents critiques</p>"},{"location":"03-operations/emergency-runbook/#incidents-critiques-reponse-rapide","title":"\u26a1 Incidents Critiques - R\u00e9ponse Rapide","text":""},{"location":"03-operations/emergency-runbook/#niveau-1-serveur-completement-inaccessible","title":"\ud83d\udd34 Niveau 1: Serveur Compl\u00e8tement Inaccessible","text":"<p>Sympt\u00f4me: Impossible de SSH, tous les services down</p>"},{"location":"03-operations/emergency-runbook/#diagnostic-5-min","title":"Diagnostic (5 min)","text":"<ol> <li> <p>Tester connectivit\u00e9 r\u00e9seau: <pre><code># Depuis machine locale\nping 69.62.108.82\nping srv759970.hstgr.cloud\n</code></pre></p> </li> <li> <p>V\u00e9rifier depuis Hostinger Panel:</p> </li> <li>Se connecter: https://hpanel.hostinger.com</li> <li>VPS &gt; srv759970 &gt; Console VNC</li> <li>V\u00e9rifier si serveur boot ou kernel panic</li> </ol>"},{"location":"03-operations/emergency-runbook/#actions-immediates","title":"Actions Imm\u00e9diates","text":"<p>Si serveur down physiquement: 1. Hostinger Panel &gt; VPS &gt; Red\u00e9marrer 2. Attendre 5-10 minutes 3. Tester SSH: <code>ssh root@69.62.108.82</code> 4. Si \u00e9chec r\u00e9p\u00e9t\u00e9 \u2192 Contacter support Hostinger</p> <p>Si serveur accessible en VNC mais pas SSH: <pre><code># Dans console VNC\nsystemctl status sshd\nsystemctl restart sshd\nsystemctl status nginx\nsystemctl status docker\n</code></pre></p>"},{"location":"03-operations/emergency-runbook/#niveau-2-serveur-accessible-services-down","title":"\ud83d\udfe0 Niveau 2: Serveur Accessible, Services Down","text":"<p>Sympt\u00f4me: SSH OK, mais tous les services web ne r\u00e9pondent pas</p>"},{"location":"03-operations/emergency-runbook/#diagnostic-rapide-2-min","title":"Diagnostic Rapide (2 min)","text":"<pre><code>ssh root@69.62.108.82\n\n# 1. V\u00e9rifier services critiques\nsystemctl status nginx\nsystemctl status docker\n\n# 2. V\u00e9rifier conteneurs actifs\ndocker ps | wc -l\n# Attendu: 15-25 conteneurs\n\n# 3. V\u00e9rifier RAM\nfree -h\n# Si &gt;28GB utilis\u00e9s \u2192 OOM imminent\n\n# 4. V\u00e9rifier disque\ndf -h\n# / doit avoir &gt;10% libre\n</code></pre>"},{"location":"03-operations/emergency-runbook/#actions-par-priorite","title":"Actions par Priorit\u00e9","text":"<p>Priorit\u00e9 1: Nginx (Reverse Proxy) <pre><code># Tester config\nnginx -t\n\n# Si erreur de config\ncd /etc/nginx/sites-enabled\nls -la\n# D\u00e9sactiver derni\u00e8re config modifi\u00e9e\nrm &lt;fichier-problematique&gt;\nnginx -t\n\n# Red\u00e9marrer\nsystemctl restart nginx\nsystemctl status nginx\n</code></pre></p> <p>Priorit\u00e9 2: Docker Daemon <pre><code>systemctl status docker\n\n# Si inactive\nsystemctl start docker\nsleep 10\n\n# V\u00e9rifier\ndocker ps\n</code></pre></p> <p>Priorit\u00e9 3: Services Critiques Always-On <pre><code># Redis Queue (d\u00e9pendance transcription)\ndocker ps | grep rq-queue-redis\ndocker logs rq-queue-redis --tail 50\n\n# Si arr\u00eat\u00e9\ncd /opt/whisperx  # ou /opt/faster-whisper-queue\ndocker-compose up -d rq-queue-redis\n\n# Dashy Portal\ndocker ps | grep dashy\ncd /opt/dashy\ndocker-compose up -d\n\n# MkDocs Documentation\ndocker ps | grep mkdocs\ncd /opt/mkdocs\ndocker-compose up -d\n</code></pre></p>"},{"location":"03-operations/emergency-runbook/#niveau-3-un-service-specifique-ne-repond-pas","title":"\ud83d\udfe1 Niveau 3: Un Service Sp\u00e9cifique Ne R\u00e9pond Pas","text":"<p>Sympt\u00f4me: Service X timeout ou erreur 502/503</p>"},{"location":"03-operations/emergency-runbook/#diagnostic-service-3-min","title":"Diagnostic Service (3 min)","text":"<pre><code># 1. Identifier le service\nSERVICE_NAME=\"whisperx\"  # Remplacer par le vrai nom\n\n# 2. V\u00e9rifier conteneur\ndocker ps | grep $SERVICE_NAME\ndocker ps -a | grep $SERVICE_NAME  # Inclut arr\u00eat\u00e9s\n\n# 3. V\u00e9rifier logs\ndocker logs $SERVICE_NAME --tail 100\n\n# 4. V\u00e9rifier config Nginx\ngrep -r \"$SERVICE_NAME\" /etc/nginx/sites-available/\ncat /etc/nginx/sites-available/$SERVICE_NAME\n\n# 5. Tester port interne\n# Trouver le port dans docker-compose.yml\ncd /opt/$SERVICE_NAME\ncat docker-compose.yml | grep ports\n# Exemple: \"8002:8000\" \u2192 port interne 8002\ncurl -I http://127.0.0.1:8002\n</code></pre>"},{"location":"03-operations/emergency-runbook/#actions-de-resolution","title":"Actions de R\u00e9solution","text":"<p>Cas 1: Conteneur arr\u00eat\u00e9 (auto-start expected) <pre><code># V\u00e9rifier si service dans auto-start\ncat /opt/docker-autostart/config.json | grep -i $SERVICE_NAME\n\n# Si oui \u2192 Attendre 30-180s apr\u00e8s premi\u00e8re requ\u00eate\n# Si non \u2192 D\u00e9marrer manuellement\ncd /opt/$SERVICE_NAME\ndocker-compose up -d\n</code></pre></p> <p>Cas 2: Conteneur running mais ne r\u00e9pond pas <pre><code>cd /opt/$SERVICE_NAME\n\n# Voir logs erreurs\ndocker-compose logs --tail 100\n\n# Red\u00e9marrer\ndocker-compose restart\n\n# Si \u00e9chec persistant\ndocker-compose down\ndocker-compose up -d\n\n# V\u00e9rifier healthcheck (si configur\u00e9)\ndocker inspect $SERVICE_NAME | grep -A 20 Health\n</code></pre></p> <p>Cas 3: Erreur 502 Bad Gateway <pre><code># Probl\u00e8me Nginx \u2192 backend\n# 1. V\u00e9rifier port dans nginx\ncat /etc/nginx/sites-available/$SERVICE_NAME | grep proxy_pass\n# Exemple: proxy_pass http://127.0.0.1:8002;\n\n# 2. V\u00e9rifier que port est ouvert\nnetstat -tlnp | grep 8002\n\n# 3. Tester backend direct\ncurl -I http://127.0.0.1:8002\n\n# 4. Si backend OK mais nginx KO \u2192 recharger nginx\nnginx -t\nsystemctl reload nginx\n</code></pre></p>"},{"location":"03-operations/emergency-runbook/#checklist-de-diagnostic-complet","title":"\ud83d\udccb Checklist de Diagnostic Complet","text":""},{"location":"03-operations/emergency-runbook/#phase-1-sante-systeme-5-min","title":"Phase 1: Sant\u00e9 Syst\u00e8me (5 min)","text":"<pre><code># Connexion\nssh root@69.62.108.82\n\n# 1. Ressources syst\u00e8me\nfree -h\ndf -h\nuptime\ntop -bn1 | head -20\n\n# 2. Services syst\u00e8me\nsystemctl status nginx\nsystemctl status docker\nsystemctl status fail2ban  # Si configur\u00e9\n\n# 3. Conteneurs Docker\ndocker ps --format \"table {{.Names}}\\t{{.Status}}\\t{{.Ports}}\" | head -30\ndocker stats --no-stream | head -20\n\n# 4. Logs syst\u00e8me r\u00e9cents\njournalctl -xe --since \"10 minutes ago\" | tail -50\n</code></pre> <p>Seuils d'alerte: - RAM: &gt;28GB/32GB \u2192 CRITIQUE - Disque /: &lt;10% libre \u2192 CRITIQUE - Load average: &gt;8.0 \u2192 ATTENTION - Conteneurs: &lt;10 actifs \u2192 ANORMAL</p>"},{"location":"03-operations/emergency-runbook/#phase-2-services-critiques-5-min","title":"Phase 2: Services Critiques (5 min)","text":"<pre><code># Redis Queue (transcription)\ndocker exec -it rq-queue-redis redis-cli ping\n# Attendu: PONG\n\ndocker exec -it rq-queue-redis redis-cli\nSELECT 0\nLLEN transcription  # Queue WhisperX\nSELECT 1\nLLEN faster-whisper-transcription  # Queue Faster-Whisper\nexit\n\n# Nginx Config\nnginx -t\n# Attendu: test is successful\n\n# Auto-Start Proxy\ncurl http://127.0.0.1:8890\n# Attendu: HTML ou \"Service not configured\"\n\n# Dashy Portal\ncurl -I https://dashy.srv759970.hstgr.cloud\n# Attendu: 200 OK ou 401 (Basic Auth)\n\n# MkDocs\ncurl -I https://docs.srv759970.hstgr.cloud\n# Attendu: 200 OK\n</code></pre>"},{"location":"03-operations/emergency-runbook/#phase-3-monitoring-logs-5-min","title":"Phase 3: Monitoring &amp; Logs (5 min)","text":"<pre><code># Grafana (si accessible)\ncurl -I https://monitoring.srv759970.hstgr.cloud\n\n# Dozzle (logs temps r\u00e9el)\ncurl -I https://dozzle.srv759970.hstgr.cloud\n\n# Prometheus\ncurl http://srv759970.hstgr.cloud:9090/-/healthy\n# Attendu: Healthy\n\n# Logs Nginx erreurs r\u00e9centes\ntail -100 /var/log/nginx/error.log\n\n# Logs Nginx access par service\nls -lh /var/log/nginx/*-access.log\ntail -50 /var/log/nginx/dashy-access.log\n</code></pre>"},{"location":"03-operations/emergency-runbook/#procedures-de-reparation-courantes","title":"\ud83d\udd27 Proc\u00e9dures de R\u00e9paration Courantes","text":""},{"location":"03-operations/emergency-runbook/#redemarrage-propre-dun-service-docker","title":"Red\u00e9marrage Propre d'un Service Docker","text":"<pre><code>SERVICE_DIR=\"/opt/whisperx\"  # Exemple\ncd $SERVICE_DIR\n\n# 1. Voir config actuelle\ndocker-compose config\n\n# 2. Arr\u00eat propre\ndocker-compose down\n# Attendre 5 secondes\nsleep 5\n\n# 3. V\u00e9rifier volumes/r\u00e9seau nettoy\u00e9s\ndocker volume ls | grep $(basename $SERVICE_DIR)\ndocker network ls | grep $(basename $SERVICE_DIR)\n\n# 4. Red\u00e9marrage\ndocker-compose up -d\n\n# 5. V\u00e9rifier logs d\u00e9marrage\ndocker-compose logs -f --tail 50\n# Ctrl+C pour quitter\n\n# 6. Tester service\ndocker-compose ps\n</code></pre>"},{"location":"03-operations/emergency-runbook/#rebuild-complet-dun-service","title":"Rebuild Complet d'un Service","text":"<pre><code>cd /opt/&lt;service&gt;\n\n# 1. Backup config si n\u00e9cessaire\ncp docker-compose.yml docker-compose.yml.backup-$(date +%Y%m%d-%H%M%S)\n\n# 2. Arr\u00eat et nettoyage\ndocker-compose down -v  # ATTENTION: -v supprime volumes!\n\n# 3. Rebuild images\ndocker-compose build --no-cache\n\n# 4. Red\u00e9marrage\ndocker-compose up -d\n\n# 5. V\u00e9rifier\ndocker-compose logs -f\n</code></pre>"},{"location":"03-operations/emergency-runbook/#nettoyage-docker-espace-disque","title":"Nettoyage Docker (Espace Disque)","text":"<pre><code># Voir espace utilis\u00e9\ndocker system df\n\n# Nettoyer images inutilis\u00e9es\ndocker image prune -a\n# Attention: Supprime toutes images non utilis\u00e9es!\n\n# Nettoyer volumes orphelins\ndocker volume prune\n\n# Nettoyer conteneurs arr\u00eat\u00e9s\ndocker container prune\n\n# Nettoyer r\u00e9seaux inutilis\u00e9s\ndocker network prune\n\n# Nettoyage complet (DANGEREUX!)\n# docker system prune -a --volumes\n# \u26a0\ufe0f Ne faire que si disque critique &lt;5%\n</code></pre>"},{"location":"03-operations/emergency-runbook/#redemarrage-nginx-securise","title":"Red\u00e9marrage Nginx S\u00e9curis\u00e9","text":"<pre><code># 1. Backup config actuelle\ntar -czf /root/backups/nginx-$(date +%Y%m%d-%H%M%S).tar.gz /etc/nginx/\n\n# 2. Tester config\nnginx -t\n\n# 3. Si OK \u2192 reload (sans interruption)\nsystemctl reload nginx\n\n# 4. Si erreur \u2192 rollback\ncd /etc/nginx/sites-enabled\nrm &lt;fichier-problematique&gt;\nnginx -t\nsystemctl reload nginx\n\n# 5. V\u00e9rifier\nsystemctl status nginx\ncurl -I https://dashy.srv759970.hstgr.cloud\n</code></pre>"},{"location":"03-operations/emergency-runbook/#scenarios-durgence-specifiques","title":"\ud83d\udd25 Sc\u00e9narios d'Urgence Sp\u00e9cifiques","text":""},{"location":"03-operations/emergency-runbook/#oom-out-of-memory-ram-30gb","title":"OOM (Out of Memory) - RAM &gt;30GB","text":"<p>Sympt\u00f4me: Services crashent al\u00e9atoirement, syst\u00e8me lent</p> <pre><code># 1. Identifier gros consommateurs\ndocker stats --no-stream | sort -k4 -h | tail -10\n\n# 2. Arr\u00eater services non-critiques\ncd /opt/nextcloud &amp;&amp; docker-compose down\ncd /opt/jitsi &amp;&amp; docker-compose down\ncd /opt/ragflow/docker &amp;&amp; docker-compose down\ncd /opt/paperless &amp;&amp; docker-compose down\n\n# 3. V\u00e9rifier RAM lib\u00e9r\u00e9e\nfree -h\n\n# 4. Si encore critique, arr\u00eater plus\ncd /opt/whisperx &amp;&amp; docker-compose down\ncd /opt/faster-whisper-queue &amp;&amp; docker-compose down\n\n# 5. Investigation apr\u00e8s stabilisation\ndmesg | grep -i \"out of memory\"\njournalctl -xe | grep -i oom\n</code></pre>"},{"location":"03-operations/emergency-runbook/#disque-plein-95","title":"Disque Plein - / &gt;95%","text":"<p>Sympt\u00f4me: Services ne d\u00e9marrent pas, erreurs \"No space left\"</p> <pre><code># 1. Identifier gros dossiers\ndu -h --max-depth=2 /opt | sort -h | tail -20\ndu -h --max-depth=2 /var | sort -h | tail -20\n\n# 2. Logs Docker (souvent gros)\ndu -sh /var/lib/docker/containers/*\ndocker system df\n\n# 3. Nettoyer logs\njournalctl --vacuum-size=500M\nfind /var/log -name \"*.log\" -mtime +30 -delete\ndocker system prune -a\n\n# 4. Volumes Docker\ndocker volume ls\ndocker volume prune\n</code></pre>"},{"location":"03-operations/emergency-runbook/#redis-queue-bloquee","title":"Redis Queue Bloqu\u00e9e","text":"<p>Sympt\u00f4me: Jobs WhisperX/Faster-Whisper ne se traitent pas</p> <pre><code># 1. Inspecter queues\ndocker exec -it rq-queue-redis redis-cli\n\nSELECT 0  # WhisperX\nLLEN transcription\nLRANGE transcription 0 5  # Voir jobs\n\nSELECT 1  # Faster-Whisper\nLLEN faster-whisper-transcription\nLRANGE faster-whisper-transcription 0 5\n\n# 2. Voir workers actifs\ndocker ps | grep worker\n\n# 3. Red\u00e9marrer workers\ncd /opt/whisperx\ndocker-compose restart whisperx-worker\n\ncd /opt/faster-whisper-queue\ndocker-compose restart faster-whisper-worker\n\n# 4. Si queue corrompue (DERNIER RECOURS!)\nSELECT 0\nDEL transcription  # \u26a0\ufe0f PERD TOUS LES JOBS!\nexit\n</code></pre>"},{"location":"03-operations/emergency-runbook/#certificat-ssl-expire","title":"Certificat SSL Expir\u00e9","text":"<p>Sympt\u00f4me: Erreur SSL dans navigateur</p> <pre><code># 1. V\u00e9rifier expiration\ncertbot certificates\n\n# 2. Renouveler\ncertbot renew\n\n# 3. Si erreur, forcer renouveau\ncertbot renew --force-renewal\n\n# 4. Recharger Nginx\nnginx -t\nsystemctl reload nginx\n\n# 5. Tester\ncurl -I https://dashy.srv759970.hstgr.cloud\n</code></pre>"},{"location":"03-operations/emergency-runbook/#contacts-escalade","title":"\ud83d\udcde Contacts &amp; Escalade","text":""},{"location":"03-operations/emergency-runbook/#informations-serveur","title":"Informations Serveur","text":"<ul> <li>H\u00e9bergeur: Hostinger</li> <li>Panel: https://hpanel.hostinger.com</li> <li>Support: https://www.hostinger.com/contact</li> <li>IP: 69.62.108.82</li> <li>Hostname: srv759970.hstgr.cloud</li> </ul>"},{"location":"03-operations/emergency-runbook/#credentials-critiques","title":"Credentials Critiques","text":"<p>Localisation: (\u00c0 compl\u00e9ter par Julien) - Root SSH: Cl\u00e9 SSH - Hostinger Panel: (email + password) - Nginx Basic Auth: <code>julien:DevAccess2025</code> (fichier <code>/etc/nginx/.htpasswd</code>)</p>"},{"location":"03-operations/emergency-runbook/#escalade","title":"Escalade","text":"<p>Niveau 1: Self-Service (0-30 min) - Utiliser ce runbook - Consulter logs - Red\u00e9marrer services</p> <p>Niveau 2: Documentation (30 min - 2h) - Nginx Troubleshooting - Docker Commands - Changelog pour modifications r\u00e9centes</p> <p>Niveau 3: Support Hostinger (2h+) - Panel Hostinger &gt; Support Ticket - Console VNC si SSH impossible - Backup restoration si corruption</p>"},{"location":"03-operations/emergency-runbook/#monitoring-prevention","title":"\ud83d\udcca Monitoring &amp; Pr\u00e9vention","text":""},{"location":"03-operations/emergency-runbook/#metriques-a-surveiller","title":"M\u00e9triques \u00e0 Surveiller","text":"<p>Quotidien: - RAM usage: <code>free -h</code> (alerte &gt;25GB) - Disque: <code>df -h</code> (alerte &gt;85%) - Conteneurs actifs: <code>docker ps | wc -l</code> (alerte &lt;10)</p> <p>Hebdomadaire: - Logs Nginx: <code>tail -500 /var/log/nginx/error.log</code> - Updates syst\u00e8me: <code>apt list --upgradable</code> - Certificats SSL: <code>certbot certificates</code></p> <p>Mensuel: - Backup v\u00e9rification - Nettoyage Docker: <code>docker system prune</code> - Review auto-start logs</p>"},{"location":"03-operations/emergency-runbook/#dashboards-de-monitoring","title":"Dashboards de Monitoring","text":"<ol> <li>Grafana: https://monitoring.srv759970.hstgr.cloud</li> <li>CPU, RAM, Disque</li> <li>M\u00e9triques Redis Queue</li> <li> <p>Logs agr\u00e9g\u00e9s (Loki)</p> </li> <li> <p>Dozzle: https://dozzle.srv759970.hstgr.cloud</p> </li> <li>Logs Docker temps r\u00e9el</li> <li> <p>Tous conteneurs</p> </li> <li> <p>Status Pages (Auto-g\u00e9n\u00e9r\u00e9es):</p> </li> <li>SERVER_STATUS.md</li> <li>SERVICES_STATUS.md</li> </ol>"},{"location":"03-operations/emergency-runbook/#procedures-de-maintenance-preventive","title":"\ud83d\udd04 Proc\u00e9dures de Maintenance Pr\u00e9ventive","text":""},{"location":"03-operations/emergency-runbook/#mise-a-jour-mensuelle","title":"Mise \u00e0 Jour Mensuelle","text":"<pre><code># 1. Backup complet\n/root/scripts/backup-full.sh  # Si existe\n\n# 2. Updates syst\u00e8me\napt update\napt list --upgradable\napt upgrade -y\n\n# 3. Reboot si kernel update\nshutdown -r now\n\n# 4. Apr\u00e8s reboot, v\u00e9rifier services\nsystemctl status docker nginx\ndocker ps | wc -l\n\n# 5. Updates Docker images\ncd /opt/dashy &amp;&amp; docker-compose pull &amp;&amp; docker-compose up -d\ncd /opt/mkdocs &amp;&amp; docker-compose pull &amp;&amp; docker-compose up -d\n# R\u00e9p\u00e9ter pour services critiques\n</code></pre>"},{"location":"03-operations/emergency-runbook/#nettoyage-trimestriel","title":"Nettoyage Trimestriel","text":"<pre><code># Logs anciens\njournalctl --vacuum-time=60d\nfind /var/log -name \"*.log\" -mtime +90 -delete\n\n# Docker cleanup\ndocker system prune -a --volumes\n# \u26a0\ufe0f Valider avant!\n\n# Backups anciens\nfind /root/backups -mtime +180 -delete\n</code></pre>"},{"location":"03-operations/emergency-runbook/#post-mortem-template","title":"\ud83d\udcdd Post-Mortem Template","text":"<p>Apr\u00e8s chaque incident, documenter:</p> <pre><code># Incident YYYY-MM-DD - [Titre]\n\n## Chronologie\n- HH:MM - D\u00e9tection\n- HH:MM - Diagnostic\n- HH:MM - Action X\n- HH:MM - R\u00e9solution\n\n## Cause Racine\n[Description]\n\n## Impact\n- Services affect\u00e9s: [Liste]\n- Dur\u00e9e: X minutes\n- Users impact\u00e9s: [Estimation]\n\n## Actions Correctives\n1. Imm\u00e9diate: [Fait]\n2. Court terme: [TODO]\n3. Long terme: [TODO]\n\n## Pr\u00e9vention Future\n[Mesures \u00e0 mettre en place]\n</code></pre> <p>Sauvegarder dans: <code>docs/incidents/YYYY-MM-DD-&lt;titre&gt;.md</code></p>"},{"location":"03-operations/emergency-runbook/#checklist-apres-resolution","title":"\u2705 Checklist Apr\u00e8s R\u00e9solution","text":"<ul> <li> Tous les services critiques UP</li> <li> Nginx reload sans erreur</li> <li> Docker containers count normal (15-25)</li> <li> RAM &lt; 25GB</li> <li> Disque &lt; 80%</li> <li> Dashy accessible</li> <li> MkDocs accessible</li> <li> Monitoring fonctionnel</li> <li> Logs v\u00e9rifi\u00e9s (pas d'erreurs)</li> <li> Post-mortem document\u00e9 (si incident majeur)</li> <li> Mise \u00e0 jour <code>changelog/</code> si modification config</li> </ul> <p>Ce runbook est un document vivant. L'am\u00e9liorer apr\u00e8s chaque incident!</p> <p>Derni\u00e8re r\u00e9vision: 2025-10-27</p>"},{"location":"03-operations/vps-setup/","title":"Guide de D\u00e9ploiement VPS","text":""},{"location":"03-operations/vps-setup/#vue-densemble","title":"Vue d'ensemble","text":"<p>Guide de d\u00e9ploiement complet pour srv759970.hstgr.cloud, incluant la configuration initiale du serveur et le d\u00e9ploiement de tous les services.</p>"},{"location":"03-operations/vps-setup/#configuration-initiale-du-serveur","title":"Configuration Initiale du Serveur","text":""},{"location":"03-operations/vps-setup/#1-connexion-ssh","title":"1. Connexion SSH","text":"<pre><code>ssh root@srv759970.hstgr.cloud\n# ou\nssh root@69.62.108.82\n</code></pre>"},{"location":"03-operations/vps-setup/#2-mise-a-jour-du-systeme","title":"2. Mise \u00e0 Jour du Syst\u00e8me","text":"<pre><code>apt-get update &amp;&amp; apt-get upgrade -y\napt-get install -y curl wget git htop vim net-tools\n</code></pre>"},{"location":"03-operations/vps-setup/#3-installation-docker","title":"3. Installation Docker","text":"<pre><code># Installation des d\u00e9pendances\napt-get install -y ca-certificates curl gnupg lsb-release\n\n# Ajout de la cl\u00e9 GPG Docker\nmkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n\n# Configuration du d\u00e9p\u00f4t\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\n# Installation\napt-get update\napt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin\n</code></pre>"},{"location":"03-operations/vps-setup/#4-installation-nginx","title":"4. Installation Nginx","text":"<pre><code>apt-get install -y nginx\nsystemctl enable nginx\nsystemctl start nginx\n</code></pre>"},{"location":"03-operations/vps-setup/#5-installation-certbot","title":"5. Installation Certbot","text":"<pre><code>apt-get install -y certbot python3-certbot-nginx\n</code></pre>"},{"location":"03-operations/vps-setup/#6-configuration-du-pare-feu","title":"6. Configuration du Pare-feu","text":"<pre><code>ufw allow 22/tcp\nufw allow 80/tcp\nufw allow 443/tcp\nufw enable\n</code></pre>"},{"location":"03-operations/vps-setup/#deploiement-des-services","title":"D\u00e9ploiement des Services","text":""},{"location":"03-operations/vps-setup/#whisperx-transcription-avec-diarization","title":"WhisperX (Transcription avec Diarization)","text":"<pre><code>mkdir -p /opt/whisperx\ncd /opt/whisperx\n\n# Cr\u00e9er docker-compose.yml, server.py, worker.py\n# (voir documentation WhisperX)\n\ndocker-compose up -d\n</code></pre> <p>V\u00e9rification: <pre><code>curl http://localhost:8002/\ndocker logs whisperx-worker -f\n</code></pre></p>"},{"location":"03-operations/vps-setup/#faster-whisper-queue","title":"Faster-Whisper Queue","text":"<pre><code>mkdir -p /opt/faster-whisper-queue\ncd /opt/faster-whisper-queue\n\n# Cr\u00e9er docker-compose.yml, server.py, worker.py, Dockerfile\n# (voir documentation Faster-Whisper Queue)\n\ndocker-compose up -d\n</code></pre> <p>V\u00e9rification: <pre><code>curl http://localhost:8003/health\ncurl http://localhost:8003/queue/stats\n</code></pre></p>"},{"location":"03-operations/vps-setup/#monitoring-stack-grafana-prometheus-loki","title":"Monitoring Stack (Grafana + Prometheus + Loki)","text":"<pre><code>mkdir -p /opt/monitoring/{prometheus,loki,promtail,grafana/provisioning/{datasources,dashboards}}\ncd /opt/monitoring\n\n# Cr\u00e9er docker-compose.yml et fichiers de config\n# (voir documentation Monitoring)\n\ndocker-compose up -d\n</code></pre> <p>V\u00e9rification: <pre><code>curl http://localhost:3001  # Grafana\ncurl http://localhost:9090  # Prometheus\ncurl http://localhost:3100/ready  # Loki\n</code></pre></p>"},{"location":"03-operations/vps-setup/#dashy-dashboard","title":"Dashy Dashboard","text":"<pre><code>mkdir -p /opt/dashy\ncd /opt/dashy\n\n# Cr\u00e9er docker-compose.yml et conf.yml\n\ndocker-compose up -d\n</code></pre>"},{"location":"03-operations/vps-setup/#dozzle-docker-logs-viewer","title":"Dozzle (Docker Logs Viewer)","text":"<pre><code>docker run -d \\\n  --name dozzle \\\n  --restart unless-stopped \\\n  -p 8888:8080 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  amir20/dozzle:latest\n</code></pre>"},{"location":"03-operations/vps-setup/#mkdocs-documentation","title":"MkDocs Documentation","text":"<pre><code>mkdir -p /opt/mkdocs/docs\ncd /opt/mkdocs\n\n# Cr\u00e9er mkdocs.yml, Dockerfile, docker-compose.yml\n# Copier les fichiers de documentation\n\ndocker-compose up -d\n</code></pre>"},{"location":"03-operations/vps-setup/#configuration-sslnginx","title":"Configuration SSL/Nginx","text":""},{"location":"03-operations/vps-setup/#creer-les-certificats","title":"Cr\u00e9er les Certificats","text":"<pre><code># Monitoring\ncertbot certonly --nginx -d monitoring.srv759970.hstgr.cloud --non-interactive --agree-tos -m julien@julienfernandez.xyz\n\n# WhisperX\ncertbot certonly --nginx -d whisperx.srv759970.hstgr.cloud --non-interactive --agree-tos -m julien@julienfernandez.xyz\n\n# Dozzle\ncertbot certonly --nginx -d dozzle.srv759970.hstgr.cloud --non-interactive --agree-tos -m julien@julienfernandez.xyz\n\n# Faster-Whisper\ncertbot certonly --nginx -d faster-whisper.srv759970.hstgr.cloud --non-interactive --agree-tos -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"03-operations/vps-setup/#creer-les-configurations-nginx","title":"Cr\u00e9er les Configurations Nginx","text":"<p>Pour chaque service, cr\u00e9er un fichier dans <code>/etc/nginx/sites-available/</code> et activer:</p> <pre><code>ln -sf /etc/nginx/sites-available/&lt;service&gt; /etc/nginx/sites-enabled/\nnginx -t\nsystemctl reload nginx\n</code></pre>"},{"location":"03-operations/vps-setup/#configuration-basic-auth","title":"Configuration Basic Auth","text":"<pre><code># Cr\u00e9er le fichier de mots de passe\nhtpasswd -c /etc/nginx/.htpasswd admin\n\n# Cr\u00e9er le snippet\ncat &gt; /etc/nginx/snippets/basic-auth.conf &lt;&lt; EOF\nauth_basic \"Restricted Access\";\nauth_basic_user_file /etc/nginx/.htpasswd;\nEOF\n</code></pre>"},{"location":"03-operations/vps-setup/#verification-post-deploiement","title":"V\u00e9rification Post-D\u00e9ploiement","text":""},{"location":"03-operations/vps-setup/#services-docker","title":"Services Docker","text":"<pre><code># Tous les conteneurs en cours\ndocker ps\n\n# V\u00e9rifier les logs\ndocker-compose logs -f\n</code></pre>"},{"location":"03-operations/vps-setup/#services-https","title":"Services HTTPS","text":"<pre><code># Monitoring\ncurl -I https://monitoring.srv759970.hstgr.cloud\n\n# WhisperX\ncurl https://whisperx.srv759970.hstgr.cloud/\n\n# Dozzle\ncurl -I https://dozzle.srv759970.hstgr.cloud\n\n# Dashy\ncurl -I https://dashy.srv759970.hstgr.cloud\n</code></pre>"},{"location":"03-operations/vps-setup/#certificats-ssl","title":"Certificats SSL","text":"<pre><code>certbot certificates\n</code></pre>"},{"location":"03-operations/vps-setup/#maintenance","title":"Maintenance","text":""},{"location":"03-operations/vps-setup/#mises-a-jour","title":"Mises \u00e0 Jour","text":"<pre><code># Syst\u00e8me\napt-get update &amp;&amp; apt-get upgrade -y\n\n# Images Docker\ncd /opt/&lt;service&gt;\ndocker-compose pull\ndocker-compose up -d --build\n</code></pre>"},{"location":"03-operations/vps-setup/#backup","title":"Backup","text":"<pre><code># Volumes Docker\ndocker run --rm -v &lt;volume_name&gt;:/data -v $(pwd):/backup alpine tar czf /backup/backup.tar.gz -C /data .\n\n# Configurations Nginx\ntar czf nginx-configs-$(date +%Y%m%d).tar.gz /etc/nginx/sites-available/\n</code></pre>"},{"location":"03-operations/vps-setup/#logs","title":"Logs","text":"<pre><code># Nginx\ntail -f /var/log/nginx/access.log\ntail -f /var/log/nginx/error.log\n\n# Docker\ndocker logs -f &lt;container_name&gt;\n\n# Syst\u00e8me\ntail -f /var/log/syslog\n</code></pre>"},{"location":"03-operations/vps-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"03-operations/vps-setup/#service-ne-demarre-pas","title":"Service ne d\u00e9marre pas","text":"<pre><code># Voir les logs\ndocker logs &lt;container_name&gt; --tail 50\n\n# Inspecter le conteneur\ndocker inspect &lt;container_name&gt;\n\n# V\u00e9rifier le r\u00e9seau\ndocker network inspect &lt;network_name&gt;\n</code></pre>"},{"location":"03-operations/vps-setup/#erreur-502-nginx","title":"Erreur 502 Nginx","text":"<pre><code># V\u00e9rifier que le service \u00e9coute\nnetstat -tlnp | grep &lt;port&gt;\n\n# Logs Nginx\ntail -50 /var/log/nginx/error.log\n\n# Red\u00e9marrer le service\ndocker-compose restart\n</code></pre>"},{"location":"03-operations/vps-setup/#certificat-ssl-expire","title":"Certificat SSL expir\u00e9","text":"<pre><code># Renouveler\ncertbot renew\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"03-operations/vps-setup/#structure-finale","title":"Structure Finale","text":"<pre><code>/opt/\n\u251c\u2500\u2500 whisperx/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 server.py\n\u2502   \u2514\u2500\u2500 worker.py\n\u251c\u2500\u2500 faster-whisper-queue/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u251c\u2500\u2500 server.py\n\u2502   \u251c\u2500\u2500 worker.py\n\u2502   \u2514\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 monitoring/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u251c\u2500\u2500 prometheus/\n\u2502   \u251c\u2500\u2500 loki/\n\u2502   \u251c\u2500\u2500 promtail/\n\u2502   \u2514\u2500\u2500 grafana/\n\u251c\u2500\u2500 dashy/\n\u2502   \u251c\u2500\u2500 docker-compose.yml\n\u2502   \u2514\u2500\u2500 conf.yml\n\u2514\u2500\u2500 mkdocs/\n    \u251c\u2500\u2500 docker-compose.yml\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 mkdocs.yml\n    \u2514\u2500\u2500 docs/\n</code></pre> <pre><code>/etc/nginx/\n\u251c\u2500\u2500 sites-available/\n\u2502   \u251c\u2500\u2500 monitoring\n\u2502   \u251c\u2500\u2500 whisperx-api\n\u2502   \u251c\u2500\u2500 dozzle\n\u2502   \u251c\u2500\u2500 dashy\n\u2502   \u2514\u2500\u2500 faster-whisper-queue\n\u251c\u2500\u2500 sites-enabled/  (symlinks)\n\u2514\u2500\u2500 snippets/\n    \u2514\u2500\u2500 basic-auth.conf\n</code></pre>"},{"location":"03-operations/vps-setup/#ressources","title":"Ressources","text":"<ul> <li>Docker Documentation</li> <li>Nginx Documentation</li> <li>Let's Encrypt</li> <li>Ubuntu Server Guide</li> </ul>"},{"location":"04-reference/docker/commands/","title":"Docker - Commandes Courantes","text":"<p>R\u00e9f\u00e9rence rapide des commandes Docker et Docker Compose les plus utilis\u00e9es.</p>"},{"location":"04-reference/docker/commands/#docker-gestion-des-conteneurs","title":"Docker - Gestion des Conteneurs","text":""},{"location":"04-reference/docker/commands/#lister-les-conteneurs","title":"Lister les conteneurs","text":"<pre><code># Conteneurs en cours d'ex\u00e9cution\ndocker ps\n\n# Tous les conteneurs (y compris arr\u00eat\u00e9s)\ndocker ps -a\n\n# Format personnalis\u00e9\ndocker ps --format \"table {{.Names}}\\t{{.Status}}\\t{{.Ports}}\"\n</code></pre>"},{"location":"04-reference/docker/commands/#logs","title":"Logs","text":"<pre><code># Voir les logs\ndocker logs &lt;container_name&gt;\n\n# Suivre les logs en temps r\u00e9el\ndocker logs -f &lt;container_name&gt;\n\n# 50 derni\u00e8res lignes\ndocker logs --tail 50 &lt;container_name&gt;\n\n# Avec timestamps\ndocker logs -t &lt;container_name&gt;\n\n# Depuis une date\ndocker logs --since 2024-01-01 &lt;container_name&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#redemarrer-arreter","title":"Red\u00e9marrer / Arr\u00eater","text":"<pre><code># Red\u00e9marrer\ndocker restart &lt;container_name&gt;\n\n# Arr\u00eater\ndocker stop &lt;container_name&gt;\n\n# Arr\u00eater avec timeout (d\u00e9faut 10s)\ndocker stop -t 30 &lt;container_name&gt;\n\n# D\u00e9marrer\ndocker start &lt;container_name&gt;\n\n# Tuer (force)\ndocker kill &lt;container_name&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#executer-des-commandes","title":"Ex\u00e9cuter des commandes","text":"<pre><code># Shell interactif\ndocker exec -it &lt;container_name&gt; bash\ndocker exec -it &lt;container_name&gt; sh  # Si bash non disponible\n\n# Commande unique\ndocker exec &lt;container_name&gt; ls -la /app\ndocker exec &lt;container_name&gt; cat /app/config.json\n\n# En tant qu'utilisateur sp\u00e9cifique\ndocker exec -u root &lt;container_name&gt; apt-get update\n</code></pre>"},{"location":"04-reference/docker/commands/#inspecter","title":"Inspecter","text":"<pre><code># Informations compl\u00e8tes\ndocker inspect &lt;container_name&gt;\n\n# IP address\ndocker inspect &lt;container_name&gt; | grep IPAddress\n\n# Env variables\ndocker inspect &lt;container_name&gt; | grep -A 20 Env\n\n# Ports\ndocker port &lt;container_name&gt;\n\n# Processus\ndocker top &lt;container_name&gt;\n\n# Stats temps r\u00e9el\ndocker stats &lt;container_name&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#supprimer","title":"Supprimer","text":"<pre><code># Supprimer conteneur arr\u00eat\u00e9\ndocker rm &lt;container_name&gt;\n\n# Forcer suppression (m\u00eame si running)\ndocker rm -f &lt;container_name&gt;\n\n# Supprimer tous les conteneurs arr\u00eat\u00e9s\ndocker container prune\n</code></pre>"},{"location":"04-reference/docker/commands/#docker-compose","title":"Docker Compose","text":""},{"location":"04-reference/docker/commands/#demarrer-arreter","title":"D\u00e9marrer / Arr\u00eater","text":"<pre><code># D\u00e9marrer tous les services\ndocker-compose up -d\n\n# D\u00e9marrer service sp\u00e9cifique\ndocker-compose up -d &lt;service_name&gt;\n\n# Arr\u00eater tous les services\ndocker-compose down\n\n# Arr\u00eater et supprimer volumes\ndocker-compose down -v\n\n# Arr\u00eater sans supprimer conteneurs\ndocker-compose stop\n</code></pre>"},{"location":"04-reference/docker/commands/#logs_1","title":"Logs","text":"<pre><code># Logs de tous les services\ndocker-compose logs\n\n# Suivre en temps r\u00e9el\ndocker-compose logs -f\n\n# Service sp\u00e9cifique\ndocker-compose logs -f &lt;service_name&gt;\n\n# 50 derni\u00e8res lignes\ndocker-compose logs --tail 50\n</code></pre>"},{"location":"04-reference/docker/commands/#rebuild","title":"Rebuild","text":"<pre><code># Reconstruire et red\u00e9marrer\ndocker-compose up -d --build\n\n# Reconstruire sans cache\ndocker-compose build --no-cache\n\n# Service sp\u00e9cifique\ndocker-compose build &lt;service_name&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#status","title":"Status","text":"<pre><code># Status des services\ndocker-compose ps\n\n# V\u00e9rifier config\ndocker-compose config\n\n# Valider config\ndocker-compose config --quiet\n</code></pre>"},{"location":"04-reference/docker/commands/#autres","title":"Autres","text":"<pre><code># Red\u00e9marrer service\ndocker-compose restart &lt;service_name&gt;\n\n# Ex\u00e9cuter commande\ndocker-compose exec &lt;service_name&gt; bash\n\n# Scaler service\ndocker-compose up -d --scale &lt;service_name&gt;=3\n</code></pre>"},{"location":"04-reference/docker/commands/#docker-images","title":"Docker - Images","text":"<pre><code># Lister images\ndocker images\n\n# Pull image\ndocker pull &lt;image_name&gt;:&lt;tag&gt;\n\n# Supprimer image\ndocker rmi &lt;image_id&gt;\n\n# Supprimer images non utilis\u00e9es\ndocker image prune -a\n\n# Tag image\ndocker tag &lt;image_id&gt; &lt;new_name&gt;:&lt;tag&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#docker-volumes","title":"Docker - Volumes","text":"<pre><code># Lister volumes\ndocker volume ls\n\n# Inspecter volume\ndocker volume inspect &lt;volume_name&gt;\n\n# Cr\u00e9er volume\ndocker volume create &lt;volume_name&gt;\n\n# Supprimer volume\ndocker volume rm &lt;volume_name&gt;\n\n# Supprimer volumes non utilis\u00e9s\ndocker volume prune\n</code></pre>"},{"location":"04-reference/docker/commands/#docker-reseaux","title":"Docker - R\u00e9seaux","text":"<pre><code># Lister r\u00e9seaux\ndocker network ls\n\n# Inspecter r\u00e9seau\ndocker network inspect &lt;network_name&gt;\n\n# Cr\u00e9er r\u00e9seau\ndocker network create &lt;network_name&gt;\n\n# Connecter conteneur \u00e0 r\u00e9seau\ndocker network connect &lt;network_name&gt; &lt;container_name&gt;\n\n# D\u00e9connecter\ndocker network disconnect &lt;network_name&gt; &lt;container_name&gt;\n</code></pre>"},{"location":"04-reference/docker/commands/#systemctl-pour-services-docker","title":"Systemctl (pour services Docker)","text":"<pre><code># D\u00e9marrer Docker daemon\nsystemctl start docker\n\n# Arr\u00eater Docker daemon\nsystemctl stop docker\n\n# Red\u00e9marrer Docker daemon\nsystemctl restart docker\n\n# Status Docker daemon\nsystemctl status docker\n\n# Activer au d\u00e9marrage\nsystemctl enable docker\n\n# Logs Docker daemon\njournalctl -u docker -f\n</code></pre>"},{"location":"04-reference/docker/commands/#nettoyage-systeme","title":"Nettoyage Syst\u00e8me","text":"<pre><code># Nettoyer tout (conteneurs, images, volumes, r\u00e9seaux)\ndocker system prune -a --volumes\n\n# Nettoyer seulement conteneurs arr\u00eat\u00e9s\ndocker container prune\n\n# Nettoyer seulement images\ndocker image prune -a\n\n# Nettoyer seulement volumes\ndocker volume prune\n\n# Voir utilisation disque\ndocker system df\n</code></pre>"},{"location":"04-reference/docker/commands/#exemples-pratiques-srv759970","title":"Exemples Pratiques srv759970","text":""},{"location":"04-reference/docker/commands/#verifier-tous-les-services","title":"V\u00e9rifier tous les services","text":"<pre><code>docker ps --format \"table {{.Names}}\\t{{.Status}}\"\n</code></pre>"},{"location":"04-reference/docker/commands/#logs-whisperx","title":"Logs WhisperX","text":"<pre><code>cd /opt/whisperx\ndocker-compose logs -f whisperx\ndocker-compose logs -f whisperx-worker\n</code></pre>"},{"location":"04-reference/docker/commands/#redemarrer-faster-whisper","title":"Red\u00e9marrer Faster-Whisper","text":"<pre><code>cd /opt/faster-whisper-queue\ndocker-compose restart\n</code></pre>"},{"location":"04-reference/docker/commands/#logs-redis-partage","title":"Logs Redis partag\u00e9","text":"<pre><code>docker logs -f rq-queue-redis\n</code></pre>"},{"location":"04-reference/docker/commands/#monitoring-usage-memoire","title":"Monitoring usage m\u00e9moire","text":"<pre><code>docker stats --no-stream\n</code></pre>"},{"location":"04-reference/docker/commands/#nettoyer-vieux-conteneurs","title":"Nettoyer vieux conteneurs","text":"<pre><code>docker container prune -f\ndocker image prune -a -f\n</code></pre>"},{"location":"04-reference/docker/commands/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Infrastructure &gt; Docker - Documentation compl\u00e8te Docker</li> <li>Docker Compose Snippets - Configurations r\u00e9utilisables</li> <li>Guides &gt; Docker Autostart - Auto-d\u00e9marrage services</li> </ul>"},{"location":"04-reference/docker/compose-patterns/","title":"Docker Compose - Snippets R\u00e9utilisables","text":"<p>Configurations Docker Compose standards \u00e0 r\u00e9utiliser dans vos services.</p>"},{"location":"04-reference/docker/compose-patterns/#healthcheck-standard","title":"Healthcheck Standard","text":"<pre><code>healthcheck:\n  test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n  interval: 10s\n  timeout: 5s\n  retries: 3\n  start_period: 30s\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#variantes","title":"Variantes","text":"<p>Pour services sans endpoint /health:</p> <pre><code>healthcheck:\n  test: [\"CMD\", \"pgrep\", \"-x\", \"python\"]  # V\u00e9rifie que le processus tourne\n  interval: 30s\n  timeout: 10s\n  retries: 3\n</code></pre> <p>Pour bases de donn\u00e9es (MySQL):</p> <pre><code>healthcheck:\n  test: [\"CMD\", \"mysqladmin\", \"ping\", \"-h\", \"localhost\"]\n  interval: 10s\n  timeout: 5s\n  retries: 5\n</code></pre> <p>Pour bases de donn\u00e9es (PostgreSQL):</p> <pre><code>healthcheck:\n  test: [\"CMD-SHELL\", \"pg_isready -U postgres\"]\n  interval: 10s\n  timeout: 5s\n  retries: 5\n</code></pre> <p>Pour Redis:</p> <pre><code>healthcheck:\n  test: [\"CMD\", \"redis-cli\", \"ping\"]\n  interval: 5s\n  timeout: 3s\n  retries: 5\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#rotation-des-logs","title":"Rotation des Logs","text":"<pre><code>logging:\n  driver: json-file\n  options:\n    max-size: '10m'\n    max-file: '3'\n</code></pre> <p>Variantes selon taille attendue:</p> <pre><code># Services l\u00e9gers\nlogging:\n  driver: json-file\n  options:\n    max-size: '5m'\n    max-file: '2'\n\n# Services verbeux (transcription, processing)\nlogging:\n  driver: json-file\n  options:\n    max-size: '50m'\n    max-file: '5'\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#restart-policy","title":"Restart Policy","text":"<pre><code>restart: unless-stopped\n</code></pre> <p>Alternatives:</p> <ul> <li><code>no</code>: Ne jamais red\u00e9marrer automatiquement</li> <li><code>always</code>: Toujours red\u00e9marrer (m\u00eame apr\u00e8s reboot)</li> <li><code>on-failure</code>: Red\u00e9marrer seulement si \u00e9chec</li> <li><code>unless-stopped</code>: Red\u00e9marrer sauf si arr\u00eat manuel (recommand\u00e9)</li> </ul>"},{"location":"04-reference/docker/compose-patterns/#networks","title":"Networks","text":"<pre><code>networks:\n  - app-network\n\n# D\u00e9claration en bas du fichier\nnetworks:\n  app-network:\n    driver: bridge\n</code></pre> <p>R\u00e9seau externe (partag\u00e9 entre services):</p> <pre><code>networks:\n  whisperx_whisperx:\n    external: true\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#volumes","title":"Volumes","text":"<pre><code>volumes:\n  - app-data:/var/lib/app       # Volume nomm\u00e9\n  - ./config:/app/config:ro      # Mount read-only\n  - /host/path:/container/path   # Bind mount\n\n# D\u00e9claration en bas du fichier\nvolumes:\n  app-data:\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#environment-variables","title":"Environment Variables","text":"<pre><code>environment:\n  - NODE_ENV=production\n  - DEBUG=false\n  - TZ=Europe/Paris\n</code></pre> <p>Depuis fichier .env:</p> <pre><code>env_file:\n  - .env\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#dependances","title":"D\u00e9pendances","text":"<pre><code>depends_on:\n  db:\n    condition: service_healthy\n  redis:\n    condition: service_started\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#resource-limits","title":"Resource Limits","text":"<pre><code>deploy:\n  resources:\n    limits:\n      cpus: '2.0'\n      memory: 4G\n    reservations:\n      cpus: '0.5'\n      memory: 1G\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#user-permissions","title":"User &amp; Permissions","text":"<pre><code>user: \"1000:1000\"  # UID:GID\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#security","title":"Security","text":"<pre><code>security_opt:\n  - no-new-privileges:true\n\ncap_drop:\n  - ALL\n\ncap_add:\n  - NET_ADMIN  # Si besoin r\u00e9seau avanc\u00e9\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#exemple-complet","title":"Exemple Complet","text":"<pre><code>version: '3.8'\n\nservices:\n  app:\n    image: myapp:latest\n    container_name: myapp\n    restart: unless-stopped\n\n    ports:\n      - '8080:8080'\n\n    environment:\n      - NODE_ENV=production\n      - DATABASE_URL=postgresql://db:5432/mydb\n\n    volumes:\n      - app-data:/var/lib/app\n      - ./config:/app/config:ro\n\n    networks:\n      - app-network\n\n    depends_on:\n      db:\n        condition: service_healthy\n      redis:\n        condition: service_started\n\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/health\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n      start_period: 30s\n\n    logging:\n      driver: json-file\n      options:\n        max-size: '10m'\n        max-file: '3'\n\n    deploy:\n      resources:\n        limits:\n          cpus: '2.0'\n          memory: 4G\n\n  db:\n    image: postgres:15\n    container_name: myapp-db\n    restart: unless-stopped\n\n    environment:\n      - POSTGRES_DB=mydb\n      - POSTGRES_USER=myuser\n      - POSTGRES_PASSWORD=${DB_PASSWORD}\n\n    volumes:\n      - db-data:/var/lib/postgresql/data\n\n    networks:\n      - app-network\n\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U myuser\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n    logging:\n      driver: json-file\n      options:\n        max-size: '10m'\n        max-file: '3'\n\n  redis:\n    image: redis:7-alpine\n    container_name: myapp-redis\n    restart: unless-stopped\n\n    networks:\n      - app-network\n\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"ping\"]\n      interval: 5s\n      timeout: 3s\n      retries: 5\n\n    logging:\n      driver: json-file\n      options:\n        max-size: '5m'\n        max-file: '2'\n\nvolumes:\n  app-data:\n  db-data:\n\nnetworks:\n  app-network:\n    driver: bridge\n</code></pre>"},{"location":"04-reference/docker/compose-patterns/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Infrastructure &gt; Docker - Commandes et gestion Docker</li> <li>Guides &gt; Docker Autostart - Configuration auto-start</li> </ul>"},{"location":"04-reference/nginx/debugging/","title":"Nginx Debugging &amp; Diagnostics","text":"<p>Quick reference for troubleshooting Nginx issues.</p>"},{"location":"04-reference/nginx/debugging/#testing-configuration","title":"Testing Configuration","text":"<pre><code># Test configuration syntax\nnginx -t\n\n# View compiled configuration (all sites)\nnginx -T\n\n# View specific site configuration\nnginx -T | grep -A 50 'server_name mon-site.srv759970.hstgr.cloud'\n\n# View which server block handles a domain\nnginx -T | grep -B 10 'server_name mon-site.srv759970.hstgr.cloud'\n</code></pre>"},{"location":"04-reference/nginx/debugging/#viewing-logs","title":"Viewing Logs","text":"<pre><code># Real-time access and error logs\ntail -f /var/log/nginx/access.log\ntail -f /var/log/nginx/error.log\n\n# Combined logs\ntail -f /var/log/nginx/access.log /var/log/nginx/error.log\n\n# Site-specific logs\ntail -f /var/log/nginx/mon-site-access.log\n\n# Filter by domain\ntail -f /var/log/nginx/access.log | grep 'mon-site.srv759970.hstgr.cloud'\n</code></pre>"},{"location":"04-reference/nginx/debugging/#diagnostic-commands","title":"Diagnostic Commands","text":""},{"location":"04-reference/nginx/debugging/#configuration-validation","title":"Configuration Validation","text":"<pre><code># List available sites\nls -la /etc/nginx/sites-available/\n\n# List enabled sites (symlinks)\nls -la /etc/nginx/sites-enabled/\n\n# View all server names\nnginx -T | grep 'server_name' | grep -v '#' | sort | uniq\n\n# View all proxy_pass entries (backend ports)\nnginx -T | grep 'proxy_pass' | sort | uniq\n\n# View all listen directives\nnginx -T | grep 'listen' | grep -v '#' | sort | uniq\n</code></pre>"},{"location":"04-reference/nginx/debugging/#process-status","title":"Process Status","text":"<pre><code># Check service status\nsystemctl status nginx\n\n# Reload configuration (no interruption)\nsystemctl reload nginx\n\n# Restart service (brief interruption)\nsystemctl restart nginx\n</code></pre>"},{"location":"04-reference/nginx/debugging/#connection-testing","title":"Connection Testing","text":"<pre><code># Test site with Host header\ncurl -I -H 'Host: mon-site.srv759970.hstgr.cloud' http://localhost/\n\n# Follow HTTP redirections\ncurl -L -I http://mon-site.srv759970.hstgr.cloud/\n\n# View response headers\ncurl -v http://mon-site.srv759970.hstgr.cloud/\n</code></pre>"},{"location":"04-reference/nginx/debugging/#ssl-certificate-checking","title":"SSL Certificate Checking","text":"<pre><code># View served certificate\nopenssl s_client -connect mon-site.srv759970.hstgr.cloud:443 -servername mon-site.srv759970.hstgr.cloud | openssl x509 -noout -subject -issuer\n\n# List installed certificates\nls -la /etc/letsencrypt/live/\n</code></pre>"},{"location":"04-reference/nginx/debugging/#network-analysis","title":"Network Analysis","text":"<pre><code># Monitor incoming requests on port 80\ntcpdump -i any port 80 -A\n\n# Watch logs while making request\ntail -f /var/log/nginx/access.log &amp;\ncurl http://mon-site.srv759970.hstgr.cloud/\n</code></pre>"},{"location":"04-reference/nginx/debugging/#advanced-debugging","title":"Advanced Debugging","text":""},{"location":"04-reference/nginx/debugging/#enable-debug-logs","title":"Enable Debug Logs","text":"<p>Add to nginx configuration:</p> <pre><code>error_log /var/log/nginx/error.log debug;\n</code></pre> <p>Then reload: <code>systemctl reload nginx</code></p>"},{"location":"04-reference/nginx/debugging/#see-also","title":"See Also","text":"<ul> <li>Configuration Reference</li> <li>../../infrastructure/nginx.md</li> <li>../../guides/infrastructure/nginx-troubleshooting.md</li> </ul>"},{"location":"04-reference/nginx/proxy-config/","title":"Nginx Configuration Reference","text":"<p>Comprehensive reference for Nginx server block configurations.</p>"},{"location":"04-reference/nginx/proxy-config/#directory-structure","title":"Directory Structure","text":"<pre><code>/etc/nginx/\n\u251c\u2500\u2500 nginx.conf                  # Global configuration\n\u251c\u2500\u2500 sites-available/            # All site configurations\n\u2502   \u251c\u2500\u2500 site-1                  # Site 1\n\u2502   \u251c\u2500\u2500 site-2                  # Site 2\n\u2502   \u2514\u2500\u2500 site-3                  # Site 3\n\u251c\u2500\u2500 sites-enabled/              # Symlinks to active sites\n\u2502   \u251c\u2500\u2500 site-1 -&gt; ../sites-available/site-1\n\u2502   \u251c\u2500\u2500 site-2 -&gt; ../sites-available/site-2\n\u2502   \u2514\u2500\u2500 site-3 -&gt; ../sites-available/site-3\n\u2514\u2500\u2500 snippets/                   # Reusable configurations\n    \u2514\u2500\u2500 ssl-params.conf\n\n/var/log/nginx/\n\u251c\u2500\u2500 access.log                  # Global access logs\n\u251c\u2500\u2500 error.log                   # Global error logs\n\u251c\u2500\u2500 site-1-access.log           # Site-specific logs\n\u2514\u2500\u2500 site-1-error.log\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#creating-a-new-site","title":"Creating a New Site","text":""},{"location":"04-reference/nginx/proxy-config/#step-1-create-the-configuration","title":"Step 1: Create the configuration","text":"<pre><code>cat &gt; /etc/nginx/sites-available/my-site &lt;&lt;'EOF'\nserver {\n    listen 80;\n    server_name my-site.example.com;\n\n    # Configuration here (see templates below)\n}\nEOF\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#step-2-activate-the-site","title":"Step 2: Activate the site","text":"<pre><code>ln -s /etc/nginx/sites-available/my-site /etc/nginx/sites-enabled/\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#step-3-test-and-reload","title":"Step 3: Test and reload","text":"<pre><code># Test syntax\nnginx -t\n\n# If OK, reload Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#step-4-verify","title":"Step 4: Verify","text":"<pre><code># Test access\ncurl -I -H 'Host: my-site.example.com' http://localhost/\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#configuration-templates","title":"Configuration Templates","text":""},{"location":"04-reference/nginx/proxy-config/#template-1-static-site","title":"Template 1: Static Site","text":"<p>Use case: HTML site, Astro/React/Vue build</p> <pre><code>server {\n    listen 80;\n    server_name my-site.example.com;\n\n    root /opt/my-site;\n    index index.html;\n\n    # Site-specific logs\n    access_log /var/log/nginx/my-site-access.log;\n    error_log /var/log/nginx/my-site-error.log;\n\n    # Serve files and directories\n    location / {\n        # For Astro/React builds: try file, then .html, then dir/, then dir/index.html\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    # Cache static assets\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n\n    # Gzip compression\n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#template-2-docker-reverse-proxy","title":"Template 2: Docker Reverse Proxy","text":"<p>Use case: Streamlit, FastAPI, Strapi, Node.js in Docker</p> <pre><code>server {\n    listen 80;\n    server_name my-app.example.com;\n\n    # Logs\n    access_log /var/log/nginx/my-app-access.log;\n    error_log /var/log/nginx/my-app-error.log;\n\n    location / {\n        # Docker port of the application (e.g., 8502, 1337, 3000)\n        proxy_pass http://localhost:8502;\n\n        proxy_http_version 1.1;\n\n        # Essential headers\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # WebSocket support (Streamlit, Strapi admin)\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        # Timeout for long polling\n        proxy_read_timeout 86400;\n    }\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#template-3-systemd-service-proxy","title":"Template 3: Systemd Service Proxy","text":"<p>Use case: Ollama, PostgreSQL, local API</p> <pre><code>server {\n    listen 80;\n    server_name api.example.com;\n\n    location / {\n        # Systemd service port\n        proxy_pass http://localhost:11434;\n\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n        # CORS if public API\n        add_header Access-Control-Allow-Origin * always;\n        add_header Access-Control-Allow-Methods \"GET, POST, OPTIONS\" always;\n        add_header Access-Control-Allow-Headers \"Content-Type, Authorization\" always;\n\n        # Timeouts for long requests (LLM)\n        proxy_read_timeout 300s;\n        proxy_connect_timeout 75s;\n\n        # No buffering (streaming)\n        proxy_buffering off;\n        proxy_cache off;\n    }\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#template-4-multiple-apps-sub-paths","title":"Template 4: Multiple Apps (Sub-paths)","text":"<p>Use case: <code>site.com/app1</code>, <code>site.com/app2</code></p> <pre><code>server {\n    listen 80;\n    server_name example.com;\n\n    # App 1: /dashboard -&gt; Streamlit\n    location /dashboard {\n        proxy_pass http://localhost:8501;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n    }\n\n    # App 2: /api -&gt; FastAPI\n    location /api {\n        proxy_pass http://localhost:8000;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    # Main site: / -&gt; Static files\n    location / {\n        root /opt/main-site;\n        index index.html;\n        try_files $uri $uri/ /index.html =404;\n    }\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#template-5-frontend-backend","title":"Template 5: Frontend + Backend","text":"<p>Use case: Frontend + Backend CMS (Strapi, Ghost, WordPress)</p> <pre><code># Frontend\nserver {\n    listen 80;\n    server_name my-site.example.com;\n\n    root /opt/my-site;\n    index index.html;\n\n    location / {\n        try_files $uri $uri.html $uri/ $uri/index.html =404;\n    }\n\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n}\n\n# Backend admin\nserver {\n    listen 80;\n    server_name admin.my-site.example.com;\n\n    location / {\n        proxy_pass http://localhost:1337;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_read_timeout 86400;\n    }\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#global-nginxconf","title":"Global nginx.conf","text":"<p>Configuration with optimizations:</p> <pre><code>user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    # Basic Settings\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout 65;\n    types_hash_max_size 2048;\n    server_tokens off;\n\n    # MIME Types\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # Logging\n    access_log /var/log/nginx/access.log;\n    error_log /var/log/nginx/error.log;\n\n    # Gzip\n    gzip on;\n    gzip_vary on;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;\n\n    # Virtual Host Configs\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#best-practices","title":"Best Practices","text":""},{"location":"04-reference/nginx/proxy-config/#1-always-use-specific-server_name","title":"1. Always use specific <code>server_name</code>","text":"<pre><code># GOOD\nserver {\n    server_name my-site.example.com www.my-site.com;\n}\n\n# BAD (creates conflicts)\nserver {\n    server_name _;  # Catch-all\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#2-one-file-one-site-or-logical-group","title":"2. One file = One site (or logical group)","text":"<pre><code>sites-available/\n\u251c\u2500\u2500 frontend              # Frontend site\n\u251c\u2500\u2500 dashboard             # Dashboard app\n\u2514\u2500\u2500 api                   # API service\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#3-separate-logs-per-site","title":"3. Separate logs per site","text":"<pre><code>server {\n    access_log /var/log/nginx/my-site-access.log;\n    error_log /var/log/nginx/my-site-error.log;\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#4-test-before-reload","title":"4. Test before reload","text":"<pre><code># ALWAYS run nginx -t before reload\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#5-comment-your-configurations","title":"5. Comment your configurations","text":"<pre><code>server {\n    listen 80;\n    server_name my-site.example.com;\n\n    # Site-specific logs\n    access_log /var/log/nginx/my-site-access.log;\n\n    # Reverse proxy to Docker container (port 8502)\n    location / {\n        proxy_pass http://localhost:8502;\n        # ...\n    }\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-config/#see-also","title":"See Also","text":"<ul> <li>Proxy Headers - Standard headers for reverse proxy</li> <li>SSL Config - HTTPS configuration</li> <li>../security/ssl-certbot.md - SSL certificate generation</li> <li>../../infrastructure/nginx.md - Nginx installation and setup</li> <li>../../guides/infrastructure/nginx-troubleshooting.md - Troubleshooting guide</li> </ul>"},{"location":"04-reference/nginx/proxy-headers/","title":"Headers Proxy Standards","text":"<p>Configuration des headers HTTP pour reverse proxy Nginx.</p>"},{"location":"04-reference/nginx/proxy-headers/#headers-de-base","title":"Headers de Base","text":"<pre><code>proxy_http_version 1.1;\nproxy_set_header Host $host;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $scheme;\nproxy_set_header X-Forwarded-Host $host;\n</code></pre>"},{"location":"04-reference/nginx/proxy-headers/#headers-pour-websocket","title":"Headers pour WebSocket","text":"<pre><code>proxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection \"upgrade\";\nproxy_buffering off;\n</code></pre>"},{"location":"04-reference/nginx/proxy-headers/#headers-pour-upload-de-fichiers","title":"Headers pour Upload de Fichiers","text":"<pre><code>client_max_body_size 500M;\nproxy_request_buffering off;\n</code></pre>"},{"location":"04-reference/nginx/proxy-headers/#timeouts-longs-api-transcription-etc","title":"Timeouts Longs (API transcription, etc.)","text":"<pre><code>proxy_read_timeout 1800;      # 30 minutes\nproxy_connect_timeout 300;    # 5 minutes\nproxy_send_timeout 300;       # 5 minutes\n</code></pre>"},{"location":"04-reference/nginx/proxy-headers/#exemple-complet","title":"Exemple Complet","text":"<pre><code>location / {\n    # Headers de base\n    proxy_pass http://localhost:8080;\n    proxy_http_version 1.1;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header X-Forwarded-Host $host;\n\n    # Support WebSocket\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_buffering off;\n\n    # Upload de fichiers volumineux\n    client_max_body_size 500M;\n\n    # Timeouts\n    proxy_read_timeout 1800;\n    proxy_connect_timeout 300;\n    proxy_send_timeout 300;\n}\n</code></pre>"},{"location":"04-reference/nginx/proxy-headers/#utilise-dans","title":"Utilis\u00e9 dans","text":"<ul> <li>WhisperX API</li> <li>Faster-Whisper API</li> <li>Dashy</li> <li>Dozzle</li> <li>Grafana</li> <li>Tous les services derri\u00e8re reverse proxy</li> </ul>"},{"location":"04-reference/nginx/ssl-config/","title":"Configuration SSL Standard","text":"<p>Configuration SSL/TLS pour serveurs Nginx avec Let's Encrypt.</p>"},{"location":"04-reference/nginx/ssl-config/#configuration-ssl-de-base","title":"Configuration SSL de Base","text":"<pre><code>listen 443 ssl http2;\nlisten [::]:443 ssl http2;\n\nssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\n\ninclude /etc/letsencrypt/options-ssl-nginx.conf;\nssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n</code></pre>"},{"location":"04-reference/nginx/ssl-config/#redirect-http-https","title":"Redirect HTTP \u2192 HTTPS","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    server_name &lt;domain&gt;;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"04-reference/nginx/ssl-config/#template-complet-https","title":"Template Complet HTTPS","text":"<pre><code># HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name example.srv759970.hstgr.cloud;\n\n    # SSL Configuration\n    ssl_certificate /etc/letsencrypt/live/example.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    # Logs\n    access_log /var/log/nginx/example-access.log;\n    error_log /var/log/nginx/example-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:8080;\n        include snippets/proxy-headers.conf;  # Voir reference/nginx/proxy-headers.md\n    }\n}\n\n# HTTP \u2192 HTTPS Redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name example.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"04-reference/nginx/ssl-config/#headers-de-securite-recommandes","title":"Headers de S\u00e9curit\u00e9 Recommand\u00e9s","text":"<pre><code>add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\nadd_header X-Frame-Options \"SAMEORIGIN\" always;\nadd_header X-Content-Type-Options \"nosniff\" always;\nadd_header X-XSS-Protection \"1; mode=block\" always;\n</code></pre>"},{"location":"04-reference/nginx/ssl-config/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Certbot SSL - Proc\u00e9dure de g\u00e9n\u00e9ration de certificats</li> <li>Proxy Headers - Configuration headers reverse proxy</li> </ul>"},{"location":"04-reference/security/basic-auth/","title":"Configuration Basic Auth Nginx","text":"<p>Mise en place de l'authentification HTTP Basic avec Nginx.</p>"},{"location":"04-reference/security/basic-auth/#installation-htpasswd","title":"Installation htpasswd","text":"<pre><code># Ubuntu/Debian\napt-get install apache2-utils\n\n# CentOS/RHEL\nyum install httpd-tools\n</code></pre>"},{"location":"04-reference/security/basic-auth/#creer-fichier-htpasswd","title":"Cr\u00e9er Fichier .htpasswd","text":""},{"location":"04-reference/security/basic-auth/#creer-nouveau-fichier","title":"Cr\u00e9er nouveau fichier","text":"<pre><code>htpasswd -c /etc/nginx/.htpasswd admin\n</code></pre> <p>Attention: Le flag <code>-c</code> \u00e9crase le fichier existant.</p>"},{"location":"04-reference/security/basic-auth/#ajouter-utilisateur-a-fichier-existant","title":"Ajouter utilisateur \u00e0 fichier existant","text":"<pre><code>htpasswd /etc/nginx/.htpasswd newuser\n</code></pre>"},{"location":"04-reference/security/basic-auth/#supprimer-un-utilisateur","title":"Supprimer un utilisateur","text":"<pre><code>htpasswd -D /etc/nginx/.htpasswd username\n</code></pre>"},{"location":"04-reference/security/basic-auth/#configuration-nginx","title":"Configuration Nginx","text":""},{"location":"04-reference/security/basic-auth/#activer-sur-tout-le-serveur","title":"Activer sur tout le serveur","text":"<pre><code>server {\n    listen 443 ssl http2;\n    server_name example.srv759970.hstgr.cloud;\n\n    auth_basic \"Restricted Access\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n\n    location / {\n        proxy_pass http://localhost:8080;\n    }\n}\n</code></pre>"},{"location":"04-reference/security/basic-auth/#activer-sur-un-location-specifique","title":"Activer sur un location sp\u00e9cifique","text":"<pre><code>server {\n    listen 443 ssl http2;\n    server_name example.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:8080;\n    }\n\n    location /admin {\n        auth_basic \"Admin Area\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        proxy_pass http://localhost:8080/admin;\n    }\n}\n</code></pre>"},{"location":"04-reference/security/basic-auth/#desactiver-pour-un-sous-path","title":"D\u00e9sactiver pour un sous-path","text":"<pre><code>location / {\n    auth_basic \"Restricted Access\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n    proxy_pass http://localhost:8080;\n}\n\nlocation /public {\n    auth_basic off;  # D\u00e9sactive l'auth pour ce path\n    proxy_pass http://localhost:8080/public;\n}\n</code></pre>"},{"location":"04-reference/security/basic-auth/#snippet-reutilisable","title":"Snippet R\u00e9utilisable","text":"<p>Cr\u00e9er <code>/etc/nginx/snippets/basic-auth.conf</code>:</p> <pre><code>auth_basic \"Restricted Access - srv759970\";\nauth_basic_user_file /etc/nginx/.htpasswd;\n</code></pre> <p>Utiliser dans les server blocks:</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name example.srv759970.hstgr.cloud;\n\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://localhost:8080;\n    }\n}\n</code></pre>"},{"location":"04-reference/security/basic-auth/#permissions","title":"Permissions","text":"<pre><code># S\u00e9curiser le fichier .htpasswd\nchmod 640 /etc/nginx/.htpasswd\nchown root:www-data /etc/nginx/.htpasswd\n</code></pre>"},{"location":"04-reference/security/basic-auth/#verifier-le-fichier","title":"V\u00e9rifier le Fichier","text":"<pre><code>cat /etc/nginx/.htpasswd\n# admin:$apr1$xyz...\n</code></pre> <p>Format: <code>username:encrypted_password</code></p>"},{"location":"04-reference/security/basic-auth/#generer-mot-de-passe-sans-interaction","title":"G\u00e9n\u00e9rer Mot de Passe Sans Interaction","text":"<pre><code># Utiliser openssl pour g\u00e9n\u00e9rer le hash\nhtpasswd -nb admin \"MyPassword123\" &gt;&gt; /etc/nginx/.htpasswd\n</code></pre>"},{"location":"04-reference/security/basic-auth/#tester-lauthentification","title":"Tester l'Authentification","text":"<pre><code># Sans credentials \u2192 401\ncurl https://example.srv759970.hstgr.cloud\n\n# Avec credentials \u2192 200\ncurl -u admin:password https://example.srv759970.hstgr.cloud\n</code></pre>"},{"location":"04-reference/security/basic-auth/#services-proteges-sur-srv759970","title":"Services Prot\u00e9g\u00e9s sur srv759970","text":"<ul> <li>Grafana: https://monitoring.srv759970.hstgr.cloud</li> <li>RQ Dashboard: https://whisperx-dashboard.srv759970.hstgr.cloud</li> <li>Dozzle: https://dozzle.srv759970.hstgr.cloud</li> </ul>"},{"location":"04-reference/security/basic-auth/#troubleshooting","title":"Troubleshooting","text":""},{"location":"04-reference/security/basic-auth/#401-unauthorized-meme-avec-bon-mot-de-passe","title":"401 Unauthorized m\u00eame avec bon mot de passe","text":"<pre><code># V\u00e9rifier permissions fichier\nls -la /etc/nginx/.htpasswd\n\n# V\u00e9rifier logs Nginx\ntail -f /var/log/nginx/error.log\n</code></pre>"},{"location":"04-reference/security/basic-auth/#pas-de-prompt-dauthentification","title":"Pas de prompt d'authentification","text":"<pre><code># V\u00e9rifier syntaxe Nginx\nnginx -t\n\n# Recharger Nginx\nsystemctl reload nginx\n</code></pre>"},{"location":"04-reference/security/basic-auth/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Infrastructure &gt; Security - Vue d'ensemble s\u00e9curit\u00e9</li> <li>Infrastructure &gt; Nginx - Configuration Nginx globale</li> </ul>"},{"location":"04-reference/security/ssl-certbot/","title":"G\u00e9n\u00e9ration Certificat SSL avec Certbot","text":"<p>Proc\u00e9dure pour g\u00e9n\u00e9rer des certificats SSL Let's Encrypt avec Certbot.</p>"},{"location":"04-reference/security/ssl-certbot/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Nginx install\u00e9 et configur\u00e9</li> <li>DNS pointant vers le serveur (A record)</li> <li>Port 80 ouvert pour validation HTTP</li> </ul>"},{"location":"04-reference/security/ssl-certbot/#generation-certificat-simple","title":"G\u00e9n\u00e9ration Certificat Simple","text":"<pre><code>certbot certonly --nginx \\\n  -d &lt;subdomain&gt;.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#generation-multi-domaines","title":"G\u00e9n\u00e9ration Multi-domaines","text":"<pre><code>certbot certonly --nginx \\\n  -d domain1.srv759970.hstgr.cloud \\\n  -d domain2.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#generation-wildcard-dns-challenge","title":"G\u00e9n\u00e9ration Wildcard (DNS Challenge)","text":"<pre><code>certbot certonly --manual \\\n  --preferred-challenges dns \\\n  -d \"*.srv759970.hstgr.cloud\" \\\n  -m julien@julienfernandez.xyz\n</code></pre> <p>Note: N\u00e9cessite de cr\u00e9er un enregistrement TXT DNS manuellement.</p>"},{"location":"04-reference/security/ssl-certbot/#renouvellement-automatique","title":"Renouvellement Automatique","text":"<p>Certbot configure automatiquement le renouvellement via systemd timer.</p>"},{"location":"04-reference/security/ssl-certbot/#verifier-le-timer","title":"V\u00e9rifier le timer","text":"<pre><code>systemctl status certbot.timer\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#tester-le-renouvellement","title":"Tester le renouvellement","text":"<pre><code>certbot renew --dry-run\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#renouvellement-manuel","title":"Renouvellement Manuel","text":"<pre><code>certbot renew\nsystemctl reload nginx\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#verifier-les-certificats","title":"V\u00e9rifier les Certificats","text":"<pre><code># Lister tous les certificats\ncertbot certificates\n\n# D\u00e9tails d'un certificat sp\u00e9cifique\nopenssl x509 -in /etc/letsencrypt/live/&lt;domain&gt;/cert.pem -text -noout\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#localisation-des-fichiers","title":"Localisation des Fichiers","text":"<pre><code>/etc/letsencrypt/\n\u251c\u2500\u2500 live/&lt;domain&gt;/\n\u2502   \u251c\u2500\u2500 fullchain.pem    # Certificat complet (\u00e0 utiliser dans nginx)\n\u2502   \u251c\u2500\u2500 privkey.pem      # Cl\u00e9 priv\u00e9e (\u00e0 utiliser dans nginx)\n\u2502   \u251c\u2500\u2500 cert.pem         # Certificat seul\n\u2502   \u2514\u2500\u2500 chain.pem        # Cha\u00eene de certification\n\u251c\u2500\u2500 archive/             # Archives des certificats\n\u2514\u2500\u2500 renewal/             # Configurations de renouvellement\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#supprimer-un-certificat","title":"Supprimer un Certificat","text":"<pre><code>certbot delete --cert-name &lt;domain&gt;.srv759970.hstgr.cloud\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#troubleshooting","title":"Troubleshooting","text":""},{"location":"04-reference/security/ssl-certbot/#erreur-port-80-non-accessible","title":"Erreur: Port 80 non accessible","text":"<pre><code># V\u00e9rifier que Nginx \u00e9coute sur port 80\nnetstat -tlnp | grep :80\n\n# V\u00e9rifier le firewall\nufw status | grep 80\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#erreur-dns-non-resolu","title":"Erreur: DNS non r\u00e9solu","text":"<pre><code># V\u00e9rifier la r\u00e9solution DNS\ndig &lt;subdomain&gt;.srv759970.hstgr.cloud +short\nnslookup &lt;subdomain&gt;.srv759970.hstgr.cloud\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#certificat-expire","title":"Certificat expir\u00e9","text":"<pre><code># Forcer le renouvellement\ncertbot renew --force-renewal --cert-name &lt;domain&gt;.srv759970.hstgr.cloud\nsystemctl reload nginx\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#common-issues","title":"Common Issues","text":""},{"location":"04-reference/security/ssl-certbot/#https-redirect-blocking-certbot","title":"HTTPS Redirect Blocking Certbot","text":"<p>Problem: Certbot validation fails because existing HTTPS redirect prevents HTTP-01 challenge.</p> <p>Symptoms: <pre><code>Failed authorization procedure. example.com (http-01):\nurn:ietf:params:acme:error:connection :: The server could not connect to the client\nInvalid response from https://... 404\n</code></pre></p> <p>Diagnosis: <pre><code># Test if HTTP access redirects to HTTPS\ncurl -I http://whisper.srv759970.hstgr.cloud/\n\n# If result shows: HTTP/1.1 301 \u2192 HTTPS, this is the problem!\n</code></pre></p> <p>Solution 1: Use standalone mode (temporarily stop Nginx):</p> <pre><code># Stop Nginx temporarily\nsystemctl stop nginx\n\n# Get certificate in standalone mode\ncertbot certonly --standalone \\\n  -d whisper.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n\n# Restart Nginx\nsystemctl start nginx\n</code></pre> <p>Solution 2: Configure site after obtaining certificate:</p> <pre><code># 1. Initial config (WITHOUT HTTPS redirect)\nserver {\n    listen 80;\n    server_name whisper.srv759970.hstgr.cloud;\n\n    location / {\n        proxy_pass http://localhost:8001;\n    }\n}\n\n# 2. Obtain certificate\n# certbot certonly --standalone ...\n\n# 3. Add HTTPS block and redirect\nserver {\n    listen 443 ssl http2;\n    server_name whisper.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/whisper.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        proxy_pass http://localhost:8001;\n    }\n}\n\nserver {\n    listen 80;\n    server_name whisper.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Solution 3: Add exception for .well-known path:</p> <pre><code>server {\n    listen 80;\n    server_name example.srv759970.hstgr.cloud;\n\n    # Allow certbot validation\n    location /.well-known/acme-challenge/ {\n        root /var/www/html;\n    }\n\n    # Redirect everything else\n    location / {\n        return 301 https://$host$request_uri;\n    }\n}\n</code></pre> <p>Solution 4: Use webroot plugin:</p> <pre><code>certbot certonly --webroot -w /var/www/html \\\n  -d example.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre> <p>Prevention: - Never add HTTPS redirect before obtaining the certificate - Use <code>certbot certonly --standalone</code> for first certificate - Then use <code>certbot --nginx</code> for renewals</p>"},{"location":"04-reference/security/ssl-certbot/#certificate-already-exists","title":"Certificate Already Exists","text":"<p>Problem: Certbot says certificate already exists.</p> <p>Solution: Use <code>--force-renewal</code>:</p> <pre><code>certbot renew --force-renewal --cert-name example.srv759970.hstgr.cloud\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#multiple-domains-on-same-certificate","title":"Multiple Domains on Same Certificate","text":"<p>Best Practice: Each service should have its own certificate for easier management:</p> <pre><code># Separate certificates (recommended)\ncertbot certonly --nginx -d service1.srv759970.hstgr.cloud\ncertbot certonly --nginx -d service2.srv759970.hstgr.cloud\n\n# vs Single certificate for multiple domains\ncertbot certonly --nginx -d service1.srv759970.hstgr.cloud -d service2.srv759970.hstgr.cloud\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#best-practices","title":"Best Practices","text":"<ol> <li>One certificate per service - Easier renewal and management</li> <li>Use --nginx plugin - Automatically handles configuration</li> <li>Test renewal early - Run <code>certbot renew --dry-run</code> regularly</li> <li>Monitor expiration - Certificates expire after 90 days</li> <li>Keep .well-known accessible - Never block /.well-known/acme-challenge/</li> <li>Never add HTTPS redirect before certificate - Prevents validation failures</li> </ol>"},{"location":"04-reference/security/ssl-certbot/#integration-with-nginx","title":"Integration with Nginx","text":""},{"location":"04-reference/security/ssl-certbot/#certificate-creation","title":"Certificate Creation","text":"<pre><code>certbot certonly --nginx \\\n  -d &lt;subdomain&gt;.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#automatic-renewal","title":"Automatic Renewal","text":"<p>Certbot automatically configures a systemd timer for renewal:</p> <pre><code># Check timer status\nsystemctl status certbot.timer\n\n# Test renewal process\ncertbot renew --dry-run\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#check-certificate-expiration","title":"Check Certificate Expiration","text":"<pre><code>certbot certificates\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#exemples-pour-srv759970","title":"Exemples pour srv759970","text":""},{"location":"04-reference/security/ssl-certbot/#whisperx","title":"WhisperX","text":"<pre><code>certbot certonly --nginx \\\n  -d whisperx.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#dozzle","title":"Dozzle","text":"<pre><code>certbot certonly --nginx \\\n  -d dozzle.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#dashy","title":"Dashy","text":"<pre><code>certbot certonly --nginx \\\n  -d dashy.srv759970.hstgr.cloud \\\n  --non-interactive \\\n  --agree-tos \\\n  -m julien@julienfernandez.xyz\n</code></pre>"},{"location":"04-reference/security/ssl-certbot/#see-also","title":"See Also","text":"<ul> <li>../nginx/ssl-config.md - Nginx SSL configuration reference</li> <li>../../infrastructure/security.md - Security overview</li> <li>../../infrastructure/nginx.md - Nginx infrastructure setup</li> </ul>"},{"location":"05-advanced/api-portal/","title":"\ud83c\udfaf Guide API &amp; Admin Portal - srv759970.hstgr.cloud","text":""},{"location":"05-advanced/api-portal/#vue-densemble","title":"\ud83d\udccb Vue d'ensemble","text":"<p>Le API &amp; Admin Portal est un portail web centralis\u00e9 qui regroupe toute la documentation API (Swagger UI) et les outils d'administration/monitoring du serveur.</p> <p>URL principale : https://portal.srv759970.hstgr.cloud</p>"},{"location":"05-advanced/api-portal/#acces-au-portail","title":"\ud83d\ude80 Acc\u00e8s au portail","text":""},{"location":"05-advanced/api-portal/#url-principale","title":"URL principale","text":"<pre><code>https://portal.srv759970.hstgr.cloud\n</code></pre> <p>Le portail affiche une page d'accueil organis\u00e9e en 3 sections : 1. \ud83d\udcda API Documentation (Swagger UI) 2. \ud83d\udd27 Monitoring &amp; Administration 3. \ud83c\udf10 Applications d\u00e9ploy\u00e9es</p>"},{"location":"05-advanced/api-portal/#documentation-api-swagger-ui","title":"\ud83d\udcda Documentation API (Swagger UI)","text":"<p>URL unifi\u00e9e : https://portal.srv759970.hstgr.cloud/api</p> <p>Le portail pr\u00e9sente une interface Swagger UI unique qui regroupe les 3 APIs suivantes :</p>"},{"location":"05-advanced/api-portal/#whisper-api","title":"Whisper API","text":"<p>Description : API de transcription speech-to-text avec faster-whisper - OpenAPI 3.1 natif (FastAPI) - Endpoints compatibles OpenAI - Interface \"Try it out\" interactive - Spec source : https://whisper.srv759970.hstgr.cloud/openapi.json</p> <p>Endpoints principaux : - <code>POST /v1/audio/transcriptions</code> - Transcription audio - <code>POST /v1/audio/translations</code> - Traduction audio - <code>GET /v1/models</code> - Liste des mod\u00e8les - <code>GET /health</code> - Health check</p>"},{"location":"05-advanced/api-portal/#tika-api","title":"Tika API","text":"<p>Description : API de parsing de documents (1000+ formats) - Spec OpenAPI 3.0 cr\u00e9\u00e9e sp\u00e9cifiquement - PDF, Office, images avec OCR, archives - Apache Tika 3.2.3 - Spec source : https://portal.srv759970.hstgr.cloud/api/specs/tika.yaml</p> <p>Endpoints principaux : - <code>PUT /tika</code> - Parser un document (extraire texte) - <code>PUT /meta</code> - Extraire m\u00e9tadonn\u00e9es - <code>PUT /detect/stream</code> - D\u00e9tecter type MIME - <code>GET /version</code> - Version Tika - <code>GET /parsers</code> - Liste des parsers disponibles - <code>GET /mime-types</code> - Types MIME support\u00e9s</p>"},{"location":"05-advanced/api-portal/#ollama-api","title":"Ollama API","text":"<p>Description : API LLM local (Llama, Mistral, Qwen) - Spec OpenAPI 3.0 communautaire - Inf\u00e9rence locale - Chat, g\u00e9n\u00e9ration, embeddings - Spec source : https://portal.srv759970.hstgr.cloud/api/specs/ollama.yaml</p> <p>Endpoints principaux : - <code>POST /api/generate</code> - G\u00e9n\u00e9ration de texte - <code>POST /api/chat</code> - Chat conversation - <code>GET /api/tags</code> - Liste des mod\u00e8les locaux - <code>POST /api/pull</code> - T\u00e9l\u00e9charger un mod\u00e8le - <code>POST /api/embeddings</code> - G\u00e9n\u00e9rer embeddings</p>"},{"location":"05-advanced/api-portal/#monitoring-administration","title":"\ud83d\udd27 Monitoring &amp; Administration","text":""},{"location":"05-advanced/api-portal/#portainer","title":"Portainer","text":"<p>URL : https://portal.srv759970.hstgr.cloud/monitoring/portainer</p> <p>Description : Interface web de gestion Docker - Gestion des containers, images, volumes, networks - Cr\u00e9ation et d\u00e9ploiement de stacks Docker Compose - Monitoring des ressources - Logs des containers - Console interactive</p> <p>Port direct : http://69.62.108.82:9000</p>"},{"location":"05-advanced/api-portal/#dozzle","title":"Dozzle","text":"<p>URL : https://portal.srv759970.hstgr.cloud/monitoring/dozzle</p> <p>Description : Visualiseur de logs Docker temps r\u00e9el - Monitoring live des logs containers - L\u00e9ger (ne stocke pas les logs) - Interface simple et rapide - Recherche dans les logs - Multi-container viewing</p> <p>Port direct : http://69.62.108.82:8888</p>"},{"location":"05-advanced/api-portal/#netdata","title":"Netdata","text":"<p>URL : https://portal.srv759970.hstgr.cloud/monitoring/netdata</p> <p>Description : Monitoring syst\u00e8me temps r\u00e9el - CPU, RAM, Disk I/O, Network - M\u00e9triques par process - Alertes configurables - Graphiques interactifs - Historique des performances</p> <p>Port direct : http://69.62.108.82:19999</p>"},{"location":"05-advanced/api-portal/#architecture-technique","title":"\ud83d\udee0\ufe0f Architecture technique","text":""},{"location":"05-advanced/api-portal/#stack-docker","title":"Stack Docker","text":"<pre><code>/opt/api-portal/\n\u251c\u2500\u2500 docker-compose.yml      # Config Swagger UI\n\u251c\u2500\u2500 index.html              # Page d'accueil du portail\n\u2514\u2500\u2500 openapi-specs/\n    \u251c\u2500\u2500 tika.yaml          # Spec OpenAPI Tika\n    \u2514\u2500\u2500 ollama.yaml        # Spec OpenAPI Ollama\n</code></pre> <p>Container Swagger UI : - Image : <code>swaggerapi/swagger-ui:latest</code> - Port : 8503 - Volume : <code>./openapi-specs</code> mont\u00e9 en lecture seule - Environment variables :   - <code>BASE_URL=/api</code> - Configure Swagger UI pour fonctionner derri\u00e8re reverse proxy   - <code>URLS=[...]</code> - Liste des specs OpenAPI \u00e0 charger (Tika, Ollama, Whisper)</p>"},{"location":"05-advanced/api-portal/#configuration-nginx","title":"Configuration Nginx","text":"<p>Fichier : <code>/etc/nginx/sites-available/portal</code></p> <p>Routes configur\u00e9es : - <code>/</code> \u2192 Page d'accueil statique (<code>/opt/api-portal/index.html</code>) - <code>/api</code> \u2192 Swagger UI (port 8503)   - Note : Pas de trailing slash pour \u00e9viter les probl\u00e8mes de routing   - Header <code>X-Forwarded-Prefix: /api</code> pour la compatibilit\u00e9 - <code>/monitoring/portainer/</code> \u2192 Portainer (port 9000) - <code>/monitoring/dozzle/</code> \u2192 Dozzle (port 8888) - <code>/monitoring/netdata/</code> \u2192 Netdata (port 19999)</p> <p>SSL : Certificat Let's Encrypt d\u00e9di\u00e9 - Certificat : <code>/etc/letsencrypt/live/portal.srv759970.hstgr.cloud/</code> - Renouvellement automatique</p>"},{"location":"05-advanced/api-portal/#fichiers-openapi-crees","title":"\ud83d\udcca Fichiers OpenAPI cr\u00e9\u00e9s","text":""},{"location":"05-advanced/api-portal/#tika-openapi-spec","title":"Tika OpenAPI Spec","text":"<p>Fichier : <code>/opt/api-portal/openapi-specs/tika.yaml</code></p> <p>D\u00e9crit tous les endpoints Tika avec : - Param\u00e8tres de requ\u00eate - Types de contenu accept\u00e9s/retourn\u00e9s - Exemples de r\u00e9ponses - Tags et descriptions</p> <p>Bas\u00e9 sur : - Documentation officielle Apache Tika - Wiki TikaJAXRS - Analyse des endpoints natifs</p>"},{"location":"05-advanced/api-portal/#ollama-openapi-spec","title":"Ollama OpenAPI Spec","text":"<p>Fichier : <code>/opt/api-portal/openapi-specs/ollama.yaml</code></p> <p>Spec communautaire compl\u00e8te avec : - Endpoints de g\u00e9n\u00e9ration et chat - Gestion des mod\u00e8les - Embeddings - Exemples pour chaque endpoint</p> <p>Bas\u00e9 sur : - Documentation officielle Ollama - Spec communautaire GitHub</p>"},{"location":"05-advanced/api-portal/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":""},{"location":"05-advanced/api-portal/#acces-https","title":"Acc\u00e8s HTTPS","text":"<p>Tous les services sont accessibles via HTTPS uniquement : - \u2705 Certificat SSL Let's Encrypt - \u2705 Redirection HTTP \u2192 HTTPS automatique - \u2705 Headers X-Forwarded correctement configur\u00e9s</p>"},{"location":"05-advanced/api-portal/#authentification","title":"Authentification","text":"<p>Status actuel : - \u26a0\ufe0f Portail public (pas d'auth) - \u26a0\ufe0f Swagger UI public - \u2705 Portainer : N\u00e9cessite login/password</p> <p>Recommandation : Ajouter authentification Basic Auth Nginx si exposition publique prolong\u00e9e.</p>"},{"location":"05-advanced/api-portal/#utilisation","title":"\ud83d\ude80 Utilisation","text":""},{"location":"05-advanced/api-portal/#tester-une-api-depuis-swagger-ui","title":"Tester une API depuis Swagger UI","text":"<ol> <li>Aller sur https://portal.srv759970.hstgr.cloud</li> <li>Cliquer sur une carte API (toutes pointent vers <code>/api</code>)</li> <li>L'interface Swagger UI s'ouvre avec les 3 APIs disponibles</li> <li>Choisir l'API dans le menu d\u00e9roulant en haut (Whisper API, Tika API, ou Ollama API)</li> <li>S\u00e9lectionner un endpoint dans la liste</li> <li>Cliquer sur \"Try it out\"</li> <li>Remplir les param\u00e8tres</li> <li>Cliquer sur \"Execute\"</li> <li>Voir la r\u00e9ponse en dessous</li> </ol> <p>Note : Les 3 cartes API sur la page d'accueil pointent vers la m\u00eame URL (<code>/api</code>) car Swagger UI pr\u00e9sente toutes les APIs dans une seule interface avec un s\u00e9lecteur.</p>"},{"location":"05-advanced/api-portal/#exemple-parser-un-pdf-avec-tika-via-swagger","title":"Exemple : Parser un PDF avec Tika via Swagger","text":"<ol> <li>Aller sur https://portal.srv759970.hstgr.cloud/api</li> <li>S\u00e9lectionner \"Tika API\" dans le menu d\u00e9roulant en haut</li> <li>S\u00e9lectionner l'endpoint <code>PUT /tika</code></li> <li>Cliquer \"Try it out\"</li> <li>Choisir un fichier PDF</li> <li>S\u00e9lectionner Accept: <code>text/plain</code></li> <li>Cliquer \"Execute\"</li> <li>Le texte extrait s'affiche dans la r\u00e9ponse</li> </ol>"},{"location":"05-advanced/api-portal/#gerer-un-container-avec-portainer","title":"G\u00e9rer un container avec Portainer","text":"<ol> <li>Aller sur <code>/monitoring/portainer</code></li> <li>Se connecter (si premi\u00e8re fois, cr\u00e9er admin)</li> <li>Cliquer sur \"Containers\"</li> <li>S\u00e9lectionner un container</li> <li>Actions disponibles : Start, Stop, Restart, Logs, Stats, Console</li> </ol>"},{"location":"05-advanced/api-portal/#voir-les-logs-en-temps-reel-avec-dozzle","title":"Voir les logs en temps r\u00e9el avec Dozzle","text":"<ol> <li>Aller sur <code>/monitoring/dozzle</code></li> <li>La liste des containers s'affiche</li> <li>Cliquer sur un container pour voir ses logs</li> <li>Recherche disponible dans la barre en haut</li> <li>Auto-scroll pour suivre les nouveaux logs</li> </ol>"},{"location":"05-advanced/api-portal/#gestion-du-portail","title":"\ud83d\udd27 Gestion du portail","text":""},{"location":"05-advanced/api-portal/#voir-les-logs-du-portail","title":"Voir les logs du portail","text":"<pre><code>ssh root@69.62.108.82 \"tail -f /var/log/nginx/portal-access.log\"\nssh root@69.62.108.82 \"tail -f /var/log/nginx/portal-error.log\"\n</code></pre>"},{"location":"05-advanced/api-portal/#redemarrer-swagger-ui","title":"Red\u00e9marrer Swagger UI","text":"<pre><code>ssh root@69.62.108.82 \"cd /opt/api-portal &amp;&amp; docker-compose restart\"\n</code></pre>"},{"location":"05-advanced/api-portal/#mettre-a-jour-une-spec-openapi","title":"Mettre \u00e0 jour une spec OpenAPI","text":"<pre><code># \u00c9diter le fichier\nssh root@69.62.108.82 \"nano /opt/api-portal/openapi-specs/tika.yaml\"\n\n# Pas besoin de red\u00e9marrer, Swagger UI recharge automatiquement\n</code></pre>"},{"location":"05-advanced/api-portal/#ajouter-une-nouvelle-api-au-portail","title":"Ajouter une nouvelle API au portail","text":"<ol> <li> <p>Cr\u00e9er le fichier OpenAPI : <pre><code>ssh root@69.62.108.82 \"nano /opt/api-portal/openapi-specs/nouvelle-api.yaml\"\n</code></pre></p> </li> <li> <p>Mettre \u00e0 jour docker-compose.yml : <pre><code>environment:\n  - URLS=[\n      {\"url\":\"specs/tika.yaml\",\"name\":\"Tika API\"},\n      {\"url\":\"specs/ollama.yaml\",\"name\":\"Ollama API\"},\n      {\"url\":\"specs/nouvelle-api.yaml\",\"name\":\"Nouvelle API\"}\n    ]\n</code></pre></p> </li> <li> <p>Red\u00e9marrer : <pre><code>ssh root@69.62.108.82 \"cd /opt/api-portal &amp;&amp; docker-compose up -d\"\n</code></pre></p> </li> <li> <p>Mettre \u00e0 jour index.html avec la nouvelle carte</p> </li> </ol>"},{"location":"05-advanced/api-portal/#statistiques-dutilisation","title":"\ud83d\udcca Statistiques d'utilisation","text":""},{"location":"05-advanced/api-portal/#verifier-les-acces-au-portail","title":"V\u00e9rifier les acc\u00e8s au portail","text":"<pre><code># Nombre de visiteurs aujourd'hui\nssh root@69.62.108.82 \"grep $(date +%d/%b/%Y) /var/log/nginx/portal-access.log | wc -l\"\n\n# Top 10 des endpoints les plus utilis\u00e9s\nssh root@69.62.108.82 \"awk '{print \\$7}' /var/log/nginx/portal-access.log | sort | uniq -c | sort -rn | head -10\"\n\n# Top IPs\nssh root@69.62.108.82 \"awk '{print \\$1}' /var/log/nginx/portal-access.log | sort | uniq -c | sort -rn | head -10\"\n</code></pre>"},{"location":"05-advanced/api-portal/#troubleshooting","title":"\u26a0\ufe0f Troubleshooting","text":""},{"location":"05-advanced/api-portal/#le-portail-ne-saffiche-pas","title":"Le portail ne s'affiche pas","text":"<pre><code># V\u00e9rifier Nginx\nssh root@69.62.108.82 \"systemctl status nginx\"\nssh root@69.62.108.82 \"nginx -t\"\n\n# V\u00e9rifier les logs\nssh root@69.62.108.82 \"tail -50 /var/log/nginx/portal-error.log\"\n</code></pre>"},{"location":"05-advanced/api-portal/#swagger-ui-ne-charge-pas","title":"Swagger UI ne charge pas","text":"<pre><code># V\u00e9rifier le container\nssh root@69.62.108.82 \"docker ps | grep swagger-ui\"\n\n# Voir les logs\nssh root@69.62.108.82 \"docker logs swagger-ui --tail=50\"\n\n# Red\u00e9marrer\nssh root@69.62.108.82 \"cd /opt/api-portal &amp;&amp; docker-compose restart\"\n</code></pre>"},{"location":"05-advanced/api-portal/#un-service-de-monitoring-est-inaccessible","title":"Un service de monitoring est inaccessible","text":"<pre><code># V\u00e9rifier que le container tourne\nssh root@69.62.108.82 \"docker ps | grep -E 'portainer|dozzle|netdata'\"\n\n# Tester l'acc\u00e8s local\nssh root@69.62.108.82 \"curl -I http://localhost:9000\"  # Portainer\nssh root@69.62.108.82 \"curl -I http://localhost:8888\"  # Dozzle\nssh root@69.62.108.82 \"curl -I http://localhost:19999\" # Netdata\n\n# Voir config Nginx\nssh root@69.62.108.82 \"cat /etc/nginx/sites-available/portal\"\n</code></pre>"},{"location":"05-advanced/api-portal/#erreur-404-sur-api-swagger-ui","title":"Erreur 404 sur /api (Swagger UI)","text":"<p>Sympt\u00f4me : Erreur \"404 Not Found\" quand on acc\u00e8de \u00e0 <code>/api/whisper</code>, <code>/api/tika</code>, ou <code>/api/ollama</code></p> <p>Cause : Probl\u00e8me de configuration de BASE_URL dans Swagger UI ou routing Nginx incorrect</p> <p>Solutions :</p> <ol> <li>V\u00e9rifier la configuration docker-compose.yml : <pre><code>ssh root@69.62.108.82 \"cat /opt/api-portal/docker-compose.yml\"\n</code></pre></li> </ol> <p>Doit contenir : <pre><code>environment:\n  - BASE_URL=/api\n  - URLS=[{\\\"url\\\":\\\"specs/tika.yaml\\\",\\\"name\\\":\\\"Tika API\\\"}...]\n</code></pre></p> <ol> <li>V\u00e9rifier la configuration Nginx : <pre><code>ssh root@69.62.108.82 \"cat /etc/nginx/sites-available/portal | grep -A 10 'location /api'\"\n</code></pre></li> </ol> <p>Doit \u00eatre : <pre><code>location /api {  # PAS de trailing slash\n    proxy_pass http://localhost:8503;  # PAS de trailing slash\n    ...\n}\n</code></pre></p> <ol> <li> <p>Red\u00e9marrer les services : <pre><code>ssh root@69.62.108.82 \"cd /opt/api-portal &amp;&amp; docker-compose restart\"\nssh root@69.62.108.82 \"systemctl reload nginx\"\n</code></pre></p> </li> <li> <p>Tester : <pre><code>ssh root@69.62.108.82 \"curl -I https://portal.srv759970.hstgr.cloud/api/\"\nssh root@69.62.108.82 \"curl -I https://portal.srv759970.hstgr.cloud/api/specs/tika.yaml\"\n</code></pre></p> </li> </ol>"},{"location":"05-advanced/api-portal/#whisper-api-cors-error-dans-swagger-ui","title":"Whisper API CORS Error dans Swagger UI","text":"<p>Sympt\u00f4me : \"Failed to load API definition\" avec erreur CORS dans Swagger UI pour Whisper API</p> <p>Cause : Whisper API (whisper.srv759970.hstgr.cloud) ne permet pas les requ\u00eates cross-origin depuis portal.srv759970.hstgr.cloud</p> <p>Solution : Ajouter les headers CORS \u00e0 la configuration Nginx de Whisper</p> <pre><code># \u00c9diter la config Whisper\nssh root@69.62.108.82 \"nano /etc/nginx/sites-available/whisper\"\n</code></pre> <p>Ajouter dans le <code>location /</code> block : <pre><code># CORS headers for Swagger UI access from portal.srv759970.hstgr.cloud\nadd_header 'Access-Control-Allow-Origin' 'https://portal.srv759970.hstgr.cloud' always;\nadd_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS' always;\nadd_header 'Access-Control-Allow-Headers' 'Content-Type, Authorization' always;\n\n# Handle preflight requests\nif ($request_method = 'OPTIONS') {\n    return 204;\n}\n</code></pre></p> <p>Recharger Nginx : <pre><code>ssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre></p>"},{"location":"05-advanced/api-portal/#dozzle-affiche-une-page-blanche","title":"Dozzle affiche une page blanche","text":"<p>Sympt\u00f4me : Page blanche lorsqu'on acc\u00e8de \u00e0 <code>/monitoring/dozzle</code></p> <p>Cause : Dozzle ne sait pas qu'il fonctionne derri\u00e8re un reverse proxy avec un subpath</p> <p>Solution : Recr\u00e9er le container Dozzle avec le param\u00e8tre <code>DOZZLE_BASE</code></p> <pre><code># Arr\u00eater et supprimer le container actuel\nssh root@69.62.108.82 \"docker stop dozzle &amp;&amp; docker rm dozzle\"\n\n# Recr\u00e9er avec base path\nssh root@69.62.108.82 \"docker run -d --name dozzle --restart unless-stopped \\\n  -p 8888:8080 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -e DOZZLE_BASE=/monitoring/dozzle \\\n  amir20/dozzle:latest\"\n</code></pre> <p>Mettre \u00e0 jour la configuration Nginx pour forward le path complet : <pre><code>location /monitoring/dozzle {  # Sans trailing slash\n    proxy_pass http://localhost:8888;  # Sans trailing slash\n    proxy_http_version 1.1;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n}\n</code></pre></p> <p>Recharger Nginx : <pre><code>ssh root@69.62.108.82 \"systemctl reload nginx\"\n</code></pre></p>"},{"location":"05-advanced/api-portal/#portainer-redirige-vers-timeouthtml-avec-404","title":"Portainer redirige vers /timeout.html avec 404","text":"<p>Sympt\u00f4me : Erreur 404 sur <code>/timeout.html</code> lors de l'acc\u00e8s \u00e0 Portainer via <code>/monitoring/portainer/</code></p> <p>Cause : Portainer redirige vers <code>/timeout.html</code> mais Nginx ne transforme pas la redirection en <code>/monitoring/portainer/timeout.html</code></p> <p>Solution : Ajouter <code>proxy_redirect</code> dans la configuration Nginx de Portainer</p> <pre><code>location /monitoring/portainer/ {\n    proxy_pass http://localhost:9000/;\n    proxy_http_version 1.1;\n    proxy_set_header Connection \"\";\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n\n    # Fix Portainer redirects to work with subpath\n    proxy_redirect / /monitoring/portainer/;\n}\n</code></pre> <p>Recharger Nginx : <pre><code>ssh root@69.62.108.82 \"nginx -t &amp;&amp; systemctl reload nginx\"\n</code></pre></p>"},{"location":"05-advanced/api-portal/#checklist-de-deploiement","title":"\ud83d\udcdd Checklist de d\u00e9ploiement","text":"<ul> <li> Container Swagger UI d\u00e9ploy\u00e9 (port 8503) \u2192 Migr\u00e9 vers fichiers statiques</li> <li> Specs OpenAPI cr\u00e9\u00e9es (Tika, Ollama)</li> <li> Page d'accueil HTML cr\u00e9\u00e9e</li> <li> Configuration Nginx cr\u00e9\u00e9e</li> <li> Certificat SSL obtenu</li> <li> Redirection HTTP \u2192 HTTPS configur\u00e9e</li> <li> Routes vers services de monitoring configur\u00e9es</li> <li> Headers CORS configur\u00e9s pour Whisper API</li> <li> Dozzle configur\u00e9 avec DOZZLE_BASE</li> <li> Portainer configur\u00e9 avec proxy_redirect</li> <li> Tests d'acc\u00e8s r\u00e9ussis pour tous les services</li> <li> Documentation cr\u00e9\u00e9e et mise \u00e0 jour</li> </ul>"},{"location":"05-advanced/api-portal/#liens-utiles","title":"\ud83d\udd17 Liens utiles","text":"<ul> <li>Portail : https://portal.srv759970.hstgr.cloud</li> <li>Swagger UI docs : https://swagger.io/tools/swagger-ui/</li> <li>OpenAPI Spec : https://swagger.io/specification/</li> <li>Portainer docs : https://docs.portainer.io/</li> <li>Dozzle docs : https://dozzle.dev/</li> <li>Netdata docs : https://learn.netdata.cloud/</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version : 1.0 Status : \u2705 En production Certificat SSL : Expire le 13 janvier 2026</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/","title":"Analyse: Strat\u00e9gie d'Authentification - OAuth vs Basic Auth","text":"<p>Date: 2025-01-21 Serveur: srv759970.hstgr.cloud Auteur: Analyse technique Status: Recommandation</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#contexte","title":"Contexte","text":"<p>Actuellement, 13 services sur srv759970.hstgr.cloud sont prot\u00e9g\u00e9s par HTTP Basic Authentication via Nginx. Cette analyse \u00e9value l'opportunit\u00e9 de migrer vers OAuth2/OIDC ou d'adopter une approche alternative.</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#inventaire-des-services-proteges","title":"Inventaire des Services Prot\u00e9g\u00e9s","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#services-par-categorie","title":"Services par Cat\u00e9gorie","text":"Cat\u00e9gorie Services Count Web/CMS clemence, cristina, admin.cristina (Strapi), wordpress 4 APIs whisper, tika, ollama 3 Monitoring grafana, dozzle, whisperx-dashboard 3 Portails dashboard, sharepoint, portal 3 TOTAL 13"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#configuration-actuelle","title":"Configuration Actuelle","text":"<p>M\u00e9thode: HTTP Basic Authentication (Nginx) Credentials: - Username: <code>julien</code> - Password: <code>DevAccess2025</code></p> <p>Fichier: <code>/etc/nginx/.htpasswd</code> (APR1 hash) Snippet: <code>/etc/nginx/snippets/basic-auth.conf</code></p> <pre><code>auth_basic \"Restricted Access - srv759970\";\nauth_basic_user_file /etc/nginx/.htpasswd;\n</code></pre>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#comparaison-detaillee","title":"Comparaison D\u00e9taill\u00e9e","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#tableau-comparatif-global","title":"Tableau Comparatif Global","text":"Crit\u00e8re OAuth2/OIDC Basic Auth Gagnant S\u00e9curit\u00e9 Tokens r\u00e9vocables, expiration Credentials statiques \ud83c\udfc6 OAuth2 Granularit\u00e9 Scopes/permissions par service Tout ou rien \ud83c\udfc6 OAuth2 Audit Logs d\u00e9taill\u00e9s par utilisateur Logs basiques \ud83c\udfc6 OAuth2 SSO Single Sign-On entre services Login par service \ud83c\udfc6 OAuth2 UX UI moderne, pas de popup Popup browser basic \ud83c\udfc6 OAuth2 MFA Support\u00e9 nativement Non support\u00e9 \ud83c\udfc6 OAuth2 Session Management R\u00e9vocation instantan\u00e9e Cache browser difficile \u00e0 invalider \ud83c\udfc6 OAuth2 Complexit\u00e9 Configuration complexe 2 lignes nginx \ud83c\udfc6 Basic Auth Maintenance Service additionnel Fichier statique \ud83c\udfc6 Basic Auth Ressources 300-800MB RAM 0MB \ud83c\udfc6 Basic Auth Setup 2-6 heures 5 minutes \ud83c\udfc6 Basic Auth Point de d\u00e9faillance Auth server = SPOF Aucune d\u00e9pendance \ud83c\udfc6 Basic Auth API simple Token management <code>curl -u user:pass</code> \ud83c\udfc6 Basic Auth <p>Score: OAuth2 = 7/13 | Basic Auth = 6/13</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#solutions-oauth2-disponibles","title":"Solutions OAuth2 Disponibles","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#1-authentik-recommande-self-hosted","title":"1. Authentik \u2b50 RECOMMAND\u00c9 (Self-Hosted)","text":"<p>Type: Open-source, self-hosted Ressources: ~300MB RAM, 1 conteneur Docker Protocols: OAuth2, OIDC, SAML, LDAP</p> <p>Avantages: - \u2705 UI moderne et intuitive - \u2705 MFA int\u00e9gr\u00e9 (TOTP, WebAuthn) - \u2705 User/Group management - \u2705 Integration Nginx via oauth2-proxy - \u2705 Monitoring int\u00e9gr\u00e9 - \u2705 Gratuit</p> <p>Inconv\u00e9nients: - \u274c 300MB RAM requis - \u274c Setup 3-4 heures - \u274c Maintenance ~1h/mois - \u274c Point de d\u00e9faillance (SPOF)</p> <p>URL: https://goauthentik.io</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#2-keycloak-self-hosted","title":"2. Keycloak (Self-Hosted)","text":"<p>Type: Open-source, RedHat Ressources: ~500-800MB RAM (Java) Protocols: OAuth2, OIDC, SAML</p> <p>Avantages: - \u2705 Enterprise-grade - \u2705 User federation (LDAP, AD) - \u2705 Fine-grained permissions - \u2705 Gratuit</p> <p>Inconv\u00e9nients: - \u274c Lourd en ressources (600-800MB) - \u274c Setup 4-6 heures - \u274c Complexe pour petit serveur</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#3-oauth2-proxy-external-provider","title":"3. oauth2-proxy + External Provider","text":"<p>Type: Lightweight reverse proxy Ressources: ~20MB RAM Providers: Google, GitHub, Azure AD, Authentik, Keycloak</p> <p>Avantages: - \u2705 Tr\u00e8s l\u00e9ger (20MB) - \u2705 Setup rapide (1-2h) - \u2705 Int\u00e9gration nginx parfaite - \u2705 Gratuit (si provider gratuit)</p> <p>Inconv\u00e9nients: - \u274c D\u00e9pend d'un provider externe - \u274c Limit\u00e9 aux providers support\u00e9s</p> <p>Exemple: GitHub OAuth pour authentification</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#4-cloudflare-access","title":"4. Cloudflare Access \ud83d\udcb0","text":"<p>Type: Managed (SaaS) Ressources: 0 (cloud) Protocols: OIDC, SAML, One-time PIN</p> <p>Avantages: - \u2705 Zero Trust Network Access - \u2705 Pas de maintenance - \u2705 Logs et analytics - \u2705 Setup 30 minutes</p> <p>Inconv\u00e9nients: - \u274c Co\u00fbt: Free (50 users) ou $7/user/month - \u274c Vendor lock-in - \u274c Minimum 30 users en payant = $210/mois</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#5-authelia","title":"5. Authelia","text":"<p>Type: Open-source, self-hosted Ressources: ~50MB RAM Protocols: OAuth2, OIDC</p> <p>Avantages: - \u2705 Tr\u00e8s l\u00e9ger (50MB) - \u2705 MFA (TOTP, U2F, Duo) - \u2705 Rules-based access control - \u2705 Gratuit</p> <p>Inconv\u00e9nients: - \u274c Setup 2-3 heures - \u274c Documentation moins compl\u00e8te qu'Authentik</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#6-auth0-okta","title":"6. Auth0 / Okta \ud83d\udcb0","text":"<p>Type: Managed (SaaS) Co\u00fbt: - Auth0: $23/mois (1,000 active users) - Okta: $2/user/mois (minimum 25 users)</p> <p>Avantages: - \u2705 Enterprise-grade - \u2705 Pas de maintenance</p> <p>Inconv\u00e9nients: - \u274c Co\u00fbt mensuel - \u274c Vendor lock-in</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#comparaison-des-couts","title":"Comparaison des Co\u00fbts","text":"Solution Setup Time Monthly Cost RAM Usage Maintenance/mois Basic Auth (actuel) 0h \u20ac0 0MB 0h Tailscale VPN 0.5h \u20ac0 0MB 0h Authentik 4h \u20ac0 300MB 1h Keycloak 6h \u20ac0 600MB 2h oauth2-proxy + GitHub 2h \u20ac0 20MB 0.5h Authelia 3h \u20ac0 50MB 1h Cloudflare Access 0.5h \u20ac0-210 0MB 0h Auth0 2h \u20ac23 0MB 0h"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#analyse-par-type-de-service","title":"Analyse par Type de Service","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#apis-whisper-tika-ollama","title":"APIs (whisper, tika, ollama)","text":"<p>Usage: Acc\u00e8s programmatique fr\u00e9quent, scripts, int\u00e9grations</p> Solution Score Rationale Basic Auth \u2b50\u2b50\u2b50\u2b50 Simple, fonctionne parfaitement API Keys custom \u2b50\u2b50\u2b50\u2b50\u2b50 Meilleur: r\u00e9vocables, par-client OAuth2 Client Credentials \u2b50\u2b50\u2b50 Overkill pour usage interne <p>Recommandation: Garder Basic Auth ou migrer vers API Keys custom</p> <p>Exemple API Key Implementation: <pre><code># Simple API key validation in FastAPI\n@app.get(\"/transcribe\")\nasync def transcribe(api_key: str = Header(None)):\n    if api_key not in VALID_API_KEYS:\n        raise HTTPException(401, \"Invalid API key\")\n</code></pre></p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#monitoring-grafana-dozzle-whisperx-dashboard","title":"Monitoring (grafana, dozzle, whisperx-dashboard)","text":"<p>Usage: Acc\u00e8s occasionnel via browser, dashboards</p> Solution Score Rationale Basic Auth \u2b50\u2b50\u2b50 Fonctionne mais pas de SSO OAuth2 (Authentik) \u2b50\u2b50\u2b50\u2b50\u2b50 SSO unifi\u00e9, MFA, meilleure UX Tailscale VPN \u2b50\u2b50\u2b50\u2b50\u2b50 S\u00e9curit\u00e9 maximale, pas de config app Cloudflare Access \u2b50\u2b50\u2b50\u2b50 Simple mais co\u00fbt potentiel <p>Recommandation: Tailscale VPN (meilleur rapport s\u00e9curit\u00e9/simplicit\u00e9)</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#webcms-clemence-cristina-wordpress-strapi","title":"Web/CMS (clemence, cristina, wordpress, strapi)","text":"<p>Usage: Sites client, administration CMS</p> Solution Score Rationale Basic Auth \u2b50\u2b50\u2b50\u2b50 Parfait pour staging/dev Application Auth native \u2b50\u2b50\u2b50\u2b50\u2b50 WordPress/Strapi ont d\u00e9j\u00e0 leur auth OAuth2 \u2b50\u2b50\u2b50 Utile seulement si SSO requis <p>Recommandation: - Sites en production: Retirer Basic Auth, utiliser auth native - Sites en staging/dev: Garder Basic Auth</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#portails-dashboard-sharepoint-portal","title":"Portails (dashboard, sharepoint, portal)","text":"<p>Usage: Acc\u00e8s admin fr\u00e9quent, gestion</p> Solution Score Rationale Basic Auth \u2b50\u2b50 UX m\u00e9diocre, pas de MFA OAuth2 (Authentik) \u2b50\u2b50\u2b50\u2b50\u2b50 SSO, MFA, audit Tailscale VPN \u2b50\u2b50\u2b50\u2b50\u2b50 Network-level, tr\u00e8s s\u00e9curis\u00e9 <p>Recommandation: Tailscale VPN + optionnel Authentik OAuth2</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#recommandation-finale-strategie-hybride","title":"Recommandation Finale: Strat\u00e9gie Hybride","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#architecture-recommandee-defense-in-depth","title":"\ud83c\udfc6 Architecture Recommand\u00e9e (Defense in Depth)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NIVEAU 1: Tailscale VPN (Network Layer)                    \u2502\n\u2502 \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550  \u2502\n\u2502 Services: grafana, dozzle, whisperx-dashboard,             \u2502\n\u2502           portal, dashboard, sharepoint                     \u2502\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502 Avantages:                                                  \u2502\n\u2502 \u2705 S\u00e9curit\u00e9 maximale (Zero Trust Network)                  \u2502\n\u2502 \u2705 Setup: 30 minutes                                        \u2502\n\u2502 \u2705 Co\u00fbt: Gratuit (20 devices)                              \u2502\n\u2502 \u2705 Maintenance: 0h/mois                                     \u2502\n\u2502 \u2705 MFA via Tailscale app                                    \u2502\n\u2502 \u2705 Pas de modification des services                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NIVEAU 2: Auth Native / Basic Auth (Application Layer)     \u2502\n\u2502 \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550  \u2502\n\u2502 WordPress/Strapi: Utiliser leur syst\u00e8me d'auth int\u00e9gr\u00e9     \u2502\n\u2502 APIs: Garder Basic Auth ou migrer vers API Keys            \u2502\n\u2502 Sites staging: Garder Basic Auth nginx                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NIVEAU 3 (Optionnel): Authentik OAuth2                     \u2502\n\u2502 \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550  \u2502\n\u2502 SEULEMENT si besoin de:                                     \u2502\n\u2502 - SSO unifi\u00e9 entre tous les services                        \u2502\n\u2502 - Acc\u00e8s externe aux dashboards (hors VPN)                  \u2502\n\u2502 - Audit logging avanc\u00e9                                      \u2502\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502 Setup: 3-4h | Co\u00fbt: \u20ac0 | RAM: 300MB | Maintenance: 1h/mois \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#plan-de-migration-recommande","title":"Plan de Migration Recommand\u00e9","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#phase-1-tailscale-vpn-priorite-haute","title":"\u2705 Phase 1: Tailscale VPN (PRIORIT\u00c9 HAUTE)","text":"<p>Objectif: S\u00e9curiser tous les dashboards/portails via VPN</p> <p>Services concern\u00e9s: - monitoring.srv759970.hstgr.cloud (Grafana) - dozzle.srv759970.hstgr.cloud - whisperx-dashboard.srv759970.hstgr.cloud - portal.srv759970.hstgr.cloud - dashboard.srv759970.hstgr.cloud - sharepoint.srv759970.hstgr.cloud</p> <p>Actions: 1. Installer Tailscale sur srv759970 2. Configurer Nginx pour \u00e9couter sur Tailscale IP uniquement 3. Retirer Basic Auth nginx sur ces services 4. Ajouter appareils autoris\u00e9s au r\u00e9seau Tailscale</p> <p>Effort: 30-60 minutes Impact: 6 services retir\u00e9s de l'internet public S\u00e9curit\u00e9: \u2b06\ufe0f\u2b06\ufe0f (VPN &gt;&gt; Basic Auth)</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#phase-2-cleanup-auth-native-priorite-moyenne","title":"\u26a1 Phase 2: Cleanup Auth Native (PRIORIT\u00c9 MOYENNE)","text":"<p>Objectif: Utiliser l'auth native des CMS</p> <p>Services concern\u00e9s: - wordpress.srv759970.hstgr.cloud - admin.cristina.srv759970.hstgr.cloud (Strapi)</p> <p>Actions: 1. Retirer <code>include snippets/basic-auth.conf;</code> de nginx 2. S'appuyer sur WordPress login / Strapi admin login 3. Optionnel: Configurer MFA dans WordPress/Strapi</p> <p>Effort: 15 minutes Impact: UX am\u00e9lior\u00e9e, moins de double-auth</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#phase-3-api-keys-pour-apis-priorite-basse","title":"\ud83d\udd11 Phase 3: API Keys pour APIs (PRIORIT\u00c9 BASSE)","text":"<p>Objectif: Remplacer Basic Auth par API Keys custom</p> <p>Services concern\u00e9s: - whisper.srv759970.hstgr.cloud - tika.srv759970.hstgr.cloud - ollama.srv759970.hstgr.cloud</p> <p>Actions: 1. Impl\u00e9menter validation API Key dans FastAPI 2. G\u00e9n\u00e9rer keys par client/projet 3. Stockage dans Redis ou fichier JSON 4. Endpoint <code>/api/keys</code> pour gestion</p> <p>Effort: 2-3 heures Impact: R\u00e9vocation par client, meilleur audit</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#phase-4-optionnelle-authentik-oauth2","title":"\ud83c\udfab Phase 4 (Optionnelle): Authentik OAuth2","text":"<p>Objectif: SSO unifi\u00e9 si besoin d'acc\u00e8s externe</p> <p>Quand l'utiliser: - \u274c NON recommand\u00e9 si Phase 1 (Tailscale) suffit - \u2705 Recommand\u00e9 si besoin d'acc\u00e8s externe aux dashboards - \u2705 Recommand\u00e9 si \u00e9quipe &gt; 5 personnes - \u2705 Recommand\u00e9 si audit compliance requis</p> <p>Setup: 1. Docker Compose Authentik 2. Configuration oauth2-proxy 3. Nginx integration 4. User/Group setup</p> <p>Effort: 3-4 heures</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#matrice-de-decision","title":"Matrice de D\u00e9cision","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#criteres-de-choix","title":"Crit\u00e8res de Choix","text":"Besoin Solution Recommand\u00e9e Justification S\u00e9curit\u00e9 maximale Tailscale VPN Network-level, Zero Trust Simplicit\u00e9 Basic Auth 2 lignes nginx, 0 maintenance SSO entre services Authentik OAuth2 Standard OIDC Acc\u00e8s API API Keys ou Basic Auth Simple, r\u00e9vocable Budget \u20ac0 Tailscale + Authentik 100% gratuit, self-hosted Pas de maintenance Tailscale ou Cloudflare Set &amp; forget Audit compliance Authentik ou Keycloak Logs d\u00e9taill\u00e9s \u00c9quipe &gt; 10 Keycloak Enterprise-grade"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#impact-serveur","title":"Impact Serveur","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#configuration-actuelle_1","title":"Configuration Actuelle","text":"<p>Ressources utilis\u00e9es: - RAM: 0MB (Basic Auth = nginx natif) - Maintenance: 0h/mois - Complexit\u00e9: Minimale</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#avec-tailscale-recommande","title":"Avec Tailscale (Recommand\u00e9)","text":"<p>Ressources utilis\u00e9es: - RAM: ~30MB (Tailscale daemon) - Maintenance: 0h/mois - Complexit\u00e9: Minimale - Gain s\u00e9curit\u00e9: \u2b06\ufe0f\u2b06\ufe0f</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#avec-authentik","title":"Avec Authentik","text":"<p>Ressources utilis\u00e9es: - RAM: ~300MB (Authentik + PostgreSQL + Redis) - Maintenance: 1h/mois - Complexit\u00e9: Moyenne - Gain fonctionnel: SSO, MFA, audit</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#avec-keycloak","title":"Avec Keycloak","text":"<p>Ressources utilis\u00e9es: - RAM: ~600-800MB (Java) - Maintenance: 2h/mois - Complexit\u00e9: \u00c9lev\u00e9e - Gain fonctionnel: Enterprise features</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#tableau-de-synthese-final","title":"Tableau de Synth\u00e8se Final","text":"Crit\u00e8re Basic Auth Tailscale Authentik Keycloak Cloudflare S\u00e9curit\u00e9 \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Simplicit\u00e9 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 \u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 Co\u00fbt \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50 Maintenance \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 \u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Fonctionnalit\u00e9s \u2b50\u2b50 \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 UX \u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 TOTAL 17/30 26/30 25/30 22/30 24/30"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#conclusion","title":"Conclusion","text":""},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#recommandation-officielle-pour-srv759970hstgrcloud","title":"\u2705 Recommandation Officielle pour srv759970.hstgr.cloud","text":"<p>NE PAS migrer vers OAuth2 complet. Adopter une approche hybride progressive:</p> <ol> <li>Court terme (semaine 1): D\u00e9ployer Tailscale VPN</li> <li>Retire 6 services de l'internet public</li> <li> <p>Co\u00fbt: \u20ac0, Setup: 30 min, S\u00e9curit\u00e9: ++</p> </li> <li> <p>Court terme (semaine 1): Cleanup auth native</p> </li> <li>WordPress, Strapi: retirer Basic Auth nginx</li> <li> <p>Utiliser leur syst\u00e8me int\u00e9gr\u00e9</p> </li> <li> <p>Moyen terme (mois 1): API Keys custom</p> </li> <li>whisper, tika, ollama</li> <li> <p>Meilleure gestion que Basic Auth</p> </li> <li> <p>Long terme (optionnel): Authentik OAuth2</p> </li> <li>Seulement si besoin SSO ou acc\u00e8s externe</li> <li>\u00c9valuer apr\u00e8s d\u00e9ploiement Tailscale</li> </ol>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#resultat-final","title":"R\u00e9sultat Final","text":"M\u00e9trique Avant Apr\u00e8s (Tailscale) \u0394 S\u00e9curit\u00e9 Basic Auth (\u2157) VPN (5/5) \u2b06\ufe0f\u2b06\ufe0f Complexit\u00e9 Minimale Minimale \u27a1\ufe0f Co\u00fbt \u20ac0 \u20ac0 \u27a1\ufe0f UX Popup basic Transparent \u2b06\ufe0f Maintenance 0h/mois 0h/mois \u27a1\ufe0f Services publics 13 7 \u2b07\ufe0f\u2b07\ufe0f <p>Verdict: Tailscale VPN offre le meilleur ROI (Return On Investment) en termes de s\u00e9curit\u00e9, sans augmenter la complexit\u00e9 ni les co\u00fbts.</p>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#prochaines-etapes","title":"Prochaines \u00c9tapes","text":"<ol> <li>Valider cette analyse avec l'\u00e9quipe</li> <li>Planifier la migration Tailscale (1 semaine)</li> <li>Documenter la proc\u00e9dure de setup</li> <li>Tester l'acc\u00e8s via VPN avant de retirer Basic Auth</li> <li>Monitorer les acc\u00e8s post-migration</li> </ol>"},{"location":"05-advanced/auth-strategy-oauth-vs-basic/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Infrastructure &gt; Security - S\u00e9curit\u00e9 actuelle</li> <li>Guide &gt; Basic Auth - Configuration actuelle</li> <li>Reference &gt; Basic Auth Setup - Technique</li> <li>Tailscale Documentation - VPN setup</li> <li>Authentik Documentation - OAuth2 setup</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: 2025-01-21 Prochaine r\u00e9vision: Apr\u00e8s d\u00e9ploiement Phase 1 (Tailscale)</p>"},{"location":"05-advanced/devops-best-practices/","title":"\ud83d\udd04 Bonnes Pratiques Dev/Prod - Gestion des Versions et Environnements","text":"<p>Guide complet pour g\u00e9rer proprement les environnements de d\u00e9veloppement, staging et production, et toujours savoir quelle version tourne o\u00f9.</p>"},{"location":"05-advanced/devops-best-practices/#table-des-matieres","title":"\ud83d\udccc Table des mati\u00e8res","text":"<ol> <li>Le Probl\u00e8me</li> <li>Solutions Progressives</li> <li>Architecture Recommand\u00e9e</li> <li>Exemples Concrets</li> <li>Scripts Automatis\u00e9s</li> <li>Checklist de D\u00e9ploiement</li> </ol>"},{"location":"05-advanced/devops-best-practices/#le-probleme","title":"\u2753 Le Probl\u00e8me","text":"<p>Lorsque vous d\u00e9veloppez une application et la d\u00e9ployez sur un serveur, vous vous posez rapidement ces questions :</p> <ul> <li>Quelle version tourne en production ?</li> <li>Est-ce que mon local est synchronis\u00e9 avec la prod ?</li> <li>Quand ai-je fait ce d\u00e9ploiement ?</li> <li>Quelles fonctionnalit\u00e9s sont en dev mais pas encore en prod ?</li> <li>Comment revenir \u00e0 une version stable en cas de probl\u00e8me ?</li> </ul> <p>Sans syst\u00e8me de gestion des versions, c'est le chaos : bugs myst\u00e9rieux, d\u00e9ploiements hasardeux, impossibilit\u00e9 de rollback...</p>"},{"location":"05-advanced/devops-best-practices/#solutions-progressives","title":"\ud83c\udfaf Solutions Progressives","text":""},{"location":"05-advanced/devops-best-practices/#niveau-1-git-commits-minimum-vital","title":"Niveau 1 : Git Commits (Minimum vital)","text":"<p>Ce que c'est : Chaque modification du code est enregistr\u00e9e avec un identifiant unique (hash).</p> <p>Exemple : <pre><code>git commit -m \"feat: Dashboard avec CSS Elyse Energy\"\n# Cr\u00e9e un commit avec hash: 764c119\n</code></pre></p> <p>Savoir quelle version est en prod : <pre><code># Local\ngit log -1 --oneline\n# 764c119 feat: Dashboard avec CSS Elyse Energy\n\n# Production\nssh root@69.62.108.82 \"cd /opt/support-dashboard &amp;&amp; git log -1 --oneline\"\n# 764c119 feat: Dashboard avec CSS Elyse Energy\n</code></pre></p> <p>\u2705 Avantages : Simple, gratuit, d\u00e9j\u00e0 en place \u274c Inconv\u00e9nients : Hash illisible, pas de notion de version \"stable\"</p>"},{"location":"05-advanced/devops-best-practices/#niveau-2-git-tags-recommande","title":"Niveau 2 : Git Tags (Recommand\u00e9)","text":"<p>Ce que c'est : Des \"\u00e9tiquettes\" lisibles pour marquer les versions importantes.</p> <p>Exemple : <pre><code># Apr\u00e8s un d\u00e9ploiement r\u00e9ussi\ngit tag -a v1.0.0 -m \"Version initiale du dashboard\"\ngit push origin v1.0.0\n\n# Lister tous les tags\ngit tag\n# v1.0.0\n# v1.0.1\n# v1.1.0\n\n# Voir le dernier tag\ngit describe --tags\n# v1.1.0\n</code></pre></p> <p>Convention de nommage (Semantic Versioning) : <pre><code>vMAJEUR.MINEUR.PATCH\n\nv1.0.0 \u2192 v1.0.1  (patch : bugfix)\nv1.0.1 \u2192 v1.1.0  (mineur : nouvelle fonctionnalit\u00e9)\nv1.1.0 \u2192 v2.0.0  (majeur : changement incompatible)\n</code></pre></p> <p>D\u00e9ployer une version sp\u00e9cifique : <pre><code># Checkout sur un tag\ngit checkout v1.0.0\n\n# D\u00e9ployer cette version pr\u00e9cise\nscripts/deploy_prod.bat\n</code></pre></p> <p>\u2705 Avantages : Lisible, permet de revenir facilement \u00e0 une version \u274c Inconv\u00e9nients : N\u00e9cessite de penser \u00e0 cr\u00e9er les tags</p>"},{"location":"05-advanced/devops-best-practices/#niveau-3-fichier-version-simple-et-efficace","title":"Niveau 3 : Fichier VERSION (Simple et efficace)","text":"<p>Ce que c'est : Un fichier texte contenant la version courante.</p> <p>Cr\u00e9er le fichier : <pre><code># \u00c0 la racine du projet\necho \"1.0.0\" &gt; VERSION.txt\ngit add VERSION.txt\ngit commit -m \"chore: Add VERSION file\"\n</code></pre></p> <p>L'afficher dans l'application :</p> <pre><code># dashboard/app.py (Streamlit)\nwith open('VERSION.txt') as f:\n    VERSION = f.read().strip()\n\nst.caption(f\"Dashboard v{VERSION} - Derni\u00e8re mise \u00e0 jour: {datetime.now()}\")\n</code></pre> <pre><code># app.py (Flask)\nwith open('VERSION.txt') as f:\n    VERSION = f.read().strip()\n\n@app.route('/version')\ndef version():\n    return {'version': VERSION, 'commit': get_git_hash()}\n</code></pre> <p>Comparer local vs prod : <pre><code># Local\ncat VERSION.txt\n# 1.0.0\n\n# Production\nssh root@69.62.108.82 \"docker exec support-dashboard cat /app/VERSION.txt\"\n# 1.0.0\n</code></pre></p> <p>Workflow de mise \u00e0 jour : <pre><code># 1. Modifier le code\n# 2. Incr\u00e9menter la version\necho \"1.0.1\" &gt; VERSION.txt\n\n# 3. Commit\ngit add .\ngit commit -m \"fix: Correction timezone\"\n\n# 4. Tag\ngit tag -a v1.0.1 -m \"Hotfix timezone\"\n\n# 5. D\u00e9ployer\nscripts/deploy_prod.bat\n</code></pre></p> <p>\u2705 Avantages : Visible dans l'app, facile \u00e0 automatiser \u274c Inconv\u00e9nients : Faut penser \u00e0 le mettre \u00e0 jour</p>"},{"location":"05-advanced/devops-best-practices/#niveau-4-branches-git-professionnel","title":"Niveau 4 : Branches Git (Professionnel)","text":"<p>Structure recommand\u00e9e : <pre><code>master (ou main)     \u2192 Production (toujours stable)\n\u251c\u2500\u2500 develop          \u2192 D\u00e9veloppement (features en cours)\n\u251c\u2500\u2500 staging          \u2192 Pr\u00e9-production (tests avant deploy)\n\u251c\u2500\u2500 feature/xyz      \u2192 Nouvelles fonctionnalit\u00e9s\n\u2514\u2500\u2500 hotfix/bug-123   \u2192 Correctifs urgents\n</code></pre></p> <p>Workflow Git Flow :</p> <pre><code># 1. D\u00e9velopper une nouvelle feature\ngit checkout -b feature/nouveaux-kpis develop\n\n# ... coder ...\n\ngit commit -m \"feat: Ajout KPIs temps r\u00e9el\"\n\n# 2. Merger dans develop\ngit checkout develop\ngit merge feature/nouveaux-kpis\n\n# 3. Tester en local\nstreamlit run dashboard/app.py\n\n# 4. Cr\u00e9er une release candidate\ngit checkout -b release/1.1.0 develop\necho \"1.1.0\" &gt; VERSION.txt\ngit commit -m \"chore: Bump version to 1.1.0\"\n\n# 5. Merger dans master\ngit checkout master\ngit merge release/1.1.0\ngit tag -a v1.1.0 -m \"Release 1.1.0: Nouveaux KPIs\"\n\n# 6. D\u00e9ployer en prod\nscripts/deploy_prod.bat\n\n# 7. Merger master dans develop\ngit checkout develop\ngit merge master\n</code></pre> <p>Hotfix urgent en prod : <pre><code># 1. Partir de master\ngit checkout -b hotfix/timezone-bug master\n\n# 2. Corriger\n# ... fix ...\necho \"1.0.1\" &gt; VERSION.txt\ngit commit -m \"fix: Correction timezone\"\n\n# 3. Merger dans master ET develop\ngit checkout master\ngit merge hotfix/timezone-bug\ngit tag -a v1.0.1 -m \"Hotfix: timezone\"\n\ngit checkout develop\ngit merge hotfix/timezone-bug\n\n# 4. D\u00e9ployer\nscripts/deploy_prod.bat\n</code></pre></p> <p>\u2705 Avantages : Isolation des features, prod toujours stable \u274c Inconv\u00e9nients : Plus complexe, n\u00e9cessite discipline</p>"},{"location":"05-advanced/devops-best-practices/#niveau-5-variables-denvironnement-distinguer-devprod","title":"Niveau 5 : Variables d'Environnement (Distinguer Dev/Prod)","text":"<p>Ce que c'est : Configurer l'application diff\u00e9remment selon l'environnement.</p> <p>Dans le code : <pre><code># dashboard/app.py\nimport os\n\nENV = os.getenv('ENVIRONMENT', 'development')\nVERSION = open('VERSION.txt').read().strip()\n\n# Configuration selon environnement\nif ENV == 'production':\n    st.set_page_config(\n        page_title=\"[PROD] Dashboard Support IT\",\n        page_icon=\"\ud83d\ude80\"\n    )\n    DEBUG = False\n    DATABASE_PATH = '/app/data/tickets.db'\nelse:\n    st.set_page_config(\n        page_title=\"[DEV] Dashboard Support IT\",\n        page_icon=\"\ud83d\udee0\ufe0f\"\n    )\n    DEBUG = True\n    DATABASE_PATH = 'data/tickets.db'\n\n# Afficher dans le footer\nst.caption(f\"Env: {ENV} | Version: {VERSION}\")\n</code></pre></p> <p>Dans docker-compose.yml : <pre><code>version: '3.8'\n\nservices:\n  dashboard:\n    build: .\n    container_name: support-dashboard\n    ports:\n      - \"8501:8501\"\n    volumes:\n      - ./data/tickets.db:/app/data/tickets.db\n    restart: unless-stopped\n    environment:\n      - ENVIRONMENT=production\n      - VERSION=1.0.0\n      - DEPLOYED_AT=2025-10-10T08:45:00Z\n      - TZ=Europe/Paris\n</code></pre></p> <p>Fichier .env (local) : <pre><code># .env\nENVIRONMENT=development\nDEBUG=true\nDATABASE_PATH=data/tickets.db\n</code></pre></p> <p>Fichier .env.prod (production) : <pre><code># .env.prod\nENVIRONMENT=production\nDEBUG=false\nDATABASE_PATH=/app/data/tickets.db\n</code></pre></p> <p>\u2705 Avantages : Configuration centralis\u00e9e, facile \u00e0 changer \u274c Inconv\u00e9nients : Attention \u00e0 ne pas committer les secrets</p>"},{"location":"05-advanced/devops-best-practices/#niveau-6-page-de-status-monitoring","title":"Niveau 6 : Page de Status (Monitoring)","text":"<p>Cr\u00e9er une page d\u00e9di\u00e9e :</p> <pre><code># dashboard/pages/status.py\nimport streamlit as st\nimport subprocess\nimport os\nfrom datetime import datetime\n\nst.title(\"\ud83d\udcca System Status &amp; Version Info\")\n\n# Version\ncol1, col2, col3 = st.columns(3)\n\nwith col1:\n    st.subheader(\"\ud83d\udce6 Version\")\n\n    # Lire VERSION.txt\n    with open('../VERSION.txt') as f:\n        version = f.read().strip()\n    st.metric(\"Version\", version)\n\n    # Git commit\n    try:\n        git_hash = subprocess.check_output(\n            ['git', 'rev-parse', '--short', 'HEAD']\n        ).decode().strip()\n        st.metric(\"Git Commit\", git_hash)\n    except:\n        st.metric(\"Git Commit\", \"N/A\")\n\n    # Git branch\n    try:\n        branch = subprocess.check_output(\n            ['git', 'rev-parse', '--abbrev-ref', 'HEAD']\n        ).decode().strip()\n        st.metric(\"Branch\", branch)\n    except:\n        st.metric(\"Branch\", \"N/A\")\n\nwith col2:\n    st.subheader(\"\ud83c\udf0d Environment\")\n\n    env = os.getenv('ENVIRONMENT', 'development')\n    st.metric(\"Environment\", env)\n\n    deployed_at = os.getenv('DEPLOYED_AT', 'N/A')\n    st.metric(\"Deployed At\", deployed_at)\n\n    tz = os.getenv('TZ', 'UTC')\n    st.metric(\"Timezone\", tz)\n\nwith col3:\n    st.subheader(\"\ud83d\udc33 Docker\")\n\n    # Docker image ID\n    try:\n        image_id = subprocess.check_output(\n            ['docker', 'inspect', '--format={{.Image}}', 'support-dashboard']\n        ).decode().strip()[:12]\n        st.metric(\"Image ID\", image_id)\n    except:\n        st.metric(\"Image ID\", \"N/A\")\n\n    # Container uptime\n    try:\n        uptime = subprocess.check_output(\n            ['docker', 'inspect', '--format={{.State.StartedAt}}', 'support-dashboard']\n        ).decode().strip()\n        st.metric(\"Started At\", uptime[:19])\n    except:\n        st.metric(\"Started At\", \"N/A\")\n\n# Changelog\nst.markdown(\"---\")\nst.subheader(\"\ud83d\udcdd Recent Changes\")\n\ntry:\n    changelog = subprocess.check_output(\n        ['git', 'log', '--pretty=format:%h - %s (%cr)', '-10']\n    ).decode()\n    st.code(changelog, language='text')\nexcept:\n    st.info(\"Git log not available\")\n</code></pre> <p>Acc\u00e8s : - Local: <code>http://localhost:8501/status</code> - Prod: <code>http://69.62.108.82:8501/status</code></p>"},{"location":"05-advanced/devops-best-practices/#architecture-recommandee","title":"\ud83c\udfd7\ufe0f Architecture Recommand\u00e9e","text":""},{"location":"05-advanced/devops-best-practices/#structure-de-projet-complete","title":"Structure de Projet Compl\u00e8te","text":"<pre><code>mon-projet/\n\u251c\u2500\u2500 .git/                       # Git repository\n\u251c\u2500\u2500 .gitignore                  # Fichiers \u00e0 ignorer\n\u251c\u2500\u2500 VERSION.txt                 # Version actuelle\n\u251c\u2500\u2500 CHANGELOG.md                # Historique des versions\n\u251c\u2500\u2500 README.md                   # Documentation\n\u251c\u2500\u2500 requirements.txt            # D\u00e9pendances Python\n\u251c\u2500\u2500 Dockerfile                  # Build Docker\n\u251c\u2500\u2500 docker-compose.yml          # Orchestration\n\u251c\u2500\u2500 .env.example                # Template variables d'env\n\u2502\n\u251c\u2500\u2500 dashboard/                  # Code source\n\u2502   \u251c\u2500\u2500 app.py\n\u2502   \u2514\u2500\u2500 pages/\n\u2502       \u2514\u2500\u2500 status.py           # Page de status\n\u2502\n\u251c\u2500\u2500 data/                       # Donn\u00e9es (gitignore)\n\u2502   \u2514\u2500\u2500 tickets.db\n\u2502\n\u251c\u2500\u2500 scripts/                    # Scripts d'automatisation\n\u2502   \u251c\u2500\u2500 deploy_prod.bat         # D\u00e9ploiement production\n\u2502   \u251c\u2500\u2500 deploy_staging.bat      # D\u00e9ploiement staging\n\u2502   \u251c\u2500\u2500 compare_versions.bat    # Compare local vs prod\n\u2502   \u251c\u2500\u2500 bump_version.py         # Incr\u00e9menter version\n\u2502   \u2514\u2500\u2500 rollback.bat            # Revenir \u00e0 version pr\u00e9c\u00e9dente\n\u2502\n\u2514\u2500\u2500 docs/                       # Documentation\n    \u251c\u2500\u2500 DEPLOY.md\n    \u2514\u2500\u2500 CHANGELOG.md\n</code></pre>"},{"location":"05-advanced/devops-best-practices/#exemples-concrets","title":"\ud83c\udf93 Exemples Concrets","text":""},{"location":"05-advanced/devops-best-practices/#exemple-1-dashboard-support-it-streamlit","title":"Exemple 1 : Dashboard Support IT (Streamlit)","text":"<p>Contexte : Application Streamlit d'analyse de tickets support, d\u00e9ploy\u00e9e sur VPS Hostinger.</p> <p>Structure actuelle : <pre><code>2025.10 Analyse tickets support/\n\u251c\u2500\u2500 VERSION.txt                     # \u26a0\ufe0f \u00c0 cr\u00e9er\n\u251c\u2500\u2500 dashboard/\n\u2502   \u2514\u2500\u2500 app.py                      # Avec CSS Elyse Energy\n\u251c\u2500\u2500 data/\n\u2502   \u2514\u2500\u2500 tickets.db                  # BDD SQLite\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 deploy_prod.bat             # \u2705 Existe\n\u2502   \u251c\u2500\u2500 manage_dashboard.bat        # \u2705 Existe\n\u2502   \u251c\u2500\u2500 sync_db_to_prod.bat         # \u2705 Existe\n\u2502   \u2514\u2500\u2500 compare_versions.bat        # \u26a0\ufe0f \u00c0 cr\u00e9er\n\u251c\u2500\u2500 Dockerfile                      # \u2705 Existe\n\u2514\u2500\u2500 docker-compose.yml              # \u2705 Existe\n</code></pre></p> <p>Workflow de mise \u00e0 jour :</p> <pre><code># 1. D\u00e9veloppement local\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_Projets de code\\2025.10 Analyse tickets support\"\n\n# Modifier le code...\n# Tester : streamlit run dashboard/app.py\n\n# 2. V\u00e9rifier les diff\u00e9rences avec prod\nscripts\\compare_versions.bat\n\n# 3. Incr\u00e9menter la version\npython scripts/bump_version.py --patch  # 1.0.0 \u2192 1.0.1\n\n# 4. Commit et tag\ngit add .\ngit commit -m \"fix: Correction filtres temporels\"\ngit tag -a v1.0.1 -m \"Hotfix: filtres temporels\"\n\n# 5. D\u00e9ployer\nscripts\\deploy_prod.bat\n\n# 6. V\u00e9rifier\nscripts\\compare_versions.bat\n# \u2713 Local et Prod sont synchronis\u00e9s (v1.0.1)\n</code></pre> <p>Exemple de VERSION.txt : <pre><code>1.0.1\n</code></pre></p> <p>Affichage dans le dashboard : <pre><code># dashboard/app.py (ajout)\nwith open('VERSION.txt') as f:\n    VERSION = f.read().strip()\n\nENV = os.getenv('ENVIRONMENT', 'development')\n\n# Dans le footer\nst.markdown(\"---\")\nst.caption(f\"Dashboard v{VERSION} | Env: {ENV} | Commit: {get_git_hash()[:7]} | Derni\u00e8re mise \u00e0 jour: {datetime.now().strftime('%d/%m/%Y %H:%M')}\")\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#exemple-2-api-fastapi","title":"Exemple 2 : API FastAPI","text":"<p>Contexte : API REST pour g\u00e9rer des budgets.</p> <p>Structure : <pre><code>api-budgets/\n\u251c\u2500\u2500 VERSION.txt                 # 1.2.0\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 main.py\n\u2502   \u251c\u2500\u2500 routers/\n\u2502   \u2514\u2500\u2500 models/\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 deploy_prod.sh\n\u2502   \u2514\u2500\u2500 compare_versions.sh\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 docker-compose.yml\n</code></pre></p> <p>Endpoint de version : <pre><code># app/main.py\nfrom fastapi import FastAPI\nimport os\nimport subprocess\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root():\n    return {\"message\": \"API Budgets\"}\n\n@app.get(\"/health\")\ndef health_check():\n    \"\"\"Endpoint de sant\u00e9 pour monitoring.\"\"\"\n    with open('VERSION.txt') as f:\n        version = f.read().strip()\n\n    try:\n        git_hash = subprocess.check_output(\n            ['git', 'rev-parse', '--short', 'HEAD']\n        ).decode().strip()\n    except:\n        git_hash = 'N/A'\n\n    return {\n        \"status\": \"ok\",\n        \"version\": version,\n        \"environment\": os.getenv('ENVIRONMENT', 'development'),\n        \"commit\": git_hash\n    }\n</code></pre></p> <p>Test : <pre><code># Local\ncurl http://localhost:8000/health\n# {\"status\":\"ok\",\"version\":\"1.2.0\",\"environment\":\"development\",\"commit\":\"a3f2b1c\"}\n\n# Production\ncurl http://69.62.108.82:8502/health\n# {\"status\":\"ok\",\"version\":\"1.2.0\",\"environment\":\"production\",\"commit\":\"a3f2b1c\"}\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#exemple-3-application-multi-environnements","title":"Exemple 3 : Application Multi-Environnements","text":"<p>Contexte : Application avec dev, staging, et prod.</p> <p>Structure de branches : <pre><code>master       \u2192 Production (v1.2.0)\n\u251c\u2500\u2500 staging  \u2192 Pre-prod (v1.3.0-rc1)\n\u2514\u2500\u2500 develop  \u2192 Dev (v1.3.0-alpha)\n</code></pre></p> <p>docker-compose.yml par environnement :</p> <pre><code># docker-compose.dev.yml\nversion: '3.8'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8501:8501\"\n    environment:\n      - ENVIRONMENT=development\n      - DEBUG=true\n    volumes:\n      - .:/app  # Hot reload\n\n# docker-compose.staging.yml\nversion: '3.8'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8502:8501\"\n    environment:\n      - ENVIRONMENT=staging\n      - DEBUG=true\n    restart: unless-stopped\n\n# docker-compose.prod.yml\nversion: '3.8'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8501:8501\"\n    environment:\n      - ENVIRONMENT=production\n      - DEBUG=false\n    restart: unless-stopped\n    logging:\n      driver: \"json-file\"\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n</code></pre> <p>Scripts de d\u00e9ploiement :</p> <pre><code># scripts/deploy_staging.bat\ndocker-compose -f docker-compose.staging.yml up -d\n\n# scripts/deploy_prod.bat\ndocker-compose -f docker-compose.prod.yml up -d\n</code></pre>"},{"location":"05-advanced/devops-best-practices/#scripts-automatises","title":"\ud83e\udd16 Scripts Automatis\u00e9s","text":""},{"location":"05-advanced/devops-best-practices/#script-1-compare_versionsbat","title":"Script 1 : <code>compare_versions.bat</code>","text":"<p>But : Comparer les versions local vs production.</p> <pre><code>@echo off\nREM ========================================\nREM Compare Local vs Production\nREM ========================================\n\nsetlocal\n\nset VPS_HOST=root@69.62.108.82\nset VPS_PATH=/opt/support-dashboard\nset APP_NAME=support-dashboard\n\necho.\necho ========================================\necho   Comparaison Local vs Production\necho ========================================\necho.\n\nREM Version locale\necho [LOCAL]\necho Version:\ntype VERSION.txt 2&gt;nul || echo \"Pas de VERSION.txt\"\necho.\necho Dernier commit:\ngit log -1 --oneline 2&gt;nul || echo \"Pas de Git\"\necho.\necho Branch:\ngit rev-parse --abbrev-ref HEAD 2&gt;nul || echo \"Pas de Git\"\necho.\n\nREM Version production\necho [PRODUCTION]\necho Version:\nssh %VPS_HOST% \"docker exec %APP_NAME% cat /app/VERSION.txt 2&gt;/dev/null || echo 'Pas de VERSION.txt'\"\necho.\necho Dernier commit:\nssh %VPS_HOST% \"cd %VPS_PATH% &amp;&amp; git log -1 --oneline 2&gt;/dev/null || echo 'Pas de Git'\"\necho.\n\nREM Diff\u00e9rences\necho [DIFFERENCE]\ngit log --oneline HEAD..origin/master 2&gt;nul\nif %errorlevel% equ 0 (\n    echo.\n    echo \u2713 Local et Prod sont synchronises\n) else (\n    echo.\n    echo \u26a0 Vous avez des commits non deployes\n    git log --oneline origin/master..HEAD 2&gt;nul\n)\necho.\n\npause\nexit /b 0\n</code></pre> <p>Utilisation : <pre><code>scripts\\compare_versions.bat\n</code></pre></p> <p>Output : <pre><code>========================================\n  Comparaison Local vs Production\n========================================\n\n[LOCAL]\nVersion:\n1.0.1\n\nDernier commit:\n764c119 feat: Dashboard avec CSS Elyse Energy\n\nBranch:\nmaster\n\n[PRODUCTION]\nVersion:\n1.0.0\n\nDernier commit:\n9054631 feat: Architecture compl\u00e8te\n\n[DIFFERENCE]\n\u26a0 Vous avez des commits non deployes\n764c119 feat: Dashboard avec CSS Elyse Energy\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#script-2-bump_versionpy","title":"Script 2 : <code>bump_version.py</code>","text":"<p>But : Incr\u00e9menter automatiquement la version.</p> <pre><code>#!/usr/bin/env python3\n\"\"\"\nScript pour incr\u00e9menter la version (Semantic Versioning).\n\nUsage:\n    python bump_version.py --major   # 1.0.0 \u2192 2.0.0\n    python bump_version.py --minor   # 1.0.0 \u2192 1.1.0\n    python bump_version.py --patch   # 1.0.0 \u2192 1.0.1\n\"\"\"\n\nimport argparse\nimport re\nfrom pathlib import Path\n\ndef read_version():\n    \"\"\"Lit la version actuelle depuis VERSION.txt\"\"\"\n    version_file = Path('VERSION.txt')\n    if not version_file.exists():\n        return '0.0.0'\n    return version_file.read_text().strip()\n\ndef write_version(version):\n    \"\"\"\u00c9crit la nouvelle version dans VERSION.txt\"\"\"\n    Path('VERSION.txt').write_text(version + '\\n')\n\ndef bump(version, level):\n    \"\"\"Incr\u00e9mente la version selon le niveau (major, minor, patch)\"\"\"\n    major, minor, patch = map(int, version.split('.'))\n\n    if level == 'major':\n        return f\"{major + 1}.0.0\"\n    elif level == 'minor':\n        return f\"{major}.{minor + 1}.0\"\n    elif level == 'patch':\n        return f\"{major}.{minor}.{patch + 1}\"\n    else:\n        raise ValueError(f\"Niveau inconnu: {level}\")\n\ndef main():\n    parser = argparse.ArgumentParser(description='Bump version')\n    group = parser.add_mutually_exclusive_group(required=True)\n    group.add_argument('--major', action='store_true', help='Bump major version')\n    group.add_argument('--minor', action='store_true', help='Bump minor version')\n    group.add_argument('--patch', action='store_true', help='Bump patch version')\n\n    args = parser.parse_args()\n\n    current_version = read_version()\n    print(f\"Version actuelle: {current_version}\")\n\n    if args.major:\n        level = 'major'\n    elif args.minor:\n        level = 'minor'\n    else:\n        level = 'patch'\n\n    new_version = bump(current_version, level)\n    write_version(new_version)\n\n    print(f\"Nouvelle version: {new_version}\")\n    print(f\"\u2713 VERSION.txt mis \u00e0 jour\")\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>Utilisation : <pre><code># Bugfix\npython scripts/bump_version.py --patch\n# Version actuelle: 1.0.0\n# Nouvelle version: 1.0.1\n# \u2713 VERSION.txt mis \u00e0 jour\n\n# Nouvelle feature\npython scripts/bump_version.py --minor\n# Version actuelle: 1.0.1\n# Nouvelle version: 1.1.0\n# \u2713 VERSION.txt mis \u00e0 jour\n\n# Breaking change\npython scripts/bump_version.py --major\n# Version actuelle: 1.1.0\n# Nouvelle version: 2.0.0\n# \u2713 VERSION.txt mis \u00e0 jour\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#script-3-rollbackbat","title":"Script 3 : <code>rollback.bat</code>","text":"<p>But : Revenir \u00e0 la version pr\u00e9c\u00e9dente en production.</p> <pre><code>@echo off\nREM ========================================\nREM Rollback \u00e0 la version pr\u00e9c\u00e9dente\nREM ========================================\n\nsetlocal\n\nset VPS_HOST=root@69.62.108.82\nset VPS_PATH=/opt/support-dashboard\n\necho.\necho ========================================\necho   ROLLBACK VERSION\necho ========================================\necho.\n\nREM Lister les 5 derniers tags\necho Versions disponibles:\ngit tag --sort=-creatordate | head -5\n\necho.\nset /p TAG=\"Choisir la version \u00e0 restaurer (ex: v1.0.0): \"\n\nif \"%TAG%\"==\"\" (\n    echo [!] Aucune version choisie\n    pause\n    exit /b 1\n)\n\nREM V\u00e9rifier que le tag existe\ngit rev-parse %TAG% &gt;nul 2&gt;&amp;1\nif %errorlevel% neq 0 (\n    echo [!] Tag %TAG% introuvable\n    pause\n    exit /b 1\n)\n\necho.\necho [!] ATTENTION: Rollback vers %TAG%\nset /p CONFIRM=\"Confirmer ? (tapez OUI): \"\n\nif /i not \"%CONFIRM%\"==\"OUI\" (\n    echo Rollback annul\u00e9\n    pause\n    exit /b 0\n)\n\necho.\necho [1/5] Checkout sur %TAG%...\ngit checkout %TAG%\necho [+] Checkout OK\n\necho.\necho [2/5] Transfert vers production...\nscp -r * %VPS_HOST%:%VPS_PATH%/\necho [+] Transfert OK\n\necho.\necho [3/5] Rebuild Docker...\nssh %VPS_HOST% \"cd %VPS_PATH% &amp;&amp; docker-compose build --no-cache\"\necho [+] Build OK\n\necho.\necho [4/5] Red\u00e9marrage...\nssh %VPS_HOST% \"cd %VPS_PATH% &amp;&amp; docker-compose down &amp;&amp; docker-compose up -d\"\necho [+] Red\u00e9marrage OK\n\necho.\necho [5/5] V\u00e9rification...\ntimeout /t 5 /nobreak &gt;nul\nssh %VPS_HOST% \"docker logs support-dashboard --tail=10\"\n\necho.\necho ========================================\necho   ROLLBACK TERMINE\necho ========================================\necho.\necho Version en production: %TAG%\necho URL: http://69.62.108.82:8501\necho.\n\npause\nexit /b 0\n</code></pre> <p>Utilisation : <pre><code>scripts\\rollback.bat\n# Versions disponibles:\n# v1.0.1\n# v1.0.0\n# v0.9.5\n#\n# Choisir la version \u00e0 restaurer: v1.0.0\n# [!] ATTENTION: Rollback vers v1.0.0\n# Confirmer ? (tapez OUI): OUI\n#\n# [1/5] Checkout sur v1.0.0...\n# ...\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#checklist-de-deploiement","title":"\u2705 Checklist de D\u00e9ploiement","text":"<p>Avant chaque d\u00e9ploiement, v\u00e9rifiez :</p>"},{"location":"05-advanced/devops-best-practices/#phase-1-preparation","title":"Phase 1 : Pr\u00e9paration","text":"<ul> <li> Code test\u00e9 localement sans erreur</li> <li> Tests unitaires passent (si vous en avez)</li> <li> Pas de <code>print()</code> / <code>console.log()</code> de debug</li> <li> Variables d'environnement mises \u00e0 jour</li> <li> <code>.gitignore</code> \u00e0 jour (pas de secrets commit\u00e9es)</li> <li> <code>requirements.txt</code> / <code>package.json</code> \u00e0 jour</li> </ul>"},{"location":"05-advanced/devops-best-practices/#phase-2-versioning","title":"Phase 2 : Versioning","text":"<ul> <li> <code>VERSION.txt</code> incr\u00e9ment\u00e9 (<code>bump_version.py</code>)</li> <li> Commit cr\u00e9\u00e9 avec message clair</li> <li> Tag Git cr\u00e9\u00e9 (<code>git tag -a v1.x.x</code>)</li> <li> <code>CHANGELOG.md</code> mis \u00e0 jour</li> </ul>"},{"location":"05-advanced/devops-best-practices/#phase-3-comparaison","title":"Phase 3 : Comparaison","text":"<ul> <li> <code>compare_versions.bat</code> ex\u00e9cut\u00e9</li> <li> Diff\u00e9rences local/prod identifi\u00e9es</li> <li> Backup de la version prod actuelle</li> </ul>"},{"location":"05-advanced/devops-best-practices/#phase-4-deploiement","title":"Phase 4 : D\u00e9ploiement","text":"<ul> <li> <code>deploy_prod.bat</code> ex\u00e9cut\u00e9</li> <li> Build Docker r\u00e9ussi</li> <li> Conteneur d\u00e9marr\u00e9 sans erreur</li> <li> Logs v\u00e9rifi\u00e9s (20 derni\u00e8res lignes)</li> <li> Application accessible via URL</li> </ul>"},{"location":"05-advanced/devops-best-practices/#phase-5-verification-post-deploiement","title":"Phase 5 : V\u00e9rification Post-D\u00e9ploiement","text":"<ul> <li> Page d'accueil charge correctement</li> <li> Fonctionnalit\u00e9s critiques test\u00e9es</li> <li> Pas d'erreur dans les logs Docker</li> <li> Pas d'erreur dans les logs Nginx</li> <li> Temps de r\u00e9ponse acceptable</li> <li> Version correcte affich\u00e9e (<code>/status</code>)</li> </ul>"},{"location":"05-advanced/devops-best-practices/#phase-6-documentation","title":"Phase 6 : Documentation","text":"<ul> <li> Version en prod not\u00e9e dans <code>README.md</code></li> <li> Date de d\u00e9ploiement not\u00e9e</li> <li> Utilisateurs pr\u00e9venus (si changements majeurs)</li> <li> Rollback plan pr\u00e9par\u00e9 (juste au cas o\u00f9)</li> </ul>"},{"location":"05-advanced/devops-best-practices/#plan-de-rollback","title":"\ud83d\udea8 Plan de Rollback","text":"<p>En cas de probl\u00e8me apr\u00e8s d\u00e9ploiement :</p>"},{"location":"05-advanced/devops-best-practices/#etape-1-diagnostic-rapide-2-min","title":"\u00c9tape 1 : Diagnostic rapide (2 min)","text":"<pre><code># V\u00e9rifier les logs\nssh root@69.62.108.82 \"docker logs support-dashboard --tail=50\"\n\n# V\u00e9rifier le status du conteneur\nssh root@69.62.108.82 \"docker ps | grep support-dashboard\"\n\n# Tester l'URL\ncurl -I http://69.62.108.82:8501\n</code></pre>"},{"location":"05-advanced/devops-best-practices/#etape-2-decision-1-min","title":"\u00c9tape 2 : D\u00e9cision (1 min)","text":"<p>Si erreur mineure : Correctif rapide <pre><code># Fix rapide\ngit add .\ngit commit -m \"hotfix: Quick fix\"\nscripts\\deploy_prod.bat\n</code></pre></p> <p>Si erreur majeure : Rollback imm\u00e9diat <pre><code>scripts\\rollback.bat\n# Choisir la derni\u00e8re version stable\n</code></pre></p>"},{"location":"05-advanced/devops-best-practices/#etape-3-post-mortem-apres-coup","title":"\u00c9tape 3 : Post-Mortem (apr\u00e8s coup)","text":"<ul> <li>Identifier la cause racine</li> <li>Ajouter des tests pour \u00e9viter la r\u00e9gression</li> <li>Documenter l'incident</li> <li>Am\u00e9liorer le processus de d\u00e9ploiement</li> </ul>"},{"location":"05-advanced/devops-best-practices/#dashboard-de-versions-bonus","title":"\ud83d\udcca Dashboard de Versions (Bonus)","text":"<p>Page Streamlit pour comparer les environnements :</p> <pre><code># dashboard/pages/versions.py\nimport streamlit as st\nimport subprocess\nimport requests\n\nst.title(\"\ud83d\udd04 Version Comparison Dashboard\")\n\ncol1, col2 = st.columns(2)\n\ndef get_version_info(env_name, url):\n    \"\"\"R\u00e9cup\u00e8re les infos de version d'un environnement.\"\"\"\n    try:\n        response = requests.get(f\"{url}/health\", timeout=5)\n        data = response.json()\n        return data\n    except:\n        return {\"status\": \"error\", \"version\": \"N/A\"}\n\nwith col1:\n    st.subheader(\"\ud83c\udfe0 Local (Development)\")\n\n    # Version locale\n    with open('../VERSION.txt') as f:\n        local_version = f.read().strip()\n    st.metric(\"Version\", local_version)\n\n    # Git info\n    try:\n        git_hash = subprocess.check_output(['git', 'rev-parse', '--short', 'HEAD']).decode().strip()\n        st.metric(\"Commit\", git_hash)\n\n        branch = subprocess.check_output(['git', 'rev-parse', '--abbrev-ref', 'HEAD']).decode().strip()\n        st.metric(\"Branch\", branch)\n    except:\n        pass\n\nwith col2:\n    st.subheader(\"\ud83d\ude80 Production\")\n\n    # Version prod\n    prod_info = get_version_info(\"production\", \"http://69.62.108.82:8501\")\n\n    st.metric(\"Version\", prod_info.get('version', 'N/A'))\n    st.metric(\"Commit\", prod_info.get('commit', 'N/A'))\n    st.metric(\"Status\", prod_info.get('status', 'error'))\n\n# Comparaison\nst.markdown(\"---\")\nst.subheader(\"\ud83d\udcca Comparison\")\n\nif local_version == prod_info.get('version'):\n    st.success(\"\u2705 Local et Production sont synchronis\u00e9s\")\nelse:\n    st.warning(f\"\u26a0\ufe0f Versions diff\u00e9rentes: {local_version} (local) vs {prod_info.get('version')} (prod)\")\n\n    # Afficher les commits non d\u00e9ploy\u00e9s\n    try:\n        commits = subprocess.check_output(\n            ['git', 'log', '--oneline', '--no-merges', f\"v{prod_info.get('version')}..HEAD\"]\n        ).decode()\n\n        if commits:\n            st.markdown(\"**Commits non d\u00e9ploy\u00e9s:**\")\n            st.code(commits, language='text')\n    except:\n        pass\n</code></pre>"},{"location":"05-advanced/devops-best-practices/#ressources-utiles","title":"\ud83d\udcda Ressources Utiles","text":""},{"location":"05-advanced/devops-best-practices/#documentation","title":"Documentation","text":"<ul> <li>Semantic Versioning : https://semver.org/</li> <li>Git Flow : https://nvie.com/posts/a-successful-git-branching-model/</li> <li>Conventional Commits : https://www.conventionalcommits.org/</li> <li>Docker Best Practices : https://docs.docker.com/develop/dev-best-practices/</li> </ul>"},{"location":"05-advanced/devops-best-practices/#outils","title":"Outils","text":"<ul> <li>bump2version : Automatiser l'incr\u00e9mentation de version</li> <li>commitizen : Standardiser les messages de commit</li> <li>semantic-release : Automatiser releases et changelogs</li> <li>Sentry : Monitoring d'erreurs en production</li> </ul>"},{"location":"05-advanced/devops-best-practices/#recapitulatif","title":"\ud83c\udfaf R\u00e9capitulatif","text":"Niveau Solution Complexit\u00e9 B\u00e9n\u00e9fice 1 Git Commits \u2b50 Facile Historique basique 2 Git Tags \u2b50\u2b50 Facile Versions lisibles 3 Fichier VERSION \u2b50\u2b50 Facile Visible dans l'app 4 Branches Git \u2b50\u2b50\u2b50 Moyen Isolation features 5 Variables Env \u2b50\u2b50 Facile Config par env 6 Page Status \u2b50\u2b50\u2b50 Moyen Monitoring visuel <p>Recommandation minimale : Niveau 1 + 2 + 3 (Commits + Tags + VERSION.txt) Recommandation professionnelle : Tous les niveaux</p>"},{"location":"05-advanced/devops-best-practices/#workflow-recommande-quick-start","title":"\ud83e\udd1d Workflow Recommand\u00e9 (Quick Start)","text":"<pre><code># 1. Cr\u00e9er VERSION.txt (une seule fois)\necho \"1.0.0\" &gt; VERSION.txt\ngit add VERSION.txt\ngit commit -m \"chore: Add VERSION file\"\n\n# 2. D\u00e9velopper\n# ... coder ...\n\n# 3. Avant de d\u00e9ployer\npython scripts/bump_version.py --patch    # Incr\u00e9menter version\ngit add .\ngit commit -m \"fix: Correction bug XYZ\"\ngit tag -a v1.0.1 -m \"Hotfix: bug XYZ\"\n\n# 4. Comparer\nscripts\\compare_versions.bat\n\n# 5. D\u00e9ployer\nscripts\\deploy_prod.bat\n\n# 6. V\u00e9rifier\nscripts\\compare_versions.bat\n# \u2713 Local et Prod synchronis\u00e9s\n</code></pre> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Version du guide : 1.0 Exemples bas\u00e9s sur : Dashboard Support IT (Streamlit)</p> <p>Prochaines \u00e9tapes recommand\u00e9es : 1. Cr\u00e9er <code>VERSION.txt</code> dans vos projets 2. Cr\u00e9er <code>scripts/compare_versions.bat</code> 3. Cr\u00e9er <code>scripts/bump_version.py</code> 4. Ajouter page <code>/status</code> dans vos apps 5. Documenter votre workflow dans <code>README.md</code></p>"},{"location":"05-advanced/git-policy/","title":"Politique Git pour srv759970","text":"<p>Strat\u00e9gie de versioning et gestion du code pour l'ensemble du serveur VPS.</p>"},{"location":"05-advanced/git-policy/#philosophie-generale","title":"Philosophie g\u00e9n\u00e9rale","text":"<p>Principe : Version control UNIQUEMENT pour la configuration et l'infrastructure, PAS pour les contenus utilisateurs.</p>"},{"location":"05-advanced/git-policy/#ce-qui-doit-etre-versionne","title":"Ce qui DOIT \u00eatre versionn\u00e9 \u2705","text":"<ul> <li>Configuration syst\u00e8me (<code>/etc/nginx/</code>, <code>/etc/systemd/</code>, configs serveur)</li> <li>Scripts d'infrastructure (<code>/opt/docker-autostart/</code>, scripts de d\u00e9ploiement)</li> <li>Code source des applications custom</li> <li>Fichiers docker-compose.yml et Dockerfiles</li> <li>Documentation locale (ce repository)</li> </ul>"},{"location":"05-advanced/git-policy/#ce-qui-ne-doit-pas-etre-versionne","title":"Ce qui NE DOIT PAS \u00eatre versionn\u00e9 \u274c","text":"<ul> <li>Bases de donn\u00e9es (<code>*.sql</code>, <code>/var/lib/mysql/</code>)</li> <li>Uploads WordPress (<code>wp-content/uploads/</code>)</li> <li>Caches et fichiers temporaires</li> <li>Secrets et credentials (<code>.env</code>, tokens, passwords)</li> <li>Fichiers volumineux (images, vid\u00e9os, backups)</li> <li>Contenus cr\u00e9\u00e9s par les utilisateurs finaux</li> </ul>"},{"location":"05-advanced/git-policy/#architecture-des-repositories","title":"Architecture des repositories","text":""},{"location":"05-advanced/git-policy/#repository-1-documentation-locale-existant","title":"Repository 1 : Documentation locale (existant)","text":"<p>Emplacement : <code>C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_r\u00e9f\u00e9rentiels de code\\Hostinger\\</code></p> <p>Contenu : - \u2705 Tous les GUIDE_*.md - \u2705 README.md, INSTRUCTIONS_LLM.md - \u2705 Scripts batch (deploy.bat, update.bat, manage.bat) - \u2705 Documentation Sablier (r\u00e9f\u00e9rence) - \u2705 portal-index.html (backup local)</p> <p>Synchro : Manuel (OneDrive + backup vers serveur si besoin)</p> <p>Git : <pre><code># D\u00e9j\u00e0 configur\u00e9\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_r\u00e9f\u00e9rentiels de code\\Hostinger\"\ngit status\n</code></pre></p>"},{"location":"05-advanced/git-policy/#repository-2-configuration-serveur-a-creer","title":"Repository 2 : Configuration serveur (\u00e0 cr\u00e9er)","text":"<p>Emplacement serveur : <code>/root/server-config/</code></p> <p>Contenu : <pre><code>/root/server-config/\n\u251c\u2500\u2500 nginx/\n\u2502   \u251c\u2500\u2500 sites-available/\n\u2502   \u2502   \u251c\u2500\u2500 portal\n\u2502   \u2502   \u251c\u2500\u2500 whisper-faster\n\u2502   \u2502   \u251c\u2500\u2500 whisperx\n\u2502   \u2502   \u251c\u2500\u2500 tika\n\u2502   \u2502   \u251c\u2500\u2500 dashboard\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 snippets/\n\u2502       \u2514\u2500\u2500 basic-auth.conf\n\u251c\u2500\u2500 systemd/\n\u2502   \u2514\u2500\u2500 docker-autostart.service\n\u251c\u2500\u2500 docker-autostart/\n\u2502   \u251c\u2500\u2500 server.js\n\u2502   \u251c\u2500\u2500 config.json\n\u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2514\u2500\u2500 themes/\n\u2502       \u251c\u2500\u2500 hacker-terminal.html\n\u2502       \u251c\u2500\u2500 ghost.html\n\u2502       \u251c\u2500\u2500 matrix.html\n\u2502       \u2514\u2500\u2500 shuffle.html\n\u251c\u2500\u2500 scripts/\n\u2502   \u2514\u2500\u2500 (utilitaires serveur)\n\u2514\u2500\u2500 README.md\n</code></pre></p> <p>Initialisation : <pre><code>ssh root@69.62.108.82\n\n# Cr\u00e9er repository\nmkdir -p /root/server-config\ncd /root/server-config\n\n# Init git\ngit init\ngit config user.name \"Julien Fernandez\"\ngit config user.email \"julien.fernandez.work@gmail.com\"\n\n# Cr\u00e9er structure\nmkdir -p nginx/sites-available nginx/snippets systemd scripts\n\n# Copier configs actuelles\ncp /etc/nginx/sites-available/portal nginx/sites-available/\ncp /etc/nginx/sites-available/whisper-faster nginx/sites-available/\ncp /etc/nginx/sites-available/whisperx nginx/sites-available/\ncp /etc/nginx/sites-available/tika nginx/sites-available/\n# ... autres sites\n\ncp /etc/nginx/snippets/basic-auth.conf nginx/snippets/\ncp /etc/systemd/system/docker-autostart.service systemd/\n\n# Copier docker-autostart (SANS node_modules)\ncp -r /opt/docker-autostart/ ./\nrm -rf docker-autostart/node_modules\n\n# Cr\u00e9er .gitignore\ncat &gt; .gitignore &lt;&lt; 'EOF'\nnode_modules/\n*.log\n.env\n*.backup\n*.swp\nEOF\n\n# Premier commit\ngit add .\ngit commit -m \"Initial commit: server configuration snapshot\n\n- Nginx configs for all services\n- Docker auto-start system\n- Systemd service files\"\n</code></pre></p>"},{"location":"05-advanced/git-policy/#repository-3-applications-custom-optionnel","title":"Repository 3 : Applications custom (optionnel)","text":"<p>Services concern\u00e9s : - <code>/opt/whisperx/</code> (WhisperX custom build) - <code>/opt/api-portal/</code> (Portal HTML)</p> <p>Si besoin de versioning par app : <pre><code># Exemple pour whisperx\ncd /opt/whisperx\ngit init\ngit add Dockerfile server.py docker-compose.yml\ngit commit -m \"Initial WhisperX service\"\n</code></pre></p>"},{"location":"05-advanced/git-policy/#strategie-de-branches","title":"Strat\u00e9gie de branches","text":""},{"location":"05-advanced/git-policy/#pour-la-documentation-locale","title":"Pour la documentation locale","text":"<p>main : Documentation \u00e0 jour, valid\u00e9e dev : Modifications en cours (optionnel si solo)</p>"},{"location":"05-advanced/git-policy/#pour-la-configuration-serveur","title":"Pour la configuration serveur","text":"<p>main : Configuration stable en production backup-YYYY-MM-DD : Snapshots avant changements majeurs</p> <pre><code># Avant changement majeur\ngit checkout -b backup-2025-10-18\ngit checkout main\n</code></pre>"},{"location":"05-advanced/git-policy/#workflow-de-modification","title":"Workflow de modification","text":""},{"location":"05-advanced/git-policy/#1-modification-dune-config-nginx","title":"1. Modification d'une config Nginx","text":"<pre><code># 1. \u00c9diter sur le serveur\nnano /etc/nginx/sites-available/whisperx\n\n# 2. Tester\nnginx -t\n\n# 3. Appliquer\nsystemctl reload nginx\n\n# 4. Mettre \u00e0 jour le repo\ncd /root/server-config\ncp /etc/nginx/sites-available/whisperx nginx/sites-available/\ngit add nginx/sites-available/whisperx\ngit commit -m \"Update whisperx nginx config: increase upload limit to 1GB\"\n</code></pre>"},{"location":"05-advanced/git-policy/#2-modification-du-systeme-auto-start","title":"2. Modification du syst\u00e8me auto-start","text":"<pre><code># 1. \u00c9diter\nnano /opt/docker-autostart/config.json\n\n# 2. Restart service\nsystemctl restart docker-autostart\n\n# 3. V\u00e9rifier logs\njournalctl -u docker-autostart -n 20\n\n# 4. Si OK, commit\ncd /root/server-config\ncp /opt/docker-autostart/config.json docker-autostart/\ngit add docker-autostart/config.json\ngit commit -m \"Add new service to auto-start: example-app\"\n</code></pre>"},{"location":"05-advanced/git-policy/#3-mise-a-jour-documentation-locale","title":"3. Mise \u00e0 jour documentation locale","text":"<pre><code># Depuis Windows\ncd \"C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_r\u00e9f\u00e9rentiels de code\\Hostinger\"\n\n# Modifier docs\nnotepad GUIDE_WHISPER_SERVICES.md\n\n# Commit\ngit add GUIDE_WHISPER_SERVICES.md\ngit commit -m \"Add WhisperX deployment guide\"\ngit push\n</code></pre>"},{"location":"05-advanced/git-policy/#backups-vs-git","title":"Backups vs Git","text":""},{"location":"05-advanced/git-policy/#git-pour","title":"Git pour : \u2705","text":"<ul> <li>Versions du code : Historique des modifications, rollback facile</li> <li>Configuration : Fichiers texte &lt;100KB</li> <li>Collaboration : Partage avec autres devs (futur)</li> <li>Documentation : Guides, README, instructions</li> </ul>"},{"location":"05-advanced/git-policy/#backups-traditionnels-pour","title":"Backups traditionnels pour : \ud83d\udcbe","text":"<ul> <li>Bases de donn\u00e9es : Dumps SQL automatiques (cron)</li> <li>Uploads : Fichiers volumineux (rsync, Duplicati, AWS S3)</li> <li>Secrets : Vaults (Bitwarden, 1Password), PAS dans Git</li> <li>State complet : Snapshots VPS Hostinger</li> </ul>"},{"location":"05-advanced/git-policy/#commandes-utiles","title":"Commandes utiles","text":""},{"location":"05-advanced/git-policy/#documentation-locale","title":"Documentation locale","text":"<pre><code># Statut\ngit status\n\n# Voir historique\ngit log --oneline\n\n# Comparer changements\ngit diff\n\n# Annuler changements non commit\u00e9s\ngit checkout -- GUIDE_DEPLOIEMENT_VPS.md\n\n# Revenir \u00e0 un commit pr\u00e9c\u00e9dent (DANGEREUX)\ngit revert &lt;commit-hash&gt;\n</code></pre>"},{"location":"05-advanced/git-policy/#configuration-serveur","title":"Configuration serveur","text":"<pre><code># Snapshot avant changement majeur\ncd /root/server-config\ngit checkout -b backup-$(date +%Y-%m-%d)\ngit checkout main\n\n# Comparer avec version en production\ndiff /etc/nginx/sites-available/portal nginx/sites-available/portal\n\n# Restaurer une config depuis git\ncp nginx/sites-available/portal /etc/nginx/sites-available/\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"05-advanced/git-policy/#politique-de-secrets","title":"Politique de secrets","text":""},{"location":"05-advanced/git-policy/#jamais-dans-git","title":"\u274c JAMAIS dans Git","text":"<ul> <li>Passwords (<code>MYSQL_ROOT_PASSWORD</code>, <code>ADMIN_PASSWORD</code>)</li> <li>API keys (HuggingFace <code>HF_TOKEN</code>, OpenAI keys)</li> <li>Basic auth credentials (<code>/etc/nginx/.htpasswd</code>)</li> <li>Certificats SSL priv\u00e9s (<code>/etc/letsencrypt/live/*/*.pem</code>)</li> </ul>"},{"location":"05-advanced/git-policy/#gestion-securisee","title":"\u2705 Gestion s\u00e9curis\u00e9e","text":"<ol> <li> <p>Fichiers .env : Stock\u00e9s uniquement sur le serveur    <pre><code># Exemple /opt/whisperx/.env\nHF_TOKEN=hf_xxxxxxxxxxxxx\n</code></pre></p> </li> <li> <p>Backup chiffr\u00e9 : Si backup des secrets n\u00e9cessaire    <pre><code># Cr\u00e9er archive chiffr\u00e9e\ntar czf - /opt/whisperx/.env | gpg -c &gt; secrets-backup.tar.gz.gpg\n</code></pre></p> </li> <li> <p>Documentation : R\u00e9f\u00e9rencer O\u00d9 sont les secrets, PAS leur valeur    <pre><code># Guide WhisperX\nHF_TOKEN requis dans `/opt/whisperx/.env`\nObtenir le token sur https://huggingface.co/settings/tokens\n</code></pre></p> </li> </ol>"},{"location":"05-advanced/git-policy/#remote-repository-optionnel-futur","title":"Remote repository (optionnel futur)","text":"<p>Si besoin de backup externe ou collaboration :</p>"},{"location":"05-advanced/git-policy/#option-1-github-prive","title":"Option 1 : GitHub priv\u00e9","text":"<pre><code>cd /root/server-config\ngit remote add origin https://github.com/username/srv759970-config.git\ngit push -u origin main\n</code></pre> <p>\u26a0\ufe0f ATTENTION : V\u00e9rifier .gitignore AVANT push initial !</p>"},{"location":"05-advanced/git-policy/#option-2-gitlab-self-hosted","title":"Option 2 : GitLab self-hosted","text":"<p>Plus de contr\u00f4le, h\u00e9berg\u00e9 sur le VPS ou autre serveur.</p>"},{"location":"05-advanced/git-policy/#option-3-pas-de-remote","title":"Option 3 : Pas de remote","text":"<p>Git local uniquement = snapshot versionn\u00e9 sur le serveur. Simple et efficace.</p>"},{"location":"05-advanced/git-policy/#frequence-de-commit","title":"Fr\u00e9quence de commit","text":""},{"location":"05-advanced/git-policy/#configuration-serveur_1","title":"Configuration serveur","text":"<ul> <li>Avant tout changement majeur : Snapshot branch</li> <li>Apr\u00e8s validation : Commit avec message descriptif</li> <li>Minimum : 1 commit/semaine si modifications</li> </ul>"},{"location":"05-advanced/git-policy/#documentation-locale_1","title":"Documentation locale","text":"<ul> <li>Apr\u00e8s cr\u00e9ation guide : Commit imm\u00e9diat</li> <li>Apr\u00e8s mise \u00e0 jour significative : Commit</li> <li>Typos/petites corrections : Batch commits OK</li> </ul>"},{"location":"05-advanced/git-policy/#messages-de-commit","title":"Messages de commit","text":""},{"location":"05-advanced/git-policy/#format-recommande","title":"Format recommand\u00e9","text":"<pre><code>&lt;type&gt;: &lt;description courte&gt;\n\n&lt;d\u00e9tails optionnels&gt;\n</code></pre> <p>Types : - <code>feat:</code> Nouvelle fonctionnalit\u00e9/service - <code>fix:</code> Correction bug/config - <code>docs:</code> Mise \u00e0 jour documentation - <code>config:</code> Changement configuration - <code>refactor:</code> R\u00e9organisation sans changement fonctionnel</p>"},{"location":"05-advanced/git-policy/#exemples","title":"Exemples","text":"<pre><code># Bon \u2705\ngit commit -m \"feat: add WhisperX service with diarization support\n\n- Create /opt/whisperx/ with custom Dockerfile\n- Add whisperx.srv759970.hstgr.cloud nginx config\n- Update docker-autostart config.json with new service\"\n\ngit commit -m \"fix: increase whisperx upload limit to 1GB\n\nclient_max_body_size changed from 500M to 1G in nginx config\"\n\ngit commit -m \"docs: add comprehensive WhisperX deployment guide\"\n\n# Mauvais \u274c\ngit commit -m \"update\"\ngit commit -m \"fix stuff\"\ngit commit -m \"wip\"\n</code></pre>"},{"location":"05-advanced/git-policy/#audit-et-nettoyage","title":"Audit et nettoyage","text":""},{"location":"05-advanced/git-policy/#verifier-taille-repo","title":"V\u00e9rifier taille repo","text":"<pre><code>cd /root/server-config\ndu -sh .git\n</code></pre> <p>Si &gt;100MB \u2192 Probablement fichier binaire/lourd committ\u00e9 par erreur.</p>"},{"location":"05-advanced/git-policy/#nettoyer-historique-dangereux","title":"Nettoyer historique (DANGEREUX)","text":"<pre><code># Supprimer gros fichier de l'historique\ngit filter-branch --tree-filter 'rm -f path/to/large/file' HEAD\n</code></pre> <p>\u26a0\ufe0f Utiliser uniquement en dernier recours !</p>"},{"location":"05-advanced/git-policy/#checklist-deploiement","title":"Checklist d\u00e9ploiement","text":"<p>Avant de commiter une nouvelle configuration :</p> <ul> <li> Test\u00e9 en local/staging si possible</li> <li> Nginx config test\u00e9e (<code>nginx -t</code>)</li> <li> Service red\u00e9marr\u00e9 et logs v\u00e9rifi\u00e9s</li> <li> Aucun secret dans les fichiers</li> <li> .gitignore \u00e0 jour</li> <li> Message de commit descriptif</li> <li> Documentation mise \u00e0 jour si besoin</li> </ul>"},{"location":"05-advanced/git-policy/#liens-utiles","title":"Liens utiles","text":"<ul> <li>Git Basics : https://git-scm.com/book/fr/v2</li> <li>Gitignore templates : https://github.com/github/gitignore</li> <li>Conventional Commits : https://www.conventionalcommits.org/fr/</li> </ul>"},{"location":"05-advanced/git-policy/#etat-actuel","title":"\u00c9tat actuel","text":""},{"location":"05-advanced/git-policy/#documentation-locale_2","title":"Documentation locale \u2705","text":"<ul> <li>Repository : <code>C:\\Users\\JulienFernandez\\OneDrive\\Coding\\_r\u00e9f\u00e9rentiels de code\\Hostinger\\</code></li> <li>Statut : G\u00e9r\u00e9 avec Git</li> <li>Remote : Aucun (OneDrive sync uniquement)</li> <li>Derni\u00e8re mise \u00e0 jour : Octobre 2025</li> </ul>"},{"location":"05-advanced/git-policy/#configuration-serveur_2","title":"Configuration serveur \u23f8\ufe0f","text":"<ul> <li>Repository : \u00c0 cr\u00e9er (<code>/root/server-config/</code>)</li> <li>Statut : Non versionn\u00e9 actuellement</li> <li>Action : Initialiser selon ce guide</li> </ul>"},{"location":"05-advanced/git-policy/#applications-custom","title":"Applications custom \u23f8\ufe0f","text":"<ul> <li>WhisperX : Non versionn\u00e9</li> <li>API Portal : Non versionn\u00e9</li> <li>Docker-autostart : Non versionn\u00e9 ind\u00e9pendamment</li> <li>Action : D\u00e9cider si versioning individuel n\u00e9cessaire</li> </ul>"},{"location":"05-advanced/llm-onboarding/","title":"Guide d'Entr\u00e9e pour LLM - srv759970.hstgr.cloud","text":"<p>Version: 1.0 Derni\u00e8re mise \u00e0 jour: 2025-10-27 Public cible: Assistants IA (Claude, GPT, etc.) d\u00e9couvrant le serveur pour la premi\u00e8re fois</p>"},{"location":"05-advanced/llm-onboarding/#objectif-de-ce-document","title":"\ud83c\udfaf Objectif de ce Document","text":"<p>Ce guide permet \u00e0 un LLM de comprendre rapidement l'infrastructure srv759970, ses services, et de r\u00e9pondre efficacement aux questions de l'administrateur (Julien).</p>"},{"location":"05-advanced/llm-onboarding/#vue-densemble-a-lire-en-premier","title":"\ud83d\udccb Vue d'Ensemble - \u00c0 Lire en Premier","text":""},{"location":"05-advanced/llm-onboarding/#identite-du-serveur","title":"Identit\u00e9 du Serveur","text":"<ul> <li>Nom: srv759970.hstgr.cloud</li> <li>IP: 69.62.108.82</li> <li>H\u00e9bergeur: Hostinger VPS</li> <li>OS: Ubuntu 24.04 LTS</li> <li>Admin: Julien Fernandez (propri\u00e9taire unique)</li> <li>Acc\u00e8s SSH: <code>ssh root@69.62.108.82</code></li> </ul>"},{"location":"05-advanced/llm-onboarding/#type-dinfrastructure","title":"Type d'Infrastructure","text":"<p>Serveur d'applications multi-services h\u00e9bergeant: - 40+ conteneurs Docker - 30+ services web/APIs - Stack compl\u00e8te IA (transcription, TTS, LLM, RAG) - Sites WordPress et applications m\u00e9tier - Infrastructure de monitoring et collaboration</p>"},{"location":"05-advanced/llm-onboarding/#architecture-globale","title":"Architecture Globale","text":"<pre><code>graph TB\n    subgraph Internet\n        Users[Utilisateurs]\n        API_Consumers[D\u00e9veloppeurs API]\n    end\n\n    subgraph \"Nginx Reverse Proxy (Port 443/80)\"\n        Nginx[Nginx + SSL/TLS]\n        BasicAuth[Basic Auth Layer]\n    end\n\n    subgraph \"Docker Autostart System (Port 8890)\"\n        AutoStart[Auto-Start Proxy&lt;br/&gt;22 services]\n    end\n\n    subgraph \"Core Services - Always Running\"\n        Dashy[Dashy Portal :4000]\n        MkDocs[MkDocs Docs :8005]\n        Redis_Queue[Redis Queue :6379]\n        Monitoring[Grafana+Prometheus+Loki]\n    end\n\n    subgraph \"AI Services - Auto-Start\"\n        WhisperX[WhisperX :8002]\n        FasterWhisper[Faster-Whisper Queue :8003]\n        Ollama[Ollama LLM :11434]\n        RAGFlow[RAGFlow :9500]\n        Tika[Tika :9998]\n    end\n\n    subgraph \"Web Services - Auto-Start\"\n        WordPress[WordPress Sites x4]\n        Nextcloud[Nextcloud :8505]\n        Jitsi[Jitsi Meet :8510]\n        RocketChat[Rocket.Chat :3002]\n    end\n\n    subgraph \"Document Management - Auto-Start\"\n        Paperless[Paperless-ngx :8000]\n        PaperlessAI[Paperless AI]\n    end\n\n    Users --&gt; Nginx\n    API_Consumers --&gt; Nginx\n    Nginx --&gt; BasicAuth\n    BasicAuth --&gt; Dashy\n    BasicAuth --&gt; MkDocs\n    BasicAuth --&gt; AutoStart\n\n    AutoStart -.Auto-Wake.-&gt; WhisperX\n    AutoStart -.Auto-Wake.-&gt; FasterWhisper\n    AutoStart -.Auto-Wake.-&gt; WordPress\n    AutoStart -.Auto-Wake.-&gt; Nextcloud\n\n    WhisperX --&gt; Redis_Queue\n    FasterWhisper --&gt; Redis_Queue\n\n    Monitoring --&gt; Redis_Queue\n    Monitoring --&gt; WhisperX\n    Monitoring --&gt; FasterWhisper</code></pre>"},{"location":"05-advanced/llm-onboarding/#concepts-cles-a-comprendre","title":"\ud83d\udd11 Concepts Cl\u00e9s \u00e0 Comprendre","text":""},{"location":"05-advanced/llm-onboarding/#1-systeme-auto-startstop-important","title":"1. Syst\u00e8me Auto-Start/Stop (IMPORTANT!)","text":"<p>Localisation: <code>/opt/docker-autostart/</code> Fonction: \u00c9conomise la RAM en arr\u00eatant les services inactifs apr\u00e8s 15 minutes</p> <p>Services concern\u00e9s: 22 services sur 30+ Port proxy: 8890 M\u00e9canisme: 1. Nginx re\u00e7oit requ\u00eate \u2192 redirige vers port 8890 2. Auto-start proxy d\u00e9tecte service arr\u00eat\u00e9 \u2192 le d\u00e9marre 3. Affiche page de chargement pendant 30-180s 4. Redirige vers service actif 5. Apr\u00e8s 15 min d'inactivit\u00e9 \u2192 arr\u00eate le service</p> <p>Services EXCLUS (toujours actifs): - Dashy (portail principal) - MkDocs (documentation) - Redis Queue (d\u00e9pendance critique) - Nginx (reverse proxy) - Monitoring stack</p>"},{"location":"05-advanced/llm-onboarding/#2-architecture-dauthentification","title":"2. Architecture d'Authentification","text":"<p>M\u00e9thode: HTTP Basic Authentication via Nginx Credentials: <code>julien:DevAccess2025</code> Fichier: <code>/etc/nginx/.htpasswd</code> Snippet: <code>/etc/nginx/snippets/basic-auth.conf</code></p> <p>Pourquoi Basic Auth et pas OAuth? \u2192 Voir Analyse Auth Strategy TL;DR: Simplicit\u00e9 (0MB RAM, 5min setup) vs OAuth (300MB RAM, 4h setup) pour un usage solo</p>"},{"location":"05-advanced/llm-onboarding/#3-organisation-docker","title":"3. Organisation Docker","text":"<p>Principe: 1 service = 1 dossier <code>/opt/&lt;service&gt;/</code> avec <code>docker-compose.yml</code></p> <p>Exemples: - <code>/opt/whisperx/</code> \u2192 WhisperX API - <code>/opt/dashy/</code> \u2192 Dashy portal - <code>/opt/wordpress-clemence/</code> \u2192 Site Cl\u00e9mence</p> <p>Commandes communes: <pre><code>cd /opt/&lt;service&gt;\ndocker-compose up -d      # D\u00e9marrer\ndocker-compose logs -f    # Voir logs\ndocker-compose restart    # Red\u00e9marrer\ndocker-compose down       # Arr\u00eater\n</code></pre></p>"},{"location":"05-advanced/llm-onboarding/#4-stack-de-transcription-ai-core","title":"4. Stack de Transcription (AI Core)","text":"<p>Architecture partag\u00e9e: <pre><code>Redis Partag\u00e9 (rq-queue-redis:6379)\n\u251c\u2500\u2500 DB 0: Queue \"transcription\" (WhisperX)\n\u2514\u2500\u2500 DB 1: Queue \"faster-whisper-transcription\"\n\nWhisperX Worker \u2192 WhisperX API (:8002)\nFaster-Whisper Worker \u2192 Faster-Whisper Queue API (:8003)\n</code></pre></p> <p>Monitoring: - Grafana: https://monitoring.srv759970.hstgr.cloud - RQ Dashboard: https://whisperx-dashboard.srv759970.hstgr.cloud - Prometheus: http://srv759970.hstgr.cloud:9090</p>"},{"location":"05-advanced/llm-onboarding/#structure-de-la-documentation","title":"\ud83d\udcda Structure de la Documentation","text":""},{"location":"05-advanced/llm-onboarding/#navigation-rapide","title":"Navigation Rapide","text":"Section Contenu Quand l'utiliser index.md Vue d'ensemble, liens rapides Point d'entr\u00e9e, d\u00e9couverte Services/ Fiches techniques par service \"Comment utiliser X?\" Infrastructure/ Docker, Nginx, S\u00e9curit\u00e9 \"Comment \u00e7a fonctionne?\" Guides/ Tutoriels d\u00e9ploiement \"Comment faire Y?\" Reference/ Commandes, snippets \"Quelle commande pour Z?\" Changelog/ Historique modifications \"Qu'est-ce qui a chang\u00e9?\" Analysis/ D\u00e9cisions techniques \"Pourquoi ce choix?\""},{"location":"05-advanced/llm-onboarding/#pages-critiques-a-connaitre","title":"Pages Critiques \u00e0 Conna\u00eetre","text":"<ol> <li>SERVER_STATUS.md - \u00c9tat serveur en temps r\u00e9el (auto-g\u00e9n\u00e9r\u00e9)</li> <li>SERVICES_STATUS.md - Statut de tous les services (auto-g\u00e9n\u00e9r\u00e9)</li> <li>EMERGENCY_RUNBOOK.md - Proc\u00e9dures d'urgence</li> <li>guides/getting-started/vps-initial-setup.md - Setup complet du serveur</li> </ol>"},{"location":"05-advanced/llm-onboarding/#services-principaux-reference-rapide","title":"\ud83d\ude80 Services Principaux - R\u00e9f\u00e9rence Rapide","text":""},{"location":"05-advanced/llm-onboarding/#intelligence-artificielle","title":"Intelligence Artificielle","text":"Service URL Port Description Auto-Start WhisperX https://whisperx.srv759970.hstgr.cloud 8002 Transcription + diarization \u2705 Faster-Whisper Queue https://faster-whisper.srv759970.hstgr.cloud 8003 Transcription async avec RQ \u2705 Ollama http://srv759970.hstgr.cloud:11434 11434 Inf\u00e9rence LLM locale \u274c RAGFlow https://ragflow.srv759970.hstgr.cloud 9500 Plateforme RAG compl\u00e8te \u2705 Tika http://srv759970.hstgr.cloud:9998 9998 Parsing documents \u2705 NeuTTS https://neutts-api.srv759970.hstgr.cloud - Synth\u00e8se vocale \u2705"},{"location":"05-advanced/llm-onboarding/#collaboration","title":"Collaboration","text":"Service URL Port Description Auto-Start Nextcloud https://nextcloud.srv759970.hstgr.cloud 8505 Stockage cloud \u2705 Rocket.Chat https://chat.srv759970.hstgr.cloud 3002 Messagerie \u00e9quipe \u2705 Jitsi Meet https://meet.srv759970.hstgr.cloud 8510 Visioconf\u00e9rence \u2705"},{"location":"05-advanced/llm-onboarding/#infrastructure","title":"Infrastructure","text":"Service URL Port Description Auto-Start Dashy https://dashy.srv759970.hstgr.cloud 4000 Portail services \u274c Always ON MkDocs https://docs.srv759970.hstgr.cloud 8005 Documentation \u274c Always ON Grafana https://monitoring.srv759970.hstgr.cloud 3001 Monitoring \u274c Always ON Dozzle https://dozzle.srv759970.hstgr.cloud 8888 Logs Docker \u274c Always ON Portainer https://portainer.srv759970.hstgr.cloud 9000 Gestion Docker \u274c Always ON"},{"location":"05-advanced/llm-onboarding/#patterns-de-questions-frequentes","title":"\ud83d\udd0d Patterns de Questions Fr\u00e9quentes","text":""},{"location":"05-advanced/llm-onboarding/#comment-redemarrer-le-service-x","title":"\"Comment red\u00e9marrer le service X?\"","text":"<pre><code>ssh root@69.62.108.82\ncd /opt/&lt;service-name&gt;\ndocker-compose restart\n</code></pre> <p>Exemples concrets: - WhisperX: <code>cd /opt/whisperx &amp;&amp; docker-compose restart</code> - Dashy: <code>cd /opt/dashy &amp;&amp; docker-compose restart</code> - Nextcloud: <code>cd /opt/nextcloud &amp;&amp; docker-compose restart</code></p>"},{"location":"05-advanced/llm-onboarding/#le-service-x-ne-repond-pas","title":"\"Le service X ne r\u00e9pond pas\"","text":"<p>Checklist de diagnostic: 1. V\u00e9rifier si auto-start (attendre 30-180s de chargement) 2. V\u00e9rifier logs: <code>docker logs &lt;container-name&gt; --tail 50</code> 3. V\u00e9rifier statut: <code>docker ps | grep &lt;service&gt;</code> 4. V\u00e9rifier Nginx: <code>nginx -t &amp;&amp; systemctl status nginx</code> 5. Voir EMERGENCY_RUNBOOK.md</p>"},{"location":"05-advanced/llm-onboarding/#comment-ajouter-un-nouveau-service","title":"\"Comment ajouter un nouveau service?\"","text":"<p>Template standard: 1. Cr\u00e9er <code>/opt/&lt;service&gt;/docker-compose.yml</code> 2. Configurer Nginx dans <code>/etc/nginx/sites-available/&lt;service&gt;</code> 3. Activer: <code>ln -s /etc/nginx/sites-available/&lt;service&gt; /etc/nginx/sites-enabled/</code> 4. Tester: <code>nginx -t</code> 5. Recharger: <code>systemctl reload nginx</code> 6. (Optionnel) Ajouter \u00e0 auto-start dans <code>/opt/docker-autostart/config.json</code></p> <p>\u2192 Voir guides/deployment/ pour d\u00e9tails</p>"},{"location":"05-advanced/llm-onboarding/#quelle-est-la-difference-entre-whisperx-et-faster-whisper-queue","title":"\"Quelle est la diff\u00e9rence entre WhisperX et Faster-Whisper Queue?\"","text":"Crit\u00e8re WhisperX Faster-Whisper Queue Mod\u00e8le large-v2 medium Diarization \u2705 Oui (qui parle quand) \u274c Non Vitesse Plus lent Plus rapide Pr\u00e9cision Meilleure Bonne Use case Transcription pr\u00e9cise avec speakers Transcription rapide simple Queue Redis DB 0 DB 1 <p>\u2192 Voir services/ai/whisperx.md et services/ai/faster-whisper-queue.md</p>"},{"location":"05-advanced/llm-onboarding/#workflow-recommande-pour-un-llm","title":"\ud83c\udf93 Workflow Recommand\u00e9 pour un LLM","text":""},{"location":"05-advanced/llm-onboarding/#premiere-requete-de-lutilisateur","title":"Premi\u00e8re Requ\u00eate de l'Utilisateur","text":"<ol> <li>Lire <code>LLM_ONBOARDING.md</code> (ce fichier) - Vue d'ensemble</li> <li>Lire <code>index.md</code> - \u00c9tat actuel des services</li> <li>Lire <code>SERVER_STATUS.md</code> et <code>SERVICES_STATUS.md</code> - Statut live</li> </ol>"},{"location":"05-advanced/llm-onboarding/#requete-technique-sur-un-service","title":"Requ\u00eate Technique sur un Service","text":"<ol> <li>Lire <code>services/&lt;categorie&gt;/&lt;service&gt;.md</code> - Fiche technique</li> <li>Lire <code>guides/services/&lt;categorie&gt;/&lt;service&gt;-*.md</code> - Guides d\u00e9taill\u00e9s</li> <li>R\u00e9f\u00e9rence <code>reference/docker/commands.md</code> ou <code>reference/nginx/</code> si besoin</li> </ol>"},{"location":"05-advanced/llm-onboarding/#probleme-depannage","title":"Probl\u00e8me / D\u00e9pannage","text":"<ol> <li>Lire <code>EMERGENCY_RUNBOOK.md</code> - Proc\u00e9dures d'urgence</li> <li>Lire <code>guides/infrastructure/nginx-troubleshooting.md</code></li> <li>R\u00e9f\u00e9rence <code>changelog/</code> pour historique r\u00e9cent</li> </ol>"},{"location":"05-advanced/llm-onboarding/#deploiement-modification","title":"D\u00e9ploiement / Modification","text":"<ol> <li>Lire <code>guides/deployment/</code> - Guides de d\u00e9ploiement</li> <li>R\u00e9f\u00e9rence <code>reference/docker/compose-patterns.md</code> - Templates</li> <li>Lire <code>analysis/</code> pour comprendre les choix techniques</li> </ol>"},{"location":"05-advanced/llm-onboarding/#pieges-courants-a-eviter","title":"\u26a0\ufe0f Pi\u00e8ges Courants \u00e0 \u00c9viter","text":""},{"location":"05-advanced/llm-onboarding/#1-ne-pas-confondre-auto-start-et-always-on","title":"1. Ne Pas Confondre Auto-Start et Always-On","text":"<p>Erreur courante: \"Dashy ne r\u00e9pond pas\" \u2192 Sugg\u00e9rer d'attendre le d\u00e9marrage auto-start R\u00e9alit\u00e9: Dashy est ALWAYS-ON, si \u00e7a ne r\u00e9pond pas, c'est un vrai probl\u00e8me</p> <p>Services Always-On (ne jamais dire \"attends le d\u00e9marrage\"): - Dashy, MkDocs, Grafana, Redis Queue, Nginx, Dozzle, Portainer</p> <p>Services Auto-Start (OK de dire \"attends 30-180s\"): - WhisperX, Faster-Whisper, WordPress, Nextcloud, Jitsi, Rocket.Chat, etc.</p>"},{"location":"05-advanced/llm-onboarding/#2-ne-pas-modifier-nginx-sans-tester","title":"2. Ne Pas Modifier Nginx Sans Tester","text":"<p>Toujours inclure ces commandes apr\u00e8s modification Nginx: <pre><code>nginx -t                    # Tester la config\nsystemctl reload nginx      # Recharger si OK\n</code></pre></p>"},{"location":"05-advanced/llm-onboarding/#3-status-checks-de-dashy-desactives","title":"3. Status Checks de Dashy D\u00e9sactiv\u00e9s","text":"<p>Contexte: Dashy avait des status checks qui emp\u00eachaient l'auto-stop Solution: Status checks SUPPRIM\u00c9S (pas d\u00e9sactiv\u00e9s, SUPPRIM\u00c9S) R\u00e9f\u00e9rence: changelog/dashy-autostart-fix-2025-10-24.md</p> <p>Ne JAMAIS sugg\u00e9rer de r\u00e9activer les status checks dans Dashy sans mentionner le conflit auto-stop!</p>"},{"location":"05-advanced/llm-onboarding/#4-redis-queue-partage-ne-pas-redemarrer-a-la-legere","title":"4. Redis Queue Partag\u00e9 - Ne Pas Red\u00e9marrer \u00e0 la L\u00e9g\u00e8re","text":"<p>Important: Redis Queue (<code>rq-queue-redis</code>) est partag\u00e9 par WhisperX ET Faster-Whisper Impact d'un restart: Perte des jobs en cours dans les 2 queues</p> <p>Commande safe pour voir les queues: <pre><code>docker exec -it rq-queue-redis redis-cli\nSELECT 0  # WhisperX\nLLEN transcription\nSELECT 1  # Faster-Whisper\nLLEN faster-whisper-transcription\n</code></pre></p>"},{"location":"05-advanced/llm-onboarding/#metriques-cles-du-serveur","title":"\ud83d\udcca M\u00e9triques Cl\u00e9s du Serveur","text":""},{"location":"05-advanced/llm-onboarding/#ressources","title":"Ressources","text":"<ul> <li>RAM Total: 32GB</li> <li>CPU: 8 vCPUs</li> <li>Disque: 400GB SSD</li> <li>Conteneurs actifs: ~15-25 (varie avec auto-start)</li> <li>Conteneurs total: ~40</li> </ul>"},{"location":"05-advanced/llm-onboarding/#limites-connues","title":"Limites Connues","text":"<ul> <li>Max conteneurs simultan\u00e9s: ~40 (incident Netdata \u00e0 59 conteneurs)</li> <li>RAM critique: &gt;28GB \u2192 Risque OOM</li> <li>Auto-stop timeout: 15 minutes (900s)</li> <li>Auto-start boot time: 30-180s selon service</li> </ul>"},{"location":"05-advanced/llm-onboarding/#liens-utiles-pour-le-llm","title":"\ud83d\udd17 Liens Utiles pour le LLM","text":""},{"location":"05-advanced/llm-onboarding/#dashboards-live","title":"Dashboards Live","text":"<ul> <li>Dashy: https://dashy.srv759970.hstgr.cloud - Vue d'ensemble tous services</li> <li>Grafana: https://monitoring.srv759970.hstgr.cloud - M\u00e9triques &amp; logs</li> <li>Dozzle: https://dozzle.srv759970.hstgr.cloud - Logs Docker temps r\u00e9el</li> </ul>"},{"location":"05-advanced/llm-onboarding/#documentation-externe","title":"Documentation Externe","text":"<ul> <li>Dashy Docs: https://dashy.to/docs</li> <li>MkDocs Material: https://squidfunk.github.io/mkdocs-material/</li> <li>Docker Compose: https://docs.docker.com/compose/</li> <li>Nginx: https://nginx.org/en/docs/</li> </ul>"},{"location":"05-advanced/llm-onboarding/#en-cas-de-doute","title":"\ud83c\udd98 En Cas de Doute","text":"<p>Si tu ne sais pas comment r\u00e9pondre:</p> <ol> <li>Consulter <code>EMERGENCY_RUNBOOK.md</code> pour urgences</li> <li>Chercher dans <code>changelog/</code> pour historique r\u00e9cent</li> <li>Lire <code>analysis/</code> pour comprendre les d\u00e9cisions</li> <li>Proposer de lire les logs: <code>docker logs &lt;service&gt; --tail 100</code></li> <li>Demander \u00e0 Julien de v\u00e9rifier <code>SERVER_STATUS.md</code> (auto-g\u00e9n\u00e9r\u00e9)</li> </ol> <p>Principe: Mieux vaut demander confirmation que donner une mauvaise info sur un serveur de production!</p>"},{"location":"05-advanced/llm-onboarding/#changelog-de-ce-guide","title":"\ud83d\udcdd Changelog de ce Guide","text":"<ul> <li>2025-10-27: Cr\u00e9ation initiale du guide d'onboarding LLM</li> <li>Prochaine r\u00e9vision: Apr\u00e8s premier usage r\u00e9el par un LLM</li> </ul> <p>Bienvenue sur srv759970! \ud83d\ude80</p> <p>Ce guide est maintenu manuellement. Si tu d\u00e9tectes une incoh\u00e9rence avec les autres docs, signale-le \u00e0 Julien.</p>"},{"location":"05-advanced/llm-usage/","title":"\ud83e\udd16 Instructions pour LLM - D\u00e9ploiement VPS Hostinger","text":"<p>Principe DRY : Ce document ne duplique PAS la documentation technique. Il r\u00e9f\u00e9rence les guides appropri\u00e9s et ajoute uniquement les workflows sp\u00e9cifiques aux LLM.</p>"},{"location":"05-advanced/llm-usage/#documentation-disponible","title":"\ud83d\udcda Documentation disponible","text":"Fichier Quand le lire <code>GUIDE_DEPLOIEMENT_VPS.md</code> D\u00e9ploiement d'applications Docker (Streamlit, Flask, React, etc.) <code>GUIDE_SERVICES_SYSTEMD.md</code> D\u00e9ploiement de services systemd (Ollama, PostgreSQL, etc.) <code>../infrastructure/nginx.md</code> Configuration Nginx (sites statiques, reverse proxy, troubleshooting) <code>GUIDE_WORDPRESS_DOCKER.md</code> Migration WordPress vers Docker (PHP-FPM, MySQL, permissions, proxy) <code>GUIDE_ASTRO.md</code> D\u00e9ploiement sites Astro (SSG, build statique, r\u00e9solution 404) <code>GUIDE_STRAPI.md</code> D\u00e9ploiement Strapi CMS (Docker Node 22, bugs Vite, mode production) <code>README.md</code> Vue d'ensemble et scripts disponibles"},{"location":"05-advanced/llm-usage/#workflow-autonome-pour-llm","title":"\ud83c\udfaf Workflow autonome pour LLM","text":""},{"location":"05-advanced/llm-usage/#etape-0-identifier-le-type-de-deploiement","title":"\u00c9tape 0 : Identifier le type de d\u00e9ploiement","text":"<pre><code>Question \u00e0 poser : \"Docker ou service natif ?\"\n\n\u2192 Application web (Streamlit, Flask, React, etc.)\n  \u279c Lire GUIDE_DEPLOIEMENT_VPS.md\n\n\u2192 Service syst\u00e8me (Ollama, base de donn\u00e9es, etc.)\n  \u279c Lire GUIDE_SERVICES_SYSTEMD.md\n\n\u2192 Pas s\u00fbr ?\n  \u279c Demander \u00e0 l'utilisateur\n</code></pre>"},{"location":"05-advanced/llm-usage/#etape-1-verifier-les-prerequis","title":"\u00c9tape 1 : V\u00e9rifier les pr\u00e9requis","text":"<pre><code># TOUJOURS v\u00e9rifier SSH avant de commencer\nssh root@69.62.108.82 \"whoami &amp;&amp; hostname\"\n# Attendu: root\\nsrv759970\n</code></pre> <p>Si \u00e9chec \u2192 Informer l'utilisateur que la cl\u00e9 SSH n'est pas configur\u00e9e.</p>"},{"location":"05-advanced/llm-usage/#etape-2-lire-le-guide-approprie","title":"\u00c9tape 2 : Lire le guide appropri\u00e9","text":"<p>NE PAS dupliquer les instructions du guide. Lire le fichier et suivre les \u00e9tapes exactement.</p>"},{"location":"05-advanced/llm-usage/#etape-3-creer-une-checklist-si-tache-complexe","title":"\u00c9tape 3 : Cr\u00e9er une checklist (si t\u00e2che complexe)","text":"<p>R\u00e8gle : Si la t\u00e2che n\u00e9cessite plus de 3 \u00e9tapes, utiliser l'outil TodoWrite.</p> <p>Exemple : <pre><code>- [ ] V\u00e9rifier connexion SSH\n- [ ] Choisir port disponible\n- [ ] Cr\u00e9er structure /opt/mon-app\n- [ ] Transf\u00e9rer fichiers\n- [ ] Build Docker\n- [ ] V\u00e9rifier logs\n</code></pre></p>"},{"location":"05-advanced/llm-usage/#etape-4-executer-et-verifier","title":"\u00c9tape 4 : Ex\u00e9cuter et v\u00e9rifier","text":"<p>Important : - V\u00e9rifier chaque commande avant l'ex\u00e9cution - Ne JAMAIS deviner les param\u00e8tres manquants - Lire les logs en cas d'erreur</p>"},{"location":"05-advanced/llm-usage/#etape-5-informer-lutilisateur","title":"\u00c9tape 5 : Informer l'utilisateur","text":"<p>Format de rapport : <pre><code>\u2705 D\u00e9ploiement r\u00e9ussi !\n\nApplication : mon-app\nURL : http://69.62.108.82:8502\nStatut : En ligne\n\nCommandes utiles :\n- Logs : ssh root@69.62.108.82 \"docker logs mon-app\"\n- Red\u00e9marrer : ssh root@69.62.108.82 \"docker restart mon-app\"\n</code></pre></p>"},{"location":"05-advanced/llm-usage/#regles-strictes","title":"\ud83d\udea8 R\u00e8gles strictes","text":""},{"location":"05-advanced/llm-usage/#ne-jamais","title":"\u274c NE JAMAIS","text":"<ol> <li>Deviner des valeurs : Si l'utilisateur ne sp\u00e9cifie pas un port, demander</li> <li>Dupliquer la doc : R\u00e9f\u00e9rencer les guides au lieu de recopier</li> <li>Ignorer les erreurs : Toujours lire les logs en cas d'\u00e9chec</li> <li>Modifier sans v\u00e9rifier : Toujours tester avec <code>nginx -t</code>, <code>docker-compose config</code>, etc.</li> <li>Committer des secrets : V\u00e9rifier <code>.env</code>, <code>*.key</code> avant tout transfert</li> </ol>"},{"location":"05-advanced/llm-usage/#toujours","title":"\u2705 TOUJOURS","text":"<ol> <li>V\u00e9rifier SSH en premier</li> <li>Lire le guide appropri\u00e9 (Docker vs systemd)</li> <li>Cr\u00e9er une checklist si &gt;3 \u00e9tapes</li> <li>V\u00e9rifier les logs apr\u00e8s d\u00e9ploiement</li> <li>Donner l'URL finale \u00e0 l'utilisateur</li> </ol>"},{"location":"05-advanced/llm-usage/#decision-rapide-docker-ou-systemd","title":"\ud83d\udd0d D\u00e9cision rapide : Docker ou systemd ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 C'est une application web ?         \u2502\n\u2502 (Streamlit, Flask, React, etc.)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n        OUI \u2502 NON\n            \u2502\n            \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 DOCKER        \u2502      \u2502 Service syst\u00e8me? \u2502\n    \u2502               \u2502      \u2502 (Ollama, DB...)  \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502                       \u2502\n            \u2502                   OUI \u2502 NON\n            \u2502                       \u2502\n            \u25bc                       \u25bc\n    GUIDE_DEPLOIEMENT_VPS    GUIDE_SERVICES_SYSTEMD\n</code></pre>"},{"location":"05-advanced/llm-usage/#templates-de-communication","title":"\ud83d\udccb Templates de communication","text":""},{"location":"05-advanced/llm-usage/#demander-confirmation","title":"Demander confirmation","text":"<pre><code>J'ai identifi\u00e9 que vous souhaitez d\u00e9ployer [TYPE_APP].\nJe vais utiliser [DOCKER/SYSTEMD] et le port [PORT].\n\nSouhaitez-vous que je proc\u00e8de ?\n</code></pre>"},{"location":"05-advanced/llm-usage/#rapport-de-succes","title":"Rapport de succ\u00e8s","text":"<pre><code>\u2705 [APP_NAME] d\u00e9ploy\u00e9 avec succ\u00e8s !\n\n\ud83d\udccd URL : http://69.62.108.82:[PORT]\n\ud83d\udce6 Type : [Docker/Systemd]\n\ud83d\udcca Status : En ligne\n\n\ud83d\udd27 Commandes utiles :\n- Logs : [COMMANDE]\n- Red\u00e9marrer : [COMMANDE]\n- Arr\u00eater : [COMMANDE]\n</code></pre>"},{"location":"05-advanced/llm-usage/#rapport-derreur","title":"Rapport d'erreur","text":"<pre><code>\u274c \u00c9chec du d\u00e9ploiement de [APP_NAME]\n\nErreur : [ERREUR_PRINCIPALE]\n\nLogs :\n[EXTRAIT_LOGS]\n\nActions sugg\u00e9r\u00e9es :\n1. [ACTION_1]\n2. [ACTION_2]\n</code></pre>"},{"location":"05-advanced/llm-usage/#exemples-de-decision","title":"\ud83c\udf93 Exemples de d\u00e9cision","text":""},{"location":"05-advanced/llm-usage/#exemple-1-lutilisateur-demande-deploie-une-api-fastapi","title":"Exemple 1 : L'utilisateur demande \"D\u00e9ploie une API FastAPI\"","text":"<pre><code>1. Identifier : Application web \u2192 Docker\n2. Lire : GUIDE_DEPLOIEMENT_VPS.md\n3. Chercher : Section \"Template Flask/FastAPI\"\n4. Appliquer : Suivre les 6 \u00e9tapes du workflow\n5. V\u00e9rifier : curl http://69.62.108.82:[PORT]\n6. Informer : Rapport de succ\u00e8s\n</code></pre>"},{"location":"05-advanced/llm-usage/#exemple-2-lutilisateur-demande-installe-postgresql","title":"Exemple 2 : L'utilisateur demande \"Installe PostgreSQL\"","text":"<pre><code>1. Identifier : Base de donn\u00e9es \u2192 Systemd (ou Docker selon pr\u00e9f\u00e9rence)\n2. Demander : \"Pr\u00e9f\u00e9rez-vous Docker ou installation native ?\"\n3. Selon r\u00e9ponse :\n   - Docker \u2192 GUIDE_DEPLOIEMENT_VPS.md\n   - Native \u2192 GUIDE_SERVICES_SYSTEMD.md (suivre template Ollama)\n</code></pre>"},{"location":"05-advanced/llm-usage/#exemple-3-lutilisateur-demande-ajoute-un-dashboard-streamlit","title":"Exemple 3 : L'utilisateur demande \"Ajoute un dashboard Streamlit\"","text":"<pre><code>1. Identifier : Streamlit \u2192 Docker\n2. Lire : GUIDE_DEPLOIEMENT_VPS.md\n3. Chercher : Section \"Template Streamlit\"\n4. Port : V\u00e9rifier ports disponibles (8502+)\n5. Appliquer : Workflow complet\n6. Nginx : Optionnel (demander \u00e0 l'utilisateur)\n</code></pre>"},{"location":"05-advanced/llm-usage/#cas-particuliers","title":"\ud83d\udee0\ufe0f Cas particuliers","text":""},{"location":"05-advanced/llm-usage/#cas-1-le-port-suggere-est-deja-utilise","title":"Cas 1 : Le port sugg\u00e9r\u00e9 est d\u00e9j\u00e0 utilis\u00e9","text":"<pre><code># V\u00e9rifier les ports utilis\u00e9s\nssh root@69.62.108.82 \"docker ps --format '{{.Names}}: {{.Ports}}'\"\nssh root@69.62.108.82 \"netstat -tlnp | grep -E '850[0-9]'\"\n\n# Proposer le prochain port libre\n</code></pre>"},{"location":"05-advanced/llm-usage/#cas-2-lutilisateur-veut-un-sous-domaine","title":"Cas 2 : L'utilisateur veut un sous-domaine","text":"<pre><code>1. D\u00e9ployer l'app normalement (IP:PORT)\n2. Demander le nom de sous-domaine souhait\u00e9\n3. Cr\u00e9er config Nginx (voir GUIDE_DEPLOIEMENT_VPS.md section \"Ajouter un nouveau site\")\n4. Informer que le DNS doit pointer vers 69.62.108.82\n</code></pre>"},{"location":"05-advanced/llm-usage/#cas-3-mise-a-jour-dune-application-existante","title":"Cas 3 : Mise \u00e0 jour d'une application existante","text":"<pre><code>1. Identifier l'app : ssh root@69.62.108.82 \"ls /opt/\"\n2. Type : Docker ou systemd ?\n   - Docker : cd /opt/[app] &amp;&amp; docker-compose down &amp;&amp; ...\n   - Systemd : systemctl restart [service]\n3. Lire le guide appropri\u00e9 section \"Mise \u00e0 jour\"\n</code></pre>"},{"location":"05-advanced/llm-usage/#cas-4-migration-wordpress-vers-docker","title":"Cas 4 : Migration WordPress vers Docker","text":"<pre><code>1. Lire : GUIDE_WORDPRESS_DOCKER.md\n2. Suivre EXACTEMENT le workflow (9 \u00e9tapes critiques)\n3. Points d'attention :\n   - \u26a0\ufe0f Backup COMPLET (db + wp-content + wp-config.php)\n   - \u26a0\ufe0f user: \"33:33\" dans docker-compose.yml\n   - \u26a0\ufe0f DB_HOST = mysql-clemence:3306 (pas localhost!)\n   - \u26a0\ufe0f Fix reverse proxy HTTPS dans wp-config.php\n   - \u26a0\ufe0f URLs (siteurl et home) en HTTPS identiques\n4. V\u00e9rifier : HTTP 200, plugins/themes OK, admin accessible\n</code></pre>"},{"location":"05-advanced/llm-usage/#securite-checklist","title":"\ud83d\udd10 S\u00e9curit\u00e9 - Checklist","text":"<p>Avant tout transfert de fichiers :</p> <ul> <li> V\u00e9rifier <code>.gitignore</code> contient <code>.env</code>, <code>*.key</code>, <code>*.pem</code></li> <li> Pas de secrets hardcod\u00e9s dans le code</li> <li> Variables sensibles dans fichier <code>.env</code> (non transf\u00e9r\u00e9)</li> <li> Permissions correctes (pas de 777)</li> </ul>"},{"location":"05-advanced/llm-usage/#monitoring-automatique","title":"\ud83d\udcca Monitoring automatique","text":"<p>Apr\u00e8s chaque d\u00e9ploiement, sugg\u00e9rer \u00e0 l'utilisateur :</p> <pre><code># Voir les ressources\nssh root@69.62.108.82 \"docker stats --no-stream\"  # Si Docker\nssh root@69.62.108.82 \"systemctl status [service]\"  # Si systemd\n\n# Voir les logs\nssh root@69.62.108.82 \"docker logs [container] --tail=20\"  # Docker\nssh root@69.62.108.82 \"journalctl -u [service] -n 20\"  # Systemd\n</code></pre>"},{"location":"05-advanced/llm-usage/#resume-des-actions-llm","title":"\ud83c\udfaf R\u00e9sum\u00e9 des actions LLM","text":"Situation Action LLM Demande de d\u00e9ploiement Identifier type \u2192 Lire guide \u2192 Cr\u00e9er checklist \u2192 Ex\u00e9cuter \u2192 V\u00e9rifier \u2192 Informer Erreur rencontr\u00e9e Lire logs \u2192 Diagnostiquer \u2192 Proposer solutions OU demander aide Mise \u00e0 jour Identifier app \u2192 Lire guide section \"Mise \u00e0 jour\" \u2192 Ex\u00e9cuter \u2192 V\u00e9rifier Question utilisateur R\u00e9f\u00e9rencer section appropri\u00e9e du guide (ne pas dupliquer) Param\u00e8tre manquant Demander \u00e0 l'utilisateur (ne JAMAIS deviner)"},{"location":"05-advanced/llm-usage/#informations-serveur-reference-rapide","title":"\ud83d\udcde Informations serveur (r\u00e9f\u00e9rence rapide)","text":"<p>SSH : <code>ssh root@69.62.108.82</code> IP : <code>69.62.108.82</code> Hostname : <code>srv759970.hstgr.cloud</code> OS : Ubuntu 24.04.2 LTS</p> <p>Chemins importants : - Applications : <code>/opt/</code> - Nginx configs : <code>/etc/nginx/sites-available/</code> - Systemd services : <code>/etc/systemd/system/</code></p> <p>V\u00e9rifications rapides : <pre><code># Apps Docker\nssh root@69.62.108.82 \"docker ps\"\n\n# Services systemd\nssh root@69.62.108.82 \"systemctl list-units --type=service --state=running | grep -v '@'\"\n\n# Ports utilis\u00e9s\nssh root@69.62.108.82 \"netstat -tlnp\"\n</code></pre></p> <p>Derni\u00e8re mise \u00e0 jour : Octobre 2025 Principe : DRY - Ne dupliquez pas, r\u00e9f\u00e9rencez !</p>"},{"location":"05-advanced/mcp-servers/","title":"\ud83e\udd16 Guide - MCP Servers (Model Context Protocol)","text":""},{"location":"05-advanced/mcp-servers/#architecture","title":"\ud83c\udfaf Architecture","text":"<p>Le serveur Hostinger h\u00e9berge deux serveurs MCP : - Node.js MCP Server (port 3000) - Python MCP Server (port 8000)</p> <p>Accessible via : <code>https://mcp.srv759970.hstgr.cloud</code></p>"},{"location":"05-advanced/mcp-servers/#serveurs-deployes","title":"\ud83d\udccb Serveurs d\u00e9ploy\u00e9s","text":""},{"location":"05-advanced/mcp-servers/#1-nodejs-mcp-server","title":"1. Node.js MCP Server","text":"<p>URL : https://mcp.srv759970.hstgr.cloud/nodejs/ Port interne : 3000 Service : <code>mcp-nodejs.service</code> Localisation : <code>/var/www/mcp-servers/nodejs/</code></p> <p>Technologies : - Node.js 22.20.0 LTS - Express.js - @modelcontextprotocol/sdk</p> <p>Endpoints : - <code>GET /health</code> - Health check - <code>GET /mcp/tools</code> - Liste des outils disponibles - <code>POST /mcp/execute</code> - Ex\u00e9cuter un outil</p>"},{"location":"05-advanced/mcp-servers/#2-python-mcp-server","title":"2. Python MCP Server","text":"<p>URL : https://mcp.srv759970.hstgr.cloud/python/ Port interne : 8000 Service : <code>mcp-python.service</code> Localisation : <code>/var/www/mcp-servers/python/</code></p> <p>Technologies : - Python 3.12.3 - FastAPI - Uvicorn - mcp (pip package) - uv (package manager)</p> <p>Endpoints : - <code>GET /health</code> - Health check - <code>GET /mcp/tools</code> - Liste des outils disponibles - <code>POST /mcp/execute</code> - Ex\u00e9cuter un outil - <code>GET /docs</code> - Documentation Swagger automatique</p>"},{"location":"05-advanced/mcp-servers/#configuration-serveur","title":"\ud83d\udd27 Configuration serveur","text":""},{"location":"05-advanced/mcp-servers/#structure-des-fichiers","title":"Structure des fichiers","text":"<pre><code>/var/www/mcp-servers/\n\u251c\u2500\u2500 nodejs/\n\u2502   \u251c\u2500\u2500 server.js\n\u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2514\u2500\u2500 node_modules/\n\u2514\u2500\u2500 python/\n    \u251c\u2500\u2500 main.py\n    \u251c\u2500\u2500 .venv/\n    \u2514\u2500\u2500 pyproject.toml\n</code></pre>"},{"location":"05-advanced/mcp-servers/#services-systemd","title":"Services systemd","text":"<pre><code># Statut des services\nsystemctl status mcp-nodejs\nsystemctl status mcp-python\n\n# Red\u00e9marrer\nsystemctl restart mcp-nodejs\nsystemctl restart mcp-python\n\n# Logs\njournalctl -u mcp-nodejs -f\njournalctl -u mcp-python -f\n</code></pre>"},{"location":"05-advanced/mcp-servers/#utilisation-cote-client","title":"\ud83d\udcbb Utilisation c\u00f4t\u00e9 client","text":""},{"location":"05-advanced/mcp-servers/#avec-npx-nodejs-typescript","title":"Avec npx (Node.js / TypeScript)","text":""},{"location":"05-advanced/mcp-servers/#installation-rapide","title":"Installation rapide","text":"<pre><code># Pas d'installation locale n\u00e9cessaire !\n# npx t\u00e9l\u00e9charge et ex\u00e9cute automatiquement\n</code></pre>"},{"location":"05-advanced/mcp-servers/#exemple-dutilisation","title":"Exemple d'utilisation","text":"<pre><code># Appeler le serveur MCP Node.js\nnpx node-fetch https://mcp.srv759970.hstgr.cloud/nodejs/health \\\n  --user julien:DevAccess2025\n</code></pre>"},{"location":"05-advanced/mcp-servers/#script-client-nodejs","title":"Script client Node.js","text":"<pre><code>// client-mcp-nodejs.js\nimport fetch from 'node-fetch';\n\nconst MCP_BASE_URL = 'https://mcp.srv759970.hstgr.cloud/nodejs';\nconst AUTH = 'Basic ' + Buffer.from('julien:DevAccess2025').toString('base64');\n\nasync function callMCP(tool, parameters) {\n  const response = await fetch(`${MCP_BASE_URL}/mcp/execute`, {\n    method: 'POST',\n    headers: {\n      'Authorization': AUTH,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ tool, parameters })\n  });\n\n  return await response.json();\n}\n\n// Utilisation\ncallMCP('example-tool', { param1: 'value1', param2: 'value2' })\n  .then(result =&gt; console.log(result))\n  .catch(err =&gt; console.error(err));\n</code></pre>"},{"location":"05-advanced/mcp-servers/#execution","title":"Ex\u00e9cution","text":"<pre><code>npx node client-mcp-nodejs.js\n</code></pre>"},{"location":"05-advanced/mcp-servers/#avec-uvx-python","title":"Avec uvx (Python)","text":""},{"location":"05-advanced/mcp-servers/#installation-rapide_1","title":"Installation rapide","text":"<pre><code># Installer uv (si pas d\u00e9j\u00e0 fait)\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Ajouter au PATH\nexport PATH=\"$HOME/.local/bin:$PATH\"\n</code></pre>"},{"location":"05-advanced/mcp-servers/#script-client-python","title":"Script client Python","text":"<pre><code># client_mcp_python.py\nimport httpx\nimport asyncio\nfrom base64 import b64encode\n\nMCP_BASE_URL = \"https://mcp.srv759970.hstgr.cloud/python\"\nAUTH_USER = \"julien\"\nAUTH_PASS = \"DevAccess2025\"\n\nasync def call_mcp(tool: str, parameters: dict):\n    # Cr\u00e9er le header Basic Auth\n    credentials = b64encode(f\"{AUTH_USER}:{AUTH_PASS}\".encode()).decode()\n    headers = {\n        \"Authorization\": f\"Basic {credentials}\",\n        \"Content-Type\": \"application/json\"\n    }\n\n    async with httpx.AsyncClient() as client:\n        response = await client.post(\n            f\"{MCP_BASE_URL}/mcp/execute\",\n            headers=headers,\n            json={\"tool\": tool, \"parameters\": parameters}\n        )\n        return response.json()\n\n# Utilisation\nasync def main():\n    result = await call_mcp(\n        \"example-python-tool\",\n        {\"param1\": \"value1\", \"param2\": \"value2\"}\n    )\n    print(result)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"05-advanced/mcp-servers/#creer-un-pyprojecttoml","title":"Cr\u00e9er un pyproject.toml","text":"<pre><code>[project]\nname = \"mcp-client\"\nversion = \"0.1.0\"\ndependencies = [\n    \"httpx\",\n]\n</code></pre>"},{"location":"05-advanced/mcp-servers/#execution-avec-uvx","title":"Ex\u00e9cution avec uvx","text":"<pre><code># Option 1 : Ex\u00e9cuter directement avec uvx\nuvx --with httpx python client_mcp_python.py\n\n# Option 2 : Cr\u00e9er un environnement et ex\u00e9cuter\nuv venv\nsource .venv/bin/activate  # Linux/Mac\n# ou .venv\\Scripts\\activate  # Windows\nuv pip install httpx\npython client_mcp_python.py\n</code></pre>"},{"location":"05-advanced/mcp-servers/#authentification","title":"\ud83d\udd10 Authentification","text":"<p>Tous les serveurs MCP n\u00e9cessitent HTTP Basic Authentication : - Username : <code>julien</code> - Password : <code>DevAccess2025</code></p>"},{"location":"05-advanced/mcp-servers/#exemples-dauth","title":"Exemples d'auth","text":""},{"location":"05-advanced/mcp-servers/#curl","title":"cURL","text":"<pre><code>curl -u julien:DevAccess2025 https://mcp.srv759970.hstgr.cloud/nodejs/health\n</code></pre>"},{"location":"05-advanced/mcp-servers/#python-requests","title":"Python (requests)","text":"<pre><code>import requests\n\nresponse = requests.get(\n    'https://mcp.srv759970.hstgr.cloud/python/health',\n    auth=('julien', 'DevAccess2025')\n)\nprint(response.json())\n</code></pre>"},{"location":"05-advanced/mcp-servers/#javascript-fetch","title":"JavaScript (fetch)","text":"<pre><code>const credentials = btoa('julien:DevAccess2025');\nfetch('https://mcp.srv759970.hstgr.cloud/nodejs/health', {\n  headers: {\n    'Authorization': `Basic ${credentials}`\n  }\n})\n.then(res =&gt; res.json())\n.then(data =&gt; console.log(data));\n</code></pre>"},{"location":"05-advanced/mcp-servers/#endpoints-disponibles","title":"\ud83d\udcca Endpoints disponibles","text":""},{"location":"05-advanced/mcp-servers/#get-health","title":"GET /health","text":"<p>Description : Health check du serveur</p> <p>R\u00e9ponse : <pre><code>{\n  \"status\": \"healthy\",\n  \"service\": \"MCP Node.js Server\"\n}\n</code></pre></p>"},{"location":"05-advanced/mcp-servers/#get-mcptools","title":"GET /mcp/tools","text":"<p>Description : Liste tous les outils MCP disponibles</p> <p>R\u00e9ponse : <pre><code>{\n  \"tools\": [\n    {\n      \"name\": \"example-tool\",\n      \"description\": \"Example MCP tool\",\n      \"parameters\": [\"param1\", \"param2\"]\n    }\n  ]\n}\n</code></pre></p>"},{"location":"05-advanced/mcp-servers/#post-mcpexecute","title":"POST /mcp/execute","text":"<p>Description : Ex\u00e9cute un outil MCP</p> <p>Request Body : <pre><code>{\n  \"tool\": \"example-tool\",\n  \"parameters\": {\n    \"param1\": \"value1\",\n    \"param2\": \"value2\"\n  }\n}\n</code></pre></p> <p>R\u00e9ponse : <pre><code>{\n  \"success\": true,\n  \"tool\": \"example-tool\",\n  \"result\": \"Executed example-tool with parameters\",\n  \"timestamp\": \"2025-10-16T19:30:00.000Z\"\n}\n</code></pre></p>"},{"location":"05-advanced/mcp-servers/#developpement-de-nouveaux-outils-mcp","title":"\ud83d\udee0\ufe0f D\u00e9veloppement de nouveaux outils MCP","text":""},{"location":"05-advanced/mcp-servers/#ajouter-un-outil-nodejs","title":"Ajouter un outil Node.js","text":"<ol> <li> <p>SSH sur le serveur : <pre><code>ssh root@69.62.108.82\ncd /var/www/mcp-servers/nodejs\n</code></pre></p> </li> <li> <p>Modifier <code>server.js</code> : <pre><code>// Ajouter un nouvel endpoint\napp.post('/mcp/custom-tool', (req, res) =&gt; {\n  const { param1, param2 } = req.body;\n\n  // Votre logique ici\n  const result = doSomething(param1, param2);\n\n  res.json({\n    success: true,\n    result: result\n  });\n});\n</code></pre></p> </li> <li> <p>Red\u00e9marrer le service : <pre><code>systemctl restart mcp-nodejs\n</code></pre></p> </li> </ol>"},{"location":"05-advanced/mcp-servers/#ajouter-un-outil-python","title":"Ajouter un outil Python","text":"<ol> <li> <p>SSH sur le serveur : <pre><code>ssh root@69.62.108.82\ncd /var/www/mcp-servers/python\nsource .venv/bin/activate\n</code></pre></p> </li> <li> <p>Modifier <code>main.py</code> : <pre><code>@app.post(\"/mcp/custom-tool\")\ndef custom_tool(param1: str, param2: str):\n    # Votre logique ici\n    result = do_something(param1, param2)\n\n    return {\n        \"success\": True,\n        \"result\": result\n    }\n</code></pre></p> </li> <li> <p>Red\u00e9marrer le service : <pre><code>systemctl restart mcp-python\n</code></pre></p> </li> </ol>"},{"location":"05-advanced/mcp-servers/#exemples-dintegration","title":"\ud83d\udcda Exemples d'int\u00e9gration","text":""},{"location":"05-advanced/mcp-servers/#dans-claude-desktop","title":"Dans Claude Desktop","text":"<p>Configuration (<code>claude_desktop_config.json</code>) :</p> <pre><code>{\n  \"mcpServers\": {\n    \"hostinger-nodejs\": {\n      \"url\": \"https://mcp.srv759970.hstgr.cloud/nodejs\",\n      \"auth\": {\n        \"type\": \"basic\",\n        \"username\": \"julien\",\n        \"password\": \"DevAccess2025\"\n      }\n    },\n    \"hostinger-python\": {\n      \"url\": \"https://mcp.srv759970.hstgr.cloud/python\",\n      \"auth\": {\n        \"type\": \"basic\",\n        \"username\": \"julien\",\n        \"password\": \"DevAccess2025\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"05-advanced/mcp-servers/#dans-un-workflow-n8n","title":"Dans un workflow n8n","text":"<ol> <li>Ajouter node HTTP Request</li> <li>Configuration :</li> <li>Method : POST</li> <li>URL : <code>https://mcp.srv759970.hstgr.cloud/python/mcp/execute</code></li> <li>Authentication : Basic Auth</li> <li>Body : JSON <code>{\"tool\": \"my-tool\", \"parameters\": {...}}</code></li> </ol>"},{"location":"05-advanced/mcp-servers/#tests","title":"\ud83e\uddea Tests","text":""},{"location":"05-advanced/mcp-servers/#test-nodejs-mcp","title":"Test Node.js MCP","text":"<pre><code>curl -u julien:DevAccess2025 \\\n  -X POST https://mcp.srv759970.hstgr.cloud/nodejs/mcp/execute \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"tool\": \"example-tool\",\n    \"parameters\": {\"param1\": \"test\", \"param2\": \"value\"}\n  }'\n</code></pre>"},{"location":"05-advanced/mcp-servers/#test-python-mcp","title":"Test Python MCP","text":"<pre><code>curl -u julien:DevAccess2025 \\\n  -X POST https://mcp.srv759970.hstgr.cloud/python/mcp/execute \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"tool\": \"example-python-tool\",\n    \"parameters\": {\"param1\": \"test\", \"param2\": \"value\"}\n  }'\n</code></pre>"},{"location":"05-advanced/mcp-servers/#test-avec-python-uvx","title":"Test avec Python uvx","text":"<pre><code># Cr\u00e9er un script de test rapide\ncat &gt; test_mcp.py &lt;&lt; 'EOF'\nimport httpx\nfrom base64 import b64encode\n\ncredentials = b64encode(b\"julien:DevAccess2025\").decode()\nheaders = {\"Authorization\": f\"Basic {credentials}\"}\n\nresponse = httpx.get(\n    \"https://mcp.srv759970.hstgr.cloud/python/health\",\n    headers=headers\n)\nprint(response.json())\nEOF\n\n# Ex\u00e9cuter avec uvx\nuvx --with httpx python test_mcp.py\n</code></pre>"},{"location":"05-advanced/mcp-servers/#commandes-utiles","title":"\ud83d\udd04 Commandes utiles","text":""},{"location":"05-advanced/mcp-servers/#gestion-des-services","title":"Gestion des services","text":"<pre><code># Status\nsystemctl status mcp-nodejs\nsystemctl status mcp-python\n\n# Red\u00e9marrer\nsystemctl restart mcp-nodejs\nsystemctl restart mcp-python\n\n# Logs en temps r\u00e9el\njournalctl -u mcp-nodejs -f\njournalctl -u mcp-python -f\n\n# Derniers logs\njournalctl -u mcp-nodejs -n 50\njournalctl -u mcp-python -n 50\n</code></pre>"},{"location":"05-advanced/mcp-servers/#mise-a-jour-des-dependances","title":"Mise \u00e0 jour des d\u00e9pendances","text":""},{"location":"05-advanced/mcp-servers/#nodejs","title":"Node.js","text":"<pre><code>cd /var/www/mcp-servers/nodejs\nexport NVM_DIR=\"$HOME/.nvm\"\n[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; . \"$NVM_DIR/nvm.sh\"\nnpm update\nsystemctl restart mcp-nodejs\n</code></pre>"},{"location":"05-advanced/mcp-servers/#python","title":"Python","text":"<pre><code>cd /var/www/mcp-servers/python\nexport PATH=\"$HOME/.local/bin:$PATH\"\nsource .venv/bin/activate\nuv pip install --upgrade fastapi uvicorn mcp\nsystemctl restart mcp-python\n</code></pre>"},{"location":"05-advanced/mcp-servers/#securite","title":"\ud83d\udd12 S\u00e9curit\u00e9","text":"<ul> <li>Basic Auth : Tous les endpoints prot\u00e9g\u00e9s</li> <li>HTTPS uniquement : SSL via Let's Encrypt</li> <li>Firewall : Ports 3000 et 8000 non expos\u00e9s directement (proxy Nginx)</li> <li>Services systemd : Red\u00e9marrage automatique en cas de crash</li> </ul>"},{"location":"05-advanced/mcp-servers/#monitoring","title":"\ud83d\udcca Monitoring","text":""},{"location":"05-advanced/mcp-servers/#verifier-si-les-services-fonctionnent","title":"V\u00e9rifier si les services fonctionnent","text":"<pre><code># Node.js\ncurl -u julien:DevAccess2025 https://mcp.srv759970.hstgr.cloud/nodejs/health\n\n# Python\ncurl -u julien:DevAccess2025 https://mcp.srv759970.hstgr.cloud/python/health\n</code></pre>"},{"location":"05-advanced/mcp-servers/#logs-dacces-nginx","title":"Logs d'acc\u00e8s Nginx","text":"<pre><code>tail -f /var/log/nginx/mcp-access.log\n</code></pre>"},{"location":"05-advanced/mcp-servers/#ressources","title":"\ud83d\udcda Ressources","text":"<ul> <li>Model Context Protocol : https://modelcontextprotocol.io/</li> <li>FastAPI Docs : https://fastapi.tiangolo.com/</li> <li>Express.js Docs : https://expressjs.com/</li> <li>uv Docs : https://docs.astral.sh/uv/</li> <li>npx Docs : https://docs.npmjs.com/cli/v10/commands/npx</li> </ul> <p>Cr\u00e9\u00e9 le : 2025-10-16 URLs : - Node.js : https://mcp.srv759970.hstgr.cloud/nodejs/ - Python : https://mcp.srv759970.hstgr.cloud/python/ Auth : julien / DevAccess2025</p>"},{"location":"05-advanced/photo-ai/","title":"\ud83e\udd16 Repos GitHub - Cat\u00e9gorisation IA de Photos","text":""},{"location":"05-advanced/photo-ai/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>Trouver des solutions IA pour cat\u00e9goriser automatiquement les photos : - Posters / Affiches de spectacles et concerts - Photos utilisateurs vs photos de famille - Photos de paysages - Reconnaissance faciale et \u00e9v\u00e9nements</p>"},{"location":"05-advanced/photo-ai/#solutions-recommandees","title":"\ud83c\udfc6 Solutions recommand\u00e9es","text":""},{"location":"05-advanced/photo-ai/#1-photoprism-most-popular","title":"1. PhotoPrism \u2b50 (Most Popular)","text":"<p>Repository : https://github.com/photoprism/photoprism</p> <p>Description : Application photos AI-Powered pour le web d\u00e9centralis\u00e9</p> <p>Features : - \u2705 Labellisation automatique bas\u00e9e sur le contenu et la localisation - \u2705 Reconnaissance faciale pour famille et amis - \u2705 Tagging IA automatique avec machine learning - \u2705 Groupement par personnes - \u2705 Auto-h\u00e9berg\u00e9 et privacy-focused - \u2705 Interface web moderne et responsive - \u2705 Support g\u00e9olocalisation et cartographie - \u2705 Recherche avanc\u00e9e par tags, personnes, lieux</p> <p>Technologies : - Go (backend) - TensorFlow (IA) - MariaDB/MySQL - Docker</p> <p>Installation : <pre><code>docker run -d \\\n  --name photoprism \\\n  --security-opt seccomp=unconfined \\\n  --security-opt apparmor=unconfined \\\n  -p 2342:2342 \\\n  -e PHOTOPRISM_UPLOAD_NSFW=\"true\" \\\n  -e PHOTOPRISM_ADMIN_PASSWORD=\"admin\" \\\n  -v /path/to/photos:/photoprism/originals \\\n  -v ./storage:/photoprism/storage \\\n  photoprism/photoprism\n</code></pre></p> <p>Avantages : - Production-ready - Large communaut\u00e9 (36k+ stars) - Bien maintenu - Interface utilisateur excellente</p> <p>Inconv\u00e9nients : - N\u00e9cessite des ressources (CPU/RAM pour IA) - Pas de cat\u00e9gorisation \"poster vs famille\" directe (n\u00e9cessite custom training)</p>"},{"location":"05-advanced/photo-ai/#2-photo-organizer-core-standalone-ai-agent","title":"2. Photo-Organizer-CORE (Standalone AI Agent)","text":"<p>Repository : https://github.com/ashesbloom/Photo-Organizer-CORE</p> <p>Description : Agent IA desktop standalone pour cat\u00e9goriser automatiquement les photos</p> <p>Features : - \u2705 Cat\u00e9gorisation automatique par date, lieu, visages - \u2705 Traitement 100% local (pas de cloud) - \u2705 Organisation en hi\u00e9rarchie albums/dossiers - \u2705 Reconnaissance faciale int\u00e9gr\u00e9e - \u2705 Pas besoin de serveur web</p> <p>Technologies : - Python - Deep Learning (mod\u00e8les locaux) - Desktop app</p> <p>Utilisation : <pre><code>git clone https://github.com/ashesbloom/Photo-Organizer-CORE\ncd Photo-Organizer-CORE\npip install -r requirements.txt\npython organizer.py --input /path/to/photos --output /path/to/organized\n</code></pre></p> <p>Avantages : - Simple et l\u00e9ger - Pas besoin de serveur - Privacy total (tout en local) - Scripts personnalisables</p> <p>Inconv\u00e9nients : - Pas d'interface web - Moins de features que PhotoPrism - N\u00e9cessite adaptation pour cat\u00e9gories sp\u00e9cifiques (posters/concerts)</p>"},{"location":"05-advanced/photo-ai/#3-jfthuongphoto-organizer-ml-modules","title":"3. jfthuong/photo-organizer (ML Modules)","text":"<p>Repository : https://github.com/jfthuong/photo-organizer</p> <p>Description : Modules ML et heuristiques pour organiser photos de famille</p> <p>Features : - \u2705 Identification faciale avec FaceNet - \u2705 Modules ML multiples - \u2705 Approche heuristique + ML - \u2705 Orient\u00e9 photos de famille</p> <p>Technologies : - Python - FaceNet (reconnaissance faciale) - TensorFlow</p> <p>Avantages : - Modulaire et extensible - Focus sur les photos de famille - Code bien document\u00e9</p> <p>Inconv\u00e9nients : - Moins actif (derni\u00e8re update 2021) - N\u00e9cessite d\u00e9veloppement custom pour nouveaux cas d'usage</p>"},{"location":"05-advanced/photo-ai/#4-picfolio-mobile-desktop","title":"4. PicFolio (Mobile + Desktop)","text":"<p>Repository : https://github.com/meet244/PicFolio</p> <p>Description : Gestionnaire photos avec client-serveur, upload depuis mobile</p> <p>Features : - \u2705 Tagging automatique avec IA (Recognise Anything Model) - \u2705 Reconnaissance faciale (DeepFace) - \u2705 Recherche avec Gemini API - \u2705 Upload depuis mobile - \u2705 Stockage local</p> <p>Technologies : - Node.js (backend) - DeepFace (face recognition) - Gemini API (search) - RAM (Recognise Anything Model)</p> <p>Avantages : - Architecture client-serveur moderne - Multiple mod\u00e8les IA - Support mobile</p> <p>Inconv\u00e9nients : - D\u00e9pendance Gemini API (Google) - Moins mature que PhotoPrism</p>"},{"location":"05-advanced/photo-ai/#5-intellialbum","title":"5. IntelliAlbum","text":"<p>Repository : https://github.com/neozhu/IntelliAlbum</p> <p>Description : Album intelligent avec IA</p> <p>Features : - \u2705 Reconnaissance faciale automatique - \u2705 Sauvegarde des donn\u00e9es faciales - \u2705 Interface album</p> <p>Technologies : - .NET / C# - Machine Learning</p> <p>Avantages : - Stack .NET bien structur\u00e9 - Interface moderne</p> <p>Inconv\u00e9nients : - Moins populaire - Communaut\u00e9 plus petite</p>"},{"location":"05-advanced/photo-ai/#cas-dusage-specifique-postersconcerts-vs-famille","title":"\ud83c\udfaf Cas d'usage sp\u00e9cifique : Posters/Concerts vs Famille","text":"<p>Pour cat\u00e9goriser posters de spectacles/concerts vs photos de famille vs paysages, il faut :</p>"},{"location":"05-advanced/photo-ai/#approche-recommandee","title":"Approche recommand\u00e9e","text":"<ol> <li>Utiliser PhotoPrism comme base</li> <li>G\u00e8re d\u00e9j\u00e0 : personnes, lieux, dates</li> <li> <p>Interface web pr\u00eate</p> </li> <li> <p>Ajouter un classifier custom</p> </li> <li>Entra\u00eener un mod\u00e8le CNN (ResNet50, EfficientNet)</li> <li>3 classes : \"poster\", \"family\", \"landscape\"</li> <li> <p>Dataset : ImageNet + custom dataset</p> </li> <li> <p>Pipeline propos\u00e9 :</p> </li> </ol> <pre><code># Pseudo-code\nimport torch\nfrom torchvision import models, transforms\n\n# Mod\u00e8le pr\u00e9-entra\u00een\u00e9\nmodel = models.resnet50(pretrained=True)\nmodel.fc = torch.nn.Linear(model.fc.in_features, 3)  # 3 classes\n\n# Inference\ntransform = transforms.Compose([\n    transforms.Resize(256),\n    transforms.CenterCrop(224),\n    transforms.ToTensor(),\n])\n\ndef classify_photo(image_path):\n    image = Image.open(image_path)\n    input_tensor = transform(image).unsqueeze(0)\n    with torch.no_grad():\n        output = model(input_tensor)\n        _, predicted = torch.max(output, 1)\n\n    classes = ['poster', 'family', 'landscape']\n    return classes[predicted.item()]\n\n# Int\u00e9gration avec PhotoPrism\n# \u2192 Ajouter tags automatiques selon classification\n</code></pre>"},{"location":"05-advanced/photo-ai/#solution-complete-recommandee","title":"\ud83d\ude80 Solution compl\u00e8te recommand\u00e9e","text":""},{"location":"05-advanced/photo-ai/#architecture-combinee","title":"Architecture combin\u00e9e","text":"<pre><code>[ Dropbox 600 Go ]\n        |\n        | (rclone mount)\n        v\n   VPS Hostinger\n        |\n        +-- PhotoPrism (galerie + IA de base)\n        +-- Custom Classifier (posters/famille/paysage)\n        +-- digiKam (MariaDB externe)\n        +-- Lychee (galerie secondaire)\n</code></pre>"},{"location":"05-advanced/photo-ai/#stack-technique","title":"Stack technique","text":"<ol> <li>PhotoPrism pour :</li> <li>Interface web</li> <li>Reconnaissance faciale</li> <li>G\u00e9olocalisation</li> <li> <p>Tags de base</p> </li> <li> <p>Custom Python script pour :</p> </li> <li>Classification poster/famille/paysage</li> <li>Mod\u00e8le PyTorch/TensorFlow</li> <li> <p>Ajout de tags dans PhotoPrism via API</p> </li> <li> <p>digiKam pour :</p> </li> <li>\u00c9dition avanc\u00e9e</li> <li>Catalogage professionnel</li> <li>Workflow photographe</li> </ol>"},{"location":"05-advanced/photo-ai/#installation-photoprism-sur-vps","title":"\ud83d\udce6 Installation PhotoPrism sur VPS","text":"<pre><code>mkdir -p /var/www/photoprism/{storage,originals}\n\ndocker run -d \\\n  --name photoprism \\\n  --security-opt seccomp=unconfined \\\n  --security-opt apparmor=unconfined \\\n  -p 2342:2342 \\\n  -e PHOTOPRISM_ADMIN_USER=\"admin\" \\\n  -e PHOTOPRISM_ADMIN_PASSWORD=\"PhotoPrism2025!\" \\\n  -e PHOTOPRISM_AUTH_MODE=\"password\" \\\n  -e PHOTOPRISM_SITE_URL=\"https://photos.srv759970.hstgr.cloud/\" \\\n  -e PHOTOPRISM_DISABLE_TLS=\"true\" \\\n  -e PHOTOPRISM_DEFAULT_TLS=\"true\" \\\n  -e PHOTOPRISM_ORIGINALS_LIMIT=\"5000\" \\\n  -e PHOTOPRISM_HTTP_COMPRESSION=\"gzip\" \\\n  -e PHOTOPRISM_WORKERS=\"2\" \\\n  -e PHOTOPRISM_LOG_LEVEL=\"info\" \\\n  -e PHOTOPRISM_READONLY=\"false\" \\\n  -e PHOTOPRISM_EXPERIMENTAL=\"false\" \\\n  -e PHOTOPRISM_DISABLE_CHOWN=\"false\" \\\n  -e PHOTOPRISM_DISABLE_WEBDAV=\"false\" \\\n  -e PHOTOPRISM_DISABLE_SETTINGS=\"false\" \\\n  -e PHOTOPRISM_DISABLE_TENSORFLOW=\"false\" \\\n  -e PHOTOPRISM_DISABLE_FACES=\"false\" \\\n  -e PHOTOPRISM_DISABLE_CLASSIFICATION=\"false\" \\\n  -e PHOTOPRISM_DETECT_NSFW=\"false\" \\\n  -e PHOTOPRISM_UPLOAD_NSFW=\"true\" \\\n  -e PHOTOPRISM_DATABASE_DRIVER=\"mysql\" \\\n  -e PHOTOPRISM_DATABASE_SERVER=\"mariadb:3306\" \\\n  -e PHOTOPRISM_DATABASE_NAME=\"photoprism\" \\\n  -e PHOTOPRISM_DATABASE_USER=\"photoprism\" \\\n  -e PHOTOPRISM_DATABASE_PASSWORD=\"PhotoPrismDB2025\" \\\n  -e PHOTOPRISM_SITE_CAPTION=\"AI-Powered Photos\" \\\n  -e PHOTOPRISM_SITE_DESCRIPTION=\"\" \\\n  -e PHOTOPRISM_SITE_AUTHOR=\"\" \\\n  -v /mnt/dropbox:/photoprism/originals:ro \\\n  -v /var/www/photoprism/storage:/photoprism/storage \\\n  photoprism/photoprism\n</code></pre>"},{"location":"05-advanced/photo-ai/#resources","title":"\ud83c\udf93 Resources","text":"<ul> <li>PhotoPrism Docs : https://docs.photoprism.app/</li> <li>PyTorch Image Classification : https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html</li> <li>TensorFlow Image Classification : https://www.tensorflow.org/tutorials/images/classification</li> <li>DeepFace : https://github.com/serengil/deepface</li> <li>FaceNet : https://github.com/davidsandberg/facenet</li> </ul> <p>Cr\u00e9\u00e9 le : 2025-10-16 Recommandation : PhotoPrism + Custom Classifier pour cat\u00e9gories sp\u00e9cifiques</p>"},{"location":"05-advanced/templates-patterns/","title":"Templates &amp; Patterns R\u00e9utilisables","text":"<p>Mod\u00e8les et patterns standardis\u00e9s pour d\u00e9ployer rapidement de nouveaux services sur srv759970.</p>"},{"location":"05-advanced/templates-patterns/#docker-compose-templates","title":"\ud83d\udc33 Docker Compose Templates","text":""},{"location":"05-advanced/templates-patterns/#template-service-web-standard","title":"Template Service Web Standard","text":"<pre><code># /opt/&lt;service-name&gt;/docker-compose.yml\nversion: '3.8'\n\nservices:\n  &lt;service-name&gt;:\n    image: &lt;image:tag&gt;\n    container_name: &lt;service-name&gt;\n    restart: unless-stopped\n    ports:\n      - '&lt;external-port&gt;:&lt;internal-port&gt;'\n    volumes:\n      - ./data:/app/data\n      - ./config:/app/config\n    environment:\n      - NODE_ENV=production\n      - TZ=Europe/Paris\n    networks:\n      - &lt;service-name&gt;-network\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:&lt;internal-port&gt;/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n\nnetworks:\n  &lt;service-name&gt;-network:\n    driver: bridge\n</code></pre>"},{"location":"05-advanced/templates-patterns/#template-service-avec-database","title":"Template Service avec Database","text":"<pre><code>version: '3.8'\n\nservices:\n  app:\n    image: &lt;app-image:tag&gt;\n    container_name: &lt;service&gt;-app\n    restart: unless-stopped\n    ports:\n      - '&lt;port&gt;:&lt;internal-port&gt;'\n    environment:\n      - DATABASE_URL=postgresql://user:password@db:5432/dbname\n    depends_on:\n      - db\n    networks:\n      - &lt;service&gt;-network\n\n  db:\n    image: postgres:15-alpine\n    container_name: &lt;service&gt;-db\n    restart: unless-stopped\n    volumes:\n      - db-data:/var/lib/postgresql/data\n    environment:\n      - POSTGRES_USER=user\n      - POSTGRES_PASSWORD=password\n      - POSTGRES_DB=dbname\n    networks:\n      - &lt;service&gt;-network\n\nvolumes:\n  db-data:\n\nnetworks:\n  &lt;service&gt;-network:\n    driver: bridge\n</code></pre>"},{"location":"05-advanced/templates-patterns/#template-service-auto-start","title":"Template Service Auto-Start","text":"<pre><code>version: '3.8'\n\nservices:\n  &lt;service-name&gt;:\n    image: &lt;image:tag&gt;\n    container_name: &lt;service-name&gt;\n    restart: \"no\"  # Important: pas de restart auto pour auto-start\n    ports:\n      - '&lt;port&gt;:&lt;internal-port&gt;'\n    volumes:\n      - ./data:/data\n    networks:\n      - &lt;service&gt;-network\n    labels:\n      - \"autostart.enable=true\"\n      - \"autostart.idle-timeout=900\"  # 15 minutes\n\nnetworks:\n  &lt;service&gt;-network:\n    driver: bridge\n</code></pre>"},{"location":"05-advanced/templates-patterns/#nginx-configuration-templates","title":"\ud83c\udf10 Nginx Configuration Templates","text":""},{"location":"05-advanced/templates-patterns/#template-reverse-proxy-https-basique","title":"Template Reverse Proxy HTTPS Basique","text":"<pre><code># /etc/nginx/sites-available/&lt;service&gt;\n\n# HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n\n    # SSL Configuration\n    ssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    # Logs\n    access_log /var/log/nginx/&lt;service&gt;-access.log;\n    error_log /var/log/nginx/&lt;service&gt;-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:&lt;port&gt;;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts\n        proxy_read_timeout 300;\n        proxy_connect_timeout 300;\n        proxy_send_timeout 300;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"05-advanced/templates-patterns/#template-reverse-proxy-avec-basic-auth","title":"Template Reverse Proxy avec Basic Auth","text":"<pre><code># HTTPS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/&lt;service&gt;-access.log;\n    error_log /var/log/nginx/&lt;service&gt;-error.log;\n\n    # Basic Authentication\n    include snippets/basic-auth.conf;\n\n    location / {\n        proxy_pass http://127.0.0.1:&lt;port&gt;;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"05-advanced/templates-patterns/#template-reverse-proxy-avec-auto-start","title":"Template Reverse Proxy avec Auto-Start","text":"<pre><code># HTTPS avec Auto-Start Proxy\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/&lt;service&gt;-access.log;\n    error_log /var/log/nginx/&lt;service&gt;-error.log;\n\n    # Bot Protection (optionnel)\n    include snippets/bot-protection.conf;\n\n    location / {\n        # Auto-start proxy\n        proxy_pass http://127.0.0.1:8890;\n        proxy_set_header X-Autostart-Target \"&lt;service&gt;.srv759970.hstgr.cloud\";\n\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts \u00e9lev\u00e9s pour boot time\n        proxy_read_timeout 300;\n        proxy_connect_timeout 300;\n        proxy_send_timeout 300;\n    }\n}\n\n# HTTP -&gt; HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"05-advanced/templates-patterns/#template-websocket-support","title":"Template WebSocket Support","text":"<pre><code>server {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name &lt;service&gt;.srv759970.hstgr.cloud;\n\n    ssl_certificate /etc/letsencrypt/live/&lt;domain&gt;/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/&lt;domain&gt;/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    access_log /var/log/nginx/&lt;service&gt;-access.log;\n    error_log /var/log/nginx/&lt;service&gt;-error.log;\n\n    location / {\n        proxy_pass http://127.0.0.1:&lt;port&gt;;\n        proxy_http_version 1.1;\n\n        # WebSocket headers\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        # Standard headers\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Timeouts pour WebSocket\n        proxy_read_timeout 3600;\n        proxy_send_timeout 3600;\n\n        # Disable buffering\n        proxy_buffering off;\n    }\n}\n</code></pre>"},{"location":"05-advanced/templates-patterns/#workflows-de-deploiement","title":"\ud83d\ude80 Workflows de D\u00e9ploiement","text":""},{"location":"05-advanced/templates-patterns/#workflow-nouveau-service-standard","title":"Workflow Nouveau Service Standard","text":"<pre><code>#!/bin/bash\n# deploy-service.sh &lt;service-name&gt; &lt;port&gt; &lt;image&gt;\n\nSERVICE_NAME=$1\nPORT=$2\nIMAGE=$3\nDOMAIN=\"${SERVICE_NAME}.srv759970.hstgr.cloud\"\n\n# 1. Cr\u00e9er structure\nmkdir -p /opt/$SERVICE_NAME\ncd /opt/$SERVICE_NAME\n\n# 2. Cr\u00e9er docker-compose.yml\ncat &gt; docker-compose.yml &lt;&lt;EOF\nversion: '3.8'\nservices:\n  $SERVICE_NAME:\n    image: $IMAGE\n    container_name: $SERVICE_NAME\n    restart: unless-stopped\n    ports:\n      - \"$PORT:8000\"\n    volumes:\n      - ./data:/data\nEOF\n\n# 3. D\u00e9marrer service\ndocker-compose up -d\n\n# 4. Attendre healthcheck\nsleep 10\ndocker ps | grep $SERVICE_NAME\n\n# 5. Cr\u00e9er config Nginx\ncat &gt; /etc/nginx/sites-available/$SERVICE_NAME &lt;&lt;'EOF'\nserver {\n    listen 443 ssl http2;\n    server_name $DOMAIN;\n\n    ssl_certificate /etc/letsencrypt/live/faster-whisper.srv759970.hstgr.cloud/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/faster-whisper.srv759970.hstgr.cloud/privkey.pem;\n    include /etc/letsencrypt/options-ssl-nginx.conf;\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / {\n        proxy_pass http://127.0.0.1:$PORT;\n        proxy_http_version 1.1;\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n    }\n}\nserver {\n    listen 80;\n    server_name $DOMAIN;\n    return 301 https://\\$host\\$request_uri;\n}\nEOF\n\n# 6. Activer Nginx\nln -s /etc/nginx/sites-available/$SERVICE_NAME /etc/nginx/sites-enabled/\nnginx -t\nsystemctl reload nginx\n\n# 7. Tester\ncurl -I https://$DOMAIN\n\necho \"\u2705 Service $SERVICE_NAME d\u00e9ploy\u00e9 sur https://$DOMAIN\"\n</code></pre>"},{"location":"05-advanced/templates-patterns/#workflow-ajout-auto-start","title":"Workflow Ajout Auto-Start","text":"<pre><code>#!/bin/bash\n# add-to-autostart.sh &lt;service-name&gt; &lt;port&gt;\n\nSERVICE_NAME=$1\nPORT=$2\nDOMAIN=\"${SERVICE_NAME}.srv759970.hstgr.cloud\"\nCONFIG_FILE=\"/opt/docker-autostart/config.json\"\n\n# 1. Modifier docker-compose pour auto-start\ncd /opt/$SERVICE_NAME\nsed -i 's/restart: unless-stopped/restart: \"no\"/' docker-compose.yml\n\n# 2. Ajouter \u00e0 config auto-start\n# (\u00c9diter manuellement /opt/docker-autostart/config.json)\necho \"Ajouter cette entr\u00e9e dans services:\"\ncat &lt;&lt;EOF\n    \"$DOMAIN\": {\n      \"name\": \"$SERVICE_NAME\",\n      \"composeDir\": \"/opt/$SERVICE_NAME\",\n      \"proxyPort\": $PORT,\n      \"idleTimeout\": 900,\n      \"theme\": \"matrix\",\n      \"containers\": [\n        \"$SERVICE_NAME\"\n      ]\n    }\nEOF\n\n# 3. Modifier Nginx pour pointer vers auto-start\nsed -i \"s|proxy_pass http://127.0.0.1:$PORT;|proxy_pass http://127.0.0.1:8890;|\" \\\n    /etc/nginx/sites-available/$SERVICE_NAME\n\n# Ajouter header auto-start\nsed -i \"/location \\/ {/a\\        proxy_set_header X-Autostart-Target \\\"$DOMAIN\\\";\" \\\n    /etc/nginx/sites-available/$SERVICE_NAME\n\n# 4. Red\u00e9marrer services\nnginx -t &amp;&amp; systemctl reload nginx\ncd /opt/docker-autostart &amp;&amp; docker-compose restart\n\necho \"\u2705 Service ajout\u00e9 \u00e0 auto-start\"\n</code></pre>"},{"location":"05-advanced/templates-patterns/#checklist-deploiement","title":"\ud83d\udccb Checklist D\u00e9ploiement","text":""},{"location":"05-advanced/templates-patterns/#avant-deploiement","title":"Avant D\u00e9ploiement","text":"<ul> <li> Port libre: <code>netstat -tlnp | grep &lt;port&gt;</code></li> <li> Image disponible: <code>docker pull &lt;image&gt;</code></li> <li> Espace disque: <code>df -h</code> (&gt;10% libre)</li> <li> RAM disponible: <code>free -h</code> (&lt;25GB utilis\u00e9s)</li> <li> Nom DNS r\u00e9solu: <code>ping &lt;service&gt;.srv759970.hstgr.cloud</code></li> </ul>"},{"location":"05-advanced/templates-patterns/#pendant-deploiement","title":"Pendant D\u00e9ploiement","text":"<ul> <li> Docker-compose valide: <code>docker-compose config</code></li> <li> Service d\u00e9marre: <code>docker-compose up -d</code></li> <li> Healthcheck OK: <code>docker ps | grep &lt;service&gt;</code></li> <li> Port \u00e9coute: <code>netstat -tlnp | grep &lt;port&gt;</code></li> <li> Nginx config valide: <code>nginx -t</code></li> <li> SSL actif: <code>curl -I https://&lt;service&gt;.srv759970.hstgr.cloud</code></li> </ul>"},{"location":"05-advanced/templates-patterns/#apres-deploiement","title":"Apr\u00e8s D\u00e9ploiement","text":"<ul> <li> Logs sans erreur: <code>docker-compose logs</code></li> <li> Service accessible externe</li> <li> Ajouter \u00e0 Dashy dashboard</li> <li> Documentation cr\u00e9\u00e9e dans <code>docs/services/</code></li> <li> Changelog mis \u00e0 jour</li> <li> Backup config: <code>tar -czf /root/backups/&lt;service&gt;-config.tar.gz /opt/&lt;service&gt;</code></li> </ul>"},{"location":"05-advanced/templates-patterns/#patterns-communs","title":"\ud83d\udd27 Patterns Communs","text":""},{"location":"05-advanced/templates-patterns/#pattern-service-avec-queue-redis","title":"Pattern: Service avec Queue Redis","text":"<p>Use case: Transcription, traitement long, jobs asynchrones</p> <p>Composants: 1. API FastAPI (endpoints + soumission jobs) 2. Worker RQ (traitement background) 3. Redis partag\u00e9 (queue)</p> <p>Structure: <pre><code>/opt/&lt;service&gt;/\n\u251c\u2500\u2500 docker-compose.yml      # API + Worker\n\u251c\u2500\u2500 api/\n\u2502   \u251c\u2500\u2500 main.py            # FastAPI app\n\u2502   \u2514\u2500\u2500 tasks.py           # Fonctions RQ\n\u2514\u2500\u2500 worker/\n    \u2514\u2500\u2500 worker.py          # RQ worker\n</code></pre></p> <p>Docker Compose: <pre><code>services:\n  api:\n    build: ./api\n    ports:\n      - \"&lt;port&gt;:8000\"\n    environment:\n      - REDIS_URL=redis://rq-queue-redis:6379/2\n    networks:\n      - whisperx_rq-network  # R\u00e9seau partag\u00e9 Redis\n\n  worker:\n    build: ./worker\n    environment:\n      - REDIS_URL=redis://rq-queue-redis:6379/2\n      - QUEUE_NAME=my-service-queue\n    networks:\n      - whisperx_rq-network\n\nnetworks:\n  whisperx_rq-network:\n    external: true\n</code></pre></p>"},{"location":"05-advanced/templates-patterns/#pattern-wordpress-docker","title":"Pattern: WordPress Docker","text":"<p>Structure: <pre><code>/opt/wordpress-&lt;site&gt;/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 nginx.conf\n\u251c\u2500\u2500 php.ini\n\u2514\u2500\u2500 wp-content/  # Volume persistant\n</code></pre></p> <p>Docker Compose: <pre><code>version: '3.8'\n\nservices:\n  wordpress:\n    image: wordpress:latest\n    container_name: wordpress-&lt;site&gt;\n    restart: unless-stopped\n    environment:\n      - WORDPRESS_DB_HOST=mysql-&lt;site&gt;\n      - WORDPRESS_DB_NAME=&lt;dbname&gt;\n      - WORDPRESS_DB_USER=&lt;user&gt;\n      - WORDPRESS_DB_PASSWORD=&lt;password&gt;\n    volumes:\n      - ./wp-content:/var/www/html/wp-content\n    networks:\n      - &lt;site&gt;-network\n\n  mysql:\n    image: mysql:8.0\n    container_name: mysql-&lt;site&gt;\n    restart: unless-stopped\n    environment:\n      - MYSQL_DATABASE=&lt;dbname&gt;\n      - MYSQL_USER=&lt;user&gt;\n      - MYSQL_PASSWORD=&lt;password&gt;\n      - MYSQL_ROOT_PASSWORD=&lt;root_password&gt;\n    volumes:\n      - mysql-data:/var/lib/mysql\n    networks:\n      - &lt;site&gt;-network\n\n  nginx:\n    image: nginx:alpine\n    container_name: nginx-&lt;site&gt;\n    restart: unless-stopped\n    ports:\n      - \"&lt;port&gt;:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./wp-content:/var/www/html/wp-content:ro\n    depends_on:\n      - wordpress\n    networks:\n      - &lt;site&gt;-network\n\nvolumes:\n  mysql-data:\n\nnetworks:\n  &lt;site&gt;-network:\n</code></pre></p>"},{"location":"05-advanced/templates-patterns/#voir-aussi","title":"\ud83d\udcda Voir Aussi","text":"<ul> <li>Docker Commands Reference</li> <li>Nginx Configuration Reference</li> <li>VPS Initial Setup</li> <li>Docker Autostart Guide</li> </ul> <p>Contributeurs: Julien Fernandez Derni\u00e8re mise \u00e0 jour: 2025-10-27</p>"},{"location":"06-changelog/autostart-v2/","title":"Docker Auto-Start/Stop - Version 2.0","text":"<p>Date: 2025-10-21 Auteur: Claude Code + Julien Fernandez</p>"},{"location":"06-changelog/autostart-v2/#objectifs","title":"\ud83c\udfaf Objectifs","text":"<ol> <li>Auditer la configuration r\u00e9elle vs documentation</li> <li>Impl\u00e9menter mode ASYNC pour les APIs (r\u00e9ponse 202 imm\u00e9diate)</li> <li>Migrer TOUS les services vers auto-start/stop (sauf bases de donn\u00e9es)</li> <li>Inclure Dashy, MkDocs, Nextcloud dans l'autostart</li> <li>Documenter de mani\u00e8re dynamique et fiable</li> </ol>"},{"location":"06-changelog/autostart-v2/#problemes-identifies","title":"\u274c Probl\u00e8mes identifi\u00e9s","text":""},{"location":"06-changelog/autostart-v2/#1-documentation-obsolete","title":"1. Documentation obsol\u00e8te","text":"<p>Sympt\u00f4me: Le config.json listait 12 services mais seulement 2 utilisaient r\u00e9ellement docker-autostart.</p> <p>Cause root: - Le <code>config.json</code> d\u00e9finit ce que docker-autostart PEUT g\u00e9rer - Nginx d\u00e9cide qui l'utilise vraiment (via <code>proxy_pass http://127.0.0.1:8890</code>) - Si Nginx pointe en direct vers le port du service, docker-autostart n'est JAMAIS appel\u00e9 - Le fichier peut contenir des configs de test/migration</p> <p>Services affect\u00e9s: - \u2705 Utilisaient autostart: solidarlink, tika, whisper-faster - \u274c Configur\u00e9s mais non utilis\u00e9s: clemence, dashboard, sharepoint, cristina, whisperx, memvid, ragflow, rag-anything</p>"},{"location":"06-changelog/autostart-v2/#2-mode-blocking-inadapte-pour-les-apis","title":"2. Mode BLOCKING inadapt\u00e9 pour les APIs","text":"<p>Probl\u00e8me: Le mode <code>blocking: true</code> gardait le client en attente pendant le d\u00e9marrage du container.</p> <p>Cons\u00e9quences: - Timeout risqu\u00e9 si d\u00e9marrage &gt; 60s - Pas de feedback au client - Pas de possibilit\u00e9 de retry intelligent</p>"},{"location":"06-changelog/autostart-v2/#solutions-implementees","title":"\u2705 Solutions impl\u00e9ment\u00e9es","text":""},{"location":"06-changelog/autostart-v2/#1-mode-async-pour-les-apis","title":"1. Mode ASYNC pour les APIs","text":"<p>Nouveau comportement (<code>async: true</code>):</p> <pre><code>// Requ\u00eate vers API arr\u00eat\u00e9e\nGET /api/endpoint\n\n// R\u00e9ponse imm\u00e9diate HTTP 202\nHTTP/2 202 Accepted\nRetry-After: 30\nContent-Type: application/json\n\n{\n  \"status\": \"starting\",\n  \"message\": \"Service WhisperX API is starting. Please retry in 30 seconds.\",\n  \"service\": \"WhisperX API (with diarization)\",\n  \"estimatedTime\": 30,\n  \"retryAfter\": 30,\n  \"healthCheckUrl\": \"/health/whisperx.srv759970.hstgr.cloud\"\n}\n</code></pre> <p>Avantages: - \u2705 R\u00e9ponse imm\u00e9diate au client (pas de timeout) - \u2705 Header <code>Retry-After</code> standard HTTP - \u2705 HealthCheck URL pour polling - \u2705 Service d\u00e9marre en arri\u00e8re-plan - \u2705 Client peut impl\u00e9menter retry logic intelligent</p>"},{"location":"06-changelog/autostart-v2/#2-migration-complete-de-18-services","title":"2. Migration compl\u00e8te de 18 services","text":"<p>Services migr\u00e9s vers auto-start/stop:</p>"},{"location":"06-changelog/autostart-v2/#applications-web-10-mode-dynamic-avec-theme","title":"Applications Web (10) - Mode Dynamic avec th\u00e8me","text":"<ol> <li>solidarlink - Theme: hacker-terminal</li> <li>clemence - Theme: ghost</li> <li>jesuishyperphagique - Theme: ghost</li> <li>panneauxsolidaires - Theme: matrix</li> <li>dashboard (Support Dashboard) - Theme: matrix</li> <li>sharepoint (SharePoint Dashboards) - Theme: shuffle</li> <li>strapi (Cristina CMS) - Theme: ghost</li> <li>dashy (Portal) - Theme: cyberpunk \u2b50 NOUVEAU</li> <li>docs (MkDocs) - Theme: matrix \u2b50 NOUVEAU</li> <li>memvid-ui - Theme: matrix</li> </ol>"},{"location":"06-changelog/autostart-v2/#apis-8-mode-async","title":"APIs (8) - Mode ASYNC","text":"<ol> <li>whisper (faster-whisper) - Port 8001</li> <li>whisperx - Port 8002</li> <li>faster-whisper-queue - Port 8003</li> <li>tika - Port 9998</li> <li>memvid - Port 8506</li> <li>ragflow - Port 9500</li> <li>rag-anything - Port 9510</li> <li>tika - Port 9998</li> </ol> <p>Note: Nextcloud configur\u00e9 dans config.json mais pas de site Nginx (\u00e0 investiguer).</p>"},{"location":"06-changelog/autostart-v2/#3-mise-a-jour-nginx-automatisee","title":"3. Mise \u00e0 jour Nginx automatis\u00e9e","text":"<p>Script cr\u00e9\u00e9: <code>/tmp/update-nginx-for-autostart.sh</code></p> <p>Actions: - \u2705 Backup de toutes les configs Nginx - \u2705 Remplacement <code>proxy_pass http://localhost:XXXX</code> \u2192 <code>proxy_pass http://127.0.0.1:8890</code> - \u2705 Ajout header <code>X-Autostart-Target</code> pour routage - \u2705 Test <code>nginx -t</code> avant application - \u2705 15 sites Nginx migr\u00e9s avec succ\u00e8s</p>"},{"location":"06-changelog/autostart-v2/#4-documentation-dynamique","title":"4. Documentation dynamique","text":"<p>Script de synchronisation: <code>scripts/sync-autostart-config.sh</code></p> <p>Fonctionnalit\u00e9s: - R\u00e9cup\u00e8re config.json depuis <code>/opt/docker-autostart/config.json</code> - G\u00e9n\u00e8re automatiquement le tableau markdown - Met \u00e0 jour les statistiques - Commit automatique avec <code>--commit</code> - Peut \u00eatre ex\u00e9cut\u00e9 en cron pour sync quotidien</p> <p>Fichiers g\u00e9n\u00e9r\u00e9s: - <code>server-configs/docker-autostart/config.json</code> (snapshot) - <code>docs/services/docker-autostart-config.md</code> (documentation)</p>"},{"location":"06-changelog/autostart-v2/#statistiques-finales","title":"\ud83d\udcca Statistiques finales","text":"M\u00e9trique Valeur Services totaux 18 Mode Dynamic 10 (applications web avec th\u00e8mes) Mode ASYNC 8 (APIs avec r\u00e9ponse 202) Idle timeout 1800s (30 minutes) Port proxy 8890 Th\u00e8mes utilis\u00e9s 5 (cyberpunk, ghost \u00d73, hacker-terminal, matrix \u00d74, shuffle \u00d72)"},{"location":"06-changelog/autostart-v2/#tests-effectues","title":"\ud83e\uddea Tests effectu\u00e9s","text":""},{"location":"06-changelog/autostart-v2/#test-1-dashy-auto-start-mode-dynamic","title":"Test 1: Dashy auto-start (Mode Dynamic)","text":"<pre><code># Arr\u00eat du service\ndocker-compose -f /opt/dashy/docker-compose.yml stop\n\n# Requ\u00eate HTTP\ncurl -I https://dashy.srv759970.hstgr.cloud\n# \u2192 HTTP/2 200 + Page HTML avec th\u00e8me cyberpunk\n\n# V\u00e9rification apr\u00e8s 10s\ndocker ps --filter name=dashy\n# \u2192 dashy   Up 17 seconds (healthy)\n</code></pre> <p>\u2705 R\u00e9sultat: Page d'attente anim\u00e9e affich\u00e9e, conteneur d\u00e9marr\u00e9 automatiquement</p>"},{"location":"06-changelog/autostart-v2/#test-2-whisperx-api-auto-start-mode-async","title":"Test 2: WhisperX API auto-start (Mode ASYNC)","text":"<pre><code># Arr\u00eat du service\ndocker-compose -f /opt/whisperx/docker-compose.yml stop whisperx\n\n# Requ\u00eate API\ncurl -i https://whisperx.srv759970.hstgr.cloud\n# \u2192 HTTP/2 202 Accepted\n# \u2192 Retry-After: 30\n# \u2192 JSON avec message et healthCheckUrl\n\n# V\u00e9rification apr\u00e8s 30s\ndocker ps --filter name=whisperx\n# \u2192 whisperx   Up 43 seconds (healthy)\n</code></pre> <p>\u2705 R\u00e9sultat: R\u00e9ponse 202 imm\u00e9diate, service d\u00e9marr\u00e9 en 30s, healthcheck OK</p>"},{"location":"06-changelog/autostart-v2/#fichiers-modifiescrees","title":"\ud83d\udcc1 Fichiers modifi\u00e9s/cr\u00e9\u00e9s","text":""},{"location":"06-changelog/autostart-v2/#serveur","title":"Serveur","text":"<ul> <li><code>/opt/docker-autostart/server.js</code> - Ajout mode ASYNC</li> <li><code>/opt/docker-autostart/config.json</code> - 18 services configur\u00e9s</li> <li><code>/etc/nginx/sites-available/*</code> - 15 sites migr\u00e9s (backups cr\u00e9\u00e9s)</li> </ul>"},{"location":"06-changelog/autostart-v2/#repo-local","title":"Repo local","text":"<ul> <li><code>server-configs/docker-autostart/server.js</code> - Code avec mode ASYNC</li> <li><code>server-configs/docker-autostart/config.json</code> - Configuration finale</li> <li><code>scripts/sync-autostart-config.sh</code> - Script de synchronisation</li> <li><code>docs/services/docker-autostart-config.md</code> - Documentation mise \u00e0 jour</li> <li><code>docs/CHANGELOG_AUTOSTART_V2.md</code> - Ce fichier</li> </ul>"},{"location":"06-changelog/autostart-v2/#ameliorations-du-code","title":"\ud83d\udd27 Am\u00e9liorations du code","text":""},{"location":"06-changelog/autostart-v2/#ajout-estimations-de-demarrage","title":"Ajout estimations de d\u00e9marrage","text":"<pre><code>const STARTUP_ESTIMATES = {\n  'whisper': 30,\n  'whisperx': 30,\n  'tika': 20,\n  'wordpress': 25,\n  'strapi': 20,\n  'streamlit': 15,\n  'dashy': 10,      // \u2190 NOUVEAU\n  'mkdocs': 5,      // \u2190 NOUVEAU\n  'nextcloud': 20,  // \u2190 NOUVEAU\n  'memvid': 15,     // \u2190 NOUVEAU\n  'ragflow': 45,    // \u2190 NOUVEAU\n  'rag-anything': 20, // \u2190 NOUVEAU\n  'default': 30\n};\n</code></pre>"},{"location":"06-changelog/autostart-v2/#nouveau-mode-async","title":"Nouveau mode ASYNC","text":"<pre><code>if (service.mode === 'async' || service.async) {\n  // ASYNC mode (for APIs): return 202 immediately with retry info\n  const retryAfter = getEstimatedStartupTime(service.name);\n  res.status(202)\n     .header('Retry-After', retryAfter.toString())\n     .json({\n       status: 'starting',\n       message: `Service ${service.name} is starting. Please retry in ${retryAfter} seconds.`,\n       service: service.name,\n       estimatedTime: retryAfter,\n       retryAfter: retryAfter,\n       healthCheckUrl: `/health/${host}`\n     });\n}\n</code></pre>"},{"location":"06-changelog/autostart-v2/#deploiement","title":"\ud83d\ude80 D\u00e9ploiement","text":""},{"location":"06-changelog/autostart-v2/#1-backup-et-deploiement","title":"1. Backup et d\u00e9ploiement","text":"<pre><code># Backups automatiques cr\u00e9\u00e9s\n/opt/docker-autostart/server.js.backup_20251021_110619\n/opt/docker-autostart/config.json.backup_20251021_110619\n\n# Nginx configs backup\u00e9es\n/etc/nginx/sites-available/*.backup_autostart_20251021\n</code></pre>"},{"location":"06-changelog/autostart-v2/#2-redemarrage-services","title":"2. Red\u00e9marrage services","text":"<pre><code>systemctl restart docker-autostart\nsystemctl reload nginx\n\n# Logs\njournalctl -u docker-autostart -f\n</code></pre>"},{"location":"06-changelog/autostart-v2/#3-verification","title":"3. V\u00e9rification","text":"<pre><code># Status\nsystemctl status docker-autostart\n\n# Test health check\ncurl http://localhost:8890/api/services | jq\n</code></pre>"},{"location":"06-changelog/autostart-v2/#documentation","title":"\ud83d\udcda Documentation","text":""},{"location":"06-changelog/autostart-v2/#guides-mis-a-jour","title":"Guides mis \u00e0 jour","text":"<ul> <li>\u2705 <code>docs/services/docker-autostart-config.md</code> - Configuration compl\u00e8te avec modes</li> <li>\u2705 <code>server-configs/README.md</code> - Ajout section docker-autostart</li> <li>\u2705 <code>mkdocs.yml</code> - Ajout dans navigation</li> </ul>"},{"location":"06-changelog/autostart-v2/#commandes-utiles","title":"Commandes utiles","text":"<p>Synchroniser la config depuis le serveur: <pre><code>./scripts/sync-autostart-config.sh\n</code></pre></p> <p>Synchroniser et committer: <pre><code>./scripts/sync-autostart-config.sh --commit\n</code></pre></p> <p>Tester un service: <pre><code># Arr\u00eater\ndocker-compose -f /opt/SERVICE/docker-compose.yml stop\n\n# Acc\u00e9der via navigateur ou curl\ncurl -I https://SERVICE.srv759970.hstgr.cloud\n\n# V\u00e9rifier d\u00e9marrage\ndocker logs -f CONTAINER_NAME\n</code></pre></p>"},{"location":"06-changelog/autostart-v2/#lecons-apprises","title":"\ud83c\udf93 Le\u00e7ons apprises","text":""},{"location":"06-changelog/autostart-v2/#1-source-de-verite","title":"1. Source de v\u00e9rit\u00e9","text":"<p>\u274c Faux: <code>config.json</code> = \u00e9tat r\u00e9el du syst\u00e8me \u2705 Vrai: Nginx configs = routage r\u00e9el, config.json = capacit\u00e9s du proxy</p>"},{"location":"06-changelog/autostart-v2/#2-verification-en-3-etapes","title":"2. V\u00e9rification en 3 \u00e9tapes","text":"<ol> <li>Nginx (<code>/etc/nginx/sites-enabled/*</code>) \u2192 Qui utilise autostart ?</li> <li>config.json \u2192 Que peut g\u00e9rer autostart ?</li> <li>Docker (<code>docker ps</code>) \u2192 Qu'est-ce qui tourne ?</li> </ol>"},{"location":"06-changelog/autostart-v2/#3-audit-script-indispensable","title":"3. Audit script indispensable","text":"<p>Cr\u00e9er des scripts d'audit qui croisent les 3 sources: - Nginx proxy_pass - config.json services - Docker containers running</p>"},{"location":"06-changelog/autostart-v2/#4-cache-nginx-autostart-incompatible","title":"4. Cache Nginx + Autostart = INCOMPATIBLE","text":"<p>Probl\u00e8me: Le cache Nginx sert du contenu statique m\u00eame quand les conteneurs sont arr\u00eat\u00e9s R\u00e9sultat: docker-autostart n'est JAMAIS appel\u00e9, les conteneurs restent arr\u00eat\u00e9s Solution: TOUJOURS d\u00e9sactiver <code>proxy_cache</code> pour les services utilisant autostart</p>"},{"location":"06-changelog/autostart-v2/#5-debug-methodique-des-problemes-de-proxy","title":"5. Debug m\u00e9thodique des probl\u00e8mes de proxy","text":"<p>Quand une page incorrecte persiste malgr\u00e9 les changements: 1. Test direct backend (<code>curl localhost:8890 -H 'Host: ...'</code>) - Isole le probl\u00e8me 2. Si backend OK mais HTTPS KO \u2192 Probl\u00e8me dans Nginx 3. V\u00e9rifier modules globaux (<code>/etc/nginx/nginx.conf</code>) - Pas seulement vhosts 4. Reload effectif - Parfois plusieurs reload n\u00e9cessaires pour processus workers</p>"},{"location":"06-changelog/autostart-v2/#6-wordpress-moderne-avec-wp-cli","title":"6. WordPress moderne avec WP-CLI","text":"<p>Architecture recommand\u00e9e 2025: - WordPress FPM (pas Apache) pour meilleures performances - Nginx avec FastCGI vers PHP-FPM - WP-CLI pour installation/gestion automatis\u00e9e - Conteneurs s\u00e9par\u00e9s: MySQL, WordPress, Nginx, WP-CLI - <code>restart: \"no\"</code> pour compatibilit\u00e9 autostart</p>"},{"location":"06-changelog/autostart-v2/#finalisation-2025-10-21-suite","title":"\u2705 Finalisation - 2025-10-21 (Suite)","text":""},{"location":"06-changelog/autostart-v2/#deploiement-des-conteneurs-manquants","title":"D\u00e9ploiement des conteneurs manquants","text":"<p>Probl\u00e8me identifi\u00e9: De nombreux services n'avaient jamais eu leurs conteneurs cr\u00e9\u00e9s.</p> <p>Action: Script de cr\u00e9ation automatique de tous les conteneurs manquants: <pre><code>/tmp/create-missing-containers.sh\n</code></pre></p> <p>Services d\u00e9ploy\u00e9s (containers cr\u00e9\u00e9s et arr\u00eat\u00e9s pour autostart): 1. \u2705 Support Dashboard (Streamlit) - Image built, containers created 2. \u2705 SharePoint Dashboards (Streamlit) - Containers created 3. \u2705 Cristina Strapi CMS - Containers created 4. \u2705 RAGFlow (with docker-compose-full.yml) - 5 containers created (server, MySQL, Redis, Elasticsearch, MinIO) 5. \u2705 SolidarLink - Compl\u00e8tement reconstruit (voir section ci-dessous)</p> <p>Note importante: Les conteneurs sont cr\u00e9\u00e9s puis imm\u00e9diatement arr\u00eat\u00e9s. C'est le comportement attendu pour docker-autostart - ils seront d\u00e9marr\u00e9s automatiquement lors de la premi\u00e8re requ\u00eate HTTP.</p>"},{"location":"06-changelog/autostart-v2/#reconstruction-complete-de-solidarlink","title":"Reconstruction compl\u00e8te de SolidarLink","text":"<p>Contexte: SolidarLink \u00e9tait compromis (\"v\u00e9rol\u00e9\") et n\u00e9cessitait une reconstruction compl\u00e8te.</p> <p>Actions effectu\u00e9es: 1. Backup et suppression de l'ancien site:    - Ancien dossier renomm\u00e9 en <code>wordpress-solidarlink.old_TIMESTAMP</code>    - Base de donn\u00e9es conserv\u00e9e mais non r\u00e9utilis\u00e9e</p> <ol> <li> <p>Cr\u00e9ation nouveau stack WordPress moderne:    <pre><code>- MySQL 8.0 (nouveau container d\u00e9di\u00e9)\n- WordPress php8.3-fpm (architecture moderne)\n- Nginx Alpine (FastCGI vers PHP-FPM)\n- WP-CLI php8.3 (pour installation automatis\u00e9e)\n</code></pre></p> </li> <li> <p>Installation WordPress via WP-CLI:    <pre><code>docker exec wp-cli-solidarlink wp core install \\\n  --url='https://solidarlink.srv759970.hstgr.cloud' \\\n  --title='SolidarLink' \\\n  --admin_user='admin' \\\n  --admin_password='SolidarLinkAdmin2025!' \\\n  --admin_email='julien@julienfernandez.xyz'\n</code></pre></p> </li> <li> <p>Configuration pour autostart:</p> </li> <li><code>restart: \"no\"</code> sur tous les conteneurs</li> <li>Port 9003 maintenu</li> <li>Theme \"hacker-terminal\" configur\u00e9</li> </ol> <p>Fichiers cr\u00e9\u00e9s: - <code>/opt/wordpress-solidarlink/docker-compose.yml</code> - Stack complet - <code>/opt/wordpress-solidarlink/nginx.conf</code> - Config FastCGI - Volumes Docker: <code>wordpress-data</code> et <code>mysql-data</code></p> <p>Identifiants admin: - URL: https://solidarlink.srv759970.hstgr.cloud/wp-admin - User: admin - Password: SolidarLinkAdmin2025!</p>"},{"location":"06-changelog/autostart-v2/#desactivation-complete-du-systeme-sablier","title":"D\u00e9sactivation compl\u00e8te du syst\u00e8me Sablier","text":"<p>Probl\u00e8me d\u00e9couvert: Malgr\u00e9 la suppression du cache Nginx et la reconstruction de SolidarLink, les pages Sablier persistaient.</p> <p>Investigation en profondeur: 1. Test direct docker-autostart (<code>:8890</code>) \u2192 \u2705 Retournait WordPress correctement 2. Test via HTTPS Nginx \u2192 \u274c Retournait toujours page Sablier 3. Conclusion: Le probl\u00e8me \u00e9tait dans la couche Nginx, pas dans docker-autostart</p> <p>Root cause identifi\u00e9e: Module JavaScript Sablier charg\u00e9 globalement dans Nginx - Fichier: <code>/etc/nginx/conf.d/sablier.js</code> (ancien syst\u00e8me Sablier) - Import global: <code>/etc/nginx/nginx.conf</code> ligne 13: <code>js_import conf.d/sablier.js;</code> - Ce module interceptait les requ\u00eates AVANT qu'elles n'atteignent docker-autostart</p> <p>Solution appliqu\u00e9e: <pre><code># Comment\u00e9 l'import global du module Sablier\nsed -i '13s/^/# /' /etc/nginx/nginx.conf\n# Ligne 13: js_import conf.d/sablier.js;  \u2192  # js_import conf.d/sablier.js;\n\n# Reload Nginx\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre></p> <p>R\u00e9sultat: - \u2705 SolidarLink fonctionne via HTTPS (WordPress affich\u00e9) - \u2705 Clemence fonctionne \u00e9galement - \u2705 Syst\u00e8me docker-autostart op\u00e9rationnel pour tous les services</p> <p>Fichiers modifi\u00e9s: - <code>/etc/nginx/nginx.conf</code> - Ligne 13 comment\u00e9e (Sablier d\u00e9sactiv\u00e9 globalement) - <code>/etc/nginx/sites-available/solidarlink</code> - Cache Nginx compl\u00e8tement supprim\u00e9 - <code>/etc/nginx/sites-available/clemence</code> - Cache Nginx compl\u00e8tement supprim\u00e9 - <code>/opt/wordpress-solidarlink/docker-compose.yml</code> - Nouveau stack sans Sablier - <code>/opt/tika-server/docker-compose.yml</code> - R\u00e9\u00e9crit sans Sablier</p> <p>Commits Git: - <code>9b21415</code> - docker autostart server.js improvements - <code>76b22a4</code> - remove obsolete Sablier references from docker-compose</p>"},{"location":"06-changelog/autostart-v2/#ajout-headers-nginx-manquants","title":"Ajout headers Nginx manquants","text":"<p>Probl\u00e8me: 17 sites Nginx utilisaient <code>proxy_pass http://127.0.0.1:8890</code> mais sans le header <code>X-Autostart-Target</code></p> <p>Solution: Script automatique d'ajout des headers: <pre><code>/tmp/add-autostart-headers.sh\n</code></pre></p> <p>R\u00e9sultat: 17 sites Nginx mis \u00e0 jour avec le bon header de routage</p>"},{"location":"06-changelog/autostart-v2/#prochaines-etapes-optionnel","title":"\ud83d\udd2e Prochaines \u00e9tapes (optionnel)","text":"<ol> <li>Nextcloud: Investiguer pourquoi pas de site Nginx, ajouter si n\u00e9cessaire</li> <li>Tests complets: Re-tester tous les 18 services autostart</li> <li>Monitoring: Ajouter m\u00e9triques Prometheus pour autostart (temps de d\u00e9marrage, requ\u00eates 202, etc.)</li> <li>Alerting: Notifier si un service ne d\u00e9marre pas apr\u00e8s N tentatives</li> <li>Cron sync: Automatiser <code>sync-autostart-config.sh</code> en daily cron</li> <li>Health checks avanc\u00e9s: V\u00e9rifier endpoints applicatifs, pas juste containers running</li> <li>Backup automatique: Sauvegarder volumes WordPress avant modifications (lesson learned)</li> </ol> <p>Version: 2.0.2 Status: \u2705 PROD Deployed: \u2705 18 services configur\u00e9s, tous conteneurs cr\u00e9\u00e9s Tested: \u2705 SolidarLink, Clemence, Dashy, WhisperX, MkDocs (5/18) Issues r\u00e9solus: - \u2705 Sablier compl\u00e8tement d\u00e9sactiv\u00e9 - \u2705 Cache Nginx incompatible document\u00e9 et supprim\u00e9 - \u2705 SolidarLink reconstruit from scratch Documentation: \u2705 Compl\u00e8te et synchronis\u00e9e avec toutes les le\u00e7ons apprises Commits \u00e0 faire: - Sync server-configs (docker-compose.yml SolidarLink) - Update changelog (ce fichier) Commits pr\u00e9c\u00e9dents: - <code>9b21415</code> - docker autostart improvements - <code>76b22a4</code> - remove Sablier references</p>"},{"location":"06-changelog/bot-protection-2025-10-23/","title":"\ud83d\udee1\ufe0f D\u00e9ploiement Protection Anti-Bots &amp; Optimisation Auto-Start","text":"<p>Date : 23 octobre 2025 Statut : \u2705 D\u00e9ploy\u00e9 en production</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#resume","title":"\ud83d\udccb R\u00e9sum\u00e9","text":"<p>D\u00e9ploiement d'une protection nginx contre les scans automatiques de bots qui emp\u00eachaient le syst\u00e8me docker-autostart de fonctionner correctement. Les services lourds en RAM (RAGFlow, XTTS, Paperless) ne s'arr\u00eataient jamais car constamment sollicit\u00e9s par des bots.</p> <p>R\u00e9sultats attendus : - R\u00e9duction des requ\u00eates de bots de ~80% - Auto-stop fonctionnel apr\u00e8s 15 min d'inactivit\u00e9 r\u00e9elle - \u00c9conomie potentielle : ~10.3 GB RAM (sur 16 GB total)</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#probleme-identifie","title":"\ud83d\udd0d Probl\u00e8me Identifi\u00e9","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#scans-de-bots-observes-dans-les-logs","title":"Scans de bots observ\u00e9s dans les logs","text":"<p>1. WordPress Cl\u00e9mence - Attaque xmlrpc.php : <pre><code>34.29.224.209 (Google Cloud)\nPOST //xmlrpc.php HTTP/1.1\n20+ requ\u00eates en 1 seconde\nToutes les 2-3 minutes\n</code></pre></p> <p>2. Nextcloud - Scan fichiers .env : <pre><code>44.251.145.131 (AWS)\nGET /.env, /.env.local, /.env.dev, /.env.prod, etc.\n20 variantes test\u00e9es syst\u00e9matiquement\n</code></pre></p> <p>3. Domaine principal - LeakIX scanner : <pre><code>178.128.207.138 (DigitalOcean)\nUser-Agent: l9scan/2.0 (LeakIX)\nGET /.git/config, /.env, /.DS_Store, /config.json\nToutes les 2-3 minutes\n</code></pre></p>"},{"location":"06-changelog/bot-protection-2025-10-23/#impact-sur-docker-autostart","title":"Impact sur docker-autostart","text":"<pre><code>15:00:00 - Service arr\u00eat\u00e9 (idle)\n15:02:37 - Bot teste /.git/config \u2192 Service se r\u00e9veille \u2192 Timer reset\n15:05:12 - Bot teste /admin \u2192 Timer reset\n15:07:45 - Shodan scan \u2192 Timer reset\n\n\u274c R\u00e9sultat : Service ne reste JAMAIS idle assez longtemps\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#solution-deployee","title":"\u2705 Solution D\u00e9ploy\u00e9e","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#1-protection-nginx-anti-bots","title":"1. Protection nginx anti-bots","text":"<p>Fichier : <code>/etc/nginx/snippets/bot-protection.conf</code></p> <p>Bloque : - Fichiers cach\u00e9s : <code>/.git</code>, <code>/.env</code>, <code>/.DS_Store</code> - WordPress : <code>/xmlrpc.php</code>, <code>/wp-admin</code>, <code>/wp-login.php</code> - Admin panels : <code>/phpmyadmin</code>, <code>/adminer</code>, <code>/admin</code> - Fichiers config : <code>/config.json</code>, <code>/composer.json</code>, <code>/package.json</code> - Scanners connus : LeakIX, Shodan, Censys, Nikto, sqlmap</p> <p>D\u00e9ploiement : - \u2705 70 vhosts nginx mis \u00e0 jour - \u2705 Configuration valid\u00e9e - \u2705 Nginx recharg\u00e9</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#2-timeouts-docker-autostart-optimises","title":"2. Timeouts docker-autostart optimis\u00e9s","text":"<p>Avant : - Global : 1800s (30 min) - Services lourds : 1800s (30 min)</p> <p>Apr\u00e8s : - Global : 1800s (30 min) - inchang\u00e9 - Services lourds : 900s (15 min) \u26a1</p> <p>Services avec timeout 15 min : 1. RAGFlow + Elasticsearch (~6.5 GB) 2. XTTS Text-to-Speech (~2.5 GB) 3. Paperless-ngx (~1.3 GB) 4. MemVid API (~490 MB) 5. Nextcloud (~130 MB) 6. Jitsi Meet (~220 MB) 7. WordPress SolidarLink 8. WordPress Cl\u00e9mence 9. WordPress Je Suis Hyperphagique 10. WordPress Panneaux Solidaires</p> <p>Backup config : <code>/opt/docker-autostart/config.json.backup-20251023-160503</code></p>"},{"location":"06-changelog/bot-protection-2025-10-23/#metriques-avantapres","title":"\ud83d\udcca M\u00e9triques Avant/Apr\u00e8s","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#etat-avant-deploiement","title":"\u00c9tat AVANT d\u00e9ploiement","text":"<pre><code>Services \"Up 2 days\" (jamais arr\u00eat\u00e9s) :\n- ragflow-server : 1.868 GiB\n- ragflow-es-01 : 4.339 GiB\n- xtts-api : 2.523 GiB\n- memvid-api : 481.6 MiB\n- nextcloud : 151.2 MiB\n\nRAM : 14Gi/15Gi utilis\u00e9e (93%)\nContainers running : 41/64\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#etat-apres-redemarrage-serveur","title":"\u00c9tat APR\u00c8S red\u00e9marrage serveur","text":"<pre><code>Tous services red\u00e9marr\u00e9s (Up 56 seconds)\nServices d\u00e9marrent \u00e0 la demande\nTimeout 15 min actif\nBot protection active\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#verification-dans-24h","title":"V\u00e9rification dans 24h","text":"<p>Pour v\u00e9rifier l'efficacit\u00e9 : <pre><code>ssh root@69.62.108.82 \"bash /opt/scripts/check-autostart-status.sh\"\n</code></pre></p> <p>Attendu : - Services lourds arr\u00eat\u00e9s si pas utilis\u00e9s - RAM libre : 5-10 GB - Logs nginx : requ\u00eates bots bloqu\u00e9es (403/404)</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#scripts-deployes","title":"\ud83d\udd27 Scripts D\u00e9ploy\u00e9s","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#optscriptsdeploy-bot-protectionsh","title":"<code>/opt/scripts/deploy-bot-protection.sh</code>","text":"<p>D\u00e9ploie la protection anti-bots sur tous les vhosts nginx.</p> <p>Usage : <pre><code>bash /opt/scripts/deploy-bot-protection.sh\n</code></pre></p>"},{"location":"06-changelog/bot-protection-2025-10-23/#optscriptsset-autostart-timeoutsh","title":"<code>/opt/scripts/set-autostart-timeout.sh</code>","text":"<p>Modifie les timeouts des services lourds.</p> <p>Usage : <pre><code>bash /opt/scripts/set-autostart-timeout.sh &lt;seconds&gt;\n\n# Exemples :\nbash /opt/scripts/set-autostart-timeout.sh 180   # 3 min (test)\nbash /opt/scripts/set-autostart-timeout.sh 900   # 15 min (prod)\nbash /opt/scripts/set-autostart-timeout.sh 1800  # 30 min (d\u00e9faut)\n</code></pre></p>"},{"location":"06-changelog/bot-protection-2025-10-23/#optscriptscheck-autostart-statussh","title":"<code>/opt/scripts/check-autostart-status.sh</code>","text":"<p>V\u00e9rifie le statut et la RAM des services auto-start.</p> <p>Usage : <pre><code>bash /opt/scripts/check-autostart-status.sh\n</code></pre></p>"},{"location":"06-changelog/bot-protection-2025-10-23/#tests-de-validation","title":"\ud83e\uddea Tests de Validation","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#1-verifier-le-blocage-des-bots","title":"1. V\u00e9rifier le blocage des bots","text":"<pre><code># Tester depuis l'ext\u00e9rieur\ncurl https://ragflow.srv759970.hstgr.cloud/.git/config\n# Attendu : 404 Not Found\n\ncurl https://clemence.srv759970.hstgr.cloud/xmlrpc.php\n# Attendu : 404 Not Found\n\n# Voir les requ\u00eates bloqu\u00e9es dans les logs\nssh root@69.62.108.82 \"tail -f /var/log/nginx/*error.log | grep denied\"\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#2-verifier-lauto-stop","title":"2. V\u00e9rifier l'auto-stop","text":"<pre><code># Laisser un service idle pendant 20 minutes\n# V\u00e9rifier qu'il s'arr\u00eate bien\n\nssh root@69.62.108.82 \"docker ps | grep ragflow\"\n# Attendu apr\u00e8s 15 min idle : aucun r\u00e9sultat\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#3-verifier-la-ram-disponible","title":"3. V\u00e9rifier la RAM disponible","text":"<pre><code>ssh root@69.62.108.82 \"free -h\"\n# Attendu : 5-10 GB disponibles si services lourds arr\u00eat\u00e9s\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#fichiers-modifies","title":"\ud83d\udcdd Fichiers Modifi\u00e9s","text":"<p>Locaux (repo) : - <code>nginx-bot-protection.conf</code> (nouveau) - <code>deploy-bot-protection.sh</code> (nouveau) - <code>docs/BOT_PROTECTION_DEPLOYMENT.md</code> (nouveau)</p> <p>Serveur : - <code>/etc/nginx/snippets/bot-protection.conf</code> (nouveau) - <code>/etc/nginx/sites-available/*</code> (70 vhosts modifi\u00e9s) - <code>/opt/docker-autostart/config.json</code> (timeouts 900s) - <code>/opt/scripts/deploy-bot-protection.sh</code> (nouveau) - <code>/opt/scripts/set-autostart-timeout.sh</code> (existant, utilis\u00e9) - <code>/opt/scripts/check-autostart-status.sh</code> (existant, utilis\u00e9)</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#rollback-si-necessaire","title":"\ud83d\udd04 Rollback si N\u00e9cessaire","text":"<p>Si probl\u00e8me, restaurer la config pr\u00e9c\u00e9dente :</p> <pre><code># Restaurer config docker-autostart\nssh root@69.62.108.82\ncp /opt/docker-autostart/config.json.backup-20251023-160503 \\\n   /opt/docker-autostart/config.json\nsystemctl restart docker-autostart\n\n# Retirer bot protection des vhosts\ncd /etc/nginx/sites-available\nfor f in *; do\n    sed -i '/bot-protection.conf/d' \"$f\"\ndone\nnginx -t &amp;&amp; systemctl reload nginx\n</code></pre>"},{"location":"06-changelog/bot-protection-2025-10-23/#monitoring-recommande","title":"\ud83d\udcc8 Monitoring Recommand\u00e9","text":""},{"location":"06-changelog/bot-protection-2025-10-23/#dashboards-grafana","title":"Dashboards Grafana","text":"<p>Ajouter m\u00e9triques : - Nombre de requ\u00eates 403/404 par vhost (bots bloqu\u00e9s) - RAM libre au fil du temps - Nombre de conteneurs running</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#alertes","title":"Alertes","text":"<p>Configurer alerte si : - RAM libre &lt; 2GB pendant &gt; 30 min - Services lourds up &gt; 24h cons\u00e9cutives</p>"},{"location":"06-changelog/bot-protection-2025-10-23/#prochaines-etapes-optionnel","title":"\ud83c\udfaf Prochaines \u00c9tapes (Optionnel)","text":"<ol> <li>Fail2Ban pour bots agressifs</li> <li>Bannir IPs avec &gt; 10 req/min sur chemins bloqu\u00e9s</li> <li> <p>Dur\u00e9e : 24h</p> </li> <li> <p>Rate limiting nginx <pre><code>limit_req_zone $binary_remote_addr zone=bot:10m rate=5r/m;\nlimit_req zone=bot burst=10 nodelay;\n</code></pre></p> </li> <li> <p>Augmenter limites SSH <pre><code># /etc/ssh/sshd_config\nMaxStartups 30:30:60\nMaxSessions 30\n</code></pre></p> </li> <li> <p>Cloudflare Bot Management</p> </li> <li>Activer \"Bot Fight Mode\"</li> <li>Challenge JS pour requ\u00eates suspectes</li> </ol>"},{"location":"06-changelog/bot-protection-2025-10-23/#references","title":"\ud83d\udcda R\u00e9f\u00e9rences","text":"<ul> <li>Logs nginx : <code>/var/log/nginx/*-access.log</code></li> <li>Config docker-autostart : <code>/opt/docker-autostart/config.json</code></li> <li>Scripts monitoring : <code>/opt/scripts/</code></li> <li>Documentation : <code>docs/services/docker-autostart-config.md</code></li> </ul> <p>\ud83e\udd16 G\u00e9n\u00e9r\u00e9 avec Claude Code</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/","title":"Fix Dashy Status Checks &amp; Auto-Stop - 2025-10-24","text":"<p>Date: 24 octobre 2025 Auteur: Claude + Julien Statut: \u2705 R\u00e9solu Priorit\u00e9: Haute</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#probleme-identifie","title":"Probl\u00e8me Identifi\u00e9","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#symptome","title":"Sympt\u00f4me","text":"<p>L'auto-stop Docker ne fonctionnait pas : les services restaient actifs m\u00eame apr\u00e8s 15 minutes d'inactivit\u00e9.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#diagnostic","title":"Diagnostic","text":"<ul> <li>Cause principale: Dashy g\u00e9n\u00e9rait des requ\u00eates <code>axios/1.12.0</code> toutes les 60 secondes vers TOUS les services</li> <li>Impact: Chaque requ\u00eate r\u00e9initialisait le compteur idle des services</li> <li>R\u00e9sultat: Impossible d'atteindre le timeout de 15 minutes pour d\u00e9clencher l'auto-stop</li> </ul>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#analyse-du-trafic","title":"Analyse du trafic","text":"<pre><code>Statistiques (1 heure) :\n- Total requ\u00eates Cl\u00e9mence : 100\n- Requ\u00eates axios (Dashy) : 68 (68%)\n- Requ\u00eates bots externes : 13 (13%)\n- Requ\u00eates humaines : 19 (19%)\n- Fr\u00e9quence axios : Toutes les 60 secondes\n</code></pre> <p>Source des requ\u00eates : - IP <code>172.30.0.2</code> / <code>172.26.0.2</code> \u2192 Container Dashy - User-Agent : <code>axios/1.12.0</code></p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#solution-appliquee","title":"Solution Appliqu\u00e9e","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#1-recherche-documentation-officielle","title":"1. Recherche Documentation Officielle","text":"<p>Consultation de la documentation Dashy officielle : - https://dashy.to/docs/status-indicators/ - https://github.com/Lissy93/dashy/wiki/status-indicators</p> <p>D\u00e9couverte cl\u00e9 : Mettre <code>statusCheck: false</code> ne suffit PAS. Il faut supprimer compl\u00e8tement les lignes du fichier de configuration.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#2-modifications-configuration-dashy","title":"2. Modifications Configuration Dashy","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#avant-ne-fonctionnait-pas","title":"Avant (ne fonctionnait pas)","text":"<pre><code>appConfig:\n  statusCheck: false\n  statusCheckInterval: 0\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#apres-fonctionne","title":"Apr\u00e8s (fonctionne)","text":"<pre><code>appConfig:\n  # statusCheck: REMOVED to prevent axios polling\n  # statusCheckInterval: REMOVED\n  # DO NOT set to false - DELETE the lines completely\n</code></pre> <p>Raison : Les sessions navigateur gardent l'ancienne configuration en localStorage. M\u00eame avec <code>false</code>, le backend Dashy continuait les health checks.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#3-suppression-complete-des-status-checks","title":"3. Suppression Compl\u00e8te des Status Checks","text":"<pre><code># Fichier : /opt/dashy/conf.yml\n# Suppression de toutes les lignes statusCheck (true/false)\nsed -i '/^[[:space:]]*statusCheck: \\(true\\|false\\)/d' conf.yml\n\n# Red\u00e9marrage complet\ncd /opt/dashy\ndocker-compose down\ndocker-compose up -d\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#4-configuration-docker-auto-stop","title":"4. Configuration Docker Auto-Stop","text":"<p>Dashy retir\u00e9 de la configuration auto-stop : - Dashy reste toujours actif (pas d'auto-stop) - \u00c9vite tout conflit avec le syst\u00e8me de monitoring - 23 services configur\u00e9s avec auto-stop (900s = 15 min)</p> <pre><code># Retrait de Dashy de config.json\njq 'del(.services[\"dashy.srv759970.hstgr.cloud\"])' /opt/docker-autostart/config.json\nsystemctl restart docker-autostart\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#5-desactivation-nginx-auto-docker","title":"5. D\u00e9sactivation nginx-auto-docker","text":"<p>Ancien syst\u00e8me d'auto-start conflictuel d\u00e9tect\u00e9 et d\u00e9sactiv\u00e9 :</p> <pre><code>systemctl disable --now nginx-auto-docker.service\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#resultats","title":"R\u00e9sultats","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#preuves-de-fonctionnement","title":"\u2705 Preuves de Fonctionnement","text":"<ol> <li>Auto-Stop V\u00e9rifi\u00e9</li> <li>SolidarLink \u00e9tait arr\u00eat\u00e9 (<code>Exited (0) 8 hours ago</code>)</li> <li> <p>Auto-start test\u00e9 avec succ\u00e8s : d\u00e9marrage en 9 secondes lors de l'acc\u00e8s</p> </li> <li> <p>Requ\u00eates Axios Arr\u00eat\u00e9es</p> </li> <li>Derni\u00e8re requ\u00eate axios : 07:06 (24/10/2025)</li> <li>Aucune nouvelle requ\u00eate apr\u00e8s red\u00e9marrage Dashy</li> <li> <p>Monitoring pendant 3 minutes : 0 requ\u00eate axios</p> </li> <li> <p>Services Auto-Stop Actifs <pre><code>Services configur\u00e9s : 23\nTimeout global : 900s (15 minutes)\n\u00c9tat : \u2705 Fonctionnel\n</code></pre></p> </li> </ol>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#statistiques-avantapres","title":"Statistiques Avant/Apr\u00e8s","text":"M\u00e9trique Avant Apr\u00e8s Requ\u00eates axios/minute 1 0 Services pouvant s'arr\u00eater 0 23 Timeout effectif Jamais atteint 15 minutes RAM \u00e9conomis\u00e9e (potentiel) 0 GB ~4.7 GB"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#configuration-finale","title":"Configuration Finale","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#services-avec-auto-stop-15-min","title":"Services avec Auto-Stop (15 min)","text":"<ul> <li>Sites WordPress :</li> <li>Cl\u00e9mence (<code>clemence.srv759970.hstgr.cloud</code>)</li> <li>SolidarLink (<code>solidarlink.srv759970.hstgr.cloud</code>)</li> <li>PanneauxSolidaires</li> <li> <p>JeSuisHyperphagique</p> </li> <li> <p>APIs IA :</p> </li> <li>WhisperX (transcription + diarization)</li> <li>Faster-Whisper (transcription rapide)</li> <li>MemVid RAG</li> <li>RAG-Anything</li> <li> <p>NeuTTS</p> </li> <li> <p>Applications :</p> </li> <li>Cristina (Astro + Strapi)</li> <li>n8n (automation)</li> <li>Support Dashboard (Streamlit)</li> <li>SharePoint Dashboards</li> </ul>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#services-toujours-actifs","title":"Services Toujours Actifs","text":"<ul> <li>Dashy Portal (monitoring)</li> <li>Nginx (reverse proxy)</li> <li>Docker-autostart service</li> <li>Grafana/Prometheus (monitoring)</li> <li>Base de donn\u00e9es partag\u00e9es (MySQL, PostgreSQL, Redis)</li> </ul>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#commandes-de-verification","title":"Commandes de V\u00e9rification","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#verifier-letat-auto-stop","title":"V\u00e9rifier l'\u00e9tat auto-stop","text":"<pre><code># \u00c9tat des services\ndocker ps -a --filter name='clemence|solidarlink' --format 'table {{.Names}}\\t{{.Status}}'\n\n# Logs docker-autostart\njournalctl -u docker-autostart --since '30 minutes ago' | grep -E 'Stopping|stopped'\n\n# V\u00e9rifier absence requ\u00eates axios\ntail -100 /var/log/nginx/clemence-access.log | grep axios | wc -l\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#tester-lauto-start","title":"Tester l'auto-start","text":"<pre><code># 1. Arr\u00eater un service\ncd /opt/wordpress-solidarlink &amp;&amp; docker-compose stop\n\n# 2. Acc\u00e9der au site\ncurl -I https://solidarlink.srv759970.hstgr.cloud\n\n# 3. V\u00e9rifier d\u00e9marrage\ndocker ps --filter name=solidarlink\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#lecons-apprises","title":"Le\u00e7ons Apprises","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#1-documentation-officielle-essentielle","title":"1. Documentation Officielle Essentielle","text":"<p>La solution \u00e9tait dans la doc officielle Dashy : <code>statusCheck: false</code> ne suffit pas, il faut supprimer compl\u00e8tement les lignes.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#2-cache-navigateur-persistant","title":"2. Cache Navigateur Persistant","text":"<p>Les configurations frontend peuvent persister en localStorage m\u00eame apr\u00e8s modification du serveur.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#3-monitoring-vs-auto-stop","title":"3. Monitoring vs Auto-Stop","text":"<p>Syst\u00e8mes de monitoring et auto-stop peuvent entrer en conflit. Solution : exclure les outils de monitoring de l'auto-stop.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#4-logs-nginx-precieux","title":"4. Logs Nginx Pr\u00e9cieux","text":"<p>Les logs nginx (<code>/var/log/nginx/*-access.log</code>) sont essentiels pour diagnostiquer le trafic r\u00e9seau et identifier les sources de requ\u00eates.</p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#actions-preventives","title":"Actions Pr\u00e9ventives","text":""},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#1-monitoring-ameliore","title":"1. Monitoring Am\u00e9lior\u00e9","text":"<p>Ajouter une alerte si les requ\u00eates axios r\u00e9apparaissent : <pre><code># \u00c0 impl\u00e9menter dans monitoring\ntail -f /var/log/nginx/clemence-access.log | grep --line-buffered axios\n</code></pre></p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#2-documentation-mise-a-jour","title":"2. Documentation Mise \u00e0 Jour","text":"<ul> <li>\u2705 Changelog cr\u00e9\u00e9</li> <li>\u23f3 Documentation Dashy mise \u00e0 jour</li> <li>\u23f3 Guide docker-autostart mis \u00e0 jour</li> </ul>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#3-tests-reguliers","title":"3. Tests R\u00e9guliers","text":"<p>V\u00e9rifier p\u00e9riodiquement que l'auto-stop fonctionne : <pre><code># Script de test (\u00e0 cr\u00e9er)\n./scripts/test-autostart.sh\n</code></pre></p>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#fichiers-modifies","title":"Fichiers Modifi\u00e9s","text":"<pre><code>/opt/dashy/conf.yml                           # Configuration Dashy nettoy\u00e9e\n/opt/docker-autostart/config.json             # Dashy retir\u00e9, 23 services\n/etc/systemd/system/nginx-auto-docker.service # D\u00e9sactiv\u00e9\ndocs/changelog/dashy-autostart-fix-2025-10-24.md # Ce fichier\ndocs/services/infrastructure/dashy-portal.md  # \u00c0 mettre \u00e0 jour\ndocs/services/automation/docker-autostart.md  # \u00c0 mettre \u00e0 jour\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Dashy Docs: https://dashy.to/docs/status-indicators/</li> <li>Issue Similar: https://github.com/Lissy93/dashy/issues/35</li> <li>Docker Auto-Start: Guide</li> <li>Deployment Report: Bot Protection 2025-10-23</li> </ul>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#timeline","title":"Timeline","text":"<pre><code>06:00 - Identification du probl\u00e8me (requ\u00eates axios toutes les minutes)\n06:30 - Recherche documentation officielle Dashy\n07:00 - Test avec statusCheck: false (\u00e9chec)\n07:00 - Suppression compl\u00e8te des lignes statusCheck\n07:04 - Red\u00e9marrage Dashy avec config nettoy\u00e9e\n07:04 - Monitoring 3 minutes : 0 requ\u00eate axios\n07:10 - Test auto-start SolidarLink : \u2705 Succ\u00e8s (9s)\n07:13 - Configuration finale valid\u00e9e\n</code></pre>"},{"location":"06-changelog/dashy-autostart-fix-2025-10-24/#statut-final","title":"Statut Final","text":"<p>\u2705 R\u00c9SOLU - L'auto-stop fonctionne maintenant correctement \u23f1\ufe0f Timeout: 900 secondes (15 minutes) \ud83d\udcca Services: 23 services configur\u00e9s \ud83d\udeab Requ\u00eates Axios: 0 depuis 07:06 \ud83d\udc9a RAM \u00e9conomis\u00e9e: Jusqu'\u00e0 4.7 GB selon utilisation</p> <p>Prochaine \u00e9tape: Surveiller pendant 24h pour confirmer stabilit\u00e9 du syst\u00e8me.</p>"},{"location":"06-changelog/deployment-2025-10-20/","title":"Deployment Summary - October 20, 2025","text":""},{"location":"06-changelog/deployment-2025-10-20/#overview","title":"Overview","text":"<p>Completed full integration of Faster-Whisper into the RQ queue system, deployed new dashboards (Dashy, MkDocs), configured SSL/Nginx for all new services, and created unified Grafana monitoring for both transcription queues.</p>"},{"location":"06-changelog/deployment-2025-10-20/#completed-tasks","title":"\u2705 Completed Tasks","text":""},{"location":"06-changelog/deployment-2025-10-20/#1-faster-whisper-queue-integration","title":"1. Faster-Whisper Queue Integration","text":"<p>Location: <code>/opt/faster-whisper-queue/</code></p> <p>Services Deployed: - <code>faster-whisper</code>: Base transcription service (port 8001) - <code>faster-whisper-queue-api</code>: FastAPI wrapper with async endpoints (port 8003) - <code>faster-whisper-worker</code>: RQ worker for background processing</p> <p>Redis Architecture: - Shared Redis instance: <code>rq-queue-redis:6379</code> - DB 0: WhisperX queue (<code>transcription</code>) - DB 1: Faster-Whisper queue (<code>faster-whisper-transcription</code>)</p> <p>Key Features: - Synchronous endpoint: <code>POST /transcribe</code> - Asynchronous endpoint: <code>POST /transcribe/async</code> - Job status tracking: <code>GET /transcribe/status/{job_id}</code> - Queue statistics: <code>GET /queue/stats</code> - Health check: <code>GET /health</code></p>"},{"location":"06-changelog/deployment-2025-10-20/#2-documentation-portals","title":"2. Documentation &amp; Portals","text":""},{"location":"06-changelog/deployment-2025-10-20/#a-comprehensive-documentation","title":"A. Comprehensive Documentation","text":"<p>File: <code>docs/../services/faster-whisper-queue.md</code> - Architecture diagrams - Installation instructions - API usage examples - Monitoring setup - Troubleshooting guide - Performance benchmarks</p>"},{"location":"06-changelog/deployment-2025-10-20/#b-openapi-specification","title":"B. OpenAPI Specification","text":"<p>File: <code>assets/openapi/faster-whisper-queue-api.yaml</code> - Complete API documentation - Request/response schemas - Example payloads - Error responses</p>"},{"location":"06-changelog/deployment-2025-10-20/#c-updated-html-portal","title":"C. Updated HTML Portal","text":"<p>File: <code>assets/portal-index-updated.html</code> - Added Faster-Whisper Queue API card (NEW badge) - Added Grafana Monitoring card (NEW badge) - Updated infrastructure details section - Added Redis Queue architecture info</p>"},{"location":"06-changelog/deployment-2025-10-20/#d-dashy-dashboard","title":"D. Dashy Dashboard","text":"<p>URL: https://dashy.srv759970.hstgr.cloud Location: <code>/opt/dashy/</code> - Modern service dashboard with health checks - Organized sections: APIs, Monitoring, Apps - Real-time status indicators - Basic auth protected</p>"},{"location":"06-changelog/deployment-2025-10-20/#e-mkdocs-documentation-site","title":"E. MkDocs Documentation Site","text":"<p>URL: https://docs.srv759970.hstgr.cloud Location: <code>/opt/mkdocs/</code> - Material theme with dark/light mode - French language support - Search functionality - Code highlighting - Responsive navigation</p>"},{"location":"06-changelog/deployment-2025-10-20/#3-nginx-ssl-configuration","title":"3. Nginx &amp; SSL Configuration","text":""},{"location":"06-changelog/deployment-2025-10-20/#a-faster-whisper-queue-api","title":"A. Faster-Whisper Queue API","text":"<ul> <li>Domain: faster-whisper.srv759970.hstgr.cloud</li> <li>SSL: Let's Encrypt certificate (expires 2026-01-18)</li> <li>Port: 8003 \u2192 443</li> <li>Features: HTTPS, file upload support (500MB max)</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#b-dashy-dashboard","title":"B. Dashy Dashboard","text":"<ul> <li>Domain: dashy.srv759970.hstgr.cloud</li> <li>SSL: Shared certificate with faster-whisper</li> <li>Port: 4000 \u2192 443</li> <li>Auth: Basic authentication (server credentials)</li> <li>Features: WebSocket support for live updates</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#c-mkdocs-documentation","title":"C. MkDocs Documentation","text":"<ul> <li>Domain: docs.srv759970.hstgr.cloud</li> <li>SSL: Shared certificate with faster-whisper</li> <li>Port: 8005 \u2192 443</li> <li>Features: WebSocket for live reload during dev</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#4-grafana-unified-monitoring","title":"4. Grafana Unified Monitoring","text":""},{"location":"06-changelog/deployment-2025-10-20/#a-dual-rq-exporters","title":"A. Dual RQ Exporters","text":"<p>Configuration: <code>/opt/monitoring/docker-compose.yml</code></p> <ul> <li><code>rq-exporter-whisperx</code> (port 9726): Monitors Redis DB 0</li> <li><code>rq-exporter-faster-whisper</code> (port 9727): Monitors Redis DB 1</li> </ul> <p>Both exporters connected to shared <code>rq-queue-redis</code> instance on external network <code>whisperx_whisperx</code>.</p>"},{"location":"06-changelog/deployment-2025-10-20/#b-prometheus-configuration","title":"B. Prometheus Configuration","text":"<p>File: <code>/opt/monitoring/prometheus/prometheus.yml</code></p> <p>Two scrape jobs: <pre><code>- job_name: 'rq-whisperx'\n  static_configs:\n    - targets: ['rq-exporter-whisperx:9726']\n      labels:\n        service: 'whisperx'\n        queue: 'transcription'\n\n- job_name: 'rq-faster-whisper'\n  static_configs:\n    - targets: ['rq-exporter-faster-whisper:9726']\n      labels:\n        service: 'faster-whisper'\n        queue: 'faster-whisper-transcription'\n</code></pre></p>"},{"location":"06-changelog/deployment-2025-10-20/#c-grafana-dashboard","title":"C. Grafana Dashboard","text":"<p>File: <code>/opt/monitoring/grafana/provisioning/dashboards/whisper-queues-dashboard.json</code></p> <p>Panels: 1. Queue Overview - Worker count stats 2. Jobs by Status (WhisperX) - Time series graph 3. Jobs by Status (Faster-Whisper) - Time series graph 4. Worker Logs (WhisperX) - Live log streaming 5. Worker Logs (Faster-Whisper) - Live log streaming</p> <p>Access: https://monitoring.srv759970.hstgr.cloud - Basic auth (server credentials) - Grafana login: admin / YourSecurePassword2025!</p>"},{"location":"06-changelog/deployment-2025-10-20/#all-service-urls","title":"\ud83c\udf10 All Service URLs","text":""},{"location":"06-changelog/deployment-2025-10-20/#api-services","title":"API Services","text":"Service URL Port Status Faster-Whisper (base) http://srv759970.hstgr.cloud:8001 8001 \u2705 Faster-Whisper Queue API https://faster-whisper.srv759970.hstgr.cloud 8003 \u2705 WhisperX API http://srv759970.hstgr.cloud:8002 8002 \u2705 Swagger Docs (FW Queue) https://faster-whisper.srv759970.hstgr.cloud/docs 8003 \u2705"},{"location":"06-changelog/deployment-2025-10-20/#dashboards-documentation","title":"Dashboards &amp; Documentation","text":"Service URL Port Auth Status Dashy Dashboard https://dashy.srv759970.hstgr.cloud 4000 Basic \u2705 MkDocs Documentation https://docs.srv759970.hstgr.cloud 8005 None \u2705 HTML Portal (legacy) https://portal.srv759970.hstgr.cloud - None \u2705"},{"location":"06-changelog/deployment-2025-10-20/#monitoring","title":"Monitoring","text":"Service URL Port Auth Status Grafana https://monitoring.srv759970.hstgr.cloud 3001 Both \u2705 RQ Dashboard https://whisperx-dashboard.srv759970.hstgr.cloud 9181 Basic \u2705 Prometheus http://srv759970.hstgr.cloud:9090 9090 None \u2705"},{"location":"06-changelog/deployment-2025-10-20/#architecture-summary","title":"\ud83d\udcca Architecture Summary","text":""},{"location":"06-changelog/deployment-2025-10-20/#redis-queue-architecture","title":"Redis Queue Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 rq-queue-redis:6379 (Redis 7) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                         \u2502\n\u2502  DB 0: Queue \"transcription\"                           \u2502\n\u2502  \u2193                                                      \u2502\n\u2502  whisperx-worker \u2192 WhisperX API (:8002)               \u2502\n\u2502                                                         \u2502\n\u2502  DB 1: Queue \"faster-whisper-transcription\"           \u2502\n\u2502  \u2193                                                      \u2502\n\u2502  faster-whisper-worker \u2192 Faster-Whisper Queue (:8003)\u2502\n\u2502                           \u2193                             \u2502\n\u2502                      faster-whisper (:8001)            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"06-changelog/deployment-2025-10-20/#monitoring-stack","title":"Monitoring Stack","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Grafana (:3001)                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502 Prometheus           \u2502 Loki                  \u2502  \u2502\n\u2502  \u2502 (Metrics)            \u2502 (Logs)                \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                              \u2502\n         \u25bc                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 rq-exporter     \u2502          \u2502 Promtail        \u2502\n\u2502 (WhisperX)      \u2502          \u2502                 \u2502\n\u2502 :9726           \u2502          \u2502                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u2502\n\u2502 rq-exporter     \u2502                  \u25bc\n\u2502 (Faster-Whisper)\u2502          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 :9727           \u2502          \u2502 Docker Logs     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502 (7 containers)  \u2502\n         \u2502                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 rq-queue-redis  \u2502\n\u2502 :6379           \u2502\n\u2502 DB 0 + DB 1     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"06-changelog/deployment-2025-10-20/#configuration-files-modified","title":"\ud83d\udd27 Configuration Files Modified","text":""},{"location":"06-changelog/deployment-2025-10-20/#server-srv759970hstgrcloud","title":"Server (srv759970.hstgr.cloud)","text":"<ol> <li><code>/opt/faster-whisper-queue/docker-compose.yml</code> - New stack</li> <li><code>/opt/faster-whisper-queue/server.py</code> - FastAPI queue wrapper</li> <li><code>/opt/faster-whisper-queue/worker.py</code> - RQ worker</li> <li><code>/opt/faster-whisper-queue/Dockerfile</code> - Python 3.11 + dependencies</li> <li> <p><code>/opt/faster-whisper-queue/requirements.txt</code> - FastAPI, RQ, requests</p> </li> <li> <p><code>/opt/dashy/conf.yml</code> - Dashboard configuration</p> </li> <li> <p><code>/opt/dashy/docker-compose.yml</code> - Dashy deployment</p> </li> <li> <p><code>/opt/mkdocs/mkdocs.yml</code> - MkDocs Material config</p> </li> <li><code>/opt/mkdocs/docs/index.md</code> - Documentation homepage</li> <li><code>/opt/mkdocs/Dockerfile</code> - Python 3.11 + MkDocs</li> <li> <p><code>/opt/mkdocs/docker-compose.yml</code> - MkDocs deployment</p> </li> <li> <p><code>/opt/monitoring/docker-compose.yml</code> - Updated with dual RQ exporters</p> </li> <li><code>/opt/monitoring/prometheus/prometheus.yml</code> - Added both RQ scrape targets</li> <li><code>/opt/monitoring/grafana/provisioning/dashboards/whisper-queues-dashboard.json</code> - New unified dashboard</li> <li> <p><code>/opt/monitoring/grafana/provisioning/dashboards/dashboards.yml</code> - Dashboard provisioning config</p> </li> <li> <p><code>/etc/nginx/sites-available/faster-whisper-queue</code> - Nginx config for port 8003</p> </li> <li><code>/etc/nginx/sites-available/dashy</code> - Nginx config for Dashy</li> <li><code>/etc/nginx/sites-available/docs</code> - Nginx config for MkDocs</li> </ol>"},{"location":"06-changelog/deployment-2025-10-20/#local-repository","title":"Local Repository","text":"<ol> <li><code>docs/../services/faster-whisper-queue.md</code> - Complete integration guide</li> <li><code>assets/openapi/faster-whisper-queue-api.yaml</code> - OpenAPI 3.0 spec</li> <li><code>assets/portal-index-updated.html</code> - Updated HTML portal</li> <li><code>docs/DEPLOYMENT_SUMMARY_2025-10-20.md</code> - This file</li> </ol>"},{"location":"06-changelog/deployment-2025-10-20/#testing-verification","title":"\ud83e\uddea Testing &amp; Verification","text":""},{"location":"06-changelog/deployment-2025-10-20/#api-endpoint-tests","title":"API Endpoint Tests","text":"<pre><code># Faster-Whisper Queue API - Service Info\ncurl -s https://faster-whisper.srv759970.hstgr.cloud/ | jq .\n# Returns: {\"service\": \"Faster-Whisper Queue API\", \"version\": \"1.0.0\", ...}\n\n# Health Check\ncurl -s https://faster-whisper.srv759970.hstgr.cloud/health | jq .\n# Returns: {\"status\": \"healthy\", \"redis\": \"connected\", \"faster_whisper\": \"up\"}\n\n# Queue Stats\ncurl -s https://faster-whisper.srv759970.hstgr.cloud/queue/stats | jq .\n# Returns: {\"queue_name\": \"faster-whisper-transcription\", \"queued\": 0, ...}\n</code></pre>"},{"location":"06-changelog/deployment-2025-10-20/#async-transcription-test","title":"Async Transcription Test","text":"<pre><code># Submit job\nJOB_ID=$(curl -X POST https://faster-whisper.srv759970.hstgr.cloud/transcribe/async \\\n  -F \"file=@test.wav\" \\\n  -F \"language=fr\" | jq -r '.job_id')\n\n# Check status\ncurl -s https://faster-whisper.srv759970.hstgr.cloud/transcribe/status/$JOB_ID | jq .\n</code></pre>"},{"location":"06-changelog/deployment-2025-10-20/#prometheus-metrics","title":"Prometheus Metrics","text":"<pre><code># WhisperX workers\ncurl -s http://localhost:9726/metrics | grep rq_workers\n\n# Faster-Whisper workers\ncurl -s http://localhost:9727/metrics | grep rq_workers\n</code></pre>"},{"location":"06-changelog/deployment-2025-10-20/#performance-benchmarks","title":"\ud83d\udcc8 Performance Benchmarks","text":"Metric WhisperX (large-v2) Faster-Whisper (small) Model Size ~3GB ~500MB 5min Audio ~180s ~45s Quality (WER) 5.2% 8.7% Features Diarization + Alignment Transcription only Best For High-quality, diarization Speed, volume"},{"location":"06-changelog/deployment-2025-10-20/#security","title":"\ud83d\udd12 Security","text":""},{"location":"06-changelog/deployment-2025-10-20/#ssltls","title":"SSL/TLS","text":"<ul> <li>All public services use Let's Encrypt certificates</li> <li>Certificate expires: 2026-01-18</li> <li>Auto-renewal configured via certbot</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#authentication","title":"Authentication","text":"<ul> <li>Dashy: Basic auth (server credentials)</li> <li>Grafana: Basic auth + Grafana login</li> <li>RQ Dashboard: Basic auth</li> <li>MkDocs: Public (documentation)</li> <li>API Endpoints: No auth (internal network)</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#recommendations","title":"Recommendations","text":"<ul> <li>Consider adding API key authentication for transcription endpoints</li> <li>Implement rate limiting on public endpoints</li> <li>Regular security updates for all Docker images</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#next-steps-recommendations","title":"\ud83d\udcdd Next Steps &amp; Recommendations","text":""},{"location":"06-changelog/deployment-2025-10-20/#immediate","title":"Immediate","text":"<ol> <li>\u2705 All tasks completed successfully</li> </ol>"},{"location":"06-changelog/deployment-2025-10-20/#short-term-optional-enhancements","title":"Short-term (Optional Enhancements)","text":"<ol> <li>Copy existing documentation to MkDocs:</li> <li>Move all <code>docs/*.md</code> files to <code>/opt/mkdocs/docs/</code></li> <li>Organize into sections (services, infrastructure, guides)</li> <li> <p>Update navigation in <code>mkdocs.yml</code></p> </li> <li> <p>API Authentication:</p> </li> <li>Add API key middleware to FastAPI services</li> <li>Store keys in Redis or environment variables</li> <li> <p>Document authentication in OpenAPI specs</p> </li> <li> <p>Grafana Alerts:</p> </li> <li>Configure alerts for failed jobs &gt; threshold</li> <li>Set up email/Slack notifications</li> <li>Create runbooks for common issues</li> </ol>"},{"location":"06-changelog/deployment-2025-10-20/#long-term","title":"Long-term","text":"<ol> <li>Load Balancing:</li> <li>Deploy multiple workers per queue</li> <li>Implement job prioritization</li> <li> <p>Add worker auto-scaling based on queue length</p> </li> <li> <p>Backup &amp; Disaster Recovery:</p> </li> <li>Automated backups of Grafana dashboards</li> <li>Redis persistence configuration</li> <li> <p>Documentation backup to git repository</p> </li> <li> <p>Observability:</p> </li> <li>Add application-level metrics (processing time, file sizes)</li> <li>Implement distributed tracing (OpenTelemetry)</li> <li>Create SLO/SLI dashboards</li> </ol>"},{"location":"06-changelog/deployment-2025-10-20/#support-resources","title":"\ud83d\udcde Support &amp; Resources","text":""},{"location":"06-changelog/deployment-2025-10-20/#documentation","title":"Documentation","text":"<ul> <li>Faster-Whisper Queue Guide</li> <li>Monitoring Guide</li> <li>MkDocs Documentation</li> <li>Dashy Dashboard</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#external-resources","title":"External Resources","text":"<ul> <li>Faster-Whisper Server</li> <li>RQ Documentation</li> <li>Grafana Dashboards</li> <li>MkDocs Material</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Check container logs: <code>docker logs &lt;container_name&gt; --tail 50</code></li> <li>Verify Redis connection: <code>docker exec rq-queue-redis redis-cli ping</code></li> <li>Test API endpoints: Use Swagger UI at <code>/docs</code></li> <li>Monitor queues: RQ Dashboard or Grafana</li> </ul>"},{"location":"06-changelog/deployment-2025-10-20/#deployment-status-complete","title":"\u2705 Deployment Status: COMPLETE","text":"<p>Date: October 20, 2025 Duration: Full session Services Deployed: 3 new services + monitoring updates Configuration Files Modified: 22 Lines of Code Added: ~2,000 Documentation Created: 4 comprehensive guides</p> <p>All planned tasks completed successfully. System is production-ready and fully monitored.</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/","title":"Am\u00e9lioration Documentation - 2025-10-27","text":"<p>Type: Am\u00e9lioration majeure documentation Impact: Documentation beaucoup plus accessible pour nouveaux utilisateurs (LLM et humains) Dur\u00e9e: ~2h</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#resume","title":"\ud83d\udccb R\u00e9sum\u00e9","text":"<p>Suite \u00e0 l'analyse approfondie de la documentation et l'identification de 3 personas utilisateurs, ajout de contenus critiques manquants pour am\u00e9liorer l'onboarding et la maintenabilit\u00e9 du serveur.</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#nouveaux-documents-crees","title":"\u2705 Nouveaux Documents Cr\u00e9\u00e9s","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#1-llm_onboardingmd-guide-dentree-pour-llm","title":"1. LLM_ONBOARDING.md - Guide d'Entr\u00e9e pour LLM","text":"<p>Localisation: <code>docs/LLM_ONBOARDING.md</code></p> <p>Objectif: Permettre \u00e0 un assistant IA (Claude, GPT, etc.) de comprendre rapidement l'infrastructure srv759970 et r\u00e9pondre efficacement aux questions de l'administrateur.</p> <p>Contenu: - Vue d'ensemble serveur (identit\u00e9, type, architecture) - Sch\u00e9ma d'architecture global (Mermaid diagram) - Concepts cl\u00e9s \u00e0 comprendre:   - Syst\u00e8me auto-start/stop (CRITIQUE pour LLM)   - Architecture authentification   - Organisation Docker   - Stack de transcription - Structure documentation et navigation - Services principaux (tableaux de r\u00e9f\u00e9rence rapide) - Patterns de questions fr\u00e9quentes - Workflow recommand\u00e9 pour LLM - Pi\u00e8ges courants \u00e0 \u00e9viter - M\u00e9triques cl\u00e9s du serveur</p> <p>B\u00e9n\u00e9fice: Un LLM d\u00e9couvrant le serveur lit ce fichier en premier et comprend imm\u00e9diatement l'architecture et les particularit\u00e9s (notamment auto-start).</p> <p>Position dans Nav: \ud83e\udd16 Guide LLM (Start Here) - 2\u00e8me position apr\u00e8s Accueil</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#2-emergency_runbookmd-procedures-durgence","title":"2. EMERGENCY_RUNBOOK.md - Proc\u00e9dures d'Urgence","text":"<p>Localisation: <code>docs/EMERGENCY_RUNBOOK.md</code></p> <p>Objectif: Guide de r\u00e9ponse rapide pour incidents critiques (serveur down, services cass\u00e9s, etc.)</p> <p>Contenu: - Incidents critiques par niveau:   - \ud83d\udd34 Niveau 1: Serveur inaccessible (diagnostic 5min, actions imm\u00e9diates)   - \ud83d\udfe0 Niveau 2: Serveur OK, services down (checklist 2min)   - \ud83d\udfe1 Niveau 3: Service sp\u00e9cifique KO (diagnostic 3min)</p> <ul> <li>Checklist diagnostic complet:</li> <li>Phase 1: Sant\u00e9 syst\u00e8me (RAM, disque, services)</li> <li>Phase 2: Services critiques (Redis, Nginx, Auto-start)</li> <li> <p>Phase 3: Monitoring &amp; logs</p> </li> <li> <p>Proc\u00e9dures de r\u00e9paration:</p> </li> <li>Red\u00e9marrage propre service Docker</li> <li>Rebuild complet</li> <li>Nettoyage Docker (espace disque)</li> <li> <p>Red\u00e9marrage Nginx s\u00e9curis\u00e9</p> </li> <li> <p>Sc\u00e9narios d'urgence sp\u00e9cifiques:</p> </li> <li>OOM (Out of Memory) - RAM &gt;30GB</li> <li>Disque plein - / &gt;95%</li> <li>Redis Queue bloqu\u00e9e</li> <li> <p>Certificat SSL expir\u00e9</p> </li> <li> <p>Monitoring &amp; pr\u00e9vention:</p> </li> <li>M\u00e9triques \u00e0 surveiller (quotidien, hebdo, mensuel)</li> <li>Dashboards monitoring</li> <li> <p>Proc\u00e9dures maintenance pr\u00e9ventive</p> </li> <li> <p>Post-mortem template</p> </li> <li>Checklist apr\u00e8s r\u00e9solution</li> </ul> <p>B\u00e9n\u00e9fice: En cas d'incident \u00e0 3h du matin, proc\u00e9dures claires \u00e0 suivre \u00e9tape par \u00e9tape.</p> <p>Position dans Nav: \ud83d\udea8 Emergency Runbook - 3\u00e8me position (tr\u00e8s visible)</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#3-quick-start-api-servicesaiwhisperxmd-enrichissement","title":"3. Quick Start API - services/ai/whisperx.md (Enrichissement)","text":"<p>Modifications: Ajout section compl\u00e8te \"\ud83d\ude80 Quick Start - Transcrivez en 5 Minutes\"</p> <p>Nouveaux contenus:</p> <p>A. Exemples de code pratiques: - curl - Exemple complet avec auth, soumission, polling statut - Python - Code pr\u00eat \u00e0 l'emploi avec requests + polling - JavaScript (Node.js) - Async/await avec axios</p> <p>B. Limites &amp; Performances: - Tableau des limites (taille max, formats, dur\u00e9e, rate limit) - Performance moyenne (temps de traitement) - Langues support\u00e9es</p> <p>C. D\u00e9pendances: - Tableau des services requis (Redis, Worker, Nginx, SSL) - Impact si service down - Commandes v\u00e9rification d\u00e9pendances</p> <p>B\u00e9n\u00e9fice: Un d\u00e9veloppeur peut copier-coller le code et avoir une transcription fonctionnelle en 5 minutes, sans lire toute la doc.</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#4-guidesadvancedtemplates-patternsmd-templates-reutilisables","title":"4. guides/advanced/templates-patterns.md - Templates R\u00e9utilisables","text":"<p>Localisation: <code>docs/guides/advanced/templates-patterns.md</code></p> <p>Objectif: Biblioth\u00e8que de templates et patterns standardis\u00e9s pour d\u00e9ployer rapidement de nouveaux services.</p> <p>Contenu:</p> <p>A. Docker Compose Templates: - Service web standard - Service avec database (PostgreSQL) - Service auto-start - Service avec queue Redis - WordPress Docker complet</p> <p>B. Nginx Configuration Templates: - Reverse proxy HTTPS basique - Reverse proxy avec Basic Auth - Reverse proxy avec Auto-Start - WebSocket support</p> <p>C. Workflows de D\u00e9ploiement: - Script <code>deploy-service.sh</code> (nouveau service standard) - Script <code>add-to-autostart.sh</code> (ajout \u00e0 auto-start)</p> <p>D. Checklist D\u00e9ploiement: - Avant d\u00e9ploiement (v\u00e9rifications) - Pendant d\u00e9ploiement (\u00e9tapes) - Apr\u00e8s d\u00e9ploiement (validation)</p> <p>E. Patterns Communs: - Pattern: Service avec Queue Redis (architecture compl\u00e8te) - Pattern: WordPress Docker (structure type)</p> <p>B\u00e9n\u00e9fice: D\u00e9ployer un nouveau service en 15-30 minutes au lieu de 2-3 heures en partant de z\u00e9ro.</p> <p>Position dans Nav: Guides &gt; Avanc\u00e9 &gt; Templates &amp; Patterns</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#modifications-fichiers-existants","title":"\ud83d\udd27 Modifications Fichiers Existants","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#mkdocsyml","title":"mkdocs.yml","text":"<p>Changements: <pre><code>nav:\n  - Accueil: index.md\n  + - \ud83e\udd16 Guide LLM (Start Here): LLM_ONBOARDING.md\n  + - \ud83d\udea8 Emergency Runbook: EMERGENCY_RUNBOOK.md\n  - \ud83d\udcca \u00c9tat Serveur (Live): SERVER_STATUS.md\n  - \ud83d\ude80 Services Status (Live): SERVICES_STATUS.md\n\n  # [...]\n\n  - Guides:\n      - Avanc\u00e9:\n          + - Templates &amp; Patterns: guides/advanced/templates-patterns.md\n          - MCP Servers: guides/advanced/mcp-servers.md\n          # [...]\n</code></pre></p> <p>Impact: Navigation am\u00e9lior\u00e9e avec guides critiques en haut de liste</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#analyse-personas-contexte","title":"\ud83d\udcca Analyse Personas (Contexte)","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#persona-1-devops-solo-toi-910","title":"Persona 1: DevOps Solo (Toi) - 9/10","text":"<p>Forces: - \u2705 Changelogs d\u00e9taill\u00e9s - \u2705 Guides d\u00e9ploiement complets - \u2705 R\u00e9f\u00e9rence technique accessible - \u2705 Analyses d\u00e9cisionnelles (OAuth vs Basic Auth) - \u2705 Pages statut live</p> <p>Am\u00e9liorations apport\u00e9es: - \u2705 Emergency Runbook (manquait) - \u2705 Templates &amp; Patterns (gain temps) - \u2705 Guide LLM pour utilisation assistant IA</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#persona-2-developpeur-api-consumer-610-810","title":"Persona 2: D\u00e9veloppeur API Consumer - 6/10 \u2192 8/10","text":"<p>Manques identifi\u00e9s: - \u274c Quick Start API - \u274c Exemples de code - \u274c Limites/performances</p> <p>Am\u00e9liorations apport\u00e9es: - \u2705 Quick Start avec curl/Python/JS (WhisperX) - \u2705 Tableau limites &amp; performances - \u2705 Documentation d\u00e9pendances</p> <p>Reste \u00e0 faire: - \u23f3 Quick Start pour Faster-Whisper Queue - \u23f3 Quick Start pour Ollama - \u23f3 Quick Start pour autres APIs</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#persona-3-futur-toi-consultant-710-8510","title":"Persona 3: Futur Toi / Consultant - 7/10 \u2192 8.5/10","text":"<p>Manques identifi\u00e9s: - \u274c Runbook d'urgence - \u26a0\ufe0f Sch\u00e9mas architecture incomplets</p> <p>Am\u00e9liorations apport\u00e9es: - \u2705 Emergency Runbook complet - \u2705 Sch\u00e9ma architecture global (Mermaid dans LLM_ONBOARDING.md) - \u2705 Documentation d\u00e9pendances services</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#metriques-de-la-documentation","title":"\ud83d\udcc8 M\u00e9triques de la Documentation","text":"<p>Avant: - 84 fichiers Markdown - ~70 pages de services/guides/r\u00e9f\u00e9rence - Manques: Quick Start API, Runbook, Guide LLM</p> <p>Apr\u00e8s: - 87 fichiers Markdown (+3) - +3 pages critiques (~150 lignes chacune) - Score personas: 9/10, 8/10, 8.5/10</p> <p>Estimation gain de temps: - Onboarding LLM: 30min \u2192 5min (lecture LLM_ONBOARDING.md) - Incident critique: 2h debugging \u2192 30min (Emergency Runbook) - Nouveau service: 3h \u2192 30min (Templates &amp; Patterns) - Utilisation API: 30min lecture Swagger \u2192 5min copier-coller exemple</p>"},{"location":"06-changelog/docs-improvement-2025-10-27/#prochaines-etapes-optionnel","title":"\ud83c\udfaf Prochaines \u00c9tapes (Optionnel)","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#priorite-1-quick-wins","title":"Priorit\u00e9 1 - Quick Wins","text":"<ul> <li> Ajouter Quick Start sur <code>services/ai/faster-whisper-queue.md</code></li> <li> Ajouter Quick Start sur <code>services/ai/ollama.md</code></li> <li> Ajouter Quick Start sur <code>services/ai/tika.md</code></li> </ul>"},{"location":"06-changelog/docs-improvement-2025-10-27/#priorite-2-moyen-terme","title":"Priorit\u00e9 2 - Moyen Terme","text":"<ul> <li> Enrichir sch\u00e9mas architecture (diagrammes r\u00e9seau d\u00e9taill\u00e9s)</li> <li> Cr\u00e9er FAQ par service populaire</li> <li> Documenter tous les rate limits/performances</li> </ul>"},{"location":"06-changelog/docs-improvement-2025-10-27/#priorite-3-long-terme","title":"Priorit\u00e9 3 - Long Terme","text":"<ul> <li> Tutoriels vid\u00e9o (si pertinent)</li> <li> Embed monitoring dashboard dans docs</li> <li> Tests automatis\u00e9s des exemples de code</li> </ul>"},{"location":"06-changelog/docs-improvement-2025-10-27/#fichiers-modifiescrees","title":"\ud83d\udd17 Fichiers Modifi\u00e9s/Cr\u00e9\u00e9s","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#nouveaux-fichiers","title":"Nouveaux Fichiers","text":"<ol> <li><code>docs/LLM_ONBOARDING.md</code> - Guide d'entr\u00e9e LLM (350 lignes)</li> <li><code>docs/EMERGENCY_RUNBOOK.md</code> - Runbook urgence (600 lignes)</li> <li><code>docs/guides/advanced/templates-patterns.md</code> - Templates (500 lignes)</li> <li><code>docs/changelog/docs-improvement-2025-10-27.md</code> - Ce changelog</li> </ol>"},{"location":"06-changelog/docs-improvement-2025-10-27/#fichiers-modifies","title":"Fichiers Modifi\u00e9s","text":"<ol> <li><code>docs/services/ai/whisperx.md</code> - Ajout Quick Start + Limites + D\u00e9pendances</li> <li><code>mkdocs.yml</code> - Ajout nav LLM_ONBOARDING + EMERGENCY_RUNBOOK + templates-patterns</li> </ol>"},{"location":"06-changelog/docs-improvement-2025-10-27/#lecons-apprises","title":"\ud83d\udca1 Le\u00e7ons Apprises","text":""},{"location":"06-changelog/docs-improvement-2025-10-27/#ce-qui-fonctionne-bien","title":"Ce qui fonctionne bien","text":"<ol> <li>Changelogs d\u00e9taill\u00e9s - Excellente trace historique des d\u00e9cisions</li> <li>Structure MkDocs Material - Navigation intuitive</li> <li>Pages statut auto-g\u00e9n\u00e9r\u00e9es - Monitoring en temps r\u00e9el</li> <li>Analyses techniques (OAuth vs Basic Auth) - Tr\u00e8s utile pour comprendre le \"pourquoi\"</li> </ol>"},{"location":"06-changelog/docs-improvement-2025-10-27/#ce-qui-manquait","title":"Ce qui manquait","text":"<ol> <li>Guide d'onboarding - Crucial pour LLM ou nouveau mainteneur</li> <li>Proc\u00e9dures d'urgence - Indispensable en production</li> <li>Exemples de code - Acc\u00e9l\u00e8re adoption des APIs</li> <li>Templates r\u00e9utilisables - \u00c9vite de r\u00e9inventer la roue</li> </ol>"},{"location":"06-changelog/docs-improvement-2025-10-27/#recommandations-futures","title":"Recommandations futures","text":"<ul> <li>Toujours documenter les d\u00e9pendances entre services</li> <li>Toujours fournir des exemples de code pour les APIs</li> <li>Maintenir un runbook d'urgence \u00e0 jour</li> <li>Cr\u00e9er des templates d\u00e8s qu'un pattern se r\u00e9p\u00e8te 2-3 fois</li> </ul>"},{"location":"06-changelog/docs-improvement-2025-10-27/#contributeurs","title":"\ud83d\udc64 Contributeurs","text":"<ul> <li>Julien Fernandez - Propri\u00e9taire infrastructure</li> <li>Claude (Anthropic) - Analyse personas, r\u00e9daction documentation</li> </ul> <p>Impact Global: Documentation pass\u00e9e de \"Excellente pour usage solo\" (9/10) \u00e0 \"Pr\u00eate pour passation/onboarding externe\" (9.5/10)</p> <p>Next Review: Apr\u00e8s premier usage r\u00e9el par un LLM ou consultant externe</p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/","title":"Refactorisation Documentation - 23 Octobre 2025","text":""},{"location":"06-changelog/docs-refactoring-2025-10-23/#objectif","title":"\ud83c\udfaf Objectif","text":"<p>R\u00e9organisation compl\u00e8te de la documentation MkDocs pour am\u00e9liorer la navigation, la maintenabilit\u00e9 et la scalabilit\u00e9.</p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#resultat","title":"\ud83d\udcca R\u00e9sultat","text":"<ul> <li>Fichiers markdown : 80 fichiers organis\u00e9s</li> <li>Dossiers : 34 dossiers structur\u00e9s logiquement</li> <li>Warnings MkDocs : R\u00e9duits de ~90 \u00e0 3 (liens externes acceptables)</li> <li>Build time : 23.75 secondes</li> <li>Build status : \u2705 Succ\u00e8s</li> </ul>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#changements-majeurs","title":"\ud83d\udd04 Changements Majeurs","text":""},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-1-nettoyage-racine-docs","title":"Phase 1 : Nettoyage racine docs/","text":"<ul> <li>\u2705 Supprim\u00e9 3 dossiers vides : <code>docsguides/</code>, <code>docsinfrastructure/</code>, <code>docsservices/</code></li> <li>\u2705 <code>BOT_PROTECTION_DEPLOYMENT.md</code> \u2192 <code>changelog/bot-protection-2025-10-23.md</code></li> <li>\u2705 <code>SERVER_ENVIRONMENT.md</code> \u2192 <code>infrastructure/environment-setup.md</code></li> </ul>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-2-reorganisation-services","title":"Phase 2 : R\u00e9organisation services/","text":"<p>Cr\u00e9ation de 8 cat\u00e9gories claires : <pre><code>services/\n\u251c\u2500\u2500 collaboration/     (Nextcloud, Rocket.Chat, Jitsi)\n\u251c\u2500\u2500 ai/               (Ollama, WhisperX, XTTS, NeuTTS, Tika, Faster-Whisper)\n\u251c\u2500\u2500 documents/        (Paperless-ngx, Paperless AI)\n\u251c\u2500\u2500 websites/         (Cristina, WP Clemence, WP SolidarLink)\n\u251c\u2500\u2500 apps/             (Impro Manager, n8n)\n\u251c\u2500\u2500 infrastructure/   (Monitoring, Glances, Dozzle, Portainer, Dashy, DB)\n\u251c\u2500\u2500 automation/       (Docker Autostart)\n\u2514\u2500\u2500 rag/             (Pr\u00e9par\u00e9 pour futurs services RAG)\n</code></pre></p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-3-reorganisation-guides","title":"Phase 3 : R\u00e9organisation guides/","text":"<p>Structure logique en 6 sections : <pre><code>guides/\n\u251c\u2500\u2500 getting-started/   (Setup VPS initial)\n\u251c\u2500\u2500 deployment/        (Docker Autostart, Systemd)\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 wordpress/     (3 guides)\n\u2502   \u251c\u2500\u2500 ai/           (3 guides)\n\u2502   \u251c\u2500\u2500 rag/          (4 guides)\n\u2502   \u251c\u2500\u2500 cms/          (2 guides)\n\u2502   \u251c\u2500\u2500 automation/   (2 guides)\n\u2502   \u2514\u2500\u2500 monitoring/   (2 guides)\n\u251c\u2500\u2500 infrastructure/    (4 guides)\n\u251c\u2500\u2500 operations/        (Backup, Cloudflare, Photos)\n\u2514\u2500\u2500 advanced/          (MCP, API Portal, DevOps, LLM)\n</code></pre></p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-4-reorganisation-reference","title":"Phase 4 : R\u00e9organisation reference/","text":"<pre><code>reference/\n\u251c\u2500\u2500 docker/     (commands.md, compose-patterns.md)\n\u251c\u2500\u2500 nginx/      (proxy-config.md, debugging.md, headers.md, ssl-config.md)\n\u251c\u2500\u2500 security/   (basic-auth.md, ssl-certbot.md)\n\u2514\u2500\u2500 services/   (Pr\u00e9par\u00e9 pour configs r\u00e9utilisables)\n</code></pre>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-5-infrastructure","title":"Phase 5 : Infrastructure/","text":"<pre><code>infrastructure/\n\u251c\u2500\u2500 docker.md\n\u251c\u2500\u2500 nginx.md\n\u251c\u2500\u2500 security.md\n\u2514\u2500\u2500 environment-setup.md\n</code></pre>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#phase-6-navigation-mkdocs","title":"Phase 6 : Navigation MkDocs","text":"<p>Navigation compl\u00e8tement r\u00e9\u00e9crite : - Services D\u00e9ploy\u00e9s (cat\u00e9goris\u00e9s par fonction) - Infrastructure (vue d'ensemble architecture) - Guides (proc\u00e9dures \u00e9tape par \u00e9tape) - R\u00e9f\u00e9rence Technique (snippets et configs)</p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#corrections-de-liens","title":"\ud83d\udd17 Corrections de Liens","text":""},{"location":"06-changelog/docs-refactoring-2025-10-23/#liens-corriges-automatiquement","title":"Liens corrig\u00e9s automatiquement","text":"<ul> <li>\u2705 200+ liens internes mis \u00e0 jour</li> <li>\u2705 Chemins relatifs corrig\u00e9s (<code>../</code> \u2192 <code>../../</code> selon contexte)</li> <li>\u2705 Anciens noms de guides renomm\u00e9s</li> <li>\u2705 Services d\u00e9plac\u00e9s r\u00e9f\u00e9renc\u00e9s correctement</li> </ul>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#patterns-de-correction-appliques","title":"Patterns de correction appliqu\u00e9s","text":"<pre><code># Services\nservices/nextcloud.md \u2192 services/collaboration/nextcloud.md\nservices/whisperx.md \u2192 services/ai/whisperx.md\nservices/monitoring.md \u2192 services/infrastructure/monitoring.md\n\n# Guides\nguides/deployment/deploiement-vps.md \u2192 guides/getting-started/vps-initial-setup.md\nguides/applications/whisper-services.md \u2192 guides/services/ai/whisper-deployment.md\nguides/ai-rag/* \u2192 guides/services/rag/*\n\n# Reference\nreference/docker/common-commands.md \u2192 reference/docker/commands.md\nreference/nginx/configuration.md \u2192 reference/nginx/proxy-config.md\nreference/security/basic-auth-setup.md \u2192 reference/security/basic-auth.md\n</code></pre>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#warnings-acceptables-3-restants","title":"\u26a0\ufe0f Warnings Acceptables (3 restants)","text":"<p>Ces warnings concernent des liens vers <code>server-configs/</code> qui est un dossier hors documentation : 1. <code>guides/operations/backup-restore.md</code> \u2192 <code>../../server-configs/README.md</code> 2. <code>guides/operations/backup-restore.md</code> \u2192 <code>../../server-configs/INVENTORY.md</code> 3. <code>services/automation/docker-autostart.md</code> \u2192 <code>../../server-configs/INVENTORY.md</code></p> <p>Ces liens sont l\u00e9gitimes car ils pointent vers des fichiers de configuration du serveur qui ne font pas partie de la documentation publique.</p>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#benefices","title":"\u2705 B\u00e9n\u00e9fices","text":"<ol> <li>Navigation intuitive : Hi\u00e9rarchie claire et pr\u00e9visible</li> <li>Scalabilit\u00e9 : Facile d'ajouter de nouveaux services/guides</li> <li>Pas de duplication : Un seul emplacement par type d'information</li> <li>Maintenance facilit\u00e9e : Structure claire = moins d'erreurs</li> <li>Performance : Build rapide (23.75s pour 80 fichiers)</li> <li>SEO am\u00e9lior\u00e9 : Arborescence logique pour les moteurs de recherche</li> </ol>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#prochaines-etapes-recommandees","title":"\ud83d\udcdd Prochaines \u00c9tapes Recommand\u00e9es","text":"<ol> <li> <p>D\u00e9ployer sur le serveur :    <pre><code>mkdocs build\nrsync -avz site/ root@srv759970.hstgr.cloud:/var/www/docs/\n</code></pre></p> </li> <li> <p>Cr\u00e9er une section RAG : Le dossier <code>services/rag/</code> est pr\u00eat pour accueillir les futures docs RAGFlow, VideoRAG, etc.</p> </li> <li> <p>Compl\u00e9ter reference/services/ : Ajouter des configs r\u00e9utilisables pour Redis, PostgreSQL, MongoDB</p> </li> <li> <p>Ajouter guides/getting-started/ : Cr\u00e9er plus de guides pour d\u00e9butants (Docker basics, security first steps)</p> </li> </ol>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#structure-finale","title":"\ud83d\udd0d Structure Finale","text":"<pre><code>docs/\n\u251c\u2500\u2500 index.md (liens mis \u00e0 jour)\n\u251c\u2500\u2500 SERVER_STATUS.md (g\u00e9n\u00e9r\u00e9)\n\u251c\u2500\u2500 SERVICES_STATUS.md (g\u00e9n\u00e9r\u00e9)\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 collaboration/\n\u2502   \u251c\u2500\u2500 ai/\n\u2502   \u251c\u2500\u2500 rag/\n\u2502   \u251c\u2500\u2500 documents/\n\u2502   \u251c\u2500\u2500 websites/\n\u2502   \u251c\u2500\u2500 apps/\n\u2502   \u251c\u2500\u2500 infrastructure/\n\u2502   \u2514\u2500\u2500 automation/\n\u251c\u2500\u2500 infrastructure/\n\u251c\u2500\u2500 guides/\n\u2502   \u251c\u2500\u2500 getting-started/\n\u2502   \u251c\u2500\u2500 deployment/\n\u2502   \u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 infrastructure/\n\u2502   \u251c\u2500\u2500 operations/\n\u2502   \u2514\u2500\u2500 advanced/\n\u251c\u2500\u2500 reference/\n\u2502   \u251c\u2500\u2500 docker/\n\u2502   \u251c\u2500\u2500 nginx/\n\u2502   \u251c\u2500\u2500 security/\n\u2502   \u2514\u2500\u2500 services/\n\u251c\u2500\u2500 impro-manager/\n\u251c\u2500\u2500 changelog/\n\u251c\u2500\u2500 analysis/\n\u2514\u2500\u2500 archives/\n</code></pre>"},{"location":"06-changelog/docs-refactoring-2025-10-23/#timeline","title":"\ud83d\udcc5 Timeline","text":"<ul> <li>D\u00e9but : 23 octobre 2025 - 22h00</li> <li>Fin : 23 octobre 2025 - 22h40</li> <li>Dur\u00e9e totale : ~40 minutes</li> <li>Commits : Refactorisation compl\u00e8te en une session</li> </ul> <p>Refactorisation effectu\u00e9e automatiquement avec Claude Code</p>"},{"location":"99-dynamic/server-status/","title":"\ud83d\udcca \u00c9tat du Serveur en Temps R\u00e9el","text":"<p>\u26a0\ufe0f Note : Cette page est g\u00e9n\u00e9r\u00e9e automatiquement par un script. Derni\u00e8re mise \u00e0 jour visible ci-dessous.</p>"},{"location":"99-dynamic/server-status/#conteneurs-docker","title":"Conteneurs Docker","text":""},{"location":"99-dynamic/server-status/#statistiques-globales","title":"Statistiques Globales","text":"<ul> <li>Total conteneurs : Chargement...</li> <li>Running : Chargement...</li> <li>Stopped : Chargement...</li> </ul>"},{"location":"99-dynamic/server-status/#liste-complete","title":"Liste Compl\u00e8te","text":"Nom Statut Depuis Image Chargement... ... ... ..."},{"location":"99-dynamic/server-status/#utilisation-ressources","title":"Utilisation Ressources","text":""},{"location":"99-dynamic/server-status/#ram","title":"RAM","text":"<ul> <li>Total : Chargement...</li> <li>Utilis\u00e9 : Chargement...</li> <li>Libre : Chargement...</li> </ul>"},{"location":"99-dynamic/server-status/#disque","title":"Disque","text":"<ul> <li>Total : Chargement...</li> <li>Utilis\u00e9 : Chargement...</li> <li>Libre : Chargement...</li> </ul>"},{"location":"99-dynamic/server-status/#services-avec-auto-startstop","title":"Services avec Auto-Start/Stop","text":"<p>Ces services d\u00e9marrent automatiquement \u00e0 la demande et s'arr\u00eatent apr\u00e8s 30 minutes d'inactivit\u00e9 :</p> <ul> <li>Dashy Portal</li> <li>MkDocs Documentation</li> <li>Nextcloud</li> <li>WhisperX (+ workers + redis)</li> <li>Faster-Whisper</li> <li>Tika</li> <li>MemVid (UI + worker)</li> <li>RAGFlow (+ ES + MySQL + Redis + MinIO)</li> <li>RAG-Anything</li> <li>ONLYOFFICE</li> <li>Rocket.Chat</li> <li>Jitsi Meet</li> </ul> <p>Pour g\u00e9n\u00e9rer cette page automatiquement, utilisez le script <code>/opt/scripts/generate-server-status.sh</code></p>"},{"location":"99-dynamic/services-status/","title":"\ud83d\ude80 Services Status - Live","text":"<p>Auto-Generated Page</p> <p>Cette page est g\u00e9n\u00e9r\u00e9e automatiquement toutes les 5 minutes via le script <code>scripts/generate-services-status.sh</code>.</p> <p>Derni\u00e8re mise \u00e0 jour: 2025-10-23 18:53:47 UTC</p>"},{"location":"99-dynamic/services-status/#statistiques-globales","title":"\ud83d\udcca Statistiques Globales","text":"M\u00e9trique Valeur Total containers 64 \ud83d\udfe2 En cours d'ex\u00e9cution 42 \ud83d\udd34 Arr\u00eat\u00e9s 22 Serveur srv759970.hstgr.cloud"},{"location":"99-dynamic/services-status/#tous-les-services","title":"\ud83d\udce6 Tous les Services","text":"Container Status Uptime Ports <code>18183ed6dcdf_rag-anything-api</code> \ud83d\udd34 stopped - <code>dashy</code> \ud83d\udfe2 18 minutes (healthy) 0.0.0.0:4000-&gt;8080/tcp, [::]:4000-&gt;8080/tcp <code>dozzle</code> \ud83d\udd34 stopped 0.0.0.0:8888-&gt;8080/tcp, [::]:8888-&gt;8080/tcp <code>faster-whisper-worker</code> \ud83d\udfe2 3 hours 8003/tcp <code>faster-whisper</code> \ud83d\udd34 stopped 0.0.0.0:8001-&gt;8000/tcp, [::]:8001-&gt;8000/tcp <code>glances</code> \ud83d\udfe2 3 hours 127.0.0.1:61208-&gt;61208/tcp, 61209/tcp <code>grafana</code> \ud83d\udfe2 3 hours 0.0.0.0:3001-&gt;3000/tcp, [::]:3001-&gt;3000/tcp <code>hbbr</code> \ud83d\udfe2 3 hours 0.0.0.0:21117-&gt;21117/tcp, [::]:21117-&gt;21117/tcp, 0 <code>hbbs</code> \ud83d\udd34 stopped 0.0.0.0:21115-21116-&gt;21115-21116/tcp, [::]:21115-2 <code>impro-manager</code> \ud83d\udfe2 8 minutes (unhealthy) 0.0.0.0:8504-&gt;3001/tcp, [::]:8504-&gt;3001/tcp <code>jitsi-jicofo</code> \ud83d\udd34 stopped - <code>jitsi-jvb</code> \ud83d\udfe2 3 hours 0.0.0.0:10000-&gt;10000/udp, [::]:10000-&gt;10000/udp <code>jitsi-prosody</code> \ud83d\udfe2 3 hours 5222/tcp, 5280/tcp <code>jitsi-web</code> \ud83d\udd34 stopped 127.0.0.1:8510-&gt;80/tcp, 127.0.0.1:8511-&gt;443/tcp <code>loki</code> \ud83d\udfe2 3 hours 127.0.0.1:3100-&gt;3100/tcp <code>loving_curran</code> \ud83d\udd34 stopped - <code>memvid-api</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:8506-&gt;8503/tcp, [::]:8506-&gt;8503/tcp <code>memvid-ui</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:8507-&gt;8501/tcp, [::]:8507-&gt;8501/tcp <code>memvid-worker</code> \ud83d\udfe2 3 hours (unhealthy) 8503/tcp <code>mkdocs</code> \ud83d\udd34 stopped - <code>mongodb-exporter</code> \ud83d\udd34 stopped 127.0.0.1:9216-&gt;9216/tcp <code>mongodb-shared</code> \ud83d\udfe2 3 hours 127.0.0.1:27017-&gt;27017/tcp <code>mysql-clemence</code> \ud83d\udfe2 3 hours 3306/tcp, 33060/tcp <code>mysql-solidarlink</code> \ud83d\udfe2 3 hours 3306/tcp, 33060/tcp <code>mysql-wordpress-shared</code> \ud83d\udd34 stopped 33060/tcp, 0.0.0.0:3307-&gt;3306/tcp, [::]:3307-&gt;3306 <code>nextcloud-cron</code> \ud83d\udfe2 3 hours 80/tcp <code>nextcloud</code> \ud83d\udfe2 3 hours (healthy) 127.0.0.1:8505-&gt;80/tcp <code>nginx-clemence</code> \ud83d\udfe2 3 hours 0.0.0.0:9002-&gt;80/tcp, [::]:9002-&gt;80/tcp <code>nginx-jesuishyperphagique</code> \ud83d\udfe1 Restarting (1) 10 seconds ago - <code>nginx-panneauxsolidaires</code> \ud83d\udfe1 Restarting (1) 37 seconds ago - <code>nginx-solidarlink</code> \ud83d\udfe2 3 hours 0.0.0.0:9003-&gt;80/tcp, [::]:9003-&gt;80/tcp <code>onlyoffice</code> \ud83d\udd34 stopped 443/tcp, 127.0.0.1:8508-&gt;80/tcp <code>paperless-ai</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:3002-&gt;3000/tcp, [::]:3002-&gt;3000/tcp <code>paperless-db</code> \ud83d\udfe2 3 hours 0.0.0.0:5433-&gt;5432/tcp, [::]:5433-&gt;5432/tcp <code>paperless-gotenberg</code> \ud83d\udfe2 3 hours 3000/tcp <code>paperless-redis</code> \ud83d\udfe2 3 hours 0.0.0.0:6382-&gt;6379/tcp, [::]:6382-&gt;6379/tcp <code>paperless-webserver</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:8600-&gt;8000/tcp, [::]:8600-&gt;8000/tcp <code>portainer</code> \ud83d\udd34 stopped - <code>postgres-exporter</code> \ud83d\udfe2 3 hours 127.0.0.1:9187-&gt;9187/tcp <code>postgresql-shared</code> \ud83d\udfe2 3 hours (healthy) 127.0.0.1:5432-&gt;5432/tcp <code>prometheus</code> \ud83d\udfe2 3 hours 0.0.0.0:9090-&gt;9090/tcp, [::]:9090-&gt;9090/tcp <code>promtail</code> \ud83d\udfe2 3 hours - <code>ragflow-es-01</code> \ud83d\udfe2 3 hours (healthy) 9300/tcp, 0.0.0.0:1220-&gt;9200/tcp, [::]:1220-&gt;9200/ <code>ragflow-minio</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:9502-&gt;9000/tcp, [::]:9502-&gt;9000/tcp, 0.0.0 <code>ragflow-mysql</code> \ud83d\udfe2 3 hours (healthy) 33060/tcp, 0.0.0.0:5456-&gt;3306/tcp, [::]:5456-&gt;3306 <code>ragflow-redis</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:6381-&gt;6379/tcp, [::]:6381-&gt;6379/tcp <code>ragflow-server</code> \ud83d\udd34 stopped - <code>redis-exporter</code> \ud83d\udd34 stopped 127.0.0.1:9121-&gt;9121/tcp <code>redis-shared</code> \ud83d\udfe2 3 hours (healthy) 127.0.0.1:6379-&gt;6379/tcp <code>rocketchat</code> \ud83d\udd34 stopped 127.0.0.1:3002-&gt;3000/tcp <code>rq-exporter-faster-whisper</code> \ud83d\udfe2 3 hours 0.0.0.0:9727-&gt;9726/tcp, [::]:9727-&gt;9726/tcp <code>rq-exporter-whisperx</code> \ud83d\udfe2 3 hours 0.0.0.0:9726-&gt;9726/tcp, [::]:9726-&gt;9726/tcp <code>rq-queue-redis</code> \ud83d\udfe2 24 minutes (healthy) 0.0.0.0:6380-&gt;6379/tcp, [::]:6380-&gt;6379/tcp <code>swagger-ui</code> \ud83d\udd34 stopped 80/tcp, 0.0.0.0:8503-&gt;8080/tcp, [::]:8503-&gt;8080/tc <code>tika-server</code> \ud83d\udd34 stopped - <code>whisperx-dashboard</code> \ud83d\udfe2 24 minutes 0.0.0.0:9181-&gt;9181/tcp, [::]:9181-&gt;9181/tcp <code>whisperx-worker</code> \ud83d\udfe2 24 minutes 8002/tcp <code>whisperx</code> \ud83d\udfe2 24 minutes (healthy) 0.0.0.0:8002-&gt;8002/tcp, [::]:8002-&gt;8002/tcp <code>wordpress-clemence</code> \ud83d\udfe2 3 hours 9000/tcp <code>wordpress-solidarlink</code> \ud83d\udfe2 3 hours 9000/tcp <code>wp-cli-clemence</code> \ud83d\udd34 stopped - <code>wp-cli-solidarlink</code> \ud83d\udd34 stopped - <code>xtts-api</code> \ud83d\udfe2 3 hours (healthy) 0.0.0.0:8004-&gt;8004/tcp, [::]:8004-&gt;8004/tcp <code>xtts-streamlit</code> \ud83d\udd34 stopped 0.0.0.0:8501-&gt;8501/tcp, [::]:8501-&gt;8501/tcp"},{"location":"99-dynamic/services-status/#ressources-systeme","title":"\ud83d\udcbb Ressources Syst\u00e8me","text":"Ressource Utilisation Total RAM 12Gi (81.1%) 15Gi Disque 138G (72%) 193G"},{"location":"99-dynamic/services-status/#top-10-consommateurs-ram","title":"\ud83d\udd25 Top 10 Consommateurs (RAM)","text":"<pre><code>NAME                         MEM USAGE / LIMIT     CPU %\npaperless-ai                 1.033GiB / 15.62GiB   0.36%\npaperless-webserver          536.8MiB / 15.62GiB   0.08%\npaperless-redis              5.449MiB / 15.62GiB   0.31%\npaperless-gotenberg          7.035MiB / 15.62GiB   0.05%\npaperless-db                 27.47MiB / 15.62GiB   0.00%\nimpro-manager                49.7MiB / 15.62GiB    0.00%\nnginx-clemence               4.941MiB / 15.62GiB   0.00%\nwordpress-clemence           69.48MiB / 15.62GiB   0.01%\nmysql-clemence               383.6MiB / 15.62GiB   0.74%\nglances                      53.71MiB / 256MiB     0.31%\n</code></pre>"},{"location":"99-dynamic/services-status/#legende","title":"\ud83d\udcd6 L\u00e9gende","text":"<ul> <li>\ud83d\udfe2 Running - Container actif</li> <li>\ud83d\udd34 Stopped - Container arr\u00eat\u00e9</li> <li>\ud83d\udfe1 Restarting - Container en red\u00e9marrage</li> <li>\u26aa Other - Autre statut</li> </ul>"},{"location":"99-dynamic/services-status/#mise-a-jour","title":"\ud83d\udd04 Mise \u00e0 Jour","text":"<p>Pour mettre \u00e0 jour manuellement:</p> <pre><code>cd /root/hostinger\n./scripts/generate-services-status.sh\n</code></pre>"},{"location":"99-dynamic/services-status/#liens-rapides","title":"\ud83d\udd17 Liens Rapides","text":"<ul> <li>Dashy Portal - Dashboard visuel</li> <li>Portainer - Gestion Docker</li> <li>Dozzle - Logs temps r\u00e9el</li> <li>Grafana - Monitoring</li> </ul> <p>G\u00e9n\u00e9r\u00e9 le 2025-10-23 18:53:47 UTC</p>"}]}